/* Generated by Cython 0.24 */

#define PY_SSIZE_T_CLEAN
#include "Python.h"
#ifndef Py_PYTHON_H
    #error Python headers needed to compile C extensions, please install development version of Python.
#elif PY_VERSION_HEX < 0x02060000 || (0x03000000 <= PY_VERSION_HEX && PY_VERSION_HEX < 0x03020000)
    #error Cython requires Python 2.6+ or Python 3.2+.
#else
#define CYTHON_ABI "0_24"
#include <stddef.h>
#ifndef offsetof
  #define offsetof(type, member) ( (size_t) & ((type*)0) -> member )
#endif
#if !defined(WIN32) && !defined(MS_WINDOWS)
  #ifndef __stdcall
    #define __stdcall
  #endif
  #ifndef __cdecl
    #define __cdecl
  #endif
  #ifndef __fastcall
    #define __fastcall
  #endif
#endif
#ifndef DL_IMPORT
  #define DL_IMPORT(t) t
#endif
#ifndef DL_EXPORT
  #define DL_EXPORT(t) t
#endif
#ifndef PY_LONG_LONG
  #define PY_LONG_LONG LONG_LONG
#endif
#ifndef Py_HUGE_VAL
  #define Py_HUGE_VAL HUGE_VAL
#endif
#ifdef PYPY_VERSION
  #define CYTHON_COMPILING_IN_PYPY 1
  #define CYTHON_COMPILING_IN_CPYTHON 0
#else
  #define CYTHON_COMPILING_IN_PYPY 0
  #define CYTHON_COMPILING_IN_CPYTHON 1
#endif
#if !defined(CYTHON_USE_PYLONG_INTERNALS) && CYTHON_COMPILING_IN_CPYTHON && PY_VERSION_HEX >= 0x02070000
  #define CYTHON_USE_PYLONG_INTERNALS 1
#endif
#if CYTHON_USE_PYLONG_INTERNALS
  #include "longintrepr.h"
  #undef SHIFT
  #undef BASE
  #undef MASK
#endif
#if CYTHON_COMPILING_IN_PYPY && PY_VERSION_HEX < 0x02070600 && !defined(Py_OptimizeFlag)
  #define Py_OptimizeFlag 0
#endif
#define __PYX_BUILD_PY_SSIZE_T "n"
#define CYTHON_FORMAT_SSIZE_T "z"
#if PY_MAJOR_VERSION < 3
  #define __Pyx_BUILTIN_MODULE_NAME "__builtin__"
  #define __Pyx_PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)\
          PyCode_New(a+k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
  #define __Pyx_DefaultClassType PyClass_Type
#else
  #define __Pyx_BUILTIN_MODULE_NAME "builtins"
  #define __Pyx_PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)\
          PyCode_New(a, k, l, s, f, code, c, n, v, fv, cell, fn, name, fline, lnos)
  #define __Pyx_DefaultClassType PyType_Type
#endif
#ifndef Py_TPFLAGS_CHECKTYPES
  #define Py_TPFLAGS_CHECKTYPES 0
#endif
#ifndef Py_TPFLAGS_HAVE_INDEX
  #define Py_TPFLAGS_HAVE_INDEX 0
#endif
#ifndef Py_TPFLAGS_HAVE_NEWBUFFER
  #define Py_TPFLAGS_HAVE_NEWBUFFER 0
#endif
#ifndef Py_TPFLAGS_HAVE_FINALIZE
  #define Py_TPFLAGS_HAVE_FINALIZE 0
#endif
#if PY_VERSION_HEX > 0x03030000 && defined(PyUnicode_KIND)
  #define CYTHON_PEP393_ENABLED 1
  #define __Pyx_PyUnicode_READY(op)       (likely(PyUnicode_IS_READY(op)) ?\
                                              0 : _PyUnicode_Ready((PyObject *)(op)))
  #define __Pyx_PyUnicode_GET_LENGTH(u)   PyUnicode_GET_LENGTH(u)
  #define __Pyx_PyUnicode_READ_CHAR(u, i) PyUnicode_READ_CHAR(u, i)
  #define __Pyx_PyUnicode_KIND(u)         PyUnicode_KIND(u)
  #define __Pyx_PyUnicode_DATA(u)         PyUnicode_DATA(u)
  #define __Pyx_PyUnicode_READ(k, d, i)   PyUnicode_READ(k, d, i)
  #define __Pyx_PyUnicode_IS_TRUE(u)      (0 != (likely(PyUnicode_IS_READY(u)) ? PyUnicode_GET_LENGTH(u) : PyUnicode_GET_SIZE(u)))
#else
  #define CYTHON_PEP393_ENABLED 0
  #define __Pyx_PyUnicode_READY(op)       (0)
  #define __Pyx_PyUnicode_GET_LENGTH(u)   PyUnicode_GET_SIZE(u)
  #define __Pyx_PyUnicode_READ_CHAR(u, i) ((Py_UCS4)(PyUnicode_AS_UNICODE(u)[i]))
  #define __Pyx_PyUnicode_KIND(u)         (sizeof(Py_UNICODE))
  #define __Pyx_PyUnicode_DATA(u)         ((void*)PyUnicode_AS_UNICODE(u))
  #define __Pyx_PyUnicode_READ(k, d, i)   ((void)(k), (Py_UCS4)(((Py_UNICODE*)d)[i]))
  #define __Pyx_PyUnicode_IS_TRUE(u)      (0 != PyUnicode_GET_SIZE(u))
#endif
#if CYTHON_COMPILING_IN_PYPY
  #define __Pyx_PyUnicode_Concat(a, b)      PyNumber_Add(a, b)
  #define __Pyx_PyUnicode_ConcatSafe(a, b)  PyNumber_Add(a, b)
#else
  #define __Pyx_PyUnicode_Concat(a, b)      PyUnicode_Concat(a, b)
  #define __Pyx_PyUnicode_ConcatSafe(a, b)  ((unlikely((a) == Py_None) || unlikely((b) == Py_None)) ?\
      PyNumber_Add(a, b) : __Pyx_PyUnicode_Concat(a, b))
#endif
#if CYTHON_COMPILING_IN_PYPY && !defined(PyUnicode_Contains)
  #define PyUnicode_Contains(u, s)  PySequence_Contains(u, s)
#endif
#if CYTHON_COMPILING_IN_PYPY && !defined(PyObject_Format)
  #define PyObject_Format(obj, fmt)  PyObject_CallMethod(obj, "__format__", "O", fmt)
#endif
#if CYTHON_COMPILING_IN_PYPY && !defined(PyObject_Malloc)
  #define PyObject_Malloc(s)   PyMem_Malloc(s)
  #define PyObject_Free(p)     PyMem_Free(p)
  #define PyObject_Realloc(p)  PyMem_Realloc(p)
#endif
#define __Pyx_PyString_FormatSafe(a, b)   ((unlikely((a) == Py_None)) ? PyNumber_Remainder(a, b) : __Pyx_PyString_Format(a, b))
#define __Pyx_PyUnicode_FormatSafe(a, b)  ((unlikely((a) == Py_None)) ? PyNumber_Remainder(a, b) : PyUnicode_Format(a, b))
#if PY_MAJOR_VERSION >= 3
  #define __Pyx_PyString_Format(a, b)  PyUnicode_Format(a, b)
#else
  #define __Pyx_PyString_Format(a, b)  PyString_Format(a, b)
#endif
#if PY_MAJOR_VERSION < 3 && !defined(PyObject_ASCII)
  #define PyObject_ASCII(o)            PyObject_Repr(o)
#endif
#if PY_MAJOR_VERSION >= 3
  #define PyBaseString_Type            PyUnicode_Type
  #define PyStringObject               PyUnicodeObject
  #define PyString_Type                PyUnicode_Type
  #define PyString_Check               PyUnicode_Check
  #define PyString_CheckExact          PyUnicode_CheckExact
#endif
#if PY_MAJOR_VERSION >= 3
  #define __Pyx_PyBaseString_Check(obj) PyUnicode_Check(obj)
  #define __Pyx_PyBaseString_CheckExact(obj) PyUnicode_CheckExact(obj)
#else
  #define __Pyx_PyBaseString_Check(obj) (PyString_Check(obj) || PyUnicode_Check(obj))
  #define __Pyx_PyBaseString_CheckExact(obj) (PyString_CheckExact(obj) || PyUnicode_CheckExact(obj))
#endif
#ifndef PySet_CheckExact
  #define PySet_CheckExact(obj)        (Py_TYPE(obj) == &PySet_Type)
#endif
#define __Pyx_TypeCheck(obj, type) PyObject_TypeCheck(obj, (PyTypeObject *)type)
#if PY_MAJOR_VERSION >= 3
  #define PyIntObject                  PyLongObject
  #define PyInt_Type                   PyLong_Type
  #define PyInt_Check(op)              PyLong_Check(op)
  #define PyInt_CheckExact(op)         PyLong_CheckExact(op)
  #define PyInt_FromString             PyLong_FromString
  #define PyInt_FromUnicode            PyLong_FromUnicode
  #define PyInt_FromLong               PyLong_FromLong
  #define PyInt_FromSize_t             PyLong_FromSize_t
  #define PyInt_FromSsize_t            PyLong_FromSsize_t
  #define PyInt_AsLong                 PyLong_AsLong
  #define PyInt_AS_LONG                PyLong_AS_LONG
  #define PyInt_AsSsize_t              PyLong_AsSsize_t
  #define PyInt_AsUnsignedLongMask     PyLong_AsUnsignedLongMask
  #define PyInt_AsUnsignedLongLongMask PyLong_AsUnsignedLongLongMask
  #define PyNumber_Int                 PyNumber_Long
#endif
#if PY_MAJOR_VERSION >= 3
  #define PyBoolObject                 PyLongObject
#endif
#if PY_MAJOR_VERSION >= 3 && CYTHON_COMPILING_IN_PYPY
  #ifndef PyUnicode_InternFromString
    #define PyUnicode_InternFromString(s) PyUnicode_FromString(s)
  #endif
#endif
#if PY_VERSION_HEX < 0x030200A4
  typedef long Py_hash_t;
  #define __Pyx_PyInt_FromHash_t PyInt_FromLong
  #define __Pyx_PyInt_AsHash_t   PyInt_AsLong
#else
  #define __Pyx_PyInt_FromHash_t PyInt_FromSsize_t
  #define __Pyx_PyInt_AsHash_t   PyInt_AsSsize_t
#endif
#if PY_MAJOR_VERSION >= 3
  #define __Pyx_PyMethod_New(func, self, klass) ((self) ? PyMethod_New(func, self) : PyInstanceMethod_New(func))
#else
  #define __Pyx_PyMethod_New(func, self, klass) PyMethod_New(func, self, klass)
#endif
#if PY_VERSION_HEX >= 0x030500B1
#define __Pyx_PyAsyncMethodsStruct PyAsyncMethods
#define __Pyx_PyType_AsAsync(obj) (Py_TYPE(obj)->tp_as_async)
#elif CYTHON_COMPILING_IN_CPYTHON && PY_MAJOR_VERSION >= 3
typedef struct {
    unaryfunc am_await;
    unaryfunc am_aiter;
    unaryfunc am_anext;
} __Pyx_PyAsyncMethodsStruct;
#define __Pyx_PyType_AsAsync(obj) ((__Pyx_PyAsyncMethodsStruct*) (Py_TYPE(obj)->tp_reserved))
#else
#define __Pyx_PyType_AsAsync(obj) NULL
#endif
#ifndef CYTHON_RESTRICT
  #if defined(__GNUC__)
    #define CYTHON_RESTRICT __restrict__
  #elif defined(_MSC_VER) && _MSC_VER >= 1400
    #define CYTHON_RESTRICT __restrict
  #elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
    #define CYTHON_RESTRICT restrict
  #else
    #define CYTHON_RESTRICT
  #endif
#endif
#define __Pyx_void_to_None(void_result) ((void)(void_result), Py_INCREF(Py_None), Py_None)

#ifndef CYTHON_INLINE
  #if defined(__GNUC__)
    #define CYTHON_INLINE __inline__
  #elif defined(_MSC_VER)
    #define CYTHON_INLINE __inline
  #elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
    #define CYTHON_INLINE inline
  #else
    #define CYTHON_INLINE
  #endif
#endif

#if defined(WIN32) || defined(MS_WINDOWS)
  #define _USE_MATH_DEFINES
#endif
#include <math.h>
#ifdef NAN
#define __PYX_NAN() ((float) NAN)
#else
static CYTHON_INLINE float __PYX_NAN() {
  float value;
  memset(&value, 0xFF, sizeof(value));
  return value;
}
#endif


#define __PYX_ERR(f_index, lineno, Ln_error) \
{ \
  __pyx_filename = __pyx_f[f_index]; __pyx_lineno = lineno; __pyx_clineno = __LINE__; goto Ln_error; \
}

#if PY_MAJOR_VERSION >= 3
  #define __Pyx_PyNumber_Divide(x,y)         PyNumber_TrueDivide(x,y)
  #define __Pyx_PyNumber_InPlaceDivide(x,y)  PyNumber_InPlaceTrueDivide(x,y)
#else
  #define __Pyx_PyNumber_Divide(x,y)         PyNumber_TrueDivide(x,y)
  #define __Pyx_PyNumber_InPlaceDivide(x,y)  PyNumber_InPlaceTrueDivide(x,y)
#endif

#ifndef __PYX_EXTERN_C
  #ifdef __cplusplus
    #define __PYX_EXTERN_C extern "C"
  #else
    #define __PYX_EXTERN_C extern
  #endif
#endif

#define __PYX_HAVE__libTEXTURIZE
#define __PYX_HAVE_API__libTEXTURIZE
#include "math.h"
#include "string.h"
#include "stdio.h"
#include "stdlib.h"
#include "numpy/arrayobject.h"
#include "numpy/ufuncobject.h"
#ifdef _OPENMP
#include <omp.h>
#endif /* _OPENMP */

#ifdef PYREX_WITHOUT_ASSERTIONS
#define CYTHON_WITHOUT_ASSERTIONS
#endif

#ifndef CYTHON_UNUSED
# if defined(__GNUC__)
#   if !(defined(__cplusplus)) || (__GNUC__ > 3 || (__GNUC__ == 3 && __GNUC_MINOR__ >= 4))
#     define CYTHON_UNUSED __attribute__ ((__unused__))
#   else
#     define CYTHON_UNUSED
#   endif
# elif defined(__ICC) || (defined(__INTEL_COMPILER) && !defined(_MSC_VER))
#   define CYTHON_UNUSED __attribute__ ((__unused__))
# else
#   define CYTHON_UNUSED
# endif
#endif
#ifndef CYTHON_NCP_UNUSED
# if CYTHON_COMPILING_IN_CPYTHON
#  define CYTHON_NCP_UNUSED
# else
#  define CYTHON_NCP_UNUSED CYTHON_UNUSED
# endif
#endif
typedef struct {PyObject **p; const char *s; const Py_ssize_t n; const char* encoding;
                const char is_unicode; const char is_str; const char intern; } __Pyx_StringTabEntry;

#define __PYX_DEFAULT_STRING_ENCODING_IS_ASCII 0
#define __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT 0
#define __PYX_DEFAULT_STRING_ENCODING ""
#define __Pyx_PyObject_FromString __Pyx_PyBytes_FromString
#define __Pyx_PyObject_FromStringAndSize __Pyx_PyBytes_FromStringAndSize
#define __Pyx_uchar_cast(c) ((unsigned char)c)
#define __Pyx_long_cast(x) ((long)x)
#define __Pyx_fits_Py_ssize_t(v, type, is_signed)  (\
    (sizeof(type) < sizeof(Py_ssize_t))  ||\
    (sizeof(type) > sizeof(Py_ssize_t) &&\
          likely(v < (type)PY_SSIZE_T_MAX ||\
                 v == (type)PY_SSIZE_T_MAX)  &&\
          (!is_signed || likely(v > (type)PY_SSIZE_T_MIN ||\
                                v == (type)PY_SSIZE_T_MIN)))  ||\
    (sizeof(type) == sizeof(Py_ssize_t) &&\
          (is_signed || likely(v < (type)PY_SSIZE_T_MAX ||\
                               v == (type)PY_SSIZE_T_MAX)))  )
#if defined (__cplusplus) && __cplusplus >= 201103L
    #include <cstdlib>
    #define __Pyx_sst_abs(value) std::abs(value)
#elif SIZEOF_INT >= SIZEOF_SIZE_T
    #define __Pyx_sst_abs(value) abs(value)
#elif SIZEOF_LONG >= SIZEOF_SIZE_T
    #define __Pyx_sst_abs(value) labs(value)
#elif defined (_MSC_VER) && defined (_M_X64)
    #define __Pyx_sst_abs(value) _abs64(value)
#elif defined (__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
    #define __Pyx_sst_abs(value) llabs(value)
#elif defined (__GNUC__)
    #define __Pyx_sst_abs(value) __builtin_llabs(value)
#else
    #define __Pyx_sst_abs(value) ((value<0) ? -value : value)
#endif
static CYTHON_INLINE char* __Pyx_PyObject_AsString(PyObject*);
static CYTHON_INLINE char* __Pyx_PyObject_AsStringAndSize(PyObject*, Py_ssize_t* length);
#define __Pyx_PyByteArray_FromString(s) PyByteArray_FromStringAndSize((const char*)s, strlen((const char*)s))
#define __Pyx_PyByteArray_FromStringAndSize(s, l) PyByteArray_FromStringAndSize((const char*)s, l)
#define __Pyx_PyBytes_FromString        PyBytes_FromString
#define __Pyx_PyBytes_FromStringAndSize PyBytes_FromStringAndSize
static CYTHON_INLINE PyObject* __Pyx_PyUnicode_FromString(const char*);
#if PY_MAJOR_VERSION < 3
    #define __Pyx_PyStr_FromString        __Pyx_PyBytes_FromString
    #define __Pyx_PyStr_FromStringAndSize __Pyx_PyBytes_FromStringAndSize
#else
    #define __Pyx_PyStr_FromString        __Pyx_PyUnicode_FromString
    #define __Pyx_PyStr_FromStringAndSize __Pyx_PyUnicode_FromStringAndSize
#endif
#define __Pyx_PyObject_AsSString(s)    ((signed char*) __Pyx_PyObject_AsString(s))
#define __Pyx_PyObject_AsUString(s)    ((unsigned char*) __Pyx_PyObject_AsString(s))
#define __Pyx_PyObject_FromCString(s)  __Pyx_PyObject_FromString((const char*)s)
#define __Pyx_PyBytes_FromCString(s)   __Pyx_PyBytes_FromString((const char*)s)
#define __Pyx_PyByteArray_FromCString(s)   __Pyx_PyByteArray_FromString((const char*)s)
#define __Pyx_PyStr_FromCString(s)     __Pyx_PyStr_FromString((const char*)s)
#define __Pyx_PyUnicode_FromCString(s) __Pyx_PyUnicode_FromString((const char*)s)
#if PY_MAJOR_VERSION < 3
static CYTHON_INLINE size_t __Pyx_Py_UNICODE_strlen(const Py_UNICODE *u)
{
    const Py_UNICODE *u_end = u;
    while (*u_end++) ;
    return (size_t)(u_end - u - 1);
}
#else
#define __Pyx_Py_UNICODE_strlen Py_UNICODE_strlen
#endif
#define __Pyx_PyUnicode_FromUnicode(u)       PyUnicode_FromUnicode(u, __Pyx_Py_UNICODE_strlen(u))
#define __Pyx_PyUnicode_FromUnicodeAndLength PyUnicode_FromUnicode
#define __Pyx_PyUnicode_AsUnicode            PyUnicode_AsUnicode
#define __Pyx_NewRef(obj) (Py_INCREF(obj), obj)
#define __Pyx_Owned_Py_None(b) __Pyx_NewRef(Py_None)
#define __Pyx_PyBool_FromLong(b) ((b) ? __Pyx_NewRef(Py_True) : __Pyx_NewRef(Py_False))
static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject*);
static CYTHON_INLINE PyObject* __Pyx_PyNumber_IntOrLong(PyObject* x);
static CYTHON_INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject*);
static CYTHON_INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t);
#if CYTHON_COMPILING_IN_CPYTHON
#define __pyx_PyFloat_AsDouble(x) (PyFloat_CheckExact(x) ? PyFloat_AS_DOUBLE(x) : PyFloat_AsDouble(x))
#else
#define __pyx_PyFloat_AsDouble(x) PyFloat_AsDouble(x)
#endif
#define __pyx_PyFloat_AsFloat(x) ((float) __pyx_PyFloat_AsDouble(x))
#if PY_MAJOR_VERSION >= 3
#define __Pyx_PyNumber_Int(x) (PyLong_CheckExact(x) ? __Pyx_NewRef(x) : PyNumber_Long(x))
#else
#define __Pyx_PyNumber_Int(x) (PyInt_CheckExact(x) ? __Pyx_NewRef(x) : PyNumber_Int(x))
#endif
#define __Pyx_PyNumber_Float(x) (PyFloat_CheckExact(x) ? __Pyx_NewRef(x) : PyNumber_Float(x))
#if PY_MAJOR_VERSION < 3 && __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
static int __Pyx_sys_getdefaultencoding_not_ascii;
static int __Pyx_init_sys_getdefaultencoding_params(void) {
    PyObject* sys;
    PyObject* default_encoding = NULL;
    PyObject* ascii_chars_u = NULL;
    PyObject* ascii_chars_b = NULL;
    const char* default_encoding_c;
    sys = PyImport_ImportModule("sys");
    if (!sys) goto bad;
    default_encoding = PyObject_CallMethod(sys, (char*) "getdefaultencoding", NULL);
    Py_DECREF(sys);
    if (!default_encoding) goto bad;
    default_encoding_c = PyBytes_AsString(default_encoding);
    if (!default_encoding_c) goto bad;
    if (strcmp(default_encoding_c, "ascii") == 0) {
        __Pyx_sys_getdefaultencoding_not_ascii = 0;
    } else {
        char ascii_chars[128];
        int c;
        for (c = 0; c < 128; c++) {
            ascii_chars[c] = c;
        }
        __Pyx_sys_getdefaultencoding_not_ascii = 1;
        ascii_chars_u = PyUnicode_DecodeASCII(ascii_chars, 128, NULL);
        if (!ascii_chars_u) goto bad;
        ascii_chars_b = PyUnicode_AsEncodedString(ascii_chars_u, default_encoding_c, NULL);
        if (!ascii_chars_b || !PyBytes_Check(ascii_chars_b) || memcmp(ascii_chars, PyBytes_AS_STRING(ascii_chars_b), 128) != 0) {
            PyErr_Format(
                PyExc_ValueError,
                "This module compiled with c_string_encoding=ascii, but default encoding '%.200s' is not a superset of ascii.",
                default_encoding_c);
            goto bad;
        }
        Py_DECREF(ascii_chars_u);
        Py_DECREF(ascii_chars_b);
    }
    Py_DECREF(default_encoding);
    return 0;
bad:
    Py_XDECREF(default_encoding);
    Py_XDECREF(ascii_chars_u);
    Py_XDECREF(ascii_chars_b);
    return -1;
}
#endif
#if __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT && PY_MAJOR_VERSION >= 3
#define __Pyx_PyUnicode_FromStringAndSize(c_str, size) PyUnicode_DecodeUTF8(c_str, size, NULL)
#else
#define __Pyx_PyUnicode_FromStringAndSize(c_str, size) PyUnicode_Decode(c_str, size, __PYX_DEFAULT_STRING_ENCODING, NULL)
#if __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT
static char* __PYX_DEFAULT_STRING_ENCODING;
static int __Pyx_init_sys_getdefaultencoding_params(void) {
    PyObject* sys;
    PyObject* default_encoding = NULL;
    char* default_encoding_c;
    sys = PyImport_ImportModule("sys");
    if (!sys) goto bad;
    default_encoding = PyObject_CallMethod(sys, (char*) (const char*) "getdefaultencoding", NULL);
    Py_DECREF(sys);
    if (!default_encoding) goto bad;
    default_encoding_c = PyBytes_AsString(default_encoding);
    if (!default_encoding_c) goto bad;
    __PYX_DEFAULT_STRING_ENCODING = (char*) malloc(strlen(default_encoding_c));
    if (!__PYX_DEFAULT_STRING_ENCODING) goto bad;
    strcpy(__PYX_DEFAULT_STRING_ENCODING, default_encoding_c);
    Py_DECREF(default_encoding);
    return 0;
bad:
    Py_XDECREF(default_encoding);
    return -1;
}
#endif
#endif


/* Test for GCC > 2.95 */
#if defined(__GNUC__)     && (__GNUC__ > 2 || (__GNUC__ == 2 && (__GNUC_MINOR__ > 95)))
  #define likely(x)   __builtin_expect(!!(x), 1)
  #define unlikely(x) __builtin_expect(!!(x), 0)
#else /* !__GNUC__ or GCC < 2.95 */
  #define likely(x)   (x)
  #define unlikely(x) (x)
#endif /* __GNUC__ */

static PyObject *__pyx_m;
static PyObject *__pyx_d;
static PyObject *__pyx_b;
static PyObject *__pyx_empty_tuple;
static PyObject *__pyx_empty_bytes;
static PyObject *__pyx_empty_unicode;
static int __pyx_lineno;
static int __pyx_clineno = 0;
static const char * __pyx_cfilenm= __FILE__;
static const char *__pyx_filename;

/* None.proto */
#if !defined(CYTHON_CCOMPLEX)
  #if defined(__cplusplus)
    #define CYTHON_CCOMPLEX 1
  #elif defined(_Complex_I)
    #define CYTHON_CCOMPLEX 1
  #else
    #define CYTHON_CCOMPLEX 0
  #endif
#endif
#if CYTHON_CCOMPLEX
  #ifdef __cplusplus
    #include <complex>
  #else
    #include <complex.h>
  #endif
#endif
#if CYTHON_CCOMPLEX && !defined(__cplusplus) && defined(__sun__) && defined(__GNUC__)
  #undef _Complex_I
  #define _Complex_I 1.0fj
#endif


static const char *__pyx_f[] = {
  "libTEXTURIZE.pyx",
  "__init__.pxd",
  "type.pxd",
};
/* BufferFormatStructs.proto */
#define IS_UNSIGNED(type) (((type) -1) > 0)
struct __Pyx_StructField_;
#define __PYX_BUF_FLAGS_PACKED_STRUCT (1 << 0)
typedef struct {
  const char* name;
  struct __Pyx_StructField_* fields;
  size_t size;
  size_t arraysize[8];
  int ndim;
  char typegroup;
  char is_unsigned;
  int flags;
} __Pyx_TypeInfo;
typedef struct __Pyx_StructField_ {
  __Pyx_TypeInfo* type;
  const char* name;
  size_t offset;
} __Pyx_StructField;
typedef struct {
  __Pyx_StructField* field;
  size_t parent_offset;
} __Pyx_BufFmt_StackElem;
typedef struct {
  __Pyx_StructField root;
  __Pyx_BufFmt_StackElem* head;
  size_t fmt_offset;
  size_t new_count, enc_count;
  size_t struct_alignment;
  int is_complex;
  char enc_type;
  char new_packmode;
  char enc_packmode;
  char is_valid_array;
} __Pyx_BufFmt_Context;


/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":725
 * # in Cython to enable them only on the right systems.
 * 
 * ctypedef npy_int8       int8_t             # <<<<<<<<<<<<<<
 * ctypedef npy_int16      int16_t
 * ctypedef npy_int32      int32_t
 */
typedef npy_int8 __pyx_t_5numpy_int8_t;

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":726
 * 
 * ctypedef npy_int8       int8_t
 * ctypedef npy_int16      int16_t             # <<<<<<<<<<<<<<
 * ctypedef npy_int32      int32_t
 * ctypedef npy_int64      int64_t
 */
typedef npy_int16 __pyx_t_5numpy_int16_t;

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":727
 * ctypedef npy_int8       int8_t
 * ctypedef npy_int16      int16_t
 * ctypedef npy_int32      int32_t             # <<<<<<<<<<<<<<
 * ctypedef npy_int64      int64_t
 * #ctypedef npy_int96      int96_t
 */
typedef npy_int32 __pyx_t_5numpy_int32_t;

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":728
 * ctypedef npy_int16      int16_t
 * ctypedef npy_int32      int32_t
 * ctypedef npy_int64      int64_t             # <<<<<<<<<<<<<<
 * #ctypedef npy_int96      int96_t
 * #ctypedef npy_int128     int128_t
 */
typedef npy_int64 __pyx_t_5numpy_int64_t;

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":732
 * #ctypedef npy_int128     int128_t
 * 
 * ctypedef npy_uint8      uint8_t             # <<<<<<<<<<<<<<
 * ctypedef npy_uint16     uint16_t
 * ctypedef npy_uint32     uint32_t
 */
typedef npy_uint8 __pyx_t_5numpy_uint8_t;

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":733
 * 
 * ctypedef npy_uint8      uint8_t
 * ctypedef npy_uint16     uint16_t             # <<<<<<<<<<<<<<
 * ctypedef npy_uint32     uint32_t
 * ctypedef npy_uint64     uint64_t
 */
typedef npy_uint16 __pyx_t_5numpy_uint16_t;

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":734
 * ctypedef npy_uint8      uint8_t
 * ctypedef npy_uint16     uint16_t
 * ctypedef npy_uint32     uint32_t             # <<<<<<<<<<<<<<
 * ctypedef npy_uint64     uint64_t
 * #ctypedef npy_uint96     uint96_t
 */
typedef npy_uint32 __pyx_t_5numpy_uint32_t;

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":735
 * ctypedef npy_uint16     uint16_t
 * ctypedef npy_uint32     uint32_t
 * ctypedef npy_uint64     uint64_t             # <<<<<<<<<<<<<<
 * #ctypedef npy_uint96     uint96_t
 * #ctypedef npy_uint128    uint128_t
 */
typedef npy_uint64 __pyx_t_5numpy_uint64_t;

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":739
 * #ctypedef npy_uint128    uint128_t
 * 
 * ctypedef npy_float32    float32_t             # <<<<<<<<<<<<<<
 * ctypedef npy_float64    float64_t
 * #ctypedef npy_float80    float80_t
 */
typedef npy_float32 __pyx_t_5numpy_float32_t;

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":740
 * 
 * ctypedef npy_float32    float32_t
 * ctypedef npy_float64    float64_t             # <<<<<<<<<<<<<<
 * #ctypedef npy_float80    float80_t
 * #ctypedef npy_float128   float128_t
 */
typedef npy_float64 __pyx_t_5numpy_float64_t;

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":749
 * # The int types are mapped a bit surprising --
 * # numpy.int corresponds to 'l' and numpy.long to 'q'
 * ctypedef npy_long       int_t             # <<<<<<<<<<<<<<
 * ctypedef npy_longlong   long_t
 * ctypedef npy_longlong   longlong_t
 */
typedef npy_long __pyx_t_5numpy_int_t;

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":750
 * # numpy.int corresponds to 'l' and numpy.long to 'q'
 * ctypedef npy_long       int_t
 * ctypedef npy_longlong   long_t             # <<<<<<<<<<<<<<
 * ctypedef npy_longlong   longlong_t
 * 
 */
typedef npy_longlong __pyx_t_5numpy_long_t;

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":751
 * ctypedef npy_long       int_t
 * ctypedef npy_longlong   long_t
 * ctypedef npy_longlong   longlong_t             # <<<<<<<<<<<<<<
 * 
 * ctypedef npy_ulong      uint_t
 */
typedef npy_longlong __pyx_t_5numpy_longlong_t;

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":753
 * ctypedef npy_longlong   longlong_t
 * 
 * ctypedef npy_ulong      uint_t             # <<<<<<<<<<<<<<
 * ctypedef npy_ulonglong  ulong_t
 * ctypedef npy_ulonglong  ulonglong_t
 */
typedef npy_ulong __pyx_t_5numpy_uint_t;

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":754
 * 
 * ctypedef npy_ulong      uint_t
 * ctypedef npy_ulonglong  ulong_t             # <<<<<<<<<<<<<<
 * ctypedef npy_ulonglong  ulonglong_t
 * 
 */
typedef npy_ulonglong __pyx_t_5numpy_ulong_t;

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":755
 * ctypedef npy_ulong      uint_t
 * ctypedef npy_ulonglong  ulong_t
 * ctypedef npy_ulonglong  ulonglong_t             # <<<<<<<<<<<<<<
 * 
 * ctypedef npy_intp       intp_t
 */
typedef npy_ulonglong __pyx_t_5numpy_ulonglong_t;

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":757
 * ctypedef npy_ulonglong  ulonglong_t
 * 
 * ctypedef npy_intp       intp_t             # <<<<<<<<<<<<<<
 * ctypedef npy_uintp      uintp_t
 * 
 */
typedef npy_intp __pyx_t_5numpy_intp_t;

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":758
 * 
 * ctypedef npy_intp       intp_t
 * ctypedef npy_uintp      uintp_t             # <<<<<<<<<<<<<<
 * 
 * ctypedef npy_double     float_t
 */
typedef npy_uintp __pyx_t_5numpy_uintp_t;

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":760
 * ctypedef npy_uintp      uintp_t
 * 
 * ctypedef npy_double     float_t             # <<<<<<<<<<<<<<
 * ctypedef npy_double     double_t
 * ctypedef npy_longdouble longdouble_t
 */
typedef npy_double __pyx_t_5numpy_float_t;

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":761
 * 
 * ctypedef npy_double     float_t
 * ctypedef npy_double     double_t             # <<<<<<<<<<<<<<
 * ctypedef npy_longdouble longdouble_t
 * 
 */
typedef npy_double __pyx_t_5numpy_double_t;

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":762
 * ctypedef npy_double     float_t
 * ctypedef npy_double     double_t
 * ctypedef npy_longdouble longdouble_t             # <<<<<<<<<<<<<<
 * 
 * ctypedef npy_cfloat      cfloat_t
 */
typedef npy_longdouble __pyx_t_5numpy_longdouble_t;
/* None.proto */
#if CYTHON_CCOMPLEX
  #ifdef __cplusplus
    typedef ::std::complex< float > __pyx_t_float_complex;
  #else
    typedef float _Complex __pyx_t_float_complex;
  #endif
#else
    typedef struct { float real, imag; } __pyx_t_float_complex;
#endif

/* None.proto */
#if CYTHON_CCOMPLEX
  #ifdef __cplusplus
    typedef ::std::complex< double > __pyx_t_double_complex;
  #else
    typedef double _Complex __pyx_t_double_complex;
  #endif
#else
    typedef struct { double real, imag; } __pyx_t_double_complex;
#endif


/*--- Type declarations ---*/

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":764
 * ctypedef npy_longdouble longdouble_t
 * 
 * ctypedef npy_cfloat      cfloat_t             # <<<<<<<<<<<<<<
 * ctypedef npy_cdouble     cdouble_t
 * ctypedef npy_clongdouble clongdouble_t
 */
typedef npy_cfloat __pyx_t_5numpy_cfloat_t;

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":765
 * 
 * ctypedef npy_cfloat      cfloat_t
 * ctypedef npy_cdouble     cdouble_t             # <<<<<<<<<<<<<<
 * ctypedef npy_clongdouble clongdouble_t
 * 
 */
typedef npy_cdouble __pyx_t_5numpy_cdouble_t;

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":766
 * ctypedef npy_cfloat      cfloat_t
 * ctypedef npy_cdouble     cdouble_t
 * ctypedef npy_clongdouble clongdouble_t             # <<<<<<<<<<<<<<
 * 
 * ctypedef npy_cdouble     complex_t
 */
typedef npy_clongdouble __pyx_t_5numpy_clongdouble_t;

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":768
 * ctypedef npy_clongdouble clongdouble_t
 * 
 * ctypedef npy_cdouble     complex_t             # <<<<<<<<<<<<<<
 * 
 * cdef inline object PyArray_MultiIterNew1(a):
 */
typedef npy_cdouble __pyx_t_5numpy_complex_t;

/* --- Runtime support code (head) --- */
/* Refnanny.proto */
#ifndef CYTHON_REFNANNY
  #define CYTHON_REFNANNY 0
#endif
#if CYTHON_REFNANNY
  typedef struct {
    void (*INCREF)(void*, PyObject*, int);
    void (*DECREF)(void*, PyObject*, int);
    void (*GOTREF)(void*, PyObject*, int);
    void (*GIVEREF)(void*, PyObject*, int);
    void* (*SetupContext)(const char*, int, const char*);
    void (*FinishContext)(void**);
  } __Pyx_RefNannyAPIStruct;
  static __Pyx_RefNannyAPIStruct *__Pyx_RefNanny = NULL;
  static __Pyx_RefNannyAPIStruct *__Pyx_RefNannyImportAPI(const char *modname);
  #define __Pyx_RefNannyDeclarations void *__pyx_refnanny = NULL;
#ifdef WITH_THREAD
  #define __Pyx_RefNannySetupContext(name, acquire_gil)\
          if (acquire_gil) {\
              PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();\
              __pyx_refnanny = __Pyx_RefNanny->SetupContext((name), __LINE__, __FILE__);\
              PyGILState_Release(__pyx_gilstate_save);\
          } else {\
              __pyx_refnanny = __Pyx_RefNanny->SetupContext((name), __LINE__, __FILE__);\
          }
#else
  #define __Pyx_RefNannySetupContext(name, acquire_gil)\
          __pyx_refnanny = __Pyx_RefNanny->SetupContext((name), __LINE__, __FILE__)
#endif
  #define __Pyx_RefNannyFinishContext()\
          __Pyx_RefNanny->FinishContext(&__pyx_refnanny)
  #define __Pyx_INCREF(r)  __Pyx_RefNanny->INCREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_DECREF(r)  __Pyx_RefNanny->DECREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_GOTREF(r)  __Pyx_RefNanny->GOTREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_GIVEREF(r) __Pyx_RefNanny->GIVEREF(__pyx_refnanny, (PyObject *)(r), __LINE__)
  #define __Pyx_XINCREF(r)  do { if((r) != NULL) {__Pyx_INCREF(r); }} while(0)
  #define __Pyx_XDECREF(r)  do { if((r) != NULL) {__Pyx_DECREF(r); }} while(0)
  #define __Pyx_XGOTREF(r)  do { if((r) != NULL) {__Pyx_GOTREF(r); }} while(0)
  #define __Pyx_XGIVEREF(r) do { if((r) != NULL) {__Pyx_GIVEREF(r);}} while(0)
#else
  #define __Pyx_RefNannyDeclarations
  #define __Pyx_RefNannySetupContext(name, acquire_gil)
  #define __Pyx_RefNannyFinishContext()
  #define __Pyx_INCREF(r) Py_INCREF(r)
  #define __Pyx_DECREF(r) Py_DECREF(r)
  #define __Pyx_GOTREF(r)
  #define __Pyx_GIVEREF(r)
  #define __Pyx_XINCREF(r) Py_XINCREF(r)
  #define __Pyx_XDECREF(r) Py_XDECREF(r)
  #define __Pyx_XGOTREF(r)
  #define __Pyx_XGIVEREF(r)
#endif
#define __Pyx_XDECREF_SET(r, v) do {\
        PyObject *tmp = (PyObject *) r;\
        r = v; __Pyx_XDECREF(tmp);\
    } while (0)
#define __Pyx_DECREF_SET(r, v) do {\
        PyObject *tmp = (PyObject *) r;\
        r = v; __Pyx_DECREF(tmp);\
    } while (0)
#define __Pyx_CLEAR(r)    do { PyObject* tmp = ((PyObject*)(r)); r = NULL; __Pyx_DECREF(tmp);} while(0)
#define __Pyx_XCLEAR(r)   do { if((r) != NULL) {PyObject* tmp = ((PyObject*)(r)); r = NULL; __Pyx_DECREF(tmp);}} while(0)

/* PyObjectGetAttrStr.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_GetAttrStr(PyObject* obj, PyObject* attr_name) {
    PyTypeObject* tp = Py_TYPE(obj);
    if (likely(tp->tp_getattro))
        return tp->tp_getattro(obj, attr_name);
#if PY_MAJOR_VERSION < 3
    if (likely(tp->tp_getattr))
        return tp->tp_getattr(obj, PyString_AS_STRING(attr_name));
#endif
    return PyObject_GetAttr(obj, attr_name);
}
#else
#define __Pyx_PyObject_GetAttrStr(o,n) PyObject_GetAttr(o,n)
#endif

/* GetBuiltinName.proto */
static PyObject *__Pyx_GetBuiltinName(PyObject *name);

/* GetModuleGlobalName.proto */
static CYTHON_INLINE PyObject *__Pyx_GetModuleGlobalName(PyObject *name);

/* PyObjectCall.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw);
#else
#define __Pyx_PyObject_Call(func, arg, kw) PyObject_Call(func, arg, kw)
#endif

/* PyObjectCallMethO.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg);
#endif

/* PyObjectCallOneArg.proto */
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg);

/* ExtTypeTest.proto */
static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type);

/* BufferFormatCheck.proto */
static CYTHON_INLINE int  __Pyx_GetBufferAndValidate(Py_buffer* buf, PyObject* obj,
    __Pyx_TypeInfo* dtype, int flags, int nd, int cast, __Pyx_BufFmt_StackElem* stack);
static CYTHON_INLINE void __Pyx_SafeReleaseBuffer(Py_buffer* info);
static const char* __Pyx_BufFmt_CheckString(__Pyx_BufFmt_Context* ctx, const char* ts);
static void __Pyx_BufFmt_Init(__Pyx_BufFmt_Context* ctx,
                              __Pyx_BufFmt_StackElem* stack,
                              __Pyx_TypeInfo* type); // PROTO

/* PyObjectCallNoArg.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func);
#else
#define __Pyx_PyObject_CallNoArg(func) __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL)
#endif

/* BufferFallbackError.proto */
static void __Pyx_RaiseBufferFallbackError(void);

/* PyIntBinop.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx_PyInt_SubtractObjC(PyObject *op1, PyObject *op2, long intval, int inplace);
#else
#define __Pyx_PyInt_SubtractObjC(op1, op2, intval, inplace)\
    (inplace ? PyNumber_InPlaceSubtract(op1, op2) : PyNumber_Subtract(op1, op2))
#endif

#define __Pyx_BufPtrStrided1d(type, buf, i0, s0) (type)((char*)buf + i0 * s0)
#define __Pyx_BufPtrStrided3d(type, buf, i0, s0, i1, s1, i2, s2) (type)((char*)buf + i0 * s0 + i1 * s1 + i2 * s2)
/* PyObjectSetAttrStr.proto */
#if CYTHON_COMPILING_IN_CPYTHON
#define __Pyx_PyObject_DelAttrStr(o,n) __Pyx_PyObject_SetAttrStr(o,n,NULL)
static CYTHON_INLINE int __Pyx_PyObject_SetAttrStr(PyObject* obj, PyObject* attr_name, PyObject* value) {
    PyTypeObject* tp = Py_TYPE(obj);
    if (likely(tp->tp_setattro))
        return tp->tp_setattro(obj, attr_name, value);
#if PY_MAJOR_VERSION < 3
    if (likely(tp->tp_setattr))
        return tp->tp_setattr(obj, PyString_AS_STRING(attr_name), value);
#endif
    return PyObject_SetAttr(obj, attr_name, value);
}
#else
#define __Pyx_PyObject_DelAttrStr(o,n)   PyObject_DelAttr(o,n)
#define __Pyx_PyObject_SetAttrStr(o,n,v) PyObject_SetAttr(o,n,v)
#endif

/* PyThreadStateGet.proto */
#if CYTHON_COMPILING_IN_CPYTHON
#define __Pyx_PyThreadState_declare  PyThreadState *__pyx_tstate;
#define __Pyx_PyThreadState_assign  __pyx_tstate = PyThreadState_GET();
#else
#define __Pyx_PyThreadState_declare
#define __Pyx_PyThreadState_assign
#endif

/* PyErrFetchRestore.proto */
#if CYTHON_COMPILING_IN_CPYTHON
#define __Pyx_ErrRestoreWithState(type, value, tb)  __Pyx_ErrRestoreInState(PyThreadState_GET(), type, value, tb)
#define __Pyx_ErrFetchWithState(type, value, tb)    __Pyx_ErrFetchInState(PyThreadState_GET(), type, value, tb)
#define __Pyx_ErrRestore(type, value, tb)  __Pyx_ErrRestoreInState(__pyx_tstate, type, value, tb)
#define __Pyx_ErrFetch(type, value, tb)    __Pyx_ErrFetchInState(__pyx_tstate, type, value, tb)
static CYTHON_INLINE void __Pyx_ErrRestoreInState(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb);
static CYTHON_INLINE void __Pyx_ErrFetchInState(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb);
#else
#define __Pyx_ErrRestoreWithState(type, value, tb)  PyErr_Restore(type, value, tb)
#define __Pyx_ErrFetchWithState(type, value, tb)  PyErr_Fetch(type, value, tb)
#define __Pyx_ErrRestore(type, value, tb)  PyErr_Restore(type, value, tb)
#define __Pyx_ErrFetch(type, value, tb)  PyErr_Fetch(type, value, tb)
#endif

#define __Pyx_BufPtrStrided2d(type, buf, i0, s0, i1, s1) (type)((char*)buf + i0 * s0 + i1 * s1)
/* RaiseTooManyValuesToUnpack.proto */
static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected);

/* RaiseNeedMoreValuesToUnpack.proto */
static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index);

/* IterFinish.proto */
static CYTHON_INLINE int __Pyx_IterFinish(void);

/* UnpackItemEndCheck.proto */
static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected);

/* GetItemInt.proto */
#define __Pyx_GetItemInt(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
    __Pyx_GetItemInt_Fast(o, (Py_ssize_t)i, is_list, wraparound, boundscheck) :\
    (is_list ? (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL) :\
               __Pyx_GetItemInt_Generic(o, to_py_func(i))))
#define __Pyx_GetItemInt_List(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
    __Pyx_GetItemInt_List_Fast(o, (Py_ssize_t)i, wraparound, boundscheck) :\
    (PyErr_SetString(PyExc_IndexError, "list index out of range"), (PyObject*)NULL))
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i,
                                                              int wraparound, int boundscheck);
#define __Pyx_GetItemInt_Tuple(o, i, type, is_signed, to_py_func, is_list, wraparound, boundscheck)\
    (__Pyx_fits_Py_ssize_t(i, type, is_signed) ?\
    __Pyx_GetItemInt_Tuple_Fast(o, (Py_ssize_t)i, wraparound, boundscheck) :\
    (PyErr_SetString(PyExc_IndexError, "tuple index out of range"), (PyObject*)NULL))
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
                                                              int wraparound, int boundscheck);
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j);
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i,
                                                     int is_list, int wraparound, int boundscheck);

/* RaiseException.proto */
static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause);

/* DictGetItem.proto */
#if PY_MAJOR_VERSION >= 3 && !CYTHON_COMPILING_IN_PYPY
static PyObject *__Pyx_PyDict_GetItem(PyObject *d, PyObject* key) {
    PyObject *value;
    value = PyDict_GetItemWithError(d, key);
    if (unlikely(!value)) {
        if (!PyErr_Occurred()) {
            PyObject* args = PyTuple_Pack(1, key);
            if (likely(args))
                PyErr_SetObject(PyExc_KeyError, args);
            Py_XDECREF(args);
        }
        return NULL;
    }
    Py_INCREF(value);
    return value;
}
#else
    #define __Pyx_PyDict_GetItem(d, key) PyObject_GetItem(d, key)
#endif

/* RaiseNoneIterError.proto */
static CYTHON_INLINE void __Pyx_RaiseNoneNotIterableError(void);

/* Import.proto */
static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level);

/* ImportFrom.proto */
static PyObject* __Pyx_ImportFrom(PyObject* module, PyObject* name);

/* PyIntBinop.proto */
#if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx_PyInt_TrueDivideObjC(PyObject *op1, PyObject *op2, long intval, int inplace);
#else
#define __Pyx_PyInt_TrueDivideObjC(op1, op2, intval, inplace)\
    (inplace ? PyNumber_InPlaceTrueDivide(op1, op2) : PyNumber_TrueDivide(op1, op2))
#endif

/* CodeObjectCache.proto */
typedef struct {
    PyCodeObject* code_object;
    int code_line;
} __Pyx_CodeObjectCacheEntry;
struct __Pyx_CodeObjectCache {
    int count;
    int max_count;
    __Pyx_CodeObjectCacheEntry* entries;
};
static struct __Pyx_CodeObjectCache __pyx_code_cache = {0,0,NULL};
static int __pyx_bisect_code_objects(__Pyx_CodeObjectCacheEntry* entries, int count, int code_line);
static PyCodeObject *__pyx_find_code_object(int code_line);
static void __pyx_insert_code_object(int code_line, PyCodeObject* code_object);

/* AddTraceback.proto */
static void __Pyx_AddTraceback(const char *funcname, int c_line,
                               int py_line, const char *filename);

/* BufferStructDeclare.proto */
typedef struct {
  Py_ssize_t shape, strides, suboffsets;
} __Pyx_Buf_DimInfo;
typedef struct {
  size_t refcount;
  Py_buffer pybuffer;
} __Pyx_Buffer;
typedef struct {
  __Pyx_Buffer *rcbuffer;
  char *data;
  __Pyx_Buf_DimInfo diminfo[8];
} __Pyx_LocalBuf_ND;

#if PY_MAJOR_VERSION < 3
    static int __Pyx_GetBuffer(PyObject *obj, Py_buffer *view, int flags);
    static void __Pyx_ReleaseBuffer(Py_buffer *view);
#else
    #define __Pyx_GetBuffer PyObject_GetBuffer
    #define __Pyx_ReleaseBuffer PyBuffer_Release
#endif


/* None.proto */
static Py_ssize_t __Pyx_zeros[] = {0, 0, 0, 0, 0, 0, 0, 0};
static Py_ssize_t __Pyx_minusones[] = {-1, -1, -1, -1, -1, -1, -1, -1};

/* CIntToPy.proto */
static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value);

/* CIntToPy.proto */
static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value);

/* None.proto */
#if CYTHON_CCOMPLEX
  #ifdef __cplusplus
    #define __Pyx_CREAL(z) ((z).real())
    #define __Pyx_CIMAG(z) ((z).imag())
  #else
    #define __Pyx_CREAL(z) (__real__(z))
    #define __Pyx_CIMAG(z) (__imag__(z))
  #endif
#else
    #define __Pyx_CREAL(z) ((z).real)
    #define __Pyx_CIMAG(z) ((z).imag)
#endif
#if defined(__cplusplus) && CYTHON_CCOMPLEX         && (defined(_WIN32) || defined(__clang__) || (defined(__GNUC__) && (__GNUC__ >= 5 || __GNUC__ == 4 && __GNUC_MINOR__ >= 4 )) || __cplusplus >= 201103)
    #define __Pyx_SET_CREAL(z,x) ((z).real(x))
    #define __Pyx_SET_CIMAG(z,y) ((z).imag(y))
#else
    #define __Pyx_SET_CREAL(z,x) __Pyx_CREAL(z) = (x)
    #define __Pyx_SET_CIMAG(z,y) __Pyx_CIMAG(z) = (y)
#endif

/* None.proto */
static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float, float);

/* None.proto */
#if CYTHON_CCOMPLEX
    #define __Pyx_c_eqf(a, b)   ((a)==(b))
    #define __Pyx_c_sumf(a, b)  ((a)+(b))
    #define __Pyx_c_difff(a, b) ((a)-(b))
    #define __Pyx_c_prodf(a, b) ((a)*(b))
    #define __Pyx_c_quotf(a, b) ((a)/(b))
    #define __Pyx_c_negf(a)     (-(a))
  #ifdef __cplusplus
    #define __Pyx_c_is_zerof(z) ((z)==(float)0)
    #define __Pyx_c_conjf(z)    (::std::conj(z))
    #if 1
        #define __Pyx_c_absf(z)     (::std::abs(z))
        #define __Pyx_c_powf(a, b)  (::std::pow(a, b))
    #endif
  #else
    #define __Pyx_c_is_zerof(z) ((z)==0)
    #define __Pyx_c_conjf(z)    (conjf(z))
    #if 1
        #define __Pyx_c_absf(z)     (cabsf(z))
        #define __Pyx_c_powf(a, b)  (cpowf(a, b))
    #endif
 #endif
#else
    static CYTHON_INLINE int __Pyx_c_eqf(__pyx_t_float_complex, __pyx_t_float_complex);
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_sumf(__pyx_t_float_complex, __pyx_t_float_complex);
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_difff(__pyx_t_float_complex, __pyx_t_float_complex);
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_prodf(__pyx_t_float_complex, __pyx_t_float_complex);
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_quotf(__pyx_t_float_complex, __pyx_t_float_complex);
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_negf(__pyx_t_float_complex);
    static CYTHON_INLINE int __Pyx_c_is_zerof(__pyx_t_float_complex);
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_conjf(__pyx_t_float_complex);
    #if 1
        static CYTHON_INLINE float __Pyx_c_absf(__pyx_t_float_complex);
        static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_powf(__pyx_t_float_complex, __pyx_t_float_complex);
    #endif
#endif

/* None.proto */
static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double, double);

/* None.proto */
#if CYTHON_CCOMPLEX
    #define __Pyx_c_eq(a, b)   ((a)==(b))
    #define __Pyx_c_sum(a, b)  ((a)+(b))
    #define __Pyx_c_diff(a, b) ((a)-(b))
    #define __Pyx_c_prod(a, b) ((a)*(b))
    #define __Pyx_c_quot(a, b) ((a)/(b))
    #define __Pyx_c_neg(a)     (-(a))
  #ifdef __cplusplus
    #define __Pyx_c_is_zero(z) ((z)==(double)0)
    #define __Pyx_c_conj(z)    (::std::conj(z))
    #if 1
        #define __Pyx_c_abs(z)     (::std::abs(z))
        #define __Pyx_c_pow(a, b)  (::std::pow(a, b))
    #endif
  #else
    #define __Pyx_c_is_zero(z) ((z)==0)
    #define __Pyx_c_conj(z)    (conj(z))
    #if 1
        #define __Pyx_c_abs(z)     (cabs(z))
        #define __Pyx_c_pow(a, b)  (cpow(a, b))
    #endif
 #endif
#else
    static CYTHON_INLINE int __Pyx_c_eq(__pyx_t_double_complex, __pyx_t_double_complex);
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_sum(__pyx_t_double_complex, __pyx_t_double_complex);
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_diff(__pyx_t_double_complex, __pyx_t_double_complex);
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_prod(__pyx_t_double_complex, __pyx_t_double_complex);
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_quot(__pyx_t_double_complex, __pyx_t_double_complex);
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_neg(__pyx_t_double_complex);
    static CYTHON_INLINE int __Pyx_c_is_zero(__pyx_t_double_complex);
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_conj(__pyx_t_double_complex);
    #if 1
        static CYTHON_INLINE double __Pyx_c_abs(__pyx_t_double_complex);
        static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_pow(__pyx_t_double_complex, __pyx_t_double_complex);
    #endif
#endif

/* CIntToPy.proto */
static CYTHON_INLINE PyObject* __Pyx_PyInt_From_enum__NPY_TYPES(enum NPY_TYPES value);

/* CIntFromPy.proto */
static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *);

/* CIntFromPy.proto */
static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *);

/* CheckBinaryVersion.proto */
static int __Pyx_check_binary_version(void);

/* PyIdentifierFromString.proto */
#if !defined(__Pyx_PyIdentifier_FromString)
#if PY_MAJOR_VERSION < 3
  #define __Pyx_PyIdentifier_FromString(s) PyString_FromString(s)
#else
  #define __Pyx_PyIdentifier_FromString(s) PyUnicode_FromString(s)
#endif
#endif

/* ModuleImport.proto */
static PyObject *__Pyx_ImportModule(const char *name);

/* TypeImport.proto */
static PyTypeObject *__Pyx_ImportType(const char *module_name, const char *class_name, size_t size, int strict);

/* InitStrings.proto */
static int __Pyx_InitStrings(__Pyx_StringTabEntry *t);


/* Module declarations from 'libc.math' */

/* Module declarations from 'cpython.buffer' */

/* Module declarations from 'libc.string' */

/* Module declarations from 'libc.stdio' */

/* Module declarations from '__builtin__' */

/* Module declarations from 'cpython.type' */
static PyTypeObject *__pyx_ptype_7cpython_4type_type = 0;

/* Module declarations from 'cpython' */

/* Module declarations from 'cpython.object' */

/* Module declarations from 'cpython.ref' */

/* Module declarations from 'libc.stdlib' */

/* Module declarations from 'numpy' */

/* Module declarations from 'numpy' */
static PyTypeObject *__pyx_ptype_5numpy_dtype = 0;
static PyTypeObject *__pyx_ptype_5numpy_flatiter = 0;
static PyTypeObject *__pyx_ptype_5numpy_broadcast = 0;
static PyTypeObject *__pyx_ptype_5numpy_ndarray = 0;
static PyTypeObject *__pyx_ptype_5numpy_ufunc = 0;
static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *, char *, char *, int *); /*proto*/

/* Module declarations from 'cython' */

/* Module declarations from 'libTEXTURIZE' */
static float __pyx_v_12libTEXTURIZE_pibt;
static float __pyx_v_12libTEXTURIZE_tpibth;
static float __pyx_v_12libTEXTURIZE_fpibth;
static float __pyx_v_12libTEXTURIZE_pi;
static float __pyx_v_12libTEXTURIZE_thpibt;
static float __pyx_v_12libTEXTURIZE_tpi;
static PyArrayObject *__pyx_f_12libTEXTURIZE_ProbSinSquare(float, float, float, int); /*proto*/
static PyObject *__pyx_f_12libTEXTURIZE_getcanvas(int, int, PyArrayObject *); /*proto*/
static __Pyx_TypeInfo __Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t = { "float64_t", NULL, sizeof(__pyx_t_5numpy_float64_t), { 0 }, 0, 'R', 0, 0 };
#define __Pyx_MODULE_NAME "libTEXTURIZE"
int __pyx_module_is_main_libTEXTURIZE = 0;

/* Implementation of 'libTEXTURIZE' */
static PyObject *__pyx_builtin_range;
static PyObject *__pyx_builtin_ValueError;
static PyObject *__pyx_builtin_RuntimeError;
static const char __pyx_k_H[] = "H";
static const char __pyx_k_P[] = "P";
static const char __pyx_k_Q[] = "Q";
static const char __pyx_k_R[] = "R";
static const char __pyx_k_S[] = "S";
static const char __pyx_k_T[] = "T";
static const char __pyx_k_U[] = "U";
static const char __pyx_k_V[] = "V";
static const char __pyx_k_a[] = "a";
static const char __pyx_k_i[] = "i";
static const char __pyx_k_j[] = "j";
static const char __pyx_k_k[] = "k";
static const char __pyx_k_l[] = "l";
static const char __pyx_k_m[] = "m";
static const char __pyx_k_n[] = "n";
static const char __pyx_k_p[] = "p";
static const char __pyx_k_u[] = "u";
static const char __pyx_k_Nd[] = "Nd";
static const char __pyx_k_Rd[] = "Rd";
static const char __pyx_k_Ro[] = "Ro";
static const char __pyx_k_Rv[] = "Rv";
static const char __pyx_k_SQ[] = "SQ";
static const char __pyx_k_U0[] = "U0";
static const char __pyx_k_U1[] = "U1";
static const char __pyx_k_U2[] = "U2";
static const char __pyx_k_V1[] = "V1";
static const char __pyx_k_V2[] = "V2";
static const char __pyx_k_V3[] = "V3";
static const char __pyx_k_X1[] = "X1";
static const char __pyx_k_X2[] = "X2";
static const char __pyx_k_X3[] = "X3";
static const char __pyx_k_Xc[] = "Xc";
static const char __pyx_k_Xp[] = "Xp";
static const char __pyx_k_Yc[] = "Yc";
static const char __pyx_k_Yp[] = "Yp";
static const char __pyx_k_Zc[] = "Zc";
static const char __pyx_k_Zp[] = "Zp";
static const char __pyx_k_c1[] = "c1";
static const char __pyx_k_c2[] = "c2";
static const char __pyx_k_cb[] = "cb";
static const char __pyx_k_cp[] = "cp";
static const char __pyx_k_ct[] = "ct";
static const char __pyx_k_lm[] = "lm";
static const char __pyx_k_np[] = "np";
static const char __pyx_k_os[] = "os";
static const char __pyx_k_ph[] = "ph";
static const char __pyx_k_pi[] = "pi";
static const char __pyx_k_r1[] = "r1";
static const char __pyx_k_r2[] = "r2";
static const char __pyx_k_s1[] = "s1";
static const char __pyx_k_s2[] = "s2";
static const char __pyx_k_sb[] = "sb";
static const char __pyx_k_sp[] = "sp";
static const char __pyx_k_st[] = "st";
static const char __pyx_k_th[] = "th";
static const char __pyx_k_u0[] = "u0";
static const char __pyx_k_u1[] = "u1";
static const char __pyx_k_u2[] = "u2";
static const char __pyx_k_v1[] = "v1";
static const char __pyx_k_v2[] = "v2";
static const char __pyx_k_v3[] = "v3";
static const char __pyx_k_x1[] = "x1";
static const char __pyx_k_x2[] = "x2";
static const char __pyx_k_x3[] = "x3";
static const char __pyx_k_xc[] = "xc";
static const char __pyx_k_xs[] = "xs";
static const char __pyx_k_yc[] = "yc";
static const char __pyx_k_ys[] = "ys";
static const char __pyx_k_zc[] = "zc";
static const char __pyx_k_zs[] = "zs";
static const char __pyx_k_CPH[] = "CPH";
static const char __pyx_k_CTH[] = "CTH";
static const char __pyx_k_EUL[] = "EUL";
static const char __pyx_k_EYE[] = "EYE";
static const char __pyx_k_Eul[] = "Eul";
static const char __pyx_k_PHI[] = "PHI";
static const char __pyx_k_Phi[] = "Phi";
static const char __pyx_k_Roo[] = "Roo";
static const char __pyx_k_Rot[] = "Rot";
static const char __pyx_k_SPH[] = "SPH";
static const char __pyx_k_STH[] = "STH";
static const char __pyx_k_X1C[] = "X1C";
static const char __pyx_k_X1S[] = "X1S";
static const char __pyx_k_X2C[] = "X2C";
static const char __pyx_k_X2S[] = "X2S";
static const char __pyx_k_X3C[] = "X3C";
static const char __pyx_k_X3S[] = "X3S";
static const char __pyx_k_Xc0[] = "Xc0";
static const char __pyx_k_Xc1[] = "Xc1";
static const char __pyx_k_Xc2[] = "Xc2";
static const char __pyx_k_clm[] = "clm";
static const char __pyx_k_cos[] = "cos";
static const char __pyx_k_cph[] = "cph";
static const char __pyx_k_cth[] = "cth";
static const char __pyx_k_cv2[] = "cv2";
static const char __pyx_k_den[] = "den";
static const char __pyx_k_eul[] = "eul";
static const char __pyx_k_eye[] = "eye";
static const char __pyx_k_met[] = "met";
static const char __pyx_k_obj[] = "obj";
static const char __pyx_k_phi[] = "phi";
static const char __pyx_k_sin[] = "sin";
static const char __pyx_k_slm[] = "slm";
static const char __pyx_k_sph[] = "sph";
static const char __pyx_k_squ[] = "squ";
static const char __pyx_k_sth[] = "sth";
static const char __pyx_k_sum[] = "sum";
static const char __pyx_k_sys[] = "sys";
static const char __pyx_k_tic[] = "tic";
static const char __pyx_k_toc[] = "toc";
static const char __pyx_k_Aux1[] = "Aux1";
static const char __pyx_k_Aux2[] = "Aux2";
static const char __pyx_k_Aux3[] = "Aux3";
static const char __pyx_k_Axis[] = "Axis";
static const char __pyx_k_Beta[] = "Beta";
static const char __pyx_k_PHI1[] = "PHI1";
static const char __pyx_k_PHI2[] = "PHI2";
static const char __pyx_k_aux1[] = "aux1";
static const char __pyx_k_aux2[] = "aux2";
static const char __pyx_k_aux3[] = "aux3";
static const char __pyx_k_beta[] = "beta";
static const char __pyx_k_conv[] = "conv";
static const char __pyx_k_coss[] = "coss";
static const char __pyx_k_delR[] = "delR";
static const char __pyx_k_den1[] = "den1";
static const char __pyx_k_den2[] = "den2";
static const char __pyx_k_den3[] = "den3";
static const char __pyx_k_eul1[] = "eul1";
static const char __pyx_k_eul2[] = "eul2";
static const char __pyx_k_main[] = "__main__";
static const char __pyx_k_math[] = "math";
static const char __pyx_k_ncap[] = "ncap";
static const char __pyx_k_seed[] = "seed";
static const char __pyx_k_sinn[] = "sinn";
static const char __pyx_k_sqrt[] = "sqrt";
static const char __pyx_k_test[] = "__test__";
static const char __pyx_k_time[] = "time";
static const char __pyx_k_Angle[] = "Angle";
static const char __pyx_k_Theta[] = "Theta";
static const char __pyx_k_alpha[] = "alpha";
static const char __pyx_k_array[] = "array";
static const char __pyx_k_atan2[] = "atan2";
static const char __pyx_k_cmath[] = "cmath";
static const char __pyx_k_cross[] = "cross";
static const char __pyx_k_dtype[] = "dtype";
static const char __pyx_k_gamma[] = "gamma";
static const char __pyx_k_normC[] = "normC";
static const char __pyx_k_normS[] = "normS";
static const char __pyx_k_numpy[] = "numpy";
static const char __pyx_k_range[] = "range";
static const char __pyx_k_rsign[] = "rsign";
static const char __pyx_k_theta[] = "theta";
static const char __pyx_k_zeros[] = "zeros";
static const char __pyx_k_arccos[] = "arccos";
static const char __pyx_k_einsum[] = "einsum";
static const char __pyx_k_gamma1[] = "gamma1";
static const char __pyx_k_gamma2[] = "gamma2";
static const char __pyx_k_import[] = "__import__";
static const char __pyx_k_myseed[] = "myseed";
static const char __pyx_k_phimax[] = "phimax";
static const char __pyx_k_phimin[] = "phimin";
static const char __pyx_k_random[] = "random";
static const char __pyx_k_sthcph[] = "sthcph";
static const char __pyx_k_sthsph[] = "sthsph";
static const char __pyx_k_Lambdaa[] = "Lambdaa";
static const char __pyx_k_PhiFunc[] = "PhiFunc";
static const char __pyx_k_exetime[] = "exetime";
static const char __pyx_k_float64[] = "float64";
static const char __pyx_k_lambdaa[] = "lambdaa";
static const char __pyx_k_phidist[] = "phidist";
static const char __pyx_k_uniform[] = "uniform";
static const char __pyx_k_INVCDF1D[] = "INVCDF1D";
static const char __pyx_k_Phi1Func[] = "Phi1Func";
static const char __pyx_k_Phi2Func[] = "Phi2Func";
static const char __pyx_k_axisdist[] = "axisdist";
static const char __pyx_k_gammamax[] = "gammamax";
static const char __pyx_k_gammamin[] = "gammamin";
static const char __pyx_k_grainloc[] = "grainloc";
static const char __pyx_k_linspace[] = "linspace";
static const char __pyx_k_thetamax[] = "thetamax";
static const char __pyx_k_thetamin[] = "thetamin";
static const char __pyx_k_aap_to_rm[] = "aap_to_rm";
static const char __pyx_k_cossncap0[] = "cossncap0";
static const char __pyx_k_cossncap1[] = "cossncap1";
static const char __pyx_k_cossncap2[] = "cossncap2";
static const char __pyx_k_gammadist[] = "gammadist";
static const char __pyx_k_plantseed[] = "plantseed";
static const char __pyx_k_qn_to_aap[] = "qn_to_aap";
static const char __pyx_k_rm_to_zxz[] = "rm_to_zxz";
static const char __pyx_k_thetadist[] = "thetadist";
static const char __pyx_k_zxz_to_rm[] = "zxz_to_rm";
static const char __pyx_k_ValueError[] = "ValueError";
static const char __pyx_k_kil_lj_kij[] = "kil,lj->kij";
static const char __pyx_k_libCONVERT[] = "libCONVERT";
static const char __pyx_k_makecanvas[] = "makecanvas";
static const char __pyx_k_RuntimeError[] = "RuntimeError";
static const char __pyx_k_libTEXTURIZE[] = "libTEXTURIZE";
static const char __pyx_k_Texture_Fiber[] = "Texture_Fiber";
static const char __pyx_k_Texture_Sheet[] = "Texture_Sheet";
static const char __pyx_k_libMETROPOLIS[] = "libMETROPOLIS";
static const char __pyx_k_Texture_URO_mur[] = "Texture_URO_mur";
static const char __pyx_k_Texture_URO_sm1[] = "Texture_URO_sm1";
static const char __pyx_k_Texture_URO_sm2[] = "Texture_URO_sm2";
static const char __pyx_k_Texture_URO_xyz[] = "Texture_URO_xyz";
static const char __pyx_k_Texture_URO_arvo[] = "Texture_URO_arvo";
static const char __pyx_k_Texture_URO_mack[] = "Texture_URO_mack";
static const char __pyx_k_Texture_URO_nxyz[] = "Texture_URO_nxyz";
static const char __pyx_k_Texture_URO_miles[] = "Texture_URO_miles";
static const char __pyx_k_multivariate_normal[] = "multivariate_normal";
static const char __pyx_k_Texture_Generic_Euler[] = "Texture_Generic_Euler";
static const char __pyx_k_ndarray_is_not_C_contiguous[] = "ndarray is not C contiguous";
static const char __pyx_k_unknown_dtype_code_in_numpy_pxd[] = "unknown dtype code in numpy.pxd (%d)";
static const char __pyx_k_E_Dropbox_Public_PhDResources_10[] = "E:\\Dropbox\\Public\\PhDResources\\10_Codes\\EvoSimPy\\WIP\\evosimcorelibs\\libTEXTURIZE.pyx";
static const char __pyx_k_Format_string_allocated_too_shor[] = "Format string allocated too short, see comment in numpy.pxd";
static const char __pyx_k_Non_native_byte_order_not_suppor[] = "Non-native byte order not supported";
static const char __pyx_k_ndarray_is_not_Fortran_contiguou[] = "ndarray is not Fortran contiguous";
static const char __pyx_k_Format_string_allocated_too_shor_2[] = "Format string allocated too short.";
static PyObject *__pyx_n_s_Angle;
static PyObject *__pyx_n_s_Aux1;
static PyObject *__pyx_n_s_Aux2;
static PyObject *__pyx_n_s_Aux3;
static PyObject *__pyx_n_s_Axis;
static PyObject *__pyx_n_s_Beta;
static PyObject *__pyx_n_s_CPH;
static PyObject *__pyx_n_s_CTH;
static PyObject *__pyx_n_s_EUL;
static PyObject *__pyx_n_s_EYE;
static PyObject *__pyx_kp_s_E_Dropbox_Public_PhDResources_10;
static PyObject *__pyx_n_s_Eul;
static PyObject *__pyx_kp_u_Format_string_allocated_too_shor;
static PyObject *__pyx_kp_u_Format_string_allocated_too_shor_2;
static PyObject *__pyx_n_s_H;
static PyObject *__pyx_n_s_INVCDF1D;
static PyObject *__pyx_n_s_Lambdaa;
static PyObject *__pyx_n_s_Nd;
static PyObject *__pyx_kp_u_Non_native_byte_order_not_suppor;
static PyObject *__pyx_n_s_P;
static PyObject *__pyx_n_s_PHI;
static PyObject *__pyx_n_s_PHI1;
static PyObject *__pyx_n_s_PHI2;
static PyObject *__pyx_n_s_Phi;
static PyObject *__pyx_n_s_Phi1Func;
static PyObject *__pyx_n_s_Phi2Func;
static PyObject *__pyx_n_s_PhiFunc;
static PyObject *__pyx_n_s_Q;
static PyObject *__pyx_n_s_R;
static PyObject *__pyx_n_s_Rd;
static PyObject *__pyx_n_s_Ro;
static PyObject *__pyx_n_s_Roo;
static PyObject *__pyx_n_s_Rot;
static PyObject *__pyx_n_s_RuntimeError;
static PyObject *__pyx_n_s_Rv;
static PyObject *__pyx_n_s_S;
static PyObject *__pyx_n_s_SPH;
static PyObject *__pyx_n_s_SQ;
static PyObject *__pyx_n_s_STH;
static PyObject *__pyx_n_s_T;
static PyObject *__pyx_n_s_Texture_Fiber;
static PyObject *__pyx_n_s_Texture_Generic_Euler;
static PyObject *__pyx_n_s_Texture_Sheet;
static PyObject *__pyx_n_s_Texture_URO_arvo;
static PyObject *__pyx_n_s_Texture_URO_mack;
static PyObject *__pyx_n_s_Texture_URO_miles;
static PyObject *__pyx_n_s_Texture_URO_mur;
static PyObject *__pyx_n_s_Texture_URO_nxyz;
static PyObject *__pyx_n_s_Texture_URO_sm1;
static PyObject *__pyx_n_s_Texture_URO_sm2;
static PyObject *__pyx_n_s_Texture_URO_xyz;
static PyObject *__pyx_n_s_Theta;
static PyObject *__pyx_n_s_U;
static PyObject *__pyx_n_s_U0;
static PyObject *__pyx_n_s_U1;
static PyObject *__pyx_n_s_U2;
static PyObject *__pyx_n_s_V;
static PyObject *__pyx_n_s_V1;
static PyObject *__pyx_n_s_V2;
static PyObject *__pyx_n_s_V3;
static PyObject *__pyx_n_s_ValueError;
static PyObject *__pyx_n_s_X1;
static PyObject *__pyx_n_s_X1C;
static PyObject *__pyx_n_s_X1S;
static PyObject *__pyx_n_s_X2;
static PyObject *__pyx_n_s_X2C;
static PyObject *__pyx_n_s_X2S;
static PyObject *__pyx_n_s_X3;
static PyObject *__pyx_n_s_X3C;
static PyObject *__pyx_n_s_X3S;
static PyObject *__pyx_n_s_Xc;
static PyObject *__pyx_n_s_Xc0;
static PyObject *__pyx_n_s_Xc1;
static PyObject *__pyx_n_s_Xc2;
static PyObject *__pyx_n_s_Xp;
static PyObject *__pyx_n_s_Yc;
static PyObject *__pyx_n_s_Yp;
static PyObject *__pyx_n_s_Zc;
static PyObject *__pyx_n_s_Zp;
static PyObject *__pyx_n_s_a;
static PyObject *__pyx_n_s_aap_to_rm;
static PyObject *__pyx_n_s_alpha;
static PyObject *__pyx_n_s_arccos;
static PyObject *__pyx_n_s_array;
static PyObject *__pyx_n_s_atan2;
static PyObject *__pyx_n_s_aux1;
static PyObject *__pyx_n_s_aux2;
static PyObject *__pyx_n_s_aux3;
static PyObject *__pyx_n_s_axisdist;
static PyObject *__pyx_n_s_beta;
static PyObject *__pyx_n_s_c1;
static PyObject *__pyx_n_s_c2;
static PyObject *__pyx_n_s_cb;
static PyObject *__pyx_n_s_clm;
static PyObject *__pyx_n_s_cmath;
static PyObject *__pyx_n_s_conv;
static PyObject *__pyx_n_s_cos;
static PyObject *__pyx_n_s_coss;
static PyObject *__pyx_n_s_cossncap0;
static PyObject *__pyx_n_s_cossncap1;
static PyObject *__pyx_n_s_cossncap2;
static PyObject *__pyx_n_s_cp;
static PyObject *__pyx_n_s_cph;
static PyObject *__pyx_n_s_cross;
static PyObject *__pyx_n_s_ct;
static PyObject *__pyx_n_s_cth;
static PyObject *__pyx_n_s_cv2;
static PyObject *__pyx_n_s_delR;
static PyObject *__pyx_n_s_den;
static PyObject *__pyx_n_s_den1;
static PyObject *__pyx_n_s_den2;
static PyObject *__pyx_n_s_den3;
static PyObject *__pyx_n_s_dtype;
static PyObject *__pyx_n_s_einsum;
static PyObject *__pyx_n_s_eul;
static PyObject *__pyx_n_s_eul1;
static PyObject *__pyx_n_s_eul2;
static PyObject *__pyx_n_s_exetime;
static PyObject *__pyx_n_s_eye;
static PyObject *__pyx_n_s_float64;
static PyObject *__pyx_n_s_gamma;
static PyObject *__pyx_n_s_gamma1;
static PyObject *__pyx_n_s_gamma2;
static PyObject *__pyx_n_s_gammadist;
static PyObject *__pyx_n_s_gammamax;
static PyObject *__pyx_n_s_gammamin;
static PyObject *__pyx_n_s_grainloc;
static PyObject *__pyx_n_s_i;
static PyObject *__pyx_n_s_import;
static PyObject *__pyx_n_s_j;
static PyObject *__pyx_n_s_k;
static PyObject *__pyx_kp_s_kil_lj_kij;
static PyObject *__pyx_n_s_l;
static PyObject *__pyx_n_s_lambdaa;
static PyObject *__pyx_n_s_libCONVERT;
static PyObject *__pyx_n_s_libMETROPOLIS;
static PyObject *__pyx_n_s_libTEXTURIZE;
static PyObject *__pyx_n_s_linspace;
static PyObject *__pyx_n_s_lm;
static PyObject *__pyx_n_s_m;
static PyObject *__pyx_n_s_main;
static PyObject *__pyx_n_s_makecanvas;
static PyObject *__pyx_n_s_math;
static PyObject *__pyx_n_s_met;
static PyObject *__pyx_n_s_multivariate_normal;
static PyObject *__pyx_n_s_myseed;
static PyObject *__pyx_n_s_n;
static PyObject *__pyx_n_s_ncap;
static PyObject *__pyx_kp_u_ndarray_is_not_C_contiguous;
static PyObject *__pyx_kp_u_ndarray_is_not_Fortran_contiguou;
static PyObject *__pyx_n_s_normC;
static PyObject *__pyx_n_s_normS;
static PyObject *__pyx_n_s_np;
static PyObject *__pyx_n_s_numpy;
static PyObject *__pyx_n_s_obj;
static PyObject *__pyx_n_s_os;
static PyObject *__pyx_n_s_p;
static PyObject *__pyx_n_s_ph;
static PyObject *__pyx_n_s_phi;
static PyObject *__pyx_n_s_phidist;
static PyObject *__pyx_n_s_phimax;
static PyObject *__pyx_n_s_phimin;
static PyObject *__pyx_n_s_pi;
static PyObject *__pyx_n_s_plantseed;
static PyObject *__pyx_n_s_qn_to_aap;
static PyObject *__pyx_n_s_r1;
static PyObject *__pyx_n_s_r2;
static PyObject *__pyx_n_s_random;
static PyObject *__pyx_n_s_range;
static PyObject *__pyx_n_s_rm_to_zxz;
static PyObject *__pyx_n_s_rsign;
static PyObject *__pyx_n_s_s1;
static PyObject *__pyx_n_s_s2;
static PyObject *__pyx_n_s_sb;
static PyObject *__pyx_n_s_seed;
static PyObject *__pyx_n_s_sin;
static PyObject *__pyx_n_s_sinn;
static PyObject *__pyx_n_s_slm;
static PyObject *__pyx_n_s_sp;
static PyObject *__pyx_n_s_sph;
static PyObject *__pyx_n_s_sqrt;
static PyObject *__pyx_n_s_squ;
static PyObject *__pyx_n_s_st;
static PyObject *__pyx_n_s_sth;
static PyObject *__pyx_n_s_sthcph;
static PyObject *__pyx_n_s_sthsph;
static PyObject *__pyx_n_s_sum;
static PyObject *__pyx_n_s_sys;
static PyObject *__pyx_n_s_test;
static PyObject *__pyx_n_s_th;
static PyObject *__pyx_n_s_theta;
static PyObject *__pyx_n_s_thetadist;
static PyObject *__pyx_n_s_thetamax;
static PyObject *__pyx_n_s_thetamin;
static PyObject *__pyx_n_s_tic;
static PyObject *__pyx_n_s_time;
static PyObject *__pyx_n_s_toc;
static PyObject *__pyx_n_s_u;
static PyObject *__pyx_n_s_u0;
static PyObject *__pyx_n_s_u1;
static PyObject *__pyx_n_s_u2;
static PyObject *__pyx_n_s_uniform;
static PyObject *__pyx_kp_u_unknown_dtype_code_in_numpy_pxd;
static PyObject *__pyx_n_s_v1;
static PyObject *__pyx_n_s_v2;
static PyObject *__pyx_n_s_v3;
static PyObject *__pyx_n_s_x1;
static PyObject *__pyx_n_s_x2;
static PyObject *__pyx_n_s_x3;
static PyObject *__pyx_n_s_xc;
static PyObject *__pyx_n_s_xs;
static PyObject *__pyx_n_s_yc;
static PyObject *__pyx_n_s_ys;
static PyObject *__pyx_n_s_zc;
static PyObject *__pyx_n_s_zeros;
static PyObject *__pyx_n_s_zs;
static PyObject *__pyx_n_s_zxz_to_rm;
static PyObject *__pyx_pf_12libTEXTURIZE_plantseed(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_myseed); /* proto */
static PyObject *__pyx_pf_12libTEXTURIZE_2Texture_URO_xyz(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_obj); /* proto */
static PyObject *__pyx_pf_12libTEXTURIZE_4Texture_URO_nxyz(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_obj); /* proto */
static PyObject *__pyx_pf_12libTEXTURIZE_6Texture_URO_arvo(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_obj); /* proto */
static PyObject *__pyx_pf_12libTEXTURIZE_8Texture_URO_mack(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_obj); /* proto */
static PyObject *__pyx_pf_12libTEXTURIZE_10Texture_URO_sm1(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_obj); /* proto */
static PyObject *__pyx_pf_12libTEXTURIZE_12Texture_URO_sm2(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_obj); /* proto */
static PyObject *__pyx_pf_12libTEXTURIZE_14Texture_URO_miles(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_obj); /* proto */
static PyObject *__pyx_pf_12libTEXTURIZE_16Texture_URO_mur(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_obj); /* proto */
static PyObject *__pyx_pf_12libTEXTURIZE_18Texture_Fiber(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_obj); /* proto */
static PyObject *__pyx_pf_12libTEXTURIZE_20Texture_Sheet(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_obj); /* proto */
static PyObject *__pyx_pf_12libTEXTURIZE_22Texture_Generic_Euler(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_obj); /* proto */
static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyArrayObject *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags); /* proto */
static void __pyx_pf_5numpy_7ndarray_2__releasebuffer__(PyArrayObject *__pyx_v_self, Py_buffer *__pyx_v_info); /* proto */
static PyObject *__pyx_int_0;
static PyObject *__pyx_int_1;
static PyObject *__pyx_int_2;
static PyObject *__pyx_int_3;
static PyObject *__pyx_int_4;
static PyObject *__pyx_tuple_;
static PyObject *__pyx_tuple__2;
static PyObject *__pyx_tuple__3;
static PyObject *__pyx_tuple__4;
static PyObject *__pyx_tuple__5;
static PyObject *__pyx_tuple__6;
static PyObject *__pyx_tuple__7;
static PyObject *__pyx_tuple__8;
static PyObject *__pyx_tuple__9;
static PyObject *__pyx_slice__23;
static PyObject *__pyx_slice__25;
static PyObject *__pyx_slice__27;
static PyObject *__pyx_slice__43;
static PyObject *__pyx_slice__45;
static PyObject *__pyx_slice__47;
static PyObject *__pyx_slice__49;
static PyObject *__pyx_slice__50;
static PyObject *__pyx_tuple__10;
static PyObject *__pyx_tuple__11;
static PyObject *__pyx_tuple__12;
static PyObject *__pyx_tuple__13;
static PyObject *__pyx_tuple__14;
static PyObject *__pyx_tuple__15;
static PyObject *__pyx_tuple__16;
static PyObject *__pyx_tuple__17;
static PyObject *__pyx_tuple__18;
static PyObject *__pyx_tuple__19;
static PyObject *__pyx_tuple__20;
static PyObject *__pyx_tuple__21;
static PyObject *__pyx_tuple__22;
static PyObject *__pyx_tuple__24;
static PyObject *__pyx_tuple__26;
static PyObject *__pyx_tuple__28;
static PyObject *__pyx_tuple__29;
static PyObject *__pyx_tuple__30;
static PyObject *__pyx_tuple__31;
static PyObject *__pyx_tuple__32;
static PyObject *__pyx_tuple__33;
static PyObject *__pyx_tuple__34;
static PyObject *__pyx_tuple__35;
static PyObject *__pyx_tuple__36;
static PyObject *__pyx_tuple__37;
static PyObject *__pyx_tuple__38;
static PyObject *__pyx_tuple__39;
static PyObject *__pyx_tuple__40;
static PyObject *__pyx_tuple__41;
static PyObject *__pyx_tuple__42;
static PyObject *__pyx_tuple__44;
static PyObject *__pyx_tuple__46;
static PyObject *__pyx_tuple__48;
static PyObject *__pyx_tuple__51;
static PyObject *__pyx_tuple__52;
static PyObject *__pyx_tuple__53;
static PyObject *__pyx_tuple__54;
static PyObject *__pyx_tuple__55;
static PyObject *__pyx_tuple__56;
static PyObject *__pyx_tuple__57;
static PyObject *__pyx_tuple__58;
static PyObject *__pyx_tuple__59;
static PyObject *__pyx_tuple__60;
static PyObject *__pyx_tuple__61;
static PyObject *__pyx_tuple__62;
static PyObject *__pyx_tuple__63;
static PyObject *__pyx_tuple__64;
static PyObject *__pyx_tuple__65;
static PyObject *__pyx_tuple__67;
static PyObject *__pyx_tuple__69;
static PyObject *__pyx_tuple__71;
static PyObject *__pyx_tuple__73;
static PyObject *__pyx_tuple__75;
static PyObject *__pyx_tuple__77;
static PyObject *__pyx_tuple__79;
static PyObject *__pyx_tuple__81;
static PyObject *__pyx_tuple__83;
static PyObject *__pyx_tuple__85;
static PyObject *__pyx_tuple__87;
static PyObject *__pyx_codeobj__66;
static PyObject *__pyx_codeobj__68;
static PyObject *__pyx_codeobj__70;
static PyObject *__pyx_codeobj__72;
static PyObject *__pyx_codeobj__74;
static PyObject *__pyx_codeobj__76;
static PyObject *__pyx_codeobj__78;
static PyObject *__pyx_codeobj__80;
static PyObject *__pyx_codeobj__82;
static PyObject *__pyx_codeobj__84;
static PyObject *__pyx_codeobj__86;
static PyObject *__pyx_codeobj__88;

/* "libTEXTURIZE.pyx":33
 * cdef float tpi = 2 * np.pi
 * 
 * def plantseed(myseed):             # <<<<<<<<<<<<<<
 *     if myseed > 0:
 *         np.random.seed(myseed)
 */

/* Python wrapper */
static PyObject *__pyx_pw_12libTEXTURIZE_1plantseed(PyObject *__pyx_self, PyObject *__pyx_v_myseed); /*proto*/
static PyMethodDef __pyx_mdef_12libTEXTURIZE_1plantseed = {"plantseed", (PyCFunction)__pyx_pw_12libTEXTURIZE_1plantseed, METH_O, 0};
static PyObject *__pyx_pw_12libTEXTURIZE_1plantseed(PyObject *__pyx_self, PyObject *__pyx_v_myseed) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("plantseed (wrapper)", 0);
  __pyx_r = __pyx_pf_12libTEXTURIZE_plantseed(__pyx_self, ((PyObject *)__pyx_v_myseed));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_12libTEXTURIZE_plantseed(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_myseed) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  __Pyx_RefNannySetupContext("plantseed", 0);

  /* "libTEXTURIZE.pyx":34
 * 
 * def plantseed(myseed):
 *     if myseed > 0:             # <<<<<<<<<<<<<<
 *         np.random.seed(myseed)
 *         random.seed(myseed)
 */
  __pyx_t_1 = PyObject_RichCompare(__pyx_v_myseed, __pyx_int_0, Py_GT); __Pyx_XGOTREF(__pyx_t_1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 34, __pyx_L1_error)
  __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 34, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {

    /* "libTEXTURIZE.pyx":35
 * def plantseed(myseed):
 *     if myseed > 0:
 *         np.random.seed(myseed)             # <<<<<<<<<<<<<<
 *         random.seed(myseed)
 * 
 */
    __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 35, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_random); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 35, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_seed); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 35, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_3))) {
      __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
      if (likely(__pyx_t_4)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
        __Pyx_INCREF(__pyx_t_4);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_3, function);
      }
    }
    if (!__pyx_t_4) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_v_myseed); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 35, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 35, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_5);
      __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
      __Pyx_INCREF(__pyx_v_myseed);
      __Pyx_GIVEREF(__pyx_v_myseed);
      PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_v_myseed);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 35, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    }
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "libTEXTURIZE.pyx":36
 *     if myseed > 0:
 *         np.random.seed(myseed)
 *         random.seed(myseed)             # <<<<<<<<<<<<<<
 * 
 * def Texture_URO_xyz(obj):
 */
    __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_random); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 36, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_seed); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 36, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = NULL;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
      __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
      if (likely(__pyx_t_3)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
        __Pyx_INCREF(__pyx_t_3);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_5, function);
      }
    }
    if (!__pyx_t_3) {
      __pyx_t_1 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_v_myseed); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 36, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
    } else {
      __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 36, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
      __Pyx_INCREF(__pyx_v_myseed);
      __Pyx_GIVEREF(__pyx_v_myseed);
      PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_myseed);
      __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 36, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_1);
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    }
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

    /* "libTEXTURIZE.pyx":34
 * 
 * def plantseed(myseed):
 *     if myseed > 0:             # <<<<<<<<<<<<<<
 *         np.random.seed(myseed)
 *         random.seed(myseed)
 */
  }

  /* "libTEXTURIZE.pyx":33
 * cdef float tpi = 2 * np.pi
 * 
 * def plantseed(myseed):             # <<<<<<<<<<<<<<
 *     if myseed > 0:
 *         np.random.seed(myseed)
 */

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_AddTraceback("libTEXTURIZE.plantseed", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "libTEXTURIZE.pyx":38
 *         random.seed(myseed)
 * 
 * def Texture_URO_xyz(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */

/* Python wrapper */
static PyObject *__pyx_pw_12libTEXTURIZE_3Texture_URO_xyz(PyObject *__pyx_self, PyObject *__pyx_v_obj); /*proto*/
static PyMethodDef __pyx_mdef_12libTEXTURIZE_3Texture_URO_xyz = {"Texture_URO_xyz", (PyCFunction)__pyx_pw_12libTEXTURIZE_3Texture_URO_xyz, METH_O, 0};
static PyObject *__pyx_pw_12libTEXTURIZE_3Texture_URO_xyz(PyObject *__pyx_self, PyObject *__pyx_v_obj) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Texture_URO_xyz (wrapper)", 0);
  __pyx_r = __pyx_pf_12libTEXTURIZE_2Texture_URO_xyz(__pyx_self, ((PyObject *)__pyx_v_obj));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_12libTEXTURIZE_2Texture_URO_xyz(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_obj) {
  int __pyx_v_myseed;
  int __pyx_v_p;
  int __pyx_v_m;
  int __pyx_v_n;
  int __pyx_v_makecanvas;
  double __pyx_v_tic;
  double __pyx_v_toc;
  int __pyx_v_i;
  float __pyx_v_th;
  float __pyx_v_ph;
  float __pyx_v_lm;
  float __pyx_v_sth;
  float __pyx_v_sph;
  float __pyx_v_cth;
  float __pyx_v_cph;
  float __pyx_v_clm;
  float __pyx_v_slm;
  PyArrayObject *__pyx_v_r1 = 0;
  PyArrayObject *__pyx_v_lambdaa = 0;
  PyArrayObject *__pyx_v_theta = 0;
  PyArrayObject *__pyx_v_phi = 0;
  PyArrayObject *__pyx_v_V1 = 0;
  PyArrayObject *__pyx_v_V2 = 0;
  PyArrayObject *__pyx_v_Xc = 0;
  PyArrayObject *__pyx_v_Yc = 0;
  PyArrayObject *__pyx_v_Zc = 0;
  PyArrayObject *__pyx_v_Rot = 0;
  PyArrayObject *__pyx_v_Eul = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Axis = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Angle = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Nd = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Rd = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Rv = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Q = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Angle;
  __Pyx_Buffer __pyx_pybuffer_Angle;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Axis;
  __Pyx_Buffer __pyx_pybuffer_Axis;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Eul;
  __Pyx_Buffer __pyx_pybuffer_Eul;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Nd;
  __Pyx_Buffer __pyx_pybuffer_Nd;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Q;
  __Pyx_Buffer __pyx_pybuffer_Q;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rd;
  __Pyx_Buffer __pyx_pybuffer_Rd;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rot;
  __Pyx_Buffer __pyx_pybuffer_Rot;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rv;
  __Pyx_Buffer __pyx_pybuffer_Rv;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_V1;
  __Pyx_Buffer __pyx_pybuffer_V1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_V2;
  __Pyx_Buffer __pyx_pybuffer_V2;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Xc;
  __Pyx_Buffer __pyx_pybuffer_Xc;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Yc;
  __Pyx_Buffer __pyx_pybuffer_Yc;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Zc;
  __Pyx_Buffer __pyx_pybuffer_Zc;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_lambdaa;
  __Pyx_Buffer __pyx_pybuffer_lambdaa;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_phi;
  __Pyx_Buffer __pyx_pybuffer_phi;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_r1;
  __Pyx_Buffer __pyx_pybuffer_r1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_theta;
  __Pyx_Buffer __pyx_pybuffer_theta;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyArrayObject *__pyx_t_7 = NULL;
  PyArrayObject *__pyx_t_8 = NULL;
  PyArrayObject *__pyx_t_9 = NULL;
  PyArrayObject *__pyx_t_10 = NULL;
  PyArrayObject *__pyx_t_11 = NULL;
  PyArrayObject *__pyx_t_12 = NULL;
  PyArrayObject *__pyx_t_13 = NULL;
  PyArrayObject *__pyx_t_14 = NULL;
  PyArrayObject *__pyx_t_15 = NULL;
  PyArrayObject *__pyx_t_16 = NULL;
  PyArrayObject *__pyx_t_17 = NULL;
  PyArrayObject *__pyx_t_18 = NULL;
  PyArrayObject *__pyx_t_19 = NULL;
  PyArrayObject *__pyx_t_20 = NULL;
  PyArrayObject *__pyx_t_21 = NULL;
  PyArrayObject *__pyx_t_22 = NULL;
  PyArrayObject *__pyx_t_23 = NULL;
  double __pyx_t_24;
  Py_ssize_t __pyx_t_25;
  PyObject *__pyx_t_26 = NULL;
  PyObject *__pyx_t_27 = NULL;
  PyObject *__pyx_t_28 = NULL;
  PyObject *__pyx_t_29 = NULL;
  int __pyx_t_30;
  Py_ssize_t __pyx_t_31;
  Py_ssize_t __pyx_t_32;
  Py_ssize_t __pyx_t_33;
  Py_ssize_t __pyx_t_34;
  Py_ssize_t __pyx_t_35;
  Py_ssize_t __pyx_t_36;
  Py_ssize_t __pyx_t_37;
  Py_ssize_t __pyx_t_38;
  Py_ssize_t __pyx_t_39;
  Py_ssize_t __pyx_t_40;
  Py_ssize_t __pyx_t_41;
  Py_ssize_t __pyx_t_42;
  Py_ssize_t __pyx_t_43;
  Py_ssize_t __pyx_t_44;
  Py_ssize_t __pyx_t_45;
  Py_ssize_t __pyx_t_46;
  Py_ssize_t __pyx_t_47;
  Py_ssize_t __pyx_t_48;
  Py_ssize_t __pyx_t_49;
  Py_ssize_t __pyx_t_50;
  Py_ssize_t __pyx_t_51;
  Py_ssize_t __pyx_t_52;
  Py_ssize_t __pyx_t_53;
  Py_ssize_t __pyx_t_54;
  Py_ssize_t __pyx_t_55;
  Py_ssize_t __pyx_t_56;
  Py_ssize_t __pyx_t_57;
  Py_ssize_t __pyx_t_58;
  Py_ssize_t __pyx_t_59;
  Py_ssize_t __pyx_t_60;
  Py_ssize_t __pyx_t_61;
  Py_ssize_t __pyx_t_62;
  Py_ssize_t __pyx_t_63;
  Py_ssize_t __pyx_t_64;
  Py_ssize_t __pyx_t_65;
  Py_ssize_t __pyx_t_66;
  Py_ssize_t __pyx_t_67;
  Py_ssize_t __pyx_t_68;
  Py_ssize_t __pyx_t_69;
  Py_ssize_t __pyx_t_70;
  Py_ssize_t __pyx_t_71;
  Py_ssize_t __pyx_t_72;
  Py_ssize_t __pyx_t_73;
  Py_ssize_t __pyx_t_74;
  Py_ssize_t __pyx_t_75;
  Py_ssize_t __pyx_t_76;
  Py_ssize_t __pyx_t_77;
  Py_ssize_t __pyx_t_78;
  Py_ssize_t __pyx_t_79;
  Py_ssize_t __pyx_t_80;
  Py_ssize_t __pyx_t_81;
  Py_ssize_t __pyx_t_82;
  Py_ssize_t __pyx_t_83;
  Py_ssize_t __pyx_t_84;
  Py_ssize_t __pyx_t_85;
  Py_ssize_t __pyx_t_86;
  Py_ssize_t __pyx_t_87;
  Py_ssize_t __pyx_t_88;
  Py_ssize_t __pyx_t_89;
  Py_ssize_t __pyx_t_90;
  Py_ssize_t __pyx_t_91;
  Py_ssize_t __pyx_t_92;
  Py_ssize_t __pyx_t_93;
  Py_ssize_t __pyx_t_94;
  Py_ssize_t __pyx_t_95;
  Py_ssize_t __pyx_t_96;
  Py_ssize_t __pyx_t_97;
  Py_ssize_t __pyx_t_98;
  Py_ssize_t __pyx_t_99;
  Py_ssize_t __pyx_t_100;
  Py_ssize_t __pyx_t_101;
  Py_ssize_t __pyx_t_102;
  int __pyx_t_103;
  __Pyx_RefNannySetupContext("Texture_URO_xyz", 0);
  __pyx_pybuffer_r1.pybuffer.buf = NULL;
  __pyx_pybuffer_r1.refcount = 0;
  __pyx_pybuffernd_r1.data = NULL;
  __pyx_pybuffernd_r1.rcbuffer = &__pyx_pybuffer_r1;
  __pyx_pybuffer_lambdaa.pybuffer.buf = NULL;
  __pyx_pybuffer_lambdaa.refcount = 0;
  __pyx_pybuffernd_lambdaa.data = NULL;
  __pyx_pybuffernd_lambdaa.rcbuffer = &__pyx_pybuffer_lambdaa;
  __pyx_pybuffer_theta.pybuffer.buf = NULL;
  __pyx_pybuffer_theta.refcount = 0;
  __pyx_pybuffernd_theta.data = NULL;
  __pyx_pybuffernd_theta.rcbuffer = &__pyx_pybuffer_theta;
  __pyx_pybuffer_phi.pybuffer.buf = NULL;
  __pyx_pybuffer_phi.refcount = 0;
  __pyx_pybuffernd_phi.data = NULL;
  __pyx_pybuffernd_phi.rcbuffer = &__pyx_pybuffer_phi;
  __pyx_pybuffer_V1.pybuffer.buf = NULL;
  __pyx_pybuffer_V1.refcount = 0;
  __pyx_pybuffernd_V1.data = NULL;
  __pyx_pybuffernd_V1.rcbuffer = &__pyx_pybuffer_V1;
  __pyx_pybuffer_V2.pybuffer.buf = NULL;
  __pyx_pybuffer_V2.refcount = 0;
  __pyx_pybuffernd_V2.data = NULL;
  __pyx_pybuffernd_V2.rcbuffer = &__pyx_pybuffer_V2;
  __pyx_pybuffer_Xc.pybuffer.buf = NULL;
  __pyx_pybuffer_Xc.refcount = 0;
  __pyx_pybuffernd_Xc.data = NULL;
  __pyx_pybuffernd_Xc.rcbuffer = &__pyx_pybuffer_Xc;
  __pyx_pybuffer_Yc.pybuffer.buf = NULL;
  __pyx_pybuffer_Yc.refcount = 0;
  __pyx_pybuffernd_Yc.data = NULL;
  __pyx_pybuffernd_Yc.rcbuffer = &__pyx_pybuffer_Yc;
  __pyx_pybuffer_Zc.pybuffer.buf = NULL;
  __pyx_pybuffer_Zc.refcount = 0;
  __pyx_pybuffernd_Zc.data = NULL;
  __pyx_pybuffernd_Zc.rcbuffer = &__pyx_pybuffer_Zc;
  __pyx_pybuffer_Rot.pybuffer.buf = NULL;
  __pyx_pybuffer_Rot.refcount = 0;
  __pyx_pybuffernd_Rot.data = NULL;
  __pyx_pybuffernd_Rot.rcbuffer = &__pyx_pybuffer_Rot;
  __pyx_pybuffer_Eul.pybuffer.buf = NULL;
  __pyx_pybuffer_Eul.refcount = 0;
  __pyx_pybuffernd_Eul.data = NULL;
  __pyx_pybuffernd_Eul.rcbuffer = &__pyx_pybuffer_Eul;
  __pyx_pybuffer_Axis.pybuffer.buf = NULL;
  __pyx_pybuffer_Axis.refcount = 0;
  __pyx_pybuffernd_Axis.data = NULL;
  __pyx_pybuffernd_Axis.rcbuffer = &__pyx_pybuffer_Axis;
  __pyx_pybuffer_Angle.pybuffer.buf = NULL;
  __pyx_pybuffer_Angle.refcount = 0;
  __pyx_pybuffernd_Angle.data = NULL;
  __pyx_pybuffernd_Angle.rcbuffer = &__pyx_pybuffer_Angle;
  __pyx_pybuffer_Nd.pybuffer.buf = NULL;
  __pyx_pybuffer_Nd.refcount = 0;
  __pyx_pybuffernd_Nd.data = NULL;
  __pyx_pybuffernd_Nd.rcbuffer = &__pyx_pybuffer_Nd;
  __pyx_pybuffer_Rd.pybuffer.buf = NULL;
  __pyx_pybuffer_Rd.refcount = 0;
  __pyx_pybuffernd_Rd.data = NULL;
  __pyx_pybuffernd_Rd.rcbuffer = &__pyx_pybuffer_Rd;
  __pyx_pybuffer_Rv.pybuffer.buf = NULL;
  __pyx_pybuffer_Rv.refcount = 0;
  __pyx_pybuffernd_Rv.data = NULL;
  __pyx_pybuffernd_Rv.rcbuffer = &__pyx_pybuffer_Rv;
  __pyx_pybuffer_Q.pybuffer.buf = NULL;
  __pyx_pybuffer_Q.refcount = 0;
  __pyx_pybuffernd_Q.data = NULL;
  __pyx_pybuffernd_Q.rcbuffer = &__pyx_pybuffer_Q;

  /* "libTEXTURIZE.pyx":39
 * 
 * def Texture_URO_xyz(obj):
 *     cdef int myseed = obj.myseed             # <<<<<<<<<<<<<<
 *     cdef int p = obj.p
 *     cdef int m = obj.m
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_myseed); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 39, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 39, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_myseed = __pyx_t_2;

  /* "libTEXTURIZE.pyx":40
 * def Texture_URO_xyz(obj):
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p             # <<<<<<<<<<<<<<
 *     cdef int m = obj.m
 *     cdef int n = obj.n
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 40, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 40, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_p = __pyx_t_2;

  /* "libTEXTURIZE.pyx":41
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 *     cdef int m = obj.m             # <<<<<<<<<<<<<<
 *     cdef int n = obj.n
 *     cdef int makecanvas = obj.makecanvas
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_m); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 41, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 41, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_m = __pyx_t_2;

  /* "libTEXTURIZE.pyx":42
 *     cdef int p = obj.p
 *     cdef int m = obj.m
 *     cdef int n = obj.n             # <<<<<<<<<<<<<<
 *     cdef int makecanvas = obj.makecanvas
 *     cdef double tic, toc
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 42, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 42, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_n = __pyx_t_2;

  /* "libTEXTURIZE.pyx":43
 *     cdef int m = obj.m
 *     cdef int n = obj.n
 *     cdef int makecanvas = obj.makecanvas             # <<<<<<<<<<<<<<
 *     cdef double tic, toc
 * 
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_makecanvas); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 43, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 43, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_makecanvas = __pyx_t_2;

  /* "libTEXTURIZE.pyx":48
 *     cdef int i
 *     cdef float th, ph, lm , sth, sph, cth, cph, clm, slm
 *     cdef np.ndarray[np.float64_t, ndim = 1] r1 = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] lambdaa = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] theta = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 48, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 48, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 48, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 48, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 48, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 48, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 48, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 48, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 48, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 48, __pyx_L1_error)
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_r1.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_r1 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_r1.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 48, __pyx_L1_error)
    } else {__pyx_pybuffernd_r1.diminfo[0].strides = __pyx_pybuffernd_r1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_r1.diminfo[0].shape = __pyx_pybuffernd_r1.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_r1 = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":49
 *     cdef float th, ph, lm , sth, sph, cth, cph, clm, slm
 *     cdef np.ndarray[np.float64_t, ndim = 1] r1 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] lambdaa = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] theta = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] phi = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 49, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 49, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 49, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 49, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 49, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 49, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 49, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 49, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 49, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 49, __pyx_L1_error)
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_lambdaa.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_lambdaa = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_lambdaa.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 49, __pyx_L1_error)
    } else {__pyx_pybuffernd_lambdaa.diminfo[0].strides = __pyx_pybuffernd_lambdaa.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_lambdaa.diminfo[0].shape = __pyx_pybuffernd_lambdaa.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_8 = 0;
  __pyx_v_lambdaa = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":50
 *     cdef np.ndarray[np.float64_t, ndim = 1] r1 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] lambdaa = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] theta = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] phi = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 50, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 50, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 50, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 50, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 50, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 50, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 50, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 50, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 50, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 50, __pyx_L1_error)
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_theta.rcbuffer->pybuffer, (PyObject*)__pyx_t_9, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_theta = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_theta.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 50, __pyx_L1_error)
    } else {__pyx_pybuffernd_theta.diminfo[0].strides = __pyx_pybuffernd_theta.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_theta.diminfo[0].shape = __pyx_pybuffernd_theta.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_9 = 0;
  __pyx_v_theta = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":51
 *     cdef np.ndarray[np.float64_t, ndim = 1] lambdaa = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] theta = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] phi = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 51, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 51, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 51, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 51, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 51, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 51, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 51, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 51, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 51, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 51, __pyx_L1_error)
  __pyx_t_10 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phi.rcbuffer->pybuffer, (PyObject*)__pyx_t_10, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_phi = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_phi.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 51, __pyx_L1_error)
    } else {__pyx_pybuffernd_phi.diminfo[0].strides = __pyx_pybuffernd_phi.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_phi.diminfo[0].shape = __pyx_pybuffernd_phi.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_10 = 0;
  __pyx_v_phi = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":52
 *     cdef np.ndarray[np.float64_t, ndim = 1] theta = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] phi = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 52, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 52, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 52, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 52, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 52, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 52, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple_, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 52, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 52, __pyx_L1_error)
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_V1.rcbuffer->pybuffer, (PyObject*)__pyx_t_11, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_V1 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_V1.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 52, __pyx_L1_error)
    } else {__pyx_pybuffernd_V1.diminfo[0].strides = __pyx_pybuffernd_V1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_V1.diminfo[0].shape = __pyx_pybuffernd_V1.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_11 = 0;
  __pyx_v_V1 = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":53
 *     cdef np.ndarray[np.float64_t, ndim = 1] phi = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 53, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 53, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 53, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 53, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 53, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 53, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__2, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 53, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 53, __pyx_L1_error)
  __pyx_t_12 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_V2.rcbuffer->pybuffer, (PyObject*)__pyx_t_12, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_V2 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_V2.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 53, __pyx_L1_error)
    } else {__pyx_pybuffernd_V2.diminfo[0].strides = __pyx_pybuffernd_V2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_V2.diminfo[0].shape = __pyx_pybuffernd_V2.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_12 = 0;
  __pyx_v_V2 = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":54
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zc = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 54, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 54, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 54, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 54, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 54, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 54, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__3, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 54, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 54, __pyx_L1_error)
  __pyx_t_13 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Xc.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Xc = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 54, __pyx_L1_error)
    } else {__pyx_pybuffernd_Xc.diminfo[0].strides = __pyx_pybuffernd_Xc.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Xc.diminfo[0].shape = __pyx_pybuffernd_Xc.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_13 = 0;
  __pyx_v_Xc = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":55
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zc = np.zeros(3, dtype=np.float64)
 * 
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 55, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 55, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 55, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 55, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 55, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 55, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__4, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 55, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 55, __pyx_L1_error)
  __pyx_t_14 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Yc.rcbuffer->pybuffer, (PyObject*)__pyx_t_14, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Yc = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 55, __pyx_L1_error)
    } else {__pyx_pybuffernd_Yc.diminfo[0].strides = __pyx_pybuffernd_Yc.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Yc.diminfo[0].shape = __pyx_pybuffernd_Yc.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_14 = 0;
  __pyx_v_Yc = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":56
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zc = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 * 
 *     # DESCRIPTORS OF ORIENTATIONS
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 56, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 56, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 56, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 56, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 56, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 56, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__5, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 56, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 56, __pyx_L1_error)
  __pyx_t_15 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Zc.rcbuffer->pybuffer, (PyObject*)__pyx_t_15, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Zc = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Zc.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 56, __pyx_L1_error)
    } else {__pyx_pybuffernd_Zc.diminfo[0].strides = __pyx_pybuffernd_Zc.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Zc.diminfo[0].shape = __pyx_pybuffernd_Zc.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_15 = 0;
  __pyx_v_Zc = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":59
 * 
 *     # DESCRIPTORS OF ORIENTATIONS
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 59, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 59, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 59, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = PyTuple_New(3); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 59, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_3);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_3, 2, __pyx_int_3);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 59, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 59, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 59, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 59, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 59, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 59, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 59, __pyx_L1_error)
  __pyx_t_16 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer, (PyObject*)__pyx_t_16, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 3, 0, __pyx_stack) == -1)) {
      __pyx_v_Rot = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 59, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rot.diminfo[0].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rot.diminfo[0].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rot.diminfo[1].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rot.diminfo[1].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_Rot.diminfo[2].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_Rot.diminfo[2].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[2];
    }
  }
  __pyx_t_16 = 0;
  __pyx_v_Rot = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":60
 *     # DESCRIPTORS OF ORIENTATIONS
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 60, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 60, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 60, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 60, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_int_3);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 60, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 60, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 60, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 60, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 60, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 60, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 60, __pyx_L1_error)
  __pyx_t_17 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_t_17, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Eul = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Eul.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 60, __pyx_L1_error)
    } else {__pyx_pybuffernd_Eul.diminfo[0].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Eul.diminfo[0].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Eul.diminfo[1].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Eul.diminfo[1].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_17 = 0;
  __pyx_v_Eul = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":61
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 61, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 61, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 61, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 61, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_int_3);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 61, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 61, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 61, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 61, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 61, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 61, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 61, __pyx_L1_error)
  __pyx_t_18 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer, (PyObject*)__pyx_t_18, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Axis = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Axis.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 61, __pyx_L1_error)
    } else {__pyx_pybuffernd_Axis.diminfo[0].strides = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Axis.diminfo[0].shape = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Axis.diminfo[1].strides = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Axis.diminfo[1].shape = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_18 = 0;
  __pyx_v_Axis = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":62
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 62, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 62, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 62, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 62, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 62, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 62, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 62, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 62, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 62, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 62, __pyx_L1_error)
  __pyx_t_19 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer, (PyObject*)__pyx_t_19, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Angle = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Angle.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 62, __pyx_L1_error)
    } else {__pyx_pybuffernd_Angle.diminfo[0].strides = __pyx_pybuffernd_Angle.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Angle.diminfo[0].shape = __pyx_pybuffernd_Angle.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_19 = 0;
  __pyx_v_Angle = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":63
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 63, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 63, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 63, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 63, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 63, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 63, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 63, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 63, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 63, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 63, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 63, __pyx_L1_error)
  __pyx_t_20 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer, (PyObject*)__pyx_t_20, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Nd = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Nd.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 63, __pyx_L1_error)
    } else {__pyx_pybuffernd_Nd.diminfo[0].strides = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Nd.diminfo[0].shape = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Nd.diminfo[1].strides = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Nd.diminfo[1].shape = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_20 = 0;
  __pyx_v_Nd = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":64
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 64, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 64, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 64, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 64, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_3);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 64, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 64, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 64, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 64, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 64, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 64, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 64, __pyx_L1_error)
  __pyx_t_21 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer, (PyObject*)__pyx_t_21, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Rd = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rd.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 64, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rd.diminfo[0].strides = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rd.diminfo[0].shape = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rd.diminfo[1].strides = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rd.diminfo[1].shape = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_21 = 0;
  __pyx_v_Rd = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":65
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)
 * 
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 65, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 65, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 65, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 65, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_int_3);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 65, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 65, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 65, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 65, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 65, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 65, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 65, __pyx_L1_error)
  __pyx_t_22 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer, (PyObject*)__pyx_t_22, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Rv = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rv.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 65, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rv.diminfo[0].strides = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rv.diminfo[0].shape = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rv.diminfo[1].strides = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rv.diminfo[1].shape = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_22 = 0;
  __pyx_v_Rv = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":66
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)             # <<<<<<<<<<<<<<
 * 
 *     plantseed(myseed)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 66, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 66, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 66, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 66, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1);
  __Pyx_INCREF(__pyx_int_4);
  __Pyx_GIVEREF(__pyx_int_4);
  PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_int_4);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 66, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 66, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 66, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 66, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 66, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 66, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 66, __pyx_L1_error)
  __pyx_t_23 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Q.rcbuffer->pybuffer, (PyObject*)__pyx_t_23, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Q = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Q.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 66, __pyx_L1_error)
    } else {__pyx_pybuffernd_Q.diminfo[0].strides = __pyx_pybuffernd_Q.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Q.diminfo[0].shape = __pyx_pybuffernd_Q.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Q.diminfo[1].strides = __pyx_pybuffernd_Q.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Q.diminfo[1].shape = __pyx_pybuffernd_Q.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_23 = 0;
  __pyx_v_Q = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":68
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)
 * 
 *     plantseed(myseed)             # <<<<<<<<<<<<<<
 *     tic = time.time()
 * 
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_plantseed); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 68, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_myseed); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 68, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 68, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_GOTREF(__pyx_t_4);
  } else {
    __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 68, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5); __pyx_t_5 = NULL;
    __Pyx_GIVEREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 68, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  }
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":69
 * 
 *     plantseed(myseed)
 *     tic = time.time()             # <<<<<<<<<<<<<<
 * 
 *     r1 = np.random.uniform(0, 1, [p, ])
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_time); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 69, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_time); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 69, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  if (__pyx_t_6) {
    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 69, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  } else {
    __pyx_t_4 = __Pyx_PyObject_CallNoArg(__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 69, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_24 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_24 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 69, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_tic = __pyx_t_24;

  /* "libTEXTURIZE.pyx":71
 *     tic = time.time()
 * 
 *     r1 = np.random.uniform(0, 1, [p, ])             # <<<<<<<<<<<<<<
 *     theta = np.arccos(2 * r1 - 1)
 *     phi = np.random.uniform(0, 2 * np.pi, [p, ])
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 71, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_random); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 71, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_uniform); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 71, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 71, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 71, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_6);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  __pyx_t_25 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
      __pyx_t_25 = 1;
    }
  }
  __pyx_t_5 = PyTuple_New(3+__pyx_t_25); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 71, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__pyx_t_6) {
    __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6); __pyx_t_6 = NULL;
  }
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_25, __pyx_int_0);
  __Pyx_INCREF(__pyx_int_1);
  __Pyx_GIVEREF(__pyx_int_1);
  PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_25, __pyx_int_1);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_5, 2+__pyx_t_25, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 71, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 71, __pyx_L1_error)
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_r1.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_r1.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_26, &__pyx_t_27, &__pyx_t_28);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_r1.rcbuffer->pybuffer, (PyObject*)__pyx_v_r1, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_26); Py_XDECREF(__pyx_t_27); Py_XDECREF(__pyx_t_28);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_26, __pyx_t_27, __pyx_t_28);
      }
    }
    __pyx_pybuffernd_r1.diminfo[0].strides = __pyx_pybuffernd_r1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_r1.diminfo[0].shape = __pyx_pybuffernd_r1.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 71, __pyx_L1_error)
  }
  __pyx_t_7 = 0;
  __Pyx_DECREF_SET(__pyx_v_r1, ((PyArrayObject *)__pyx_t_4));
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":72
 * 
 *     r1 = np.random.uniform(0, 1, [p, ])
 *     theta = np.arccos(2 * r1 - 1)             # <<<<<<<<<<<<<<
 *     phi = np.random.uniform(0, 2 * np.pi, [p, ])
 *     lambdaa = np.random.uniform(0, 2 * pi, [p, ])
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 72, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_arccos); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 72, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyNumber_Multiply(__pyx_int_2, ((PyObject *)__pyx_v_r1)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 72, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = __Pyx_PyInt_SubtractObjC(__pyx_t_3, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 72, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 72, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_GOTREF(__pyx_t_4);
  } else {
    __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 72, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3); __pyx_t_3 = NULL;
    __Pyx_GIVEREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_6, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 72, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 72, __pyx_L1_error)
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_theta.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_theta.rcbuffer->pybuffer, (PyObject*)__pyx_t_9, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_28, &__pyx_t_27, &__pyx_t_26);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_theta.rcbuffer->pybuffer, (PyObject*)__pyx_v_theta, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_28); Py_XDECREF(__pyx_t_27); Py_XDECREF(__pyx_t_26);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_28, __pyx_t_27, __pyx_t_26);
      }
    }
    __pyx_pybuffernd_theta.diminfo[0].strides = __pyx_pybuffernd_theta.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_theta.diminfo[0].shape = __pyx_pybuffernd_theta.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 72, __pyx_L1_error)
  }
  __pyx_t_9 = 0;
  __Pyx_DECREF_SET(__pyx_v_theta, ((PyArrayObject *)__pyx_t_4));
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":73
 *     r1 = np.random.uniform(0, 1, [p, ])
 *     theta = np.arccos(2 * r1 - 1)
 *     phi = np.random.uniform(0, 2 * np.pi, [p, ])             # <<<<<<<<<<<<<<
 *     lambdaa = np.random.uniform(0, 2 * pi, [p, ])
 * 
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 73, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_random); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 73, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_uniform); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 73, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 73, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_pi); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 73, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = PyNumber_Multiply(__pyx_int_2, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 73, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 73, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 73, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_1);
  PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  __pyx_t_25 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
      __pyx_t_25 = 1;
    }
  }
  __pyx_t_29 = PyTuple_New(3+__pyx_t_25); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 73, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_29);
  if (__pyx_t_1) {
    __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_29, 0, __pyx_t_1); __pyx_t_1 = NULL;
  }
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_29, 0+__pyx_t_25, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_29, 1+__pyx_t_25, __pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_29, 2+__pyx_t_25, __pyx_t_3);
  __pyx_t_6 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_29, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 73, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 73, __pyx_L1_error)
  __pyx_t_10 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_phi.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phi.rcbuffer->pybuffer, (PyObject*)__pyx_t_10, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_26, &__pyx_t_27, &__pyx_t_28);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phi.rcbuffer->pybuffer, (PyObject*)__pyx_v_phi, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_26); Py_XDECREF(__pyx_t_27); Py_XDECREF(__pyx_t_28);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_26, __pyx_t_27, __pyx_t_28);
      }
    }
    __pyx_pybuffernd_phi.diminfo[0].strides = __pyx_pybuffernd_phi.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_phi.diminfo[0].shape = __pyx_pybuffernd_phi.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 73, __pyx_L1_error)
  }
  __pyx_t_10 = 0;
  __Pyx_DECREF_SET(__pyx_v_phi, ((PyArrayObject *)__pyx_t_4));
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":74
 *     theta = np.arccos(2 * r1 - 1)
 *     phi = np.random.uniform(0, 2 * np.pi, [p, ])
 *     lambdaa = np.random.uniform(0, 2 * pi, [p, ])             # <<<<<<<<<<<<<<
 * 
 *     for i in range(p):
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 74, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_29 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_random); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 74, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_29);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_29, __pyx_n_s_uniform); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 74, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_29); __pyx_t_29 = 0;
  __pyx_t_29 = PyFloat_FromDouble((2.0 * __pyx_v_12libTEXTURIZE_pi)); if (unlikely(!__pyx_t_29)) __PYX_ERR(0, 74, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_29);
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 74, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = PyList_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 74, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_3);
  PyList_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_25 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
      __pyx_t_25 = 1;
    }
  }
  __pyx_t_1 = PyTuple_New(3+__pyx_t_25); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 74, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (__pyx_t_3) {
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_25, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_t_29);
  PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_25, __pyx_t_29);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_1, 2+__pyx_t_25, __pyx_t_6);
  __pyx_t_29 = 0;
  __pyx_t_6 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 74, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 74, __pyx_L1_error)
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_lambdaa.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_lambdaa.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_28, &__pyx_t_27, &__pyx_t_26);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_lambdaa.rcbuffer->pybuffer, (PyObject*)__pyx_v_lambdaa, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_28); Py_XDECREF(__pyx_t_27); Py_XDECREF(__pyx_t_26);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_28, __pyx_t_27, __pyx_t_26);
      }
    }
    __pyx_pybuffernd_lambdaa.diminfo[0].strides = __pyx_pybuffernd_lambdaa.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_lambdaa.diminfo[0].shape = __pyx_pybuffernd_lambdaa.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 74, __pyx_L1_error)
  }
  __pyx_t_8 = 0;
  __Pyx_DECREF_SET(__pyx_v_lambdaa, ((PyArrayObject *)__pyx_t_4));
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":76
 *     lambdaa = np.random.uniform(0, 2 * pi, [p, ])
 * 
 *     for i in range(p):             # <<<<<<<<<<<<<<
 *         th = theta[i]
 *         ph = phi[i]
 */
  __pyx_t_2 = __pyx_v_p;
  for (__pyx_t_30 = 0; __pyx_t_30 < __pyx_t_2; __pyx_t_30+=1) {
    __pyx_v_i = __pyx_t_30;

    /* "libTEXTURIZE.pyx":77
 * 
 *     for i in range(p):
 *         th = theta[i]             # <<<<<<<<<<<<<<
 *         ph = phi[i]
 *         lm = lambdaa[i]
 */
    __pyx_t_31 = __pyx_v_i;
    __pyx_v_th = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_theta.rcbuffer->pybuffer.buf, __pyx_t_31, __pyx_pybuffernd_theta.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":78
 *     for i in range(p):
 *         th = theta[i]
 *         ph = phi[i]             # <<<<<<<<<<<<<<
 *         lm = lambdaa[i]
 *         cth = cos(th)
 */
    __pyx_t_32 = __pyx_v_i;
    __pyx_v_ph = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_phi.rcbuffer->pybuffer.buf, __pyx_t_32, __pyx_pybuffernd_phi.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":79
 *         th = theta[i]
 *         ph = phi[i]
 *         lm = lambdaa[i]             # <<<<<<<<<<<<<<
 *         cth = cos(th)
 *         cph = cos(ph)
 */
    __pyx_t_33 = __pyx_v_i;
    __pyx_v_lm = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_lambdaa.rcbuffer->pybuffer.buf, __pyx_t_33, __pyx_pybuffernd_lambdaa.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":80
 *         ph = phi[i]
 *         lm = lambdaa[i]
 *         cth = cos(th)             # <<<<<<<<<<<<<<
 *         cph = cos(ph)
 *         clm = cos(lm)
 */
    __pyx_v_cth = cos(__pyx_v_th);

    /* "libTEXTURIZE.pyx":81
 *         lm = lambdaa[i]
 *         cth = cos(th)
 *         cph = cos(ph)             # <<<<<<<<<<<<<<
 *         clm = cos(lm)
 * 
 */
    __pyx_v_cph = cos(__pyx_v_ph);

    /* "libTEXTURIZE.pyx":82
 *         cth = cos(th)
 *         cph = cos(ph)
 *         clm = cos(lm)             # <<<<<<<<<<<<<<
 * 
 *         sth = sin(th)
 */
    __pyx_v_clm = cos(__pyx_v_lm);

    /* "libTEXTURIZE.pyx":84
 *         clm = cos(lm)
 * 
 *         sth = sin(th)             # <<<<<<<<<<<<<<
 *         sph = sin(ph)
 *         slm = sin(lm)
 */
    __pyx_v_sth = sin(__pyx_v_th);

    /* "libTEXTURIZE.pyx":85
 * 
 *         sth = sin(th)
 *         sph = sin(ph)             # <<<<<<<<<<<<<<
 *         slm = sin(lm)
 * 
 */
    __pyx_v_sph = sin(__pyx_v_ph);

    /* "libTEXTURIZE.pyx":86
 *         sth = sin(th)
 *         sph = sin(ph)
 *         slm = sin(lm)             # <<<<<<<<<<<<<<
 * 
 *         # CRYSTALLOGRAPHIC X AXIS
 */
    __pyx_v_slm = sin(__pyx_v_lm);

    /* "libTEXTURIZE.pyx":89
 * 
 *         # CRYSTALLOGRAPHIC X AXIS
 *         Xc[0] = sth * cph             # <<<<<<<<<<<<<<
 *         Xc[1] = sth * sph
 *         Xc[2] = cth
 */
    __pyx_t_34 = 0;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_Xc.diminfo[0].strides) = (__pyx_v_sth * __pyx_v_cph);

    /* "libTEXTURIZE.pyx":90
 *         # CRYSTALLOGRAPHIC X AXIS
 *         Xc[0] = sth * cph
 *         Xc[1] = sth * sph             # <<<<<<<<<<<<<<
 *         Xc[2] = cth
 * 
 */
    __pyx_t_35 = 1;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_35, __pyx_pybuffernd_Xc.diminfo[0].strides) = (__pyx_v_sth * __pyx_v_sph);

    /* "libTEXTURIZE.pyx":91
 *         Xc[0] = sth * cph
 *         Xc[1] = sth * sph
 *         Xc[2] = cth             # <<<<<<<<<<<<<<
 * 
 *         # ORTHOGONAL AUXILARY VECTORS PERPENDICULAR TO X AXIS
 */
    __pyx_t_36 = 2;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_36, __pyx_pybuffernd_Xc.diminfo[0].strides) = __pyx_v_cth;

    /* "libTEXTURIZE.pyx":94
 * 
 *         # ORTHOGONAL AUXILARY VECTORS PERPENDICULAR TO X AXIS
 *         V1[0] = sph             # <<<<<<<<<<<<<<
 *         V1[1] = -cph
 *         V1[2] = 0
 */
    __pyx_t_37 = 0;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V1.rcbuffer->pybuffer.buf, __pyx_t_37, __pyx_pybuffernd_V1.diminfo[0].strides) = __pyx_v_sph;

    /* "libTEXTURIZE.pyx":95
 *         # ORTHOGONAL AUXILARY VECTORS PERPENDICULAR TO X AXIS
 *         V1[0] = sph
 *         V1[1] = -cph             # <<<<<<<<<<<<<<
 *         V1[2] = 0
 *         V2[0] = cph * cth
 */
    __pyx_t_38 = 1;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V1.rcbuffer->pybuffer.buf, __pyx_t_38, __pyx_pybuffernd_V1.diminfo[0].strides) = (-__pyx_v_cph);

    /* "libTEXTURIZE.pyx":96
 *         V1[0] = sph
 *         V1[1] = -cph
 *         V1[2] = 0             # <<<<<<<<<<<<<<
 *         V2[0] = cph * cth
 *         V2[1] = sph * cth
 */
    __pyx_t_39 = 2;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V1.rcbuffer->pybuffer.buf, __pyx_t_39, __pyx_pybuffernd_V1.diminfo[0].strides) = 0.0;

    /* "libTEXTURIZE.pyx":97
 *         V1[1] = -cph
 *         V1[2] = 0
 *         V2[0] = cph * cth             # <<<<<<<<<<<<<<
 *         V2[1] = sph * cth
 *         V2[2] = -sth
 */
    __pyx_t_40 = 0;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V2.rcbuffer->pybuffer.buf, __pyx_t_40, __pyx_pybuffernd_V2.diminfo[0].strides) = (__pyx_v_cph * __pyx_v_cth);

    /* "libTEXTURIZE.pyx":98
 *         V1[2] = 0
 *         V2[0] = cph * cth
 *         V2[1] = sph * cth             # <<<<<<<<<<<<<<
 *         V2[2] = -sth
 * 
 */
    __pyx_t_41 = 1;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V2.rcbuffer->pybuffer.buf, __pyx_t_41, __pyx_pybuffernd_V2.diminfo[0].strides) = (__pyx_v_sph * __pyx_v_cth);

    /* "libTEXTURIZE.pyx":99
 *         V2[0] = cph * cth
 *         V2[1] = sph * cth
 *         V2[2] = -sth             # <<<<<<<<<<<<<<
 * 
 *         # CRYSTALLOGRAPHIC Y AXIS
 */
    __pyx_t_42 = 2;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V2.rcbuffer->pybuffer.buf, __pyx_t_42, __pyx_pybuffernd_V2.diminfo[0].strides) = (-__pyx_v_sth);

    /* "libTEXTURIZE.pyx":102
 * 
 *         # CRYSTALLOGRAPHIC Y AXIS
 *         Yc[0] = clm * V1[0] + slm * V2[0]             # <<<<<<<<<<<<<<
 *         Yc[1] = clm * V1[1] + slm * V2[1]
 *         Yc[2] = clm * V1[2] + slm * V2[2]
 */
    __pyx_t_43 = 0;
    __pyx_t_44 = 0;
    __pyx_t_45 = 0;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_45, __pyx_pybuffernd_Yc.diminfo[0].strides) = ((__pyx_v_clm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V1.rcbuffer->pybuffer.buf, __pyx_t_43, __pyx_pybuffernd_V1.diminfo[0].strides))) + (__pyx_v_slm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V2.rcbuffer->pybuffer.buf, __pyx_t_44, __pyx_pybuffernd_V2.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":103
 *         # CRYSTALLOGRAPHIC Y AXIS
 *         Yc[0] = clm * V1[0] + slm * V2[0]
 *         Yc[1] = clm * V1[1] + slm * V2[1]             # <<<<<<<<<<<<<<
 *         Yc[2] = clm * V1[2] + slm * V2[2]
 * 
 */
    __pyx_t_46 = 1;
    __pyx_t_47 = 1;
    __pyx_t_48 = 1;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_48, __pyx_pybuffernd_Yc.diminfo[0].strides) = ((__pyx_v_clm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V1.rcbuffer->pybuffer.buf, __pyx_t_46, __pyx_pybuffernd_V1.diminfo[0].strides))) + (__pyx_v_slm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V2.rcbuffer->pybuffer.buf, __pyx_t_47, __pyx_pybuffernd_V2.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":104
 *         Yc[0] = clm * V1[0] + slm * V2[0]
 *         Yc[1] = clm * V1[1] + slm * V2[1]
 *         Yc[2] = clm * V1[2] + slm * V2[2]             # <<<<<<<<<<<<<<
 * 
 *         # CRYSTALLOGRAPHIC Z AXIS
 */
    __pyx_t_49 = 2;
    __pyx_t_50 = 2;
    __pyx_t_51 = 2;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_51, __pyx_pybuffernd_Yc.diminfo[0].strides) = ((__pyx_v_clm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V1.rcbuffer->pybuffer.buf, __pyx_t_49, __pyx_pybuffernd_V1.diminfo[0].strides))) + (__pyx_v_slm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V2.rcbuffer->pybuffer.buf, __pyx_t_50, __pyx_pybuffernd_V2.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":108
 *         # CRYSTALLOGRAPHIC Z AXIS
 * 
 *         Zc[0] = Xc[1] * Yc[2] - Yc[1] * Xc[2]             # <<<<<<<<<<<<<<
 *         Zc[1] = Xc[2] * Yc[0] - Yc[2] * Xc[0]
 *         Zc[2] = Xc[0] * Yc[1] - Yc[0] * Xc[1]
 */
    __pyx_t_52 = 1;
    __pyx_t_53 = 2;
    __pyx_t_54 = 1;
    __pyx_t_55 = 2;
    __pyx_t_56 = 0;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Zc.rcbuffer->pybuffer.buf, __pyx_t_56, __pyx_pybuffernd_Zc.diminfo[0].strides) = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_52, __pyx_pybuffernd_Xc.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_53, __pyx_pybuffernd_Yc.diminfo[0].strides))) - ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_54, __pyx_pybuffernd_Yc.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_55, __pyx_pybuffernd_Xc.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":109
 * 
 *         Zc[0] = Xc[1] * Yc[2] - Yc[1] * Xc[2]
 *         Zc[1] = Xc[2] * Yc[0] - Yc[2] * Xc[0]             # <<<<<<<<<<<<<<
 *         Zc[2] = Xc[0] * Yc[1] - Yc[0] * Xc[1]
 * 
 */
    __pyx_t_57 = 2;
    __pyx_t_58 = 0;
    __pyx_t_59 = 2;
    __pyx_t_60 = 0;
    __pyx_t_61 = 1;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Zc.rcbuffer->pybuffer.buf, __pyx_t_61, __pyx_pybuffernd_Zc.diminfo[0].strides) = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_57, __pyx_pybuffernd_Xc.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_58, __pyx_pybuffernd_Yc.diminfo[0].strides))) - ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_59, __pyx_pybuffernd_Yc.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_60, __pyx_pybuffernd_Xc.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":110
 *         Zc[0] = Xc[1] * Yc[2] - Yc[1] * Xc[2]
 *         Zc[1] = Xc[2] * Yc[0] - Yc[2] * Xc[0]
 *         Zc[2] = Xc[0] * Yc[1] - Yc[0] * Xc[1]             # <<<<<<<<<<<<<<
 * 
 *         # ROTATION MATRIX
 */
    __pyx_t_62 = 0;
    __pyx_t_63 = 1;
    __pyx_t_64 = 0;
    __pyx_t_65 = 1;
    __pyx_t_66 = 2;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Zc.rcbuffer->pybuffer.buf, __pyx_t_66, __pyx_pybuffernd_Zc.diminfo[0].strides) = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_62, __pyx_pybuffernd_Xc.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_63, __pyx_pybuffernd_Yc.diminfo[0].strides))) - ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_64, __pyx_pybuffernd_Yc.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_65, __pyx_pybuffernd_Xc.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":113
 * 
 *         # ROTATION MATRIX
 *         Rot[i, 0, 0] = Xc[0]             # <<<<<<<<<<<<<<
 *         Rot[i, 0, 1] = Xc[1]
 *         Rot[i, 0, 2] = Xc[2]
 */
    __pyx_t_67 = 0;
    __pyx_t_68 = __pyx_v_i;
    __pyx_t_69 = 0;
    __pyx_t_70 = 0;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_68, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_69, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_70, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_67, __pyx_pybuffernd_Xc.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":114
 *         # ROTATION MATRIX
 *         Rot[i, 0, 0] = Xc[0]
 *         Rot[i, 0, 1] = Xc[1]             # <<<<<<<<<<<<<<
 *         Rot[i, 0, 2] = Xc[2]
 *         Rot[i, 1, 0] = Yc[0]
 */
    __pyx_t_71 = 1;
    __pyx_t_72 = __pyx_v_i;
    __pyx_t_73 = 0;
    __pyx_t_74 = 1;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_72, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_73, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_74, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_71, __pyx_pybuffernd_Xc.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":115
 *         Rot[i, 0, 0] = Xc[0]
 *         Rot[i, 0, 1] = Xc[1]
 *         Rot[i, 0, 2] = Xc[2]             # <<<<<<<<<<<<<<
 *         Rot[i, 1, 0] = Yc[0]
 *         Rot[i, 1, 1] = Yc[1]
 */
    __pyx_t_75 = 2;
    __pyx_t_76 = __pyx_v_i;
    __pyx_t_77 = 0;
    __pyx_t_78 = 2;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_76, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_77, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_78, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_75, __pyx_pybuffernd_Xc.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":116
 *         Rot[i, 0, 1] = Xc[1]
 *         Rot[i, 0, 2] = Xc[2]
 *         Rot[i, 1, 0] = Yc[0]             # <<<<<<<<<<<<<<
 *         Rot[i, 1, 1] = Yc[1]
 *         Rot[i, 1, 2] = Yc[2]
 */
    __pyx_t_79 = 0;
    __pyx_t_80 = __pyx_v_i;
    __pyx_t_81 = 1;
    __pyx_t_82 = 0;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_80, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_81, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_82, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_79, __pyx_pybuffernd_Yc.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":117
 *         Rot[i, 0, 2] = Xc[2]
 *         Rot[i, 1, 0] = Yc[0]
 *         Rot[i, 1, 1] = Yc[1]             # <<<<<<<<<<<<<<
 *         Rot[i, 1, 2] = Yc[2]
 *         Rot[i, 2, 0] = Zc[0]
 */
    __pyx_t_83 = 1;
    __pyx_t_84 = __pyx_v_i;
    __pyx_t_85 = 1;
    __pyx_t_86 = 1;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_84, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_85, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_86, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_83, __pyx_pybuffernd_Yc.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":118
 *         Rot[i, 1, 0] = Yc[0]
 *         Rot[i, 1, 1] = Yc[1]
 *         Rot[i, 1, 2] = Yc[2]             # <<<<<<<<<<<<<<
 *         Rot[i, 2, 0] = Zc[0]
 *         Rot[i, 2, 1] = Zc[1]
 */
    __pyx_t_87 = 2;
    __pyx_t_88 = __pyx_v_i;
    __pyx_t_89 = 1;
    __pyx_t_90 = 2;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_88, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_89, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_90, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_87, __pyx_pybuffernd_Yc.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":119
 *         Rot[i, 1, 1] = Yc[1]
 *         Rot[i, 1, 2] = Yc[2]
 *         Rot[i, 2, 0] = Zc[0]             # <<<<<<<<<<<<<<
 *         Rot[i, 2, 1] = Zc[1]
 *         Rot[i, 2, 2] = Zc[2]
 */
    __pyx_t_91 = 0;
    __pyx_t_92 = __pyx_v_i;
    __pyx_t_93 = 2;
    __pyx_t_94 = 0;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_92, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_93, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_94, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Zc.rcbuffer->pybuffer.buf, __pyx_t_91, __pyx_pybuffernd_Zc.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":120
 *         Rot[i, 1, 2] = Yc[2]
 *         Rot[i, 2, 0] = Zc[0]
 *         Rot[i, 2, 1] = Zc[1]             # <<<<<<<<<<<<<<
 *         Rot[i, 2, 2] = Zc[2]
 * 
 */
    __pyx_t_95 = 1;
    __pyx_t_96 = __pyx_v_i;
    __pyx_t_97 = 2;
    __pyx_t_98 = 1;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_96, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_97, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_98, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Zc.rcbuffer->pybuffer.buf, __pyx_t_95, __pyx_pybuffernd_Zc.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":121
 *         Rot[i, 2, 0] = Zc[0]
 *         Rot[i, 2, 1] = Zc[1]
 *         Rot[i, 2, 2] = Zc[2]             # <<<<<<<<<<<<<<
 * 
 *     Eul = conv.rm_to_zxz(Rot)
 */
    __pyx_t_99 = 2;
    __pyx_t_100 = __pyx_v_i;
    __pyx_t_101 = 2;
    __pyx_t_102 = 2;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_100, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_101, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_102, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Zc.rcbuffer->pybuffer.buf, __pyx_t_99, __pyx_pybuffernd_Zc.diminfo[0].strides));
  }

  /* "libTEXTURIZE.pyx":123
 *         Rot[i, 2, 2] = Zc[2]
 * 
 *     Eul = conv.rm_to_zxz(Rot)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_conv); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 123, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_rm_to_zxz); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 123, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_1, ((PyObject *)__pyx_v_Rot)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 123, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
  } else {
    __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 123, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5); __pyx_t_5 = NULL;
    __Pyx_INCREF(((PyObject *)__pyx_v_Rot));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_Rot));
    PyTuple_SET_ITEM(__pyx_t_6, 0+1, ((PyObject *)__pyx_v_Rot));
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 123, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 123, __pyx_L1_error)
  __pyx_t_17 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_t_17, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_26, &__pyx_t_27, &__pyx_t_28);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_v_Eul, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_26); Py_XDECREF(__pyx_t_27); Py_XDECREF(__pyx_t_28);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_26, __pyx_t_27, __pyx_t_28);
      }
    }
    __pyx_pybuffernd_Eul.diminfo[0].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Eul.diminfo[0].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Eul.diminfo[1].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Eul.diminfo[1].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[1];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 123, __pyx_L1_error)
  }
  __pyx_t_17 = 0;
  __Pyx_DECREF_SET(__pyx_v_Eul, ((PyArrayObject *)__pyx_t_4));
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":126
 * 
 * 
 *     if makecanvas == 0:             # <<<<<<<<<<<<<<
 * 
 *         obj.Eul = Eul
 */
  __pyx_t_103 = ((__pyx_v_makecanvas == 0) != 0);
  if (__pyx_t_103) {

    /* "libTEXTURIZE.pyx":128
 *     if makecanvas == 0:
 * 
 *         obj.Eul = Eul             # <<<<<<<<<<<<<<
 *     else:
 *         obj.EUL = getcanvas(m, n, Eul)
 */
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_Eul, ((PyObject *)__pyx_v_Eul)) < 0) __PYX_ERR(0, 128, __pyx_L1_error)

    /* "libTEXTURIZE.pyx":126
 * 
 * 
 *     if makecanvas == 0:             # <<<<<<<<<<<<<<
 * 
 *         obj.Eul = Eul
 */
    goto __pyx_L5;
  }

  /* "libTEXTURIZE.pyx":130
 *         obj.Eul = Eul
 *     else:
 *         obj.EUL = getcanvas(m, n, Eul)             # <<<<<<<<<<<<<<
 * 
 *     toc = time.time()
 */
  /*else*/ {
    __pyx_t_4 = __pyx_f_12libTEXTURIZE_getcanvas(__pyx_v_m, __pyx_v_n, ((PyArrayObject *)__pyx_v_Eul)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 130, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_EUL, __pyx_t_4) < 0) __PYX_ERR(0, 130, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_L5:;

  /* "libTEXTURIZE.pyx":132
 *         obj.EUL = getcanvas(m, n, Eul)
 * 
 *     toc = time.time()             # <<<<<<<<<<<<<<
 *     obj.exetime = toc - tic
 *     return obj
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_time); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 132, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_time); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 132, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
    }
  }
  if (__pyx_t_1) {
    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 132, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    __pyx_t_4 = __Pyx_PyObject_CallNoArg(__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 132, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_24 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_24 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 132, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_toc = __pyx_t_24;

  /* "libTEXTURIZE.pyx":133
 * 
 *     toc = time.time()
 *     obj.exetime = toc - tic             # <<<<<<<<<<<<<<
 *     return obj
 * 
 */
  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_toc - __pyx_v_tic)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 133, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_exetime, __pyx_t_4) < 0) __PYX_ERR(0, 133, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":134
 *     toc = time.time()
 *     obj.exetime = toc - tic
 *     return obj             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_obj);
  __pyx_r = __pyx_v_obj;
  goto __pyx_L0;

  /* "libTEXTURIZE.pyx":38
 *         random.seed(myseed)
 * 
 * def Texture_URO_xyz(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_29);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Q.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V1.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V2.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Xc.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Yc.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Zc.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_lambdaa.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_phi.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_r1.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_theta.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("libTEXTURIZE.Texture_URO_xyz", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Q.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V1.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V2.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Xc.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Yc.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Zc.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_lambdaa.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_phi.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_r1.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_theta.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XDECREF((PyObject *)__pyx_v_r1);
  __Pyx_XDECREF((PyObject *)__pyx_v_lambdaa);
  __Pyx_XDECREF((PyObject *)__pyx_v_theta);
  __Pyx_XDECREF((PyObject *)__pyx_v_phi);
  __Pyx_XDECREF((PyObject *)__pyx_v_V1);
  __Pyx_XDECREF((PyObject *)__pyx_v_V2);
  __Pyx_XDECREF((PyObject *)__pyx_v_Xc);
  __Pyx_XDECREF((PyObject *)__pyx_v_Yc);
  __Pyx_XDECREF((PyObject *)__pyx_v_Zc);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rot);
  __Pyx_XDECREF((PyObject *)__pyx_v_Eul);
  __Pyx_XDECREF((PyObject *)__pyx_v_Axis);
  __Pyx_XDECREF((PyObject *)__pyx_v_Angle);
  __Pyx_XDECREF((PyObject *)__pyx_v_Nd);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rd);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rv);
  __Pyx_XDECREF((PyObject *)__pyx_v_Q);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "libTEXTURIZE.pyx":139
 * 
 * 
 * def Texture_URO_nxyz(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */

/* Python wrapper */
static PyObject *__pyx_pw_12libTEXTURIZE_5Texture_URO_nxyz(PyObject *__pyx_self, PyObject *__pyx_v_obj); /*proto*/
static PyMethodDef __pyx_mdef_12libTEXTURIZE_5Texture_URO_nxyz = {"Texture_URO_nxyz", (PyCFunction)__pyx_pw_12libTEXTURIZE_5Texture_URO_nxyz, METH_O, 0};
static PyObject *__pyx_pw_12libTEXTURIZE_5Texture_URO_nxyz(PyObject *__pyx_self, PyObject *__pyx_v_obj) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Texture_URO_nxyz (wrapper)", 0);
  __pyx_r = __pyx_pf_12libTEXTURIZE_4Texture_URO_nxyz(__pyx_self, ((PyObject *)__pyx_v_obj));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_12libTEXTURIZE_4Texture_URO_nxyz(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_obj) {
  int __pyx_v_myseed;
  int __pyx_v_p;
  int __pyx_v_m;
  int __pyx_v_n;
  int __pyx_v_makecanvas;
  double __pyx_v_tic;
  double __pyx_v_toc;
  int __pyx_v_i;
  float __pyx_v_th;
  float __pyx_v_ph;
  float __pyx_v_lm;
  float __pyx_v_sth;
  float __pyx_v_sph;
  float __pyx_v_cth;
  float __pyx_v_cph;
  float __pyx_v_clm;
  float __pyx_v_slm;
  float __pyx_v_coss;
  float __pyx_v_sinn;
  float __pyx_v_cossncap0;
  float __pyx_v_cossncap1;
  float __pyx_v_cossncap2;
  PyArrayObject *__pyx_v_r1 = 0;
  PyArrayObject *__pyx_v_lambdaa = 0;
  PyArrayObject *__pyx_v_theta = 0;
  PyArrayObject *__pyx_v_phi = 0;
  PyArrayObject *__pyx_v_ncap = 0;
  PyArrayObject *__pyx_v_V1 = 0;
  PyArrayObject *__pyx_v_V2 = 0;
  PyArrayObject *__pyx_v_Xp = 0;
  PyArrayObject *__pyx_v_Yp = 0;
  PyArrayObject *__pyx_v_Zp = 0;
  PyArrayObject *__pyx_v_Xc = 0;
  PyArrayObject *__pyx_v_Yc = 0;
  PyArrayObject *__pyx_v_Zc = 0;
  PyArrayObject *__pyx_v_Rot = 0;
  PyArrayObject *__pyx_v_Eul = 0;
  PyArrayObject *__pyx_v_Axis = 0;
  PyArrayObject *__pyx_v_Angle = 0;
  PyArrayObject *__pyx_v_Nd = 0;
  PyArrayObject *__pyx_v_Rd = 0;
  PyArrayObject *__pyx_v_Rv = 0;
  PyArrayObject *__pyx_v_Q = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Angle;
  __Pyx_Buffer __pyx_pybuffer_Angle;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Axis;
  __Pyx_Buffer __pyx_pybuffer_Axis;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Eul;
  __Pyx_Buffer __pyx_pybuffer_Eul;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Nd;
  __Pyx_Buffer __pyx_pybuffer_Nd;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Q;
  __Pyx_Buffer __pyx_pybuffer_Q;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rd;
  __Pyx_Buffer __pyx_pybuffer_Rd;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rot;
  __Pyx_Buffer __pyx_pybuffer_Rot;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rv;
  __Pyx_Buffer __pyx_pybuffer_Rv;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_V1;
  __Pyx_Buffer __pyx_pybuffer_V1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_V2;
  __Pyx_Buffer __pyx_pybuffer_V2;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Xc;
  __Pyx_Buffer __pyx_pybuffer_Xc;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Xp;
  __Pyx_Buffer __pyx_pybuffer_Xp;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Yc;
  __Pyx_Buffer __pyx_pybuffer_Yc;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Yp;
  __Pyx_Buffer __pyx_pybuffer_Yp;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Zc;
  __Pyx_Buffer __pyx_pybuffer_Zc;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Zp;
  __Pyx_Buffer __pyx_pybuffer_Zp;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_lambdaa;
  __Pyx_Buffer __pyx_pybuffer_lambdaa;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_ncap;
  __Pyx_Buffer __pyx_pybuffer_ncap;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_phi;
  __Pyx_Buffer __pyx_pybuffer_phi;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_r1;
  __Pyx_Buffer __pyx_pybuffer_r1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_theta;
  __Pyx_Buffer __pyx_pybuffer_theta;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyArrayObject *__pyx_t_7 = NULL;
  PyArrayObject *__pyx_t_8 = NULL;
  PyArrayObject *__pyx_t_9 = NULL;
  PyArrayObject *__pyx_t_10 = NULL;
  PyArrayObject *__pyx_t_11 = NULL;
  PyArrayObject *__pyx_t_12 = NULL;
  PyArrayObject *__pyx_t_13 = NULL;
  PyArrayObject *__pyx_t_14 = NULL;
  PyArrayObject *__pyx_t_15 = NULL;
  PyArrayObject *__pyx_t_16 = NULL;
  PyArrayObject *__pyx_t_17 = NULL;
  PyArrayObject *__pyx_t_18 = NULL;
  PyArrayObject *__pyx_t_19 = NULL;
  PyArrayObject *__pyx_t_20 = NULL;
  PyArrayObject *__pyx_t_21 = NULL;
  PyArrayObject *__pyx_t_22 = NULL;
  PyArrayObject *__pyx_t_23 = NULL;
  PyArrayObject *__pyx_t_24 = NULL;
  PyArrayObject *__pyx_t_25 = NULL;
  PyArrayObject *__pyx_t_26 = NULL;
  PyArrayObject *__pyx_t_27 = NULL;
  double __pyx_t_28;
  Py_ssize_t __pyx_t_29;
  PyObject *__pyx_t_30 = NULL;
  PyObject *__pyx_t_31 = NULL;
  PyObject *__pyx_t_32 = NULL;
  PyObject *__pyx_t_33 = NULL;
  int __pyx_t_34;
  Py_ssize_t __pyx_t_35;
  Py_ssize_t __pyx_t_36;
  Py_ssize_t __pyx_t_37;
  Py_ssize_t __pyx_t_38;
  Py_ssize_t __pyx_t_39;
  Py_ssize_t __pyx_t_40;
  Py_ssize_t __pyx_t_41;
  Py_ssize_t __pyx_t_42;
  Py_ssize_t __pyx_t_43;
  Py_ssize_t __pyx_t_44;
  Py_ssize_t __pyx_t_45;
  Py_ssize_t __pyx_t_46;
  Py_ssize_t __pyx_t_47;
  Py_ssize_t __pyx_t_48;
  Py_ssize_t __pyx_t_49;
  Py_ssize_t __pyx_t_50;
  Py_ssize_t __pyx_t_51;
  Py_ssize_t __pyx_t_52;
  Py_ssize_t __pyx_t_53;
  Py_ssize_t __pyx_t_54;
  Py_ssize_t __pyx_t_55;
  Py_ssize_t __pyx_t_56;
  Py_ssize_t __pyx_t_57;
  Py_ssize_t __pyx_t_58;
  Py_ssize_t __pyx_t_59;
  Py_ssize_t __pyx_t_60;
  Py_ssize_t __pyx_t_61;
  Py_ssize_t __pyx_t_62;
  Py_ssize_t __pyx_t_63;
  Py_ssize_t __pyx_t_64;
  Py_ssize_t __pyx_t_65;
  Py_ssize_t __pyx_t_66;
  Py_ssize_t __pyx_t_67;
  Py_ssize_t __pyx_t_68;
  Py_ssize_t __pyx_t_69;
  Py_ssize_t __pyx_t_70;
  Py_ssize_t __pyx_t_71;
  Py_ssize_t __pyx_t_72;
  Py_ssize_t __pyx_t_73;
  Py_ssize_t __pyx_t_74;
  Py_ssize_t __pyx_t_75;
  Py_ssize_t __pyx_t_76;
  Py_ssize_t __pyx_t_77;
  Py_ssize_t __pyx_t_78;
  Py_ssize_t __pyx_t_79;
  Py_ssize_t __pyx_t_80;
  Py_ssize_t __pyx_t_81;
  Py_ssize_t __pyx_t_82;
  Py_ssize_t __pyx_t_83;
  Py_ssize_t __pyx_t_84;
  Py_ssize_t __pyx_t_85;
  Py_ssize_t __pyx_t_86;
  Py_ssize_t __pyx_t_87;
  Py_ssize_t __pyx_t_88;
  Py_ssize_t __pyx_t_89;
  Py_ssize_t __pyx_t_90;
  Py_ssize_t __pyx_t_91;
  Py_ssize_t __pyx_t_92;
  Py_ssize_t __pyx_t_93;
  Py_ssize_t __pyx_t_94;
  Py_ssize_t __pyx_t_95;
  Py_ssize_t __pyx_t_96;
  Py_ssize_t __pyx_t_97;
  Py_ssize_t __pyx_t_98;
  Py_ssize_t __pyx_t_99;
  Py_ssize_t __pyx_t_100;
  Py_ssize_t __pyx_t_101;
  Py_ssize_t __pyx_t_102;
  Py_ssize_t __pyx_t_103;
  Py_ssize_t __pyx_t_104;
  Py_ssize_t __pyx_t_105;
  Py_ssize_t __pyx_t_106;
  Py_ssize_t __pyx_t_107;
  Py_ssize_t __pyx_t_108;
  Py_ssize_t __pyx_t_109;
  Py_ssize_t __pyx_t_110;
  Py_ssize_t __pyx_t_111;
  Py_ssize_t __pyx_t_112;
  Py_ssize_t __pyx_t_113;
  Py_ssize_t __pyx_t_114;
  Py_ssize_t __pyx_t_115;
  Py_ssize_t __pyx_t_116;
  Py_ssize_t __pyx_t_117;
  Py_ssize_t __pyx_t_118;
  Py_ssize_t __pyx_t_119;
  Py_ssize_t __pyx_t_120;
  Py_ssize_t __pyx_t_121;
  Py_ssize_t __pyx_t_122;
  Py_ssize_t __pyx_t_123;
  Py_ssize_t __pyx_t_124;
  Py_ssize_t __pyx_t_125;
  Py_ssize_t __pyx_t_126;
  Py_ssize_t __pyx_t_127;
  Py_ssize_t __pyx_t_128;
  Py_ssize_t __pyx_t_129;
  Py_ssize_t __pyx_t_130;
  int __pyx_t_131;
  __Pyx_RefNannySetupContext("Texture_URO_nxyz", 0);
  __pyx_pybuffer_r1.pybuffer.buf = NULL;
  __pyx_pybuffer_r1.refcount = 0;
  __pyx_pybuffernd_r1.data = NULL;
  __pyx_pybuffernd_r1.rcbuffer = &__pyx_pybuffer_r1;
  __pyx_pybuffer_lambdaa.pybuffer.buf = NULL;
  __pyx_pybuffer_lambdaa.refcount = 0;
  __pyx_pybuffernd_lambdaa.data = NULL;
  __pyx_pybuffernd_lambdaa.rcbuffer = &__pyx_pybuffer_lambdaa;
  __pyx_pybuffer_theta.pybuffer.buf = NULL;
  __pyx_pybuffer_theta.refcount = 0;
  __pyx_pybuffernd_theta.data = NULL;
  __pyx_pybuffernd_theta.rcbuffer = &__pyx_pybuffer_theta;
  __pyx_pybuffer_phi.pybuffer.buf = NULL;
  __pyx_pybuffer_phi.refcount = 0;
  __pyx_pybuffernd_phi.data = NULL;
  __pyx_pybuffernd_phi.rcbuffer = &__pyx_pybuffer_phi;
  __pyx_pybuffer_ncap.pybuffer.buf = NULL;
  __pyx_pybuffer_ncap.refcount = 0;
  __pyx_pybuffernd_ncap.data = NULL;
  __pyx_pybuffernd_ncap.rcbuffer = &__pyx_pybuffer_ncap;
  __pyx_pybuffer_V1.pybuffer.buf = NULL;
  __pyx_pybuffer_V1.refcount = 0;
  __pyx_pybuffernd_V1.data = NULL;
  __pyx_pybuffernd_V1.rcbuffer = &__pyx_pybuffer_V1;
  __pyx_pybuffer_V2.pybuffer.buf = NULL;
  __pyx_pybuffer_V2.refcount = 0;
  __pyx_pybuffernd_V2.data = NULL;
  __pyx_pybuffernd_V2.rcbuffer = &__pyx_pybuffer_V2;
  __pyx_pybuffer_Xp.pybuffer.buf = NULL;
  __pyx_pybuffer_Xp.refcount = 0;
  __pyx_pybuffernd_Xp.data = NULL;
  __pyx_pybuffernd_Xp.rcbuffer = &__pyx_pybuffer_Xp;
  __pyx_pybuffer_Yp.pybuffer.buf = NULL;
  __pyx_pybuffer_Yp.refcount = 0;
  __pyx_pybuffernd_Yp.data = NULL;
  __pyx_pybuffernd_Yp.rcbuffer = &__pyx_pybuffer_Yp;
  __pyx_pybuffer_Zp.pybuffer.buf = NULL;
  __pyx_pybuffer_Zp.refcount = 0;
  __pyx_pybuffernd_Zp.data = NULL;
  __pyx_pybuffernd_Zp.rcbuffer = &__pyx_pybuffer_Zp;
  __pyx_pybuffer_Xc.pybuffer.buf = NULL;
  __pyx_pybuffer_Xc.refcount = 0;
  __pyx_pybuffernd_Xc.data = NULL;
  __pyx_pybuffernd_Xc.rcbuffer = &__pyx_pybuffer_Xc;
  __pyx_pybuffer_Yc.pybuffer.buf = NULL;
  __pyx_pybuffer_Yc.refcount = 0;
  __pyx_pybuffernd_Yc.data = NULL;
  __pyx_pybuffernd_Yc.rcbuffer = &__pyx_pybuffer_Yc;
  __pyx_pybuffer_Zc.pybuffer.buf = NULL;
  __pyx_pybuffer_Zc.refcount = 0;
  __pyx_pybuffernd_Zc.data = NULL;
  __pyx_pybuffernd_Zc.rcbuffer = &__pyx_pybuffer_Zc;
  __pyx_pybuffer_Rot.pybuffer.buf = NULL;
  __pyx_pybuffer_Rot.refcount = 0;
  __pyx_pybuffernd_Rot.data = NULL;
  __pyx_pybuffernd_Rot.rcbuffer = &__pyx_pybuffer_Rot;
  __pyx_pybuffer_Eul.pybuffer.buf = NULL;
  __pyx_pybuffer_Eul.refcount = 0;
  __pyx_pybuffernd_Eul.data = NULL;
  __pyx_pybuffernd_Eul.rcbuffer = &__pyx_pybuffer_Eul;
  __pyx_pybuffer_Axis.pybuffer.buf = NULL;
  __pyx_pybuffer_Axis.refcount = 0;
  __pyx_pybuffernd_Axis.data = NULL;
  __pyx_pybuffernd_Axis.rcbuffer = &__pyx_pybuffer_Axis;
  __pyx_pybuffer_Angle.pybuffer.buf = NULL;
  __pyx_pybuffer_Angle.refcount = 0;
  __pyx_pybuffernd_Angle.data = NULL;
  __pyx_pybuffernd_Angle.rcbuffer = &__pyx_pybuffer_Angle;
  __pyx_pybuffer_Nd.pybuffer.buf = NULL;
  __pyx_pybuffer_Nd.refcount = 0;
  __pyx_pybuffernd_Nd.data = NULL;
  __pyx_pybuffernd_Nd.rcbuffer = &__pyx_pybuffer_Nd;
  __pyx_pybuffer_Rd.pybuffer.buf = NULL;
  __pyx_pybuffer_Rd.refcount = 0;
  __pyx_pybuffernd_Rd.data = NULL;
  __pyx_pybuffernd_Rd.rcbuffer = &__pyx_pybuffer_Rd;
  __pyx_pybuffer_Rv.pybuffer.buf = NULL;
  __pyx_pybuffer_Rv.refcount = 0;
  __pyx_pybuffernd_Rv.data = NULL;
  __pyx_pybuffernd_Rv.rcbuffer = &__pyx_pybuffer_Rv;
  __pyx_pybuffer_Q.pybuffer.buf = NULL;
  __pyx_pybuffer_Q.refcount = 0;
  __pyx_pybuffernd_Q.data = NULL;
  __pyx_pybuffernd_Q.rcbuffer = &__pyx_pybuffer_Q;

  /* "libTEXTURIZE.pyx":140
 * 
 * def Texture_URO_nxyz(obj):
 *     cdef int myseed = obj.myseed             # <<<<<<<<<<<<<<
 *     cdef int p = obj.p
 *     cdef int m = obj.m
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_myseed); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 140, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 140, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_myseed = __pyx_t_2;

  /* "libTEXTURIZE.pyx":141
 * def Texture_URO_nxyz(obj):
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p             # <<<<<<<<<<<<<<
 *     cdef int m = obj.m
 *     cdef int n = obj.n
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 141, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 141, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_p = __pyx_t_2;

  /* "libTEXTURIZE.pyx":142
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 *     cdef int m = obj.m             # <<<<<<<<<<<<<<
 *     cdef int n = obj.n
 *     cdef int makecanvas = obj.makecanvas
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_m); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 142, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 142, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_m = __pyx_t_2;

  /* "libTEXTURIZE.pyx":143
 *     cdef int p = obj.p
 *     cdef int m = obj.m
 *     cdef int n = obj.n             # <<<<<<<<<<<<<<
 *     cdef int makecanvas = obj.makecanvas
 *     cdef double tic, toc
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 143, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 143, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_n = __pyx_t_2;

  /* "libTEXTURIZE.pyx":144
 *     cdef int m = obj.m
 *     cdef int n = obj.n
 *     cdef int makecanvas = obj.makecanvas             # <<<<<<<<<<<<<<
 *     cdef double tic, toc
 * 
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_makecanvas); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 144, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 144, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_makecanvas = __pyx_t_2;

  /* "libTEXTURIZE.pyx":150
 *     cdef float th, ph, lm , sth, sph, cth, cph, clm, slm, coss, sinn, cossncap0, cossncap1, cossncap2
 * 
 *     cdef np.ndarray[np.float64_t, ndim = 1] r1 = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] lambdaa = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] theta = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 150, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 150, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 150, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 150, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 150, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 150, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 150, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 150, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 150, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 150, __pyx_L1_error)
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_r1.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_r1 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_r1.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 150, __pyx_L1_error)
    } else {__pyx_pybuffernd_r1.diminfo[0].strides = __pyx_pybuffernd_r1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_r1.diminfo[0].shape = __pyx_pybuffernd_r1.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_r1 = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":151
 * 
 *     cdef np.ndarray[np.float64_t, ndim = 1] r1 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] lambdaa = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] theta = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] phi = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 151, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 151, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 151, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 151, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 151, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 151, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 151, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 151, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 151, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 151, __pyx_L1_error)
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_lambdaa.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_lambdaa = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_lambdaa.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 151, __pyx_L1_error)
    } else {__pyx_pybuffernd_lambdaa.diminfo[0].strides = __pyx_pybuffernd_lambdaa.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_lambdaa.diminfo[0].shape = __pyx_pybuffernd_lambdaa.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_8 = 0;
  __pyx_v_lambdaa = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":152
 *     cdef np.ndarray[np.float64_t, ndim = 1] r1 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] lambdaa = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] theta = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] phi = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] ncap = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 152, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 152, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 152, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 152, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 152, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 152, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 152, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 152, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 152, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 152, __pyx_L1_error)
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_theta.rcbuffer->pybuffer, (PyObject*)__pyx_t_9, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_theta = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_theta.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 152, __pyx_L1_error)
    } else {__pyx_pybuffernd_theta.diminfo[0].strides = __pyx_pybuffernd_theta.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_theta.diminfo[0].shape = __pyx_pybuffernd_theta.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_9 = 0;
  __pyx_v_theta = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":153
 *     cdef np.ndarray[np.float64_t, ndim = 1] lambdaa = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] theta = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] phi = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] ncap = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 153, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 153, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 153, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 153, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 153, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 153, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 153, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 153, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 153, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 153, __pyx_L1_error)
  __pyx_t_10 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phi.rcbuffer->pybuffer, (PyObject*)__pyx_t_10, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_phi = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_phi.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 153, __pyx_L1_error)
    } else {__pyx_pybuffernd_phi.diminfo[0].strides = __pyx_pybuffernd_phi.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_phi.diminfo[0].shape = __pyx_pybuffernd_phi.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_10 = 0;
  __pyx_v_phi = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":154
 *     cdef np.ndarray[np.float64_t, ndim = 1] theta = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] phi = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] ncap = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 154, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 154, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 154, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 154, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 154, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 154, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__6, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 154, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 154, __pyx_L1_error)
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_ncap.rcbuffer->pybuffer, (PyObject*)__pyx_t_11, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_ncap = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_ncap.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 154, __pyx_L1_error)
    } else {__pyx_pybuffernd_ncap.diminfo[0].strides = __pyx_pybuffernd_ncap.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_ncap.diminfo[0].shape = __pyx_pybuffernd_ncap.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_11 = 0;
  __pyx_v_ncap = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":155
 *     cdef np.ndarray[np.float64_t, ndim = 1] phi = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] ncap = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xp = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 155, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 155, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 155, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 155, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 155, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 155, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__7, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 155, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 155, __pyx_L1_error)
  __pyx_t_12 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_V1.rcbuffer->pybuffer, (PyObject*)__pyx_t_12, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_V1 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_V1.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 155, __pyx_L1_error)
    } else {__pyx_pybuffernd_V1.diminfo[0].strides = __pyx_pybuffernd_V1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_V1.diminfo[0].shape = __pyx_pybuffernd_V1.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_12 = 0;
  __pyx_v_V1 = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":156
 *     cdef np.ndarray[np.float64_t, ndim = 1] ncap = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xp = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yp = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 156, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 156, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 156, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 156, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 156, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 156, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__8, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 156, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 156, __pyx_L1_error)
  __pyx_t_13 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_V2.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_V2 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_V2.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 156, __pyx_L1_error)
    } else {__pyx_pybuffernd_V2.diminfo[0].strides = __pyx_pybuffernd_V2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_V2.diminfo[0].shape = __pyx_pybuffernd_V2.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_13 = 0;
  __pyx_v_V2 = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":157
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xp = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yp = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zp = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 157, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 157, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 157, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 157, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 157, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 157, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__9, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 157, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 157, __pyx_L1_error)
  __pyx_t_14 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Xp.rcbuffer->pybuffer, (PyObject*)__pyx_t_14, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Xp = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Xp.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 157, __pyx_L1_error)
    } else {__pyx_pybuffernd_Xp.diminfo[0].strides = __pyx_pybuffernd_Xp.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Xp.diminfo[0].shape = __pyx_pybuffernd_Xp.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_14 = 0;
  __pyx_v_Xp = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":158
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xp = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yp = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zp = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 158, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 158, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 158, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 158, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 158, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 158, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__10, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 158, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 158, __pyx_L1_error)
  __pyx_t_15 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Yp.rcbuffer->pybuffer, (PyObject*)__pyx_t_15, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Yp = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Yp.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 158, __pyx_L1_error)
    } else {__pyx_pybuffernd_Yp.diminfo[0].strides = __pyx_pybuffernd_Yp.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Yp.diminfo[0].shape = __pyx_pybuffernd_Yp.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_15 = 0;
  __pyx_v_Yp = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":159
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xp = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yp = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zp = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 159, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 159, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 159, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 159, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 159, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 159, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__11, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 159, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 159, __pyx_L1_error)
  __pyx_t_16 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Zp.rcbuffer->pybuffer, (PyObject*)__pyx_t_16, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Zp = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Zp.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 159, __pyx_L1_error)
    } else {__pyx_pybuffernd_Zp.diminfo[0].strides = __pyx_pybuffernd_Zp.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Zp.diminfo[0].shape = __pyx_pybuffernd_Zp.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_16 = 0;
  __pyx_v_Zp = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":160
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yp = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zp = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zc = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 160, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 160, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 160, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 160, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 160, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 160, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 160, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 160, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 160, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 160, __pyx_L1_error)
  __pyx_t_17 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Xc.rcbuffer->pybuffer, (PyObject*)__pyx_t_17, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Xc = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 160, __pyx_L1_error)
    } else {__pyx_pybuffernd_Xc.diminfo[0].strides = __pyx_pybuffernd_Xc.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Xc.diminfo[0].shape = __pyx_pybuffernd_Xc.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_17 = 0;
  __pyx_v_Xc = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":161
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zp = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zc = np.zeros(p, dtype=np.float64)
 * 
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 161, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 161, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 161, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 161, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 161, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 161, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 161, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 161, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 161, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 161, __pyx_L1_error)
  __pyx_t_18 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Yc.rcbuffer->pybuffer, (PyObject*)__pyx_t_18, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Yc = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 161, __pyx_L1_error)
    } else {__pyx_pybuffernd_Yc.diminfo[0].strides = __pyx_pybuffernd_Yc.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Yc.diminfo[0].shape = __pyx_pybuffernd_Yc.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_18 = 0;
  __pyx_v_Yc = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":162
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zc = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 * 
 *     # DESCRIPTORS OF ORIENTATIONS
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 162, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 162, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 162, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 162, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 162, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 162, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 162, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 162, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 162, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 162, __pyx_L1_error)
  __pyx_t_19 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Zc.rcbuffer->pybuffer, (PyObject*)__pyx_t_19, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Zc = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Zc.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 162, __pyx_L1_error)
    } else {__pyx_pybuffernd_Zc.diminfo[0].strides = __pyx_pybuffernd_Zc.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Zc.diminfo[0].shape = __pyx_pybuffernd_Zc.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_19 = 0;
  __pyx_v_Zc = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":165
 * 
 *     # DESCRIPTORS OF ORIENTATIONS
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 165, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 165, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 165, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = PyTuple_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 165, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_3);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_1, 2, __pyx_int_3);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 165, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 165, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 165, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 165, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 165, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 165, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 165, __pyx_L1_error)
  __pyx_t_20 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer, (PyObject*)__pyx_t_20, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 3, 0, __pyx_stack) == -1)) {
      __pyx_v_Rot = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 165, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rot.diminfo[0].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rot.diminfo[0].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rot.diminfo[1].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rot.diminfo[1].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_Rot.diminfo[2].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_Rot.diminfo[2].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[2];
    }
  }
  __pyx_t_20 = 0;
  __pyx_v_Rot = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":166
 *     # DESCRIPTORS OF ORIENTATIONS
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 166, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 166, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 166, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 166, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_int_3);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 166, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 166, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 166, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 166, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 166, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 166, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 166, __pyx_L1_error)
  __pyx_t_21 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_t_21, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Eul = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Eul.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 166, __pyx_L1_error)
    } else {__pyx_pybuffernd_Eul.diminfo[0].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Eul.diminfo[0].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Eul.diminfo[1].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Eul.diminfo[1].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_21 = 0;
  __pyx_v_Eul = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":167
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 167, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 167, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 167, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 167, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_3);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 167, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 167, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 167, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 167, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 167, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 167, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 167, __pyx_L1_error)
  __pyx_t_22 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer, (PyObject*)__pyx_t_22, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Axis = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Axis.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 167, __pyx_L1_error)
    } else {__pyx_pybuffernd_Axis.diminfo[0].strides = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Axis.diminfo[0].shape = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Axis.diminfo[1].strides = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Axis.diminfo[1].shape = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_22 = 0;
  __pyx_v_Axis = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":168
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 168, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 168, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 168, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 168, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 168, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 168, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 168, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 168, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 168, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 168, __pyx_L1_error)
  __pyx_t_23 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer, (PyObject*)__pyx_t_23, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Angle = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Angle.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 168, __pyx_L1_error)
    } else {__pyx_pybuffernd_Angle.diminfo[0].strides = __pyx_pybuffernd_Angle.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Angle.diminfo[0].shape = __pyx_pybuffernd_Angle.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_23 = 0;
  __pyx_v_Angle = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":169
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 169, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 169, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 169, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 169, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_int_3);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 169, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 169, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 169, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 169, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 169, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 169, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 169, __pyx_L1_error)
  __pyx_t_24 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer, (PyObject*)__pyx_t_24, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Nd = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Nd.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 169, __pyx_L1_error)
    } else {__pyx_pybuffernd_Nd.diminfo[0].strides = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Nd.diminfo[0].shape = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Nd.diminfo[1].strides = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Nd.diminfo[1].shape = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_24 = 0;
  __pyx_v_Nd = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":170
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 170, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 170, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 170, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 170, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_3);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 170, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 170, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 170, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 170, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 170, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 170, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 170, __pyx_L1_error)
  __pyx_t_25 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer, (PyObject*)__pyx_t_25, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Rd = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rd.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 170, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rd.diminfo[0].strides = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rd.diminfo[0].shape = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rd.diminfo[1].strides = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rd.diminfo[1].shape = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_25 = 0;
  __pyx_v_Rd = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":171
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)
 * 
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 171, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 171, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 171, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 171, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_int_3);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 171, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 171, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 171, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 171, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 171, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 171, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 171, __pyx_L1_error)
  __pyx_t_26 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer, (PyObject*)__pyx_t_26, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Rv = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rv.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 171, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rv.diminfo[0].strides = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rv.diminfo[0].shape = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rv.diminfo[1].strides = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rv.diminfo[1].shape = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_26 = 0;
  __pyx_v_Rv = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":172
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 172, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 172, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 172, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 172, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __Pyx_INCREF(__pyx_int_4);
  __Pyx_GIVEREF(__pyx_int_4);
  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_4);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 172, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 172, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 172, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 172, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 172, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 172, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 172, __pyx_L1_error)
  __pyx_t_27 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Q.rcbuffer->pybuffer, (PyObject*)__pyx_t_27, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Q = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Q.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 172, __pyx_L1_error)
    } else {__pyx_pybuffernd_Q.diminfo[0].strides = __pyx_pybuffernd_Q.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Q.diminfo[0].shape = __pyx_pybuffernd_Q.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Q.diminfo[1].strides = __pyx_pybuffernd_Q.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Q.diminfo[1].shape = __pyx_pybuffernd_Q.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_27 = 0;
  __pyx_v_Q = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":175
 * 
 * 
 *     plantseed(myseed)             # <<<<<<<<<<<<<<
 *     tic = time.time()
 * 
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_plantseed); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 175, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_myseed); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 175, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 175, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_GOTREF(__pyx_t_6);
  } else {
    __pyx_t_1 = PyTuple_New(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 175, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5); __pyx_t_5 = NULL;
    __Pyx_GIVEREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_1, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 175, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":176
 * 
 *     plantseed(myseed)
 *     tic = time.time()             # <<<<<<<<<<<<<<
 * 
 *     r1 = np.random.uniform(0, 1, [p, ])
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_time); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 176, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_time); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 176, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  if (__pyx_t_4) {
    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 176, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    __pyx_t_6 = __Pyx_PyObject_CallNoArg(__pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 176, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_28 = __pyx_PyFloat_AsDouble(__pyx_t_6); if (unlikely((__pyx_t_28 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 176, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_tic = __pyx_t_28;

  /* "libTEXTURIZE.pyx":178
 *     tic = time.time()
 * 
 *     r1 = np.random.uniform(0, 1, [p, ])             # <<<<<<<<<<<<<<
 *     theta = np.arccos(2 * r1 - 1)
 *     phi = np.random.uniform(0, 2 * pi, [p, ])
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 178, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_random); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 178, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_uniform); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 178, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 178, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 178, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_4);
  PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_29 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
      __pyx_t_29 = 1;
    }
  }
  __pyx_t_5 = PyTuple_New(3+__pyx_t_29); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 178, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__pyx_t_4) {
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
  }
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_29, __pyx_int_0);
  __Pyx_INCREF(__pyx_int_1);
  __Pyx_GIVEREF(__pyx_int_1);
  PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_29, __pyx_int_1);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_5, 2+__pyx_t_29, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_5, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 178, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 178, __pyx_L1_error)
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_r1.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_r1.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_30, &__pyx_t_31, &__pyx_t_32);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_r1.rcbuffer->pybuffer, (PyObject*)__pyx_v_r1, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_30); Py_XDECREF(__pyx_t_31); Py_XDECREF(__pyx_t_32);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_30, __pyx_t_31, __pyx_t_32);
      }
    }
    __pyx_pybuffernd_r1.diminfo[0].strides = __pyx_pybuffernd_r1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_r1.diminfo[0].shape = __pyx_pybuffernd_r1.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 178, __pyx_L1_error)
  }
  __pyx_t_7 = 0;
  __Pyx_DECREF_SET(__pyx_v_r1, ((PyArrayObject *)__pyx_t_6));
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":179
 * 
 *     r1 = np.random.uniform(0, 1, [p, ])
 *     theta = np.arccos(2 * r1 - 1)             # <<<<<<<<<<<<<<
 *     phi = np.random.uniform(0, 2 * pi, [p, ])
 *     lambdaa = np.random.uniform(0, 2 * pi, [p, ])
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 179, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_arccos); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 179, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyNumber_Multiply(__pyx_int_2, ((PyObject *)__pyx_v_r1)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 179, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_t_1, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 179, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 179, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_GOTREF(__pyx_t_6);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 179, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1); __pyx_t_1 = NULL;
    __Pyx_GIVEREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 179, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 179, __pyx_L1_error)
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_theta.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_theta.rcbuffer->pybuffer, (PyObject*)__pyx_t_9, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_32, &__pyx_t_31, &__pyx_t_30);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_theta.rcbuffer->pybuffer, (PyObject*)__pyx_v_theta, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_32); Py_XDECREF(__pyx_t_31); Py_XDECREF(__pyx_t_30);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_32, __pyx_t_31, __pyx_t_30);
      }
    }
    __pyx_pybuffernd_theta.diminfo[0].strides = __pyx_pybuffernd_theta.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_theta.diminfo[0].shape = __pyx_pybuffernd_theta.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 179, __pyx_L1_error)
  }
  __pyx_t_9 = 0;
  __Pyx_DECREF_SET(__pyx_v_theta, ((PyArrayObject *)__pyx_t_6));
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":180
 *     r1 = np.random.uniform(0, 1, [p, ])
 *     theta = np.arccos(2 * r1 - 1)
 *     phi = np.random.uniform(0, 2 * pi, [p, ])             # <<<<<<<<<<<<<<
 *     lambdaa = np.random.uniform(0, 2 * pi, [p, ])
 *     coss = 1 / sqrt(3.0)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 180, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_random); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 180, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_uniform); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 180, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = PyFloat_FromDouble((2.0 * __pyx_v_12libTEXTURIZE_pi)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 180, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 180, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 180, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_3);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_29 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
      __pyx_t_29 = 1;
    }
  }
  __pyx_t_33 = PyTuple_New(3+__pyx_t_29); if (unlikely(!__pyx_t_33)) __PYX_ERR(0, 180, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_33);
  if (__pyx_t_3) {
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_33, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_33, 0+__pyx_t_29, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_33, 1+__pyx_t_29, __pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_33, 2+__pyx_t_29, __pyx_t_1);
  __pyx_t_4 = 0;
  __pyx_t_1 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_33, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 180, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_33); __pyx_t_33 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 180, __pyx_L1_error)
  __pyx_t_10 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_phi.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phi.rcbuffer->pybuffer, (PyObject*)__pyx_t_10, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_30, &__pyx_t_31, &__pyx_t_32);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phi.rcbuffer->pybuffer, (PyObject*)__pyx_v_phi, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_30); Py_XDECREF(__pyx_t_31); Py_XDECREF(__pyx_t_32);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_30, __pyx_t_31, __pyx_t_32);
      }
    }
    __pyx_pybuffernd_phi.diminfo[0].strides = __pyx_pybuffernd_phi.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_phi.diminfo[0].shape = __pyx_pybuffernd_phi.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 180, __pyx_L1_error)
  }
  __pyx_t_10 = 0;
  __Pyx_DECREF_SET(__pyx_v_phi, ((PyArrayObject *)__pyx_t_6));
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":181
 *     theta = np.arccos(2 * r1 - 1)
 *     phi = np.random.uniform(0, 2 * pi, [p, ])
 *     lambdaa = np.random.uniform(0, 2 * pi, [p, ])             # <<<<<<<<<<<<<<
 *     coss = 1 / sqrt(3.0)
 *     sinn = sqrt(2.0 / 3.0)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 181, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_33 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_random); if (unlikely(!__pyx_t_33)) __PYX_ERR(0, 181, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_33);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_33, __pyx_n_s_uniform); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 181, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_33); __pyx_t_33 = 0;
  __pyx_t_33 = PyFloat_FromDouble((2.0 * __pyx_v_12libTEXTURIZE_pi)); if (unlikely(!__pyx_t_33)) __PYX_ERR(0, 181, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_33);
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 181, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 181, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  __pyx_t_29 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
      __pyx_t_29 = 1;
    }
  }
  __pyx_t_3 = PyTuple_New(3+__pyx_t_29); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 181, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  if (__pyx_t_1) {
    __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1); __pyx_t_1 = NULL;
  }
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_29, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_t_33);
  PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_29, __pyx_t_33);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_3, 2+__pyx_t_29, __pyx_t_4);
  __pyx_t_33 = 0;
  __pyx_t_4 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 181, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 181, __pyx_L1_error)
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_lambdaa.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_lambdaa.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_32, &__pyx_t_31, &__pyx_t_30);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_lambdaa.rcbuffer->pybuffer, (PyObject*)__pyx_v_lambdaa, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_32); Py_XDECREF(__pyx_t_31); Py_XDECREF(__pyx_t_30);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_32, __pyx_t_31, __pyx_t_30);
      }
    }
    __pyx_pybuffernd_lambdaa.diminfo[0].strides = __pyx_pybuffernd_lambdaa.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_lambdaa.diminfo[0].shape = __pyx_pybuffernd_lambdaa.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 181, __pyx_L1_error)
  }
  __pyx_t_8 = 0;
  __Pyx_DECREF_SET(__pyx_v_lambdaa, ((PyArrayObject *)__pyx_t_6));
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":182
 *     phi = np.random.uniform(0, 2 * pi, [p, ])
 *     lambdaa = np.random.uniform(0, 2 * pi, [p, ])
 *     coss = 1 / sqrt(3.0)             # <<<<<<<<<<<<<<
 *     sinn = sqrt(2.0 / 3.0)
 * 
 */
  __pyx_v_coss = (1.0 / sqrt(3.0));

  /* "libTEXTURIZE.pyx":183
 *     lambdaa = np.random.uniform(0, 2 * pi, [p, ])
 *     coss = 1 / sqrt(3.0)
 *     sinn = sqrt(2.0 / 3.0)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_v_sinn = sqrt((2.0 / 3.0));

  /* "libTEXTURIZE.pyx":186
 * 
 * 
 *     for i in range(p):             # <<<<<<<<<<<<<<
 *         th = theta[i]
 *         ph = phi[i]
 */
  __pyx_t_2 = __pyx_v_p;
  for (__pyx_t_34 = 0; __pyx_t_34 < __pyx_t_2; __pyx_t_34+=1) {
    __pyx_v_i = __pyx_t_34;

    /* "libTEXTURIZE.pyx":187
 * 
 *     for i in range(p):
 *         th = theta[i]             # <<<<<<<<<<<<<<
 *         ph = phi[i]
 *         cth = cos(th)
 */
    __pyx_t_35 = __pyx_v_i;
    __pyx_v_th = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_theta.rcbuffer->pybuffer.buf, __pyx_t_35, __pyx_pybuffernd_theta.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":188
 *     for i in range(p):
 *         th = theta[i]
 *         ph = phi[i]             # <<<<<<<<<<<<<<
 *         cth = cos(th)
 *         cph = cos(ph)
 */
    __pyx_t_36 = __pyx_v_i;
    __pyx_v_ph = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_phi.rcbuffer->pybuffer.buf, __pyx_t_36, __pyx_pybuffernd_phi.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":189
 *         th = theta[i]
 *         ph = phi[i]
 *         cth = cos(th)             # <<<<<<<<<<<<<<
 *         cph = cos(ph)
 *         sth = sin(th)
 */
    __pyx_v_cth = cos(__pyx_v_th);

    /* "libTEXTURIZE.pyx":190
 *         ph = phi[i]
 *         cth = cos(th)
 *         cph = cos(ph)             # <<<<<<<<<<<<<<
 *         sth = sin(th)
 *         sph = sin(ph)
 */
    __pyx_v_cph = cos(__pyx_v_ph);

    /* "libTEXTURIZE.pyx":191
 *         cth = cos(th)
 *         cph = cos(ph)
 *         sth = sin(th)             # <<<<<<<<<<<<<<
 *         sph = sin(ph)
 * 
 */
    __pyx_v_sth = sin(__pyx_v_th);

    /* "libTEXTURIZE.pyx":192
 *         cph = cos(ph)
 *         sth = sin(th)
 *         sph = sin(ph)             # <<<<<<<<<<<<<<
 * 
 *         # CRYSTALLOGRAPHIC ncap AXIS
 */
    __pyx_v_sph = sin(__pyx_v_ph);

    /* "libTEXTURIZE.pyx":195
 * 
 *         # CRYSTALLOGRAPHIC ncap AXIS
 *         ncap[0] = sth * cph             # <<<<<<<<<<<<<<
 *         ncap[1] = sth * sph
 *         ncap[2] = cth
 */
    __pyx_t_37 = 0;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_ncap.rcbuffer->pybuffer.buf, __pyx_t_37, __pyx_pybuffernd_ncap.diminfo[0].strides) = (__pyx_v_sth * __pyx_v_cph);

    /* "libTEXTURIZE.pyx":196
 *         # CRYSTALLOGRAPHIC ncap AXIS
 *         ncap[0] = sth * cph
 *         ncap[1] = sth * sph             # <<<<<<<<<<<<<<
 *         ncap[2] = cth
 * 
 */
    __pyx_t_38 = 1;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_ncap.rcbuffer->pybuffer.buf, __pyx_t_38, __pyx_pybuffernd_ncap.diminfo[0].strides) = (__pyx_v_sth * __pyx_v_sph);

    /* "libTEXTURIZE.pyx":197
 *         ncap[0] = sth * cph
 *         ncap[1] = sth * sph
 *         ncap[2] = cth             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __pyx_t_39 = 2;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_ncap.rcbuffer->pybuffer.buf, __pyx_t_39, __pyx_pybuffernd_ncap.diminfo[0].strides) = __pyx_v_cth;

    /* "libTEXTURIZE.pyx":201
 * 
 *         # ORTHOGONAL AUXILARY VECTORS PERPENDICULAR TO ncap AXIS
 *         V1[0] = sph             # <<<<<<<<<<<<<<
 *         V1[1] = -cph
 *         V1[2] = 0
 */
    __pyx_t_40 = 0;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V1.rcbuffer->pybuffer.buf, __pyx_t_40, __pyx_pybuffernd_V1.diminfo[0].strides) = __pyx_v_sph;

    /* "libTEXTURIZE.pyx":202
 *         # ORTHOGONAL AUXILARY VECTORS PERPENDICULAR TO ncap AXIS
 *         V1[0] = sph
 *         V1[1] = -cph             # <<<<<<<<<<<<<<
 *         V1[2] = 0
 *         V2[0] = cph * cth
 */
    __pyx_t_41 = 1;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V1.rcbuffer->pybuffer.buf, __pyx_t_41, __pyx_pybuffernd_V1.diminfo[0].strides) = (-__pyx_v_cph);

    /* "libTEXTURIZE.pyx":203
 *         V1[0] = sph
 *         V1[1] = -cph
 *         V1[2] = 0             # <<<<<<<<<<<<<<
 *         V2[0] = cph * cth
 *         V2[1] = sph * cth
 */
    __pyx_t_42 = 2;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V1.rcbuffer->pybuffer.buf, __pyx_t_42, __pyx_pybuffernd_V1.diminfo[0].strides) = 0.0;

    /* "libTEXTURIZE.pyx":204
 *         V1[1] = -cph
 *         V1[2] = 0
 *         V2[0] = cph * cth             # <<<<<<<<<<<<<<
 *         V2[1] = sph * cth
 *         V2[2] = -sth
 */
    __pyx_t_43 = 0;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V2.rcbuffer->pybuffer.buf, __pyx_t_43, __pyx_pybuffernd_V2.diminfo[0].strides) = (__pyx_v_cph * __pyx_v_cth);

    /* "libTEXTURIZE.pyx":205
 *         V1[2] = 0
 *         V2[0] = cph * cth
 *         V2[1] = sph * cth             # <<<<<<<<<<<<<<
 *         V2[2] = -sth
 * 
 */
    __pyx_t_44 = 1;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V2.rcbuffer->pybuffer.buf, __pyx_t_44, __pyx_pybuffernd_V2.diminfo[0].strides) = (__pyx_v_sph * __pyx_v_cth);

    /* "libTEXTURIZE.pyx":206
 *         V2[0] = cph * cth
 *         V2[1] = sph * cth
 *         V2[2] = -sth             # <<<<<<<<<<<<<<
 * 
 *         # PROJECTION OF X AXIS PERPENDICULAR TO ncap
 */
    __pyx_t_45 = 2;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V2.rcbuffer->pybuffer.buf, __pyx_t_45, __pyx_pybuffernd_V2.diminfo[0].strides) = (-__pyx_v_sth);

    /* "libTEXTURIZE.pyx":209
 * 
 *         # PROJECTION OF X AXIS PERPENDICULAR TO ncap
 *         lm = lambdaa[i]             # <<<<<<<<<<<<<<
 *         clm = cos(lm)
 *         slm = sin(lm)
 */
    __pyx_t_46 = __pyx_v_i;
    __pyx_v_lm = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_lambdaa.rcbuffer->pybuffer.buf, __pyx_t_46, __pyx_pybuffernd_lambdaa.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":210
 *         # PROJECTION OF X AXIS PERPENDICULAR TO ncap
 *         lm = lambdaa[i]
 *         clm = cos(lm)             # <<<<<<<<<<<<<<
 *         slm = sin(lm)
 *         Xp[0] = clm * V1[0] + slm * V2[0]
 */
    __pyx_v_clm = cos(__pyx_v_lm);

    /* "libTEXTURIZE.pyx":211
 *         lm = lambdaa[i]
 *         clm = cos(lm)
 *         slm = sin(lm)             # <<<<<<<<<<<<<<
 *         Xp[0] = clm * V1[0] + slm * V2[0]
 *         Xp[1] = clm * V1[1] + slm * V2[1]
 */
    __pyx_v_slm = sin(__pyx_v_lm);

    /* "libTEXTURIZE.pyx":212
 *         clm = cos(lm)
 *         slm = sin(lm)
 *         Xp[0] = clm * V1[0] + slm * V2[0]             # <<<<<<<<<<<<<<
 *         Xp[1] = clm * V1[1] + slm * V2[1]
 *         Xp[2] = clm * V1[2] + slm * V2[2]
 */
    __pyx_t_47 = 0;
    __pyx_t_48 = 0;
    __pyx_t_49 = 0;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xp.rcbuffer->pybuffer.buf, __pyx_t_49, __pyx_pybuffernd_Xp.diminfo[0].strides) = ((__pyx_v_clm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V1.rcbuffer->pybuffer.buf, __pyx_t_47, __pyx_pybuffernd_V1.diminfo[0].strides))) + (__pyx_v_slm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V2.rcbuffer->pybuffer.buf, __pyx_t_48, __pyx_pybuffernd_V2.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":213
 *         slm = sin(lm)
 *         Xp[0] = clm * V1[0] + slm * V2[0]
 *         Xp[1] = clm * V1[1] + slm * V2[1]             # <<<<<<<<<<<<<<
 *         Xp[2] = clm * V1[2] + slm * V2[2]
 * 
 */
    __pyx_t_50 = 1;
    __pyx_t_51 = 1;
    __pyx_t_52 = 1;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xp.rcbuffer->pybuffer.buf, __pyx_t_52, __pyx_pybuffernd_Xp.diminfo[0].strides) = ((__pyx_v_clm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V1.rcbuffer->pybuffer.buf, __pyx_t_50, __pyx_pybuffernd_V1.diminfo[0].strides))) + (__pyx_v_slm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V2.rcbuffer->pybuffer.buf, __pyx_t_51, __pyx_pybuffernd_V2.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":214
 *         Xp[0] = clm * V1[0] + slm * V2[0]
 *         Xp[1] = clm * V1[1] + slm * V2[1]
 *         Xp[2] = clm * V1[2] + slm * V2[2]             # <<<<<<<<<<<<<<
 * 
 *         # PROJECTION OF Y AXIS PERPENDICULAR TO ncap
 */
    __pyx_t_53 = 2;
    __pyx_t_54 = 2;
    __pyx_t_55 = 2;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xp.rcbuffer->pybuffer.buf, __pyx_t_55, __pyx_pybuffernd_Xp.diminfo[0].strides) = ((__pyx_v_clm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V1.rcbuffer->pybuffer.buf, __pyx_t_53, __pyx_pybuffernd_V1.diminfo[0].strides))) + (__pyx_v_slm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V2.rcbuffer->pybuffer.buf, __pyx_t_54, __pyx_pybuffernd_V2.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":217
 * 
 *         # PROJECTION OF Y AXIS PERPENDICULAR TO ncap
 *         lm = lm + tpibth             # <<<<<<<<<<<<<<
 *         clm = cos(lm)
 *         slm = sin(lm)
 */
    __pyx_v_lm = (__pyx_v_lm + __pyx_v_12libTEXTURIZE_tpibth);

    /* "libTEXTURIZE.pyx":218
 *         # PROJECTION OF Y AXIS PERPENDICULAR TO ncap
 *         lm = lm + tpibth
 *         clm = cos(lm)             # <<<<<<<<<<<<<<
 *         slm = sin(lm)
 *         Yp[0] = clm * V1[0] + slm * V2[0]
 */
    __pyx_v_clm = cos(__pyx_v_lm);

    /* "libTEXTURIZE.pyx":219
 *         lm = lm + tpibth
 *         clm = cos(lm)
 *         slm = sin(lm)             # <<<<<<<<<<<<<<
 *         Yp[0] = clm * V1[0] + slm * V2[0]
 *         Yp[1] = clm * V1[1] + slm * V2[1]
 */
    __pyx_v_slm = sin(__pyx_v_lm);

    /* "libTEXTURIZE.pyx":220
 *         clm = cos(lm)
 *         slm = sin(lm)
 *         Yp[0] = clm * V1[0] + slm * V2[0]             # <<<<<<<<<<<<<<
 *         Yp[1] = clm * V1[1] + slm * V2[1]
 *         Yp[2] = clm * V1[2] + slm * V2[2]
 */
    __pyx_t_56 = 0;
    __pyx_t_57 = 0;
    __pyx_t_58 = 0;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yp.rcbuffer->pybuffer.buf, __pyx_t_58, __pyx_pybuffernd_Yp.diminfo[0].strides) = ((__pyx_v_clm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V1.rcbuffer->pybuffer.buf, __pyx_t_56, __pyx_pybuffernd_V1.diminfo[0].strides))) + (__pyx_v_slm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V2.rcbuffer->pybuffer.buf, __pyx_t_57, __pyx_pybuffernd_V2.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":221
 *         slm = sin(lm)
 *         Yp[0] = clm * V1[0] + slm * V2[0]
 *         Yp[1] = clm * V1[1] + slm * V2[1]             # <<<<<<<<<<<<<<
 *         Yp[2] = clm * V1[2] + slm * V2[2]
 * 
 */
    __pyx_t_59 = 1;
    __pyx_t_60 = 1;
    __pyx_t_61 = 1;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yp.rcbuffer->pybuffer.buf, __pyx_t_61, __pyx_pybuffernd_Yp.diminfo[0].strides) = ((__pyx_v_clm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V1.rcbuffer->pybuffer.buf, __pyx_t_59, __pyx_pybuffernd_V1.diminfo[0].strides))) + (__pyx_v_slm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V2.rcbuffer->pybuffer.buf, __pyx_t_60, __pyx_pybuffernd_V2.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":222
 *         Yp[0] = clm * V1[0] + slm * V2[0]
 *         Yp[1] = clm * V1[1] + slm * V2[1]
 *         Yp[2] = clm * V1[2] + slm * V2[2]             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __pyx_t_62 = 2;
    __pyx_t_63 = 2;
    __pyx_t_64 = 2;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yp.rcbuffer->pybuffer.buf, __pyx_t_64, __pyx_pybuffernd_Yp.diminfo[0].strides) = ((__pyx_v_clm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V1.rcbuffer->pybuffer.buf, __pyx_t_62, __pyx_pybuffernd_V1.diminfo[0].strides))) + (__pyx_v_slm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V2.rcbuffer->pybuffer.buf, __pyx_t_63, __pyx_pybuffernd_V2.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":226
 * 
 *         # PROJECTION OF Z AXIS PERPENDICULAR TO ncap
 *         lm = lm + tpibth             # <<<<<<<<<<<<<<
 *         clm = cos(lm)
 *         slm = sin(lm)
 */
    __pyx_v_lm = (__pyx_v_lm + __pyx_v_12libTEXTURIZE_tpibth);

    /* "libTEXTURIZE.pyx":227
 *         # PROJECTION OF Z AXIS PERPENDICULAR TO ncap
 *         lm = lm + tpibth
 *         clm = cos(lm)             # <<<<<<<<<<<<<<
 *         slm = sin(lm)
 *         Zp[0] = clm * V1[0] + slm * V2[0]
 */
    __pyx_v_clm = cos(__pyx_v_lm);

    /* "libTEXTURIZE.pyx":228
 *         lm = lm + tpibth
 *         clm = cos(lm)
 *         slm = sin(lm)             # <<<<<<<<<<<<<<
 *         Zp[0] = clm * V1[0] + slm * V2[0]
 *         Zp[1] = clm * V1[1] + slm * V2[1]
 */
    __pyx_v_slm = sin(__pyx_v_lm);

    /* "libTEXTURIZE.pyx":229
 *         clm = cos(lm)
 *         slm = sin(lm)
 *         Zp[0] = clm * V1[0] + slm * V2[0]             # <<<<<<<<<<<<<<
 *         Zp[1] = clm * V1[1] + slm * V2[1]
 *         Zp[2] = clm * V1[2] + slm * V2[2]
 */
    __pyx_t_65 = 0;
    __pyx_t_66 = 0;
    __pyx_t_67 = 0;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Zp.rcbuffer->pybuffer.buf, __pyx_t_67, __pyx_pybuffernd_Zp.diminfo[0].strides) = ((__pyx_v_clm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V1.rcbuffer->pybuffer.buf, __pyx_t_65, __pyx_pybuffernd_V1.diminfo[0].strides))) + (__pyx_v_slm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V2.rcbuffer->pybuffer.buf, __pyx_t_66, __pyx_pybuffernd_V2.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":230
 *         slm = sin(lm)
 *         Zp[0] = clm * V1[0] + slm * V2[0]
 *         Zp[1] = clm * V1[1] + slm * V2[1]             # <<<<<<<<<<<<<<
 *         Zp[2] = clm * V1[2] + slm * V2[2]
 * 
 */
    __pyx_t_68 = 1;
    __pyx_t_69 = 1;
    __pyx_t_70 = 1;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Zp.rcbuffer->pybuffer.buf, __pyx_t_70, __pyx_pybuffernd_Zp.diminfo[0].strides) = ((__pyx_v_clm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V1.rcbuffer->pybuffer.buf, __pyx_t_68, __pyx_pybuffernd_V1.diminfo[0].strides))) + (__pyx_v_slm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V2.rcbuffer->pybuffer.buf, __pyx_t_69, __pyx_pybuffernd_V2.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":231
 *         Zp[0] = clm * V1[0] + slm * V2[0]
 *         Zp[1] = clm * V1[1] + slm * V2[1]
 *         Zp[2] = clm * V1[2] + slm * V2[2]             # <<<<<<<<<<<<<<
 * 
 *         # CRYSTALLOGRAPHIC X AXIS
 */
    __pyx_t_71 = 2;
    __pyx_t_72 = 2;
    __pyx_t_73 = 2;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Zp.rcbuffer->pybuffer.buf, __pyx_t_73, __pyx_pybuffernd_Zp.diminfo[0].strides) = ((__pyx_v_clm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V1.rcbuffer->pybuffer.buf, __pyx_t_71, __pyx_pybuffernd_V1.diminfo[0].strides))) + (__pyx_v_slm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V2.rcbuffer->pybuffer.buf, __pyx_t_72, __pyx_pybuffernd_V2.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":234
 * 
 *         # CRYSTALLOGRAPHIC X AXIS
 *         cossncap0 = coss * ncap[0]             # <<<<<<<<<<<<<<
 *         cossncap1 = coss * ncap[1]
 *         cossncap2 = coss * ncap[2]
 */
    __pyx_t_74 = 0;
    __pyx_v_cossncap0 = (__pyx_v_coss * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_ncap.rcbuffer->pybuffer.buf, __pyx_t_74, __pyx_pybuffernd_ncap.diminfo[0].strides)));

    /* "libTEXTURIZE.pyx":235
 *         # CRYSTALLOGRAPHIC X AXIS
 *         cossncap0 = coss * ncap[0]
 *         cossncap1 = coss * ncap[1]             # <<<<<<<<<<<<<<
 *         cossncap2 = coss * ncap[2]
 * 
 */
    __pyx_t_75 = 1;
    __pyx_v_cossncap1 = (__pyx_v_coss * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_ncap.rcbuffer->pybuffer.buf, __pyx_t_75, __pyx_pybuffernd_ncap.diminfo[0].strides)));

    /* "libTEXTURIZE.pyx":236
 *         cossncap0 = coss * ncap[0]
 *         cossncap1 = coss * ncap[1]
 *         cossncap2 = coss * ncap[2]             # <<<<<<<<<<<<<<
 * 
 *         Xc[0] = cossncap0 + sinn * Xp[0]
 */
    __pyx_t_76 = 2;
    __pyx_v_cossncap2 = (__pyx_v_coss * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_ncap.rcbuffer->pybuffer.buf, __pyx_t_76, __pyx_pybuffernd_ncap.diminfo[0].strides)));

    /* "libTEXTURIZE.pyx":238
 *         cossncap2 = coss * ncap[2]
 * 
 *         Xc[0] = cossncap0 + sinn * Xp[0]             # <<<<<<<<<<<<<<
 *         Xc[1] = cossncap1 + sinn * Xp[1]
 *         Xc[2] = cossncap2 + sinn * Xp[2]
 */
    __pyx_t_77 = 0;
    __pyx_t_78 = 0;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_78, __pyx_pybuffernd_Xc.diminfo[0].strides) = (__pyx_v_cossncap0 + (__pyx_v_sinn * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xp.rcbuffer->pybuffer.buf, __pyx_t_77, __pyx_pybuffernd_Xp.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":239
 * 
 *         Xc[0] = cossncap0 + sinn * Xp[0]
 *         Xc[1] = cossncap1 + sinn * Xp[1]             # <<<<<<<<<<<<<<
 *         Xc[2] = cossncap2 + sinn * Xp[2]
 * 
 */
    __pyx_t_79 = 1;
    __pyx_t_80 = 1;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_80, __pyx_pybuffernd_Xc.diminfo[0].strides) = (__pyx_v_cossncap1 + (__pyx_v_sinn * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xp.rcbuffer->pybuffer.buf, __pyx_t_79, __pyx_pybuffernd_Xp.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":240
 *         Xc[0] = cossncap0 + sinn * Xp[0]
 *         Xc[1] = cossncap1 + sinn * Xp[1]
 *         Xc[2] = cossncap2 + sinn * Xp[2]             # <<<<<<<<<<<<<<
 * 
 *         # CRYSTALLOGRAPHIC Y AXIS
 */
    __pyx_t_81 = 2;
    __pyx_t_82 = 2;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_82, __pyx_pybuffernd_Xc.diminfo[0].strides) = (__pyx_v_cossncap2 + (__pyx_v_sinn * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xp.rcbuffer->pybuffer.buf, __pyx_t_81, __pyx_pybuffernd_Xp.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":243
 * 
 *         # CRYSTALLOGRAPHIC Y AXIS
 *         Yc[0] = cossncap0 + sinn * Yp[0]             # <<<<<<<<<<<<<<
 *         Yc[1] = cossncap1 + sinn * Yp[1]
 *         Yc[2] = cossncap2 + sinn * Yp[2]
 */
    __pyx_t_83 = 0;
    __pyx_t_84 = 0;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_84, __pyx_pybuffernd_Yc.diminfo[0].strides) = (__pyx_v_cossncap0 + (__pyx_v_sinn * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yp.rcbuffer->pybuffer.buf, __pyx_t_83, __pyx_pybuffernd_Yp.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":244
 *         # CRYSTALLOGRAPHIC Y AXIS
 *         Yc[0] = cossncap0 + sinn * Yp[0]
 *         Yc[1] = cossncap1 + sinn * Yp[1]             # <<<<<<<<<<<<<<
 *         Yc[2] = cossncap2 + sinn * Yp[2]
 * 
 */
    __pyx_t_85 = 1;
    __pyx_t_86 = 1;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_86, __pyx_pybuffernd_Yc.diminfo[0].strides) = (__pyx_v_cossncap1 + (__pyx_v_sinn * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yp.rcbuffer->pybuffer.buf, __pyx_t_85, __pyx_pybuffernd_Yp.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":245
 *         Yc[0] = cossncap0 + sinn * Yp[0]
 *         Yc[1] = cossncap1 + sinn * Yp[1]
 *         Yc[2] = cossncap2 + sinn * Yp[2]             # <<<<<<<<<<<<<<
 * 
 *         # CRYSTALLOGRAPHIC Z AXIS
 */
    __pyx_t_87 = 2;
    __pyx_t_88 = 2;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_88, __pyx_pybuffernd_Yc.diminfo[0].strides) = (__pyx_v_cossncap2 + (__pyx_v_sinn * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yp.rcbuffer->pybuffer.buf, __pyx_t_87, __pyx_pybuffernd_Yp.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":248
 * 
 *         # CRYSTALLOGRAPHIC Z AXIS
 *         Zc[0] = cossncap0 + sinn * Zp[0]             # <<<<<<<<<<<<<<
 *         Zc[1] = cossncap1 + sinn * Zp[1]
 *         Zc[2] = cossncap2 + sinn * Zp[2]
 */
    __pyx_t_89 = 0;
    __pyx_t_90 = 0;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Zc.rcbuffer->pybuffer.buf, __pyx_t_90, __pyx_pybuffernd_Zc.diminfo[0].strides) = (__pyx_v_cossncap0 + (__pyx_v_sinn * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Zp.rcbuffer->pybuffer.buf, __pyx_t_89, __pyx_pybuffernd_Zp.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":249
 *         # CRYSTALLOGRAPHIC Z AXIS
 *         Zc[0] = cossncap0 + sinn * Zp[0]
 *         Zc[1] = cossncap1 + sinn * Zp[1]             # <<<<<<<<<<<<<<
 *         Zc[2] = cossncap2 + sinn * Zp[2]
 * 
 */
    __pyx_t_91 = 1;
    __pyx_t_92 = 1;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Zc.rcbuffer->pybuffer.buf, __pyx_t_92, __pyx_pybuffernd_Zc.diminfo[0].strides) = (__pyx_v_cossncap1 + (__pyx_v_sinn * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Zp.rcbuffer->pybuffer.buf, __pyx_t_91, __pyx_pybuffernd_Zp.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":250
 *         Zc[0] = cossncap0 + sinn * Zp[0]
 *         Zc[1] = cossncap1 + sinn * Zp[1]
 *         Zc[2] = cossncap2 + sinn * Zp[2]             # <<<<<<<<<<<<<<
 * 
 *         # ROTATION MATRIX
 */
    __pyx_t_93 = 2;
    __pyx_t_94 = 2;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Zc.rcbuffer->pybuffer.buf, __pyx_t_94, __pyx_pybuffernd_Zc.diminfo[0].strides) = (__pyx_v_cossncap2 + (__pyx_v_sinn * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Zp.rcbuffer->pybuffer.buf, __pyx_t_93, __pyx_pybuffernd_Zp.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":253
 * 
 *         # ROTATION MATRIX
 *         Rot[i, 0, 0] = Xc[0]             # <<<<<<<<<<<<<<
 *         Rot[i, 0, 1] = Xc[1]
 *         Rot[i, 0, 2] = Xc[2]
 */
    __pyx_t_95 = 0;
    __pyx_t_96 = __pyx_v_i;
    __pyx_t_97 = 0;
    __pyx_t_98 = 0;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_96, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_97, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_98, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_95, __pyx_pybuffernd_Xc.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":254
 *         # ROTATION MATRIX
 *         Rot[i, 0, 0] = Xc[0]
 *         Rot[i, 0, 1] = Xc[1]             # <<<<<<<<<<<<<<
 *         Rot[i, 0, 2] = Xc[2]
 *         Rot[i, 1, 0] = Yc[0]
 */
    __pyx_t_99 = 1;
    __pyx_t_100 = __pyx_v_i;
    __pyx_t_101 = 0;
    __pyx_t_102 = 1;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_100, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_101, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_102, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_99, __pyx_pybuffernd_Xc.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":255
 *         Rot[i, 0, 0] = Xc[0]
 *         Rot[i, 0, 1] = Xc[1]
 *         Rot[i, 0, 2] = Xc[2]             # <<<<<<<<<<<<<<
 *         Rot[i, 1, 0] = Yc[0]
 *         Rot[i, 1, 1] = Yc[1]
 */
    __pyx_t_103 = 2;
    __pyx_t_104 = __pyx_v_i;
    __pyx_t_105 = 0;
    __pyx_t_106 = 2;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_104, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_105, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_106, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_103, __pyx_pybuffernd_Xc.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":256
 *         Rot[i, 0, 1] = Xc[1]
 *         Rot[i, 0, 2] = Xc[2]
 *         Rot[i, 1, 0] = Yc[0]             # <<<<<<<<<<<<<<
 *         Rot[i, 1, 1] = Yc[1]
 *         Rot[i, 1, 2] = Yc[2]
 */
    __pyx_t_107 = 0;
    __pyx_t_108 = __pyx_v_i;
    __pyx_t_109 = 1;
    __pyx_t_110 = 0;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_108, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_109, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_110, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_107, __pyx_pybuffernd_Yc.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":257
 *         Rot[i, 0, 2] = Xc[2]
 *         Rot[i, 1, 0] = Yc[0]
 *         Rot[i, 1, 1] = Yc[1]             # <<<<<<<<<<<<<<
 *         Rot[i, 1, 2] = Yc[2]
 *         Rot[i, 2, 0] = Zc[0]
 */
    __pyx_t_111 = 1;
    __pyx_t_112 = __pyx_v_i;
    __pyx_t_113 = 1;
    __pyx_t_114 = 1;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_112, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_113, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_114, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_111, __pyx_pybuffernd_Yc.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":258
 *         Rot[i, 1, 0] = Yc[0]
 *         Rot[i, 1, 1] = Yc[1]
 *         Rot[i, 1, 2] = Yc[2]             # <<<<<<<<<<<<<<
 *         Rot[i, 2, 0] = Zc[0]
 *         Rot[i, 2, 1] = Zc[1]
 */
    __pyx_t_115 = 2;
    __pyx_t_116 = __pyx_v_i;
    __pyx_t_117 = 1;
    __pyx_t_118 = 2;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_116, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_117, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_118, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_115, __pyx_pybuffernd_Yc.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":259
 *         Rot[i, 1, 1] = Yc[1]
 *         Rot[i, 1, 2] = Yc[2]
 *         Rot[i, 2, 0] = Zc[0]             # <<<<<<<<<<<<<<
 *         Rot[i, 2, 1] = Zc[1]
 *         Rot[i, 2, 2] = Zc[2]
 */
    __pyx_t_119 = 0;
    __pyx_t_120 = __pyx_v_i;
    __pyx_t_121 = 2;
    __pyx_t_122 = 0;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_120, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_121, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_122, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Zc.rcbuffer->pybuffer.buf, __pyx_t_119, __pyx_pybuffernd_Zc.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":260
 *         Rot[i, 1, 2] = Yc[2]
 *         Rot[i, 2, 0] = Zc[0]
 *         Rot[i, 2, 1] = Zc[1]             # <<<<<<<<<<<<<<
 *         Rot[i, 2, 2] = Zc[2]
 * 
 */
    __pyx_t_123 = 1;
    __pyx_t_124 = __pyx_v_i;
    __pyx_t_125 = 2;
    __pyx_t_126 = 1;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_124, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_125, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_126, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Zc.rcbuffer->pybuffer.buf, __pyx_t_123, __pyx_pybuffernd_Zc.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":261
 *         Rot[i, 2, 0] = Zc[0]
 *         Rot[i, 2, 1] = Zc[1]
 *         Rot[i, 2, 2] = Zc[2]             # <<<<<<<<<<<<<<
 * 
 *     Eul = conv.rm_to_zxz(Rot)
 */
    __pyx_t_127 = 2;
    __pyx_t_128 = __pyx_v_i;
    __pyx_t_129 = 2;
    __pyx_t_130 = 2;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_128, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_129, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_130, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Zc.rcbuffer->pybuffer.buf, __pyx_t_127, __pyx_pybuffernd_Zc.diminfo[0].strides));
  }

  /* "libTEXTURIZE.pyx":263
 *         Rot[i, 2, 2] = Zc[2]
 * 
 *     Eul = conv.rm_to_zxz(Rot)             # <<<<<<<<<<<<<<
 * 
 *     if makecanvas == 0:
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_conv); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 263, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_rm_to_zxz); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 263, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_3, ((PyObject *)__pyx_v_Rot)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 263, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 263, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5); __pyx_t_5 = NULL;
    __Pyx_INCREF(((PyObject *)__pyx_v_Rot));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_Rot));
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, ((PyObject *)__pyx_v_Rot));
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 263, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 263, __pyx_L1_error)
  __pyx_t_21 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_t_21, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_30, &__pyx_t_31, &__pyx_t_32);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_v_Eul, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_30); Py_XDECREF(__pyx_t_31); Py_XDECREF(__pyx_t_32);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_30, __pyx_t_31, __pyx_t_32);
      }
    }
    __pyx_pybuffernd_Eul.diminfo[0].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Eul.diminfo[0].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Eul.diminfo[1].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Eul.diminfo[1].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[1];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 263, __pyx_L1_error)
  }
  __pyx_t_21 = 0;
  __Pyx_DECREF_SET(__pyx_v_Eul, ((PyArrayObject *)__pyx_t_6));
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":265
 *     Eul = conv.rm_to_zxz(Rot)
 * 
 *     if makecanvas == 0:             # <<<<<<<<<<<<<<
 * 
 *         obj.Eul = Eul
 */
  __pyx_t_131 = ((__pyx_v_makecanvas == 0) != 0);
  if (__pyx_t_131) {

    /* "libTEXTURIZE.pyx":267
 *     if makecanvas == 0:
 * 
 *         obj.Eul = Eul             # <<<<<<<<<<<<<<
 *         obj.Axis = Axis
 *         obj.Angle = Angle
 */
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_Eul, ((PyObject *)__pyx_v_Eul)) < 0) __PYX_ERR(0, 267, __pyx_L1_error)

    /* "libTEXTURIZE.pyx":268
 * 
 *         obj.Eul = Eul
 *         obj.Axis = Axis             # <<<<<<<<<<<<<<
 *         obj.Angle = Angle
 *         obj.Nd = Nd
 */
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_Axis, ((PyObject *)__pyx_v_Axis)) < 0) __PYX_ERR(0, 268, __pyx_L1_error)

    /* "libTEXTURIZE.pyx":269
 *         obj.Eul = Eul
 *         obj.Axis = Axis
 *         obj.Angle = Angle             # <<<<<<<<<<<<<<
 *         obj.Nd = Nd
 *         obj.Rd = Rd
 */
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_Angle, ((PyObject *)__pyx_v_Angle)) < 0) __PYX_ERR(0, 269, __pyx_L1_error)

    /* "libTEXTURIZE.pyx":270
 *         obj.Axis = Axis
 *         obj.Angle = Angle
 *         obj.Nd = Nd             # <<<<<<<<<<<<<<
 *         obj.Rd = Rd
 *         obj.Rv = Rv
 */
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_Nd, ((PyObject *)__pyx_v_Nd)) < 0) __PYX_ERR(0, 270, __pyx_L1_error)

    /* "libTEXTURIZE.pyx":271
 *         obj.Angle = Angle
 *         obj.Nd = Nd
 *         obj.Rd = Rd             # <<<<<<<<<<<<<<
 *         obj.Rv = Rv
 *         obj.Q = Q
 */
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_Rd, ((PyObject *)__pyx_v_Rd)) < 0) __PYX_ERR(0, 271, __pyx_L1_error)

    /* "libTEXTURIZE.pyx":272
 *         obj.Nd = Nd
 *         obj.Rd = Rd
 *         obj.Rv = Rv             # <<<<<<<<<<<<<<
 *         obj.Q = Q
 * 
 */
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_Rv, ((PyObject *)__pyx_v_Rv)) < 0) __PYX_ERR(0, 272, __pyx_L1_error)

    /* "libTEXTURIZE.pyx":273
 *         obj.Rd = Rd
 *         obj.Rv = Rv
 *         obj.Q = Q             # <<<<<<<<<<<<<<
 * 
 *     else:
 */
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_Q, ((PyObject *)__pyx_v_Q)) < 0) __PYX_ERR(0, 273, __pyx_L1_error)

    /* "libTEXTURIZE.pyx":265
 *     Eul = conv.rm_to_zxz(Rot)
 * 
 *     if makecanvas == 0:             # <<<<<<<<<<<<<<
 * 
 *         obj.Eul = Eul
 */
    goto __pyx_L5;
  }

  /* "libTEXTURIZE.pyx":276
 * 
 *     else:
 *         obj.EUL = getcanvas(m, n, Eul)             # <<<<<<<<<<<<<<
 * 
 *     toc = time.time()
 */
  /*else*/ {
    __pyx_t_6 = __pyx_f_12libTEXTURIZE_getcanvas(__pyx_v_m, __pyx_v_n, ((PyArrayObject *)__pyx_v_Eul)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 276, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_EUL, __pyx_t_6) < 0) __PYX_ERR(0, 276, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __pyx_L5:;

  /* "libTEXTURIZE.pyx":278
 *         obj.EUL = getcanvas(m, n, Eul)
 * 
 *     toc = time.time()             # <<<<<<<<<<<<<<
 *     obj.exetime = toc - tic
 *     return obj
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_time); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 278, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_time); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 278, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  if (__pyx_t_3) {
    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 278, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    __pyx_t_6 = __Pyx_PyObject_CallNoArg(__pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 278, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_28 = __pyx_PyFloat_AsDouble(__pyx_t_6); if (unlikely((__pyx_t_28 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 278, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_toc = __pyx_t_28;

  /* "libTEXTURIZE.pyx":279
 * 
 *     toc = time.time()
 *     obj.exetime = toc - tic             # <<<<<<<<<<<<<<
 *     return obj
 * 
 */
  __pyx_t_6 = PyFloat_FromDouble((__pyx_v_toc - __pyx_v_tic)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 279, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_exetime, __pyx_t_6) < 0) __PYX_ERR(0, 279, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":280
 *     toc = time.time()
 *     obj.exetime = toc - tic
 *     return obj             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_obj);
  __pyx_r = __pyx_v_obj;
  goto __pyx_L0;

  /* "libTEXTURIZE.pyx":139
 * 
 * 
 * def Texture_URO_nxyz(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_33);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Q.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V1.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V2.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Xc.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Xp.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Yc.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Yp.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Zc.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Zp.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_lambdaa.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_ncap.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_phi.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_r1.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_theta.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("libTEXTURIZE.Texture_URO_nxyz", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Q.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V1.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V2.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Xc.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Xp.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Yc.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Yp.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Zc.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Zp.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_lambdaa.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_ncap.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_phi.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_r1.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_theta.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XDECREF((PyObject *)__pyx_v_r1);
  __Pyx_XDECREF((PyObject *)__pyx_v_lambdaa);
  __Pyx_XDECREF((PyObject *)__pyx_v_theta);
  __Pyx_XDECREF((PyObject *)__pyx_v_phi);
  __Pyx_XDECREF((PyObject *)__pyx_v_ncap);
  __Pyx_XDECREF((PyObject *)__pyx_v_V1);
  __Pyx_XDECREF((PyObject *)__pyx_v_V2);
  __Pyx_XDECREF((PyObject *)__pyx_v_Xp);
  __Pyx_XDECREF((PyObject *)__pyx_v_Yp);
  __Pyx_XDECREF((PyObject *)__pyx_v_Zp);
  __Pyx_XDECREF((PyObject *)__pyx_v_Xc);
  __Pyx_XDECREF((PyObject *)__pyx_v_Yc);
  __Pyx_XDECREF((PyObject *)__pyx_v_Zc);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rot);
  __Pyx_XDECREF((PyObject *)__pyx_v_Eul);
  __Pyx_XDECREF((PyObject *)__pyx_v_Axis);
  __Pyx_XDECREF((PyObject *)__pyx_v_Angle);
  __Pyx_XDECREF((PyObject *)__pyx_v_Nd);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rd);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rv);
  __Pyx_XDECREF((PyObject *)__pyx_v_Q);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "libTEXTURIZE.pyx":283
 * 
 * 
 * def Texture_URO_arvo(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */

/* Python wrapper */
static PyObject *__pyx_pw_12libTEXTURIZE_7Texture_URO_arvo(PyObject *__pyx_self, PyObject *__pyx_v_obj); /*proto*/
static PyMethodDef __pyx_mdef_12libTEXTURIZE_7Texture_URO_arvo = {"Texture_URO_arvo", (PyCFunction)__pyx_pw_12libTEXTURIZE_7Texture_URO_arvo, METH_O, 0};
static PyObject *__pyx_pw_12libTEXTURIZE_7Texture_URO_arvo(PyObject *__pyx_self, PyObject *__pyx_v_obj) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Texture_URO_arvo (wrapper)", 0);
  __pyx_r = __pyx_pf_12libTEXTURIZE_6Texture_URO_arvo(__pyx_self, ((PyObject *)__pyx_v_obj));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_12libTEXTURIZE_6Texture_URO_arvo(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_obj) {
  int __pyx_v_myseed;
  int __pyx_v_p;
  int __pyx_v_m;
  int __pyx_v_n;
  int __pyx_v_makecanvas;
  double __pyx_v_tic;
  double __pyx_v_toc;
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_k;
  int __pyx_v_l;
  float __pyx_v_ph;
  float __pyx_v_lm;
  float __pyx_v_sph;
  float __pyx_v_cph;
  float __pyx_v_clm;
  float __pyx_v_slm;
  float __pyx_v_squ;
  float __pyx_v_sum;
  float __pyx_v_u;
  PyArrayObject *__pyx_v_rsign = 0;
  PyArrayObject *__pyx_v_phi = 0;
  PyArrayObject *__pyx_v_U = 0;
  PyArrayObject *__pyx_v_lambdaa = 0;
  PyArrayObject *__pyx_v_V = 0;
  PyArrayObject *__pyx_v_R = 0;
  PyArrayObject *__pyx_v_H = 0;
  PyArrayObject *__pyx_v_EYE = 0;
  PyArrayObject *__pyx_v_Rot = 0;
  PyArrayObject *__pyx_v_Eul = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Axis = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Angle = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Nd = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Rd = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Rv = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Q = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Angle;
  __Pyx_Buffer __pyx_pybuffer_Angle;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Axis;
  __Pyx_Buffer __pyx_pybuffer_Axis;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_EYE;
  __Pyx_Buffer __pyx_pybuffer_EYE;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Eul;
  __Pyx_Buffer __pyx_pybuffer_Eul;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_H;
  __Pyx_Buffer __pyx_pybuffer_H;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Nd;
  __Pyx_Buffer __pyx_pybuffer_Nd;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Q;
  __Pyx_Buffer __pyx_pybuffer_Q;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_R;
  __Pyx_Buffer __pyx_pybuffer_R;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rd;
  __Pyx_Buffer __pyx_pybuffer_Rd;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rot;
  __Pyx_Buffer __pyx_pybuffer_Rot;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rv;
  __Pyx_Buffer __pyx_pybuffer_Rv;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_U;
  __Pyx_Buffer __pyx_pybuffer_U;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_V;
  __Pyx_Buffer __pyx_pybuffer_V;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_lambdaa;
  __Pyx_Buffer __pyx_pybuffer_lambdaa;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_phi;
  __Pyx_Buffer __pyx_pybuffer_phi;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_rsign;
  __Pyx_Buffer __pyx_pybuffer_rsign;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyArrayObject *__pyx_t_7 = NULL;
  PyArrayObject *__pyx_t_8 = NULL;
  PyArrayObject *__pyx_t_9 = NULL;
  PyArrayObject *__pyx_t_10 = NULL;
  PyArrayObject *__pyx_t_11 = NULL;
  PyArrayObject *__pyx_t_12 = NULL;
  PyArrayObject *__pyx_t_13 = NULL;
  PyArrayObject *__pyx_t_14 = NULL;
  PyObject *__pyx_t_15 = NULL;
  PyObject *__pyx_t_16 = NULL;
  PyObject *__pyx_t_17 = NULL;
  PyArrayObject *__pyx_t_18 = NULL;
  PyArrayObject *__pyx_t_19 = NULL;
  PyArrayObject *__pyx_t_20 = NULL;
  PyArrayObject *__pyx_t_21 = NULL;
  PyArrayObject *__pyx_t_22 = NULL;
  PyArrayObject *__pyx_t_23 = NULL;
  PyArrayObject *__pyx_t_24 = NULL;
  PyArrayObject *__pyx_t_25 = NULL;
  double __pyx_t_26;
  Py_ssize_t __pyx_t_27;
  PyObject *__pyx_t_28 = NULL;
  int __pyx_t_29;
  Py_ssize_t __pyx_t_30;
  Py_ssize_t __pyx_t_31;
  Py_ssize_t __pyx_t_32;
  Py_ssize_t __pyx_t_33;
  Py_ssize_t __pyx_t_34;
  Py_ssize_t __pyx_t_35;
  Py_ssize_t __pyx_t_36;
  Py_ssize_t __pyx_t_37;
  Py_ssize_t __pyx_t_38;
  Py_ssize_t __pyx_t_39;
  Py_ssize_t __pyx_t_40;
  Py_ssize_t __pyx_t_41;
  Py_ssize_t __pyx_t_42;
  Py_ssize_t __pyx_t_43;
  Py_ssize_t __pyx_t_44;
  Py_ssize_t __pyx_t_45;
  Py_ssize_t __pyx_t_46;
  Py_ssize_t __pyx_t_47;
  Py_ssize_t __pyx_t_48;
  Py_ssize_t __pyx_t_49;
  Py_ssize_t __pyx_t_50;
  Py_ssize_t __pyx_t_51;
  Py_ssize_t __pyx_t_52;
  Py_ssize_t __pyx_t_53;
  Py_ssize_t __pyx_t_54;
  int __pyx_t_55;
  Py_ssize_t __pyx_t_56;
  Py_ssize_t __pyx_t_57;
  int __pyx_t_58;
  int __pyx_t_59;
  Py_ssize_t __pyx_t_60;
  Py_ssize_t __pyx_t_61;
  Py_ssize_t __pyx_t_62;
  Py_ssize_t __pyx_t_63;
  Py_ssize_t __pyx_t_64;
  Py_ssize_t __pyx_t_65;
  int __pyx_t_66;
  Py_ssize_t __pyx_t_67;
  Py_ssize_t __pyx_t_68;
  Py_ssize_t __pyx_t_69;
  Py_ssize_t __pyx_t_70;
  Py_ssize_t __pyx_t_71;
  Py_ssize_t __pyx_t_72;
  Py_ssize_t __pyx_t_73;
  __Pyx_RefNannySetupContext("Texture_URO_arvo", 0);
  __pyx_pybuffer_rsign.pybuffer.buf = NULL;
  __pyx_pybuffer_rsign.refcount = 0;
  __pyx_pybuffernd_rsign.data = NULL;
  __pyx_pybuffernd_rsign.rcbuffer = &__pyx_pybuffer_rsign;
  __pyx_pybuffer_phi.pybuffer.buf = NULL;
  __pyx_pybuffer_phi.refcount = 0;
  __pyx_pybuffernd_phi.data = NULL;
  __pyx_pybuffernd_phi.rcbuffer = &__pyx_pybuffer_phi;
  __pyx_pybuffer_U.pybuffer.buf = NULL;
  __pyx_pybuffer_U.refcount = 0;
  __pyx_pybuffernd_U.data = NULL;
  __pyx_pybuffernd_U.rcbuffer = &__pyx_pybuffer_U;
  __pyx_pybuffer_lambdaa.pybuffer.buf = NULL;
  __pyx_pybuffer_lambdaa.refcount = 0;
  __pyx_pybuffernd_lambdaa.data = NULL;
  __pyx_pybuffernd_lambdaa.rcbuffer = &__pyx_pybuffer_lambdaa;
  __pyx_pybuffer_V.pybuffer.buf = NULL;
  __pyx_pybuffer_V.refcount = 0;
  __pyx_pybuffernd_V.data = NULL;
  __pyx_pybuffernd_V.rcbuffer = &__pyx_pybuffer_V;
  __pyx_pybuffer_R.pybuffer.buf = NULL;
  __pyx_pybuffer_R.refcount = 0;
  __pyx_pybuffernd_R.data = NULL;
  __pyx_pybuffernd_R.rcbuffer = &__pyx_pybuffer_R;
  __pyx_pybuffer_H.pybuffer.buf = NULL;
  __pyx_pybuffer_H.refcount = 0;
  __pyx_pybuffernd_H.data = NULL;
  __pyx_pybuffernd_H.rcbuffer = &__pyx_pybuffer_H;
  __pyx_pybuffer_EYE.pybuffer.buf = NULL;
  __pyx_pybuffer_EYE.refcount = 0;
  __pyx_pybuffernd_EYE.data = NULL;
  __pyx_pybuffernd_EYE.rcbuffer = &__pyx_pybuffer_EYE;
  __pyx_pybuffer_Rot.pybuffer.buf = NULL;
  __pyx_pybuffer_Rot.refcount = 0;
  __pyx_pybuffernd_Rot.data = NULL;
  __pyx_pybuffernd_Rot.rcbuffer = &__pyx_pybuffer_Rot;
  __pyx_pybuffer_Eul.pybuffer.buf = NULL;
  __pyx_pybuffer_Eul.refcount = 0;
  __pyx_pybuffernd_Eul.data = NULL;
  __pyx_pybuffernd_Eul.rcbuffer = &__pyx_pybuffer_Eul;
  __pyx_pybuffer_Axis.pybuffer.buf = NULL;
  __pyx_pybuffer_Axis.refcount = 0;
  __pyx_pybuffernd_Axis.data = NULL;
  __pyx_pybuffernd_Axis.rcbuffer = &__pyx_pybuffer_Axis;
  __pyx_pybuffer_Angle.pybuffer.buf = NULL;
  __pyx_pybuffer_Angle.refcount = 0;
  __pyx_pybuffernd_Angle.data = NULL;
  __pyx_pybuffernd_Angle.rcbuffer = &__pyx_pybuffer_Angle;
  __pyx_pybuffer_Nd.pybuffer.buf = NULL;
  __pyx_pybuffer_Nd.refcount = 0;
  __pyx_pybuffernd_Nd.data = NULL;
  __pyx_pybuffernd_Nd.rcbuffer = &__pyx_pybuffer_Nd;
  __pyx_pybuffer_Rd.pybuffer.buf = NULL;
  __pyx_pybuffer_Rd.refcount = 0;
  __pyx_pybuffernd_Rd.data = NULL;
  __pyx_pybuffernd_Rd.rcbuffer = &__pyx_pybuffer_Rd;
  __pyx_pybuffer_Rv.pybuffer.buf = NULL;
  __pyx_pybuffer_Rv.refcount = 0;
  __pyx_pybuffernd_Rv.data = NULL;
  __pyx_pybuffernd_Rv.rcbuffer = &__pyx_pybuffer_Rv;
  __pyx_pybuffer_Q.pybuffer.buf = NULL;
  __pyx_pybuffer_Q.refcount = 0;
  __pyx_pybuffernd_Q.data = NULL;
  __pyx_pybuffernd_Q.rcbuffer = &__pyx_pybuffer_Q;

  /* "libTEXTURIZE.pyx":284
 * 
 * def Texture_URO_arvo(obj):
 *     cdef int myseed = obj.myseed             # <<<<<<<<<<<<<<
 *     cdef int p = obj.p
 *     cdef int m = obj.m
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_myseed); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 284, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 284, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_myseed = __pyx_t_2;

  /* "libTEXTURIZE.pyx":285
 * def Texture_URO_arvo(obj):
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p             # <<<<<<<<<<<<<<
 *     cdef int m = obj.m
 *     cdef int n = obj.n
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 285, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 285, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_p = __pyx_t_2;

  /* "libTEXTURIZE.pyx":286
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 *     cdef int m = obj.m             # <<<<<<<<<<<<<<
 *     cdef int n = obj.n
 *     cdef int makecanvas = obj.makecanvas
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_m); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 286, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 286, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_m = __pyx_t_2;

  /* "libTEXTURIZE.pyx":287
 *     cdef int p = obj.p
 *     cdef int m = obj.m
 *     cdef int n = obj.n             # <<<<<<<<<<<<<<
 *     cdef int makecanvas = obj.makecanvas
 *     cdef double tic, toc
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 287, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 287, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_n = __pyx_t_2;

  /* "libTEXTURIZE.pyx":288
 *     cdef int m = obj.m
 *     cdef int n = obj.n
 *     cdef int makecanvas = obj.makecanvas             # <<<<<<<<<<<<<<
 *     cdef double tic, toc
 * 
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_makecanvas); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 288, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 288, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_makecanvas = __pyx_t_2;

  /* "libTEXTURIZE.pyx":294
 *     cdef float ph, lm , sph, cph, clm, slm, squ, sum, u
 * 
 *     cdef np.ndarray[np.float64_t, ndim = 1] rsign = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] phi = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] U = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 294, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 294, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 294, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 294, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 294, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 294, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 294, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 294, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 294, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 294, __pyx_L1_error)
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_rsign.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_rsign = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_rsign.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 294, __pyx_L1_error)
    } else {__pyx_pybuffernd_rsign.diminfo[0].strides = __pyx_pybuffernd_rsign.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_rsign.diminfo[0].shape = __pyx_pybuffernd_rsign.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_rsign = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":295
 * 
 *     cdef np.ndarray[np.float64_t, ndim = 1] rsign = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] phi = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] U = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] lambdaa = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 295, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 295, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 295, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 295, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 295, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 295, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 295, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 295, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 295, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 295, __pyx_L1_error)
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phi.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_phi = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_phi.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 295, __pyx_L1_error)
    } else {__pyx_pybuffernd_phi.diminfo[0].strides = __pyx_pybuffernd_phi.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_phi.diminfo[0].shape = __pyx_pybuffernd_phi.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_8 = 0;
  __pyx_v_phi = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":296
 *     cdef np.ndarray[np.float64_t, ndim = 1] rsign = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] phi = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] U = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] lambdaa = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 296, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 296, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 296, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 296, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 296, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 296, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 296, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 296, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 296, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 296, __pyx_L1_error)
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_U.rcbuffer->pybuffer, (PyObject*)__pyx_t_9, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_U = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_U.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 296, __pyx_L1_error)
    } else {__pyx_pybuffernd_U.diminfo[0].strides = __pyx_pybuffernd_U.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_U.diminfo[0].shape = __pyx_pybuffernd_U.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_9 = 0;
  __pyx_v_U = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":297
 *     cdef np.ndarray[np.float64_t, ndim = 1] phi = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] U = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] lambdaa = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] V = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] R = np.zeros((3, 3), dtype=np.float64)
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 297, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 297, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 297, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 297, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 297, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 297, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 297, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 297, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 297, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 297, __pyx_L1_error)
  __pyx_t_10 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_lambdaa.rcbuffer->pybuffer, (PyObject*)__pyx_t_10, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_lambdaa = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_lambdaa.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 297, __pyx_L1_error)
    } else {__pyx_pybuffernd_lambdaa.diminfo[0].strides = __pyx_pybuffernd_lambdaa.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_lambdaa.diminfo[0].shape = __pyx_pybuffernd_lambdaa.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_10 = 0;
  __pyx_v_lambdaa = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":298
 *     cdef np.ndarray[np.float64_t, ndim = 1] U = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] lambdaa = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] R = np.zeros((3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] H = np.zeros((3, 3), dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 298, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 298, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 298, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 298, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 298, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 298, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__12, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 298, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 298, __pyx_L1_error)
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_V.rcbuffer->pybuffer, (PyObject*)__pyx_t_11, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_V = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_V.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 298, __pyx_L1_error)
    } else {__pyx_pybuffernd_V.diminfo[0].strides = __pyx_pybuffernd_V.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_V.diminfo[0].shape = __pyx_pybuffernd_V.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_11 = 0;
  __pyx_v_V = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":299
 *     cdef np.ndarray[np.float64_t, ndim = 1] lambdaa = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] R = np.zeros((3, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] H = np.zeros((3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] EYE = np.zeros((3, 3), dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 299, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 299, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 299, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 299, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 299, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 299, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__14, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 299, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 299, __pyx_L1_error)
  __pyx_t_12 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_R.rcbuffer->pybuffer, (PyObject*)__pyx_t_12, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_R = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_R.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 299, __pyx_L1_error)
    } else {__pyx_pybuffernd_R.diminfo[0].strides = __pyx_pybuffernd_R.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_R.diminfo[0].shape = __pyx_pybuffernd_R.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_R.diminfo[1].strides = __pyx_pybuffernd_R.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_R.diminfo[1].shape = __pyx_pybuffernd_R.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_12 = 0;
  __pyx_v_R = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":300
 *     cdef np.ndarray[np.float64_t, ndim = 1] V = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] R = np.zeros((3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] H = np.zeros((3, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] EYE = np.zeros((3, 3), dtype=np.float64)
 *     EYE = np.eye(3)
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 300, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 300, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 300, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 300, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 300, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 300, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__16, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 300, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 300, __pyx_L1_error)
  __pyx_t_13 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_H.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_H = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_H.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 300, __pyx_L1_error)
    } else {__pyx_pybuffernd_H.diminfo[0].strides = __pyx_pybuffernd_H.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_H.diminfo[0].shape = __pyx_pybuffernd_H.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_H.diminfo[1].strides = __pyx_pybuffernd_H.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_H.diminfo[1].shape = __pyx_pybuffernd_H.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_13 = 0;
  __pyx_v_H = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":301
 *     cdef np.ndarray[np.float64_t, ndim = 2] R = np.zeros((3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] H = np.zeros((3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] EYE = np.zeros((3, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     EYE = np.eye(3)
 * 
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 301, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 301, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 301, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 301, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 301, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 301, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__18, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 301, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 301, __pyx_L1_error)
  __pyx_t_14 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_EYE.rcbuffer->pybuffer, (PyObject*)__pyx_t_14, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_EYE = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_EYE.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 301, __pyx_L1_error)
    } else {__pyx_pybuffernd_EYE.diminfo[0].strides = __pyx_pybuffernd_EYE.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_EYE.diminfo[0].shape = __pyx_pybuffernd_EYE.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_EYE.diminfo[1].strides = __pyx_pybuffernd_EYE.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_EYE.diminfo[1].shape = __pyx_pybuffernd_EYE.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_14 = 0;
  __pyx_v_EYE = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":302
 *     cdef np.ndarray[np.float64_t, ndim = 2] H = np.zeros((3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] EYE = np.zeros((3, 3), dtype=np.float64)
 *     EYE = np.eye(3)             # <<<<<<<<<<<<<<
 * 
 *     # DESCRIPTORS OF ORIENTATIONS
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 302, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_eye); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 302, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_tuple__19, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 302, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 302, __pyx_L1_error)
  __pyx_t_14 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_EYE.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_EYE.rcbuffer->pybuffer, (PyObject*)__pyx_t_14, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_15, &__pyx_t_16, &__pyx_t_17);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_EYE.rcbuffer->pybuffer, (PyObject*)__pyx_v_EYE, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_15); Py_XDECREF(__pyx_t_16); Py_XDECREF(__pyx_t_17);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_15, __pyx_t_16, __pyx_t_17);
      }
    }
    __pyx_pybuffernd_EYE.diminfo[0].strides = __pyx_pybuffernd_EYE.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_EYE.diminfo[0].shape = __pyx_pybuffernd_EYE.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_EYE.diminfo[1].strides = __pyx_pybuffernd_EYE.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_EYE.diminfo[1].shape = __pyx_pybuffernd_EYE.rcbuffer->pybuffer.shape[1];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 302, __pyx_L1_error)
  }
  __pyx_t_14 = 0;
  __Pyx_DECREF_SET(__pyx_v_EYE, ((PyArrayObject *)__pyx_t_1));
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":305
 * 
 *     # DESCRIPTORS OF ORIENTATIONS
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 305, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 305, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 305, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 305, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_3);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_int_3);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 305, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 305, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 305, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 305, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 305, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 305, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 305, __pyx_L1_error)
  __pyx_t_18 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer, (PyObject*)__pyx_t_18, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 3, 0, __pyx_stack) == -1)) {
      __pyx_v_Rot = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 305, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rot.diminfo[0].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rot.diminfo[0].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rot.diminfo[1].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rot.diminfo[1].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_Rot.diminfo[2].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_Rot.diminfo[2].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[2];
    }
  }
  __pyx_t_18 = 0;
  __pyx_v_Rot = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":306
 *     # DESCRIPTORS OF ORIENTATIONS
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 306, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 306, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 306, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 306, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_3);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 306, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 306, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 306, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 306, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 306, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 306, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 306, __pyx_L1_error)
  __pyx_t_19 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_t_19, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Eul = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Eul.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 306, __pyx_L1_error)
    } else {__pyx_pybuffernd_Eul.diminfo[0].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Eul.diminfo[0].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Eul.diminfo[1].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Eul.diminfo[1].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_19 = 0;
  __pyx_v_Eul = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":307
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 307, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 307, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 307, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 307, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_int_3);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 307, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 307, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 307, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 307, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 307, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 307, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 307, __pyx_L1_error)
  __pyx_t_20 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer, (PyObject*)__pyx_t_20, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Axis = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Axis.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 307, __pyx_L1_error)
    } else {__pyx_pybuffernd_Axis.diminfo[0].strides = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Axis.diminfo[0].shape = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Axis.diminfo[1].strides = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Axis.diminfo[1].shape = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_20 = 0;
  __pyx_v_Axis = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":308
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 308, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 308, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 308, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 308, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 308, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 308, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 308, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 308, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 308, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 308, __pyx_L1_error)
  __pyx_t_21 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer, (PyObject*)__pyx_t_21, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Angle = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Angle.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 308, __pyx_L1_error)
    } else {__pyx_pybuffernd_Angle.diminfo[0].strides = __pyx_pybuffernd_Angle.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Angle.diminfo[0].shape = __pyx_pybuffernd_Angle.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_21 = 0;
  __pyx_v_Angle = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":309
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 309, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 309, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 309, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 309, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_int_3);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 309, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 309, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 309, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 309, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 309, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 309, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 309, __pyx_L1_error)
  __pyx_t_22 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer, (PyObject*)__pyx_t_22, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Nd = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Nd.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 309, __pyx_L1_error)
    } else {__pyx_pybuffernd_Nd.diminfo[0].strides = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Nd.diminfo[0].shape = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Nd.diminfo[1].strides = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Nd.diminfo[1].shape = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_22 = 0;
  __pyx_v_Nd = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":310
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 310, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 310, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 310, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 310, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_3);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 310, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 310, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 310, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 310, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 310, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 310, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 310, __pyx_L1_error)
  __pyx_t_23 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer, (PyObject*)__pyx_t_23, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Rd = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rd.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 310, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rd.diminfo[0].strides = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rd.diminfo[0].shape = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rd.diminfo[1].strides = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rd.diminfo[1].shape = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_23 = 0;
  __pyx_v_Rd = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":311
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)
 * 
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 311, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 311, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 311, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 311, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_3);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 311, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 311, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 311, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 311, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 311, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 311, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 311, __pyx_L1_error)
  __pyx_t_24 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer, (PyObject*)__pyx_t_24, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Rv = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rv.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 311, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rv.diminfo[0].strides = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rv.diminfo[0].shape = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rv.diminfo[1].strides = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rv.diminfo[1].shape = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_24 = 0;
  __pyx_v_Rv = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":312
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 312, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 312, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 312, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 312, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
  __Pyx_INCREF(__pyx_int_4);
  __Pyx_GIVEREF(__pyx_int_4);
  PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_int_4);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 312, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 312, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 312, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 312, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 312, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 312, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 312, __pyx_L1_error)
  __pyx_t_25 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Q.rcbuffer->pybuffer, (PyObject*)__pyx_t_25, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Q = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Q.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 312, __pyx_L1_error)
    } else {__pyx_pybuffernd_Q.diminfo[0].strides = __pyx_pybuffernd_Q.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Q.diminfo[0].shape = __pyx_pybuffernd_Q.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Q.diminfo[1].strides = __pyx_pybuffernd_Q.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Q.diminfo[1].shape = __pyx_pybuffernd_Q.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_25 = 0;
  __pyx_v_Q = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":315
 * 
 * 
 *     plantseed(myseed)             # <<<<<<<<<<<<<<
 *     tic = time.time()
 * 
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_plantseed); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 315, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_myseed); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 315, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 315, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_GOTREF(__pyx_t_5);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 315, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1); __pyx_t_1 = NULL;
    __Pyx_GIVEREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 315, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":316
 * 
 *     plantseed(myseed)
 *     tic = time.time()             # <<<<<<<<<<<<<<
 * 
 *     rsign = np.random.uniform(0, 1, [p, ])
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_time); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 316, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_time); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 316, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  if (__pyx_t_6) {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 316, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  } else {
    __pyx_t_5 = __Pyx_PyObject_CallNoArg(__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 316, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_26 = __pyx_PyFloat_AsDouble(__pyx_t_5); if (unlikely((__pyx_t_26 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 316, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_tic = __pyx_t_26;

  /* "libTEXTURIZE.pyx":318
 *     tic = time.time()
 * 
 *     rsign = np.random.uniform(0, 1, [p, ])             # <<<<<<<<<<<<<<
 *     phi = np.random.uniform(0, 2 * pi, [p, ])
 *     U = np.random.uniform(0, 1, [p, ])
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 318, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_random); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 318, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_uniform); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 318, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 318, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 318, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_6);
  PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  __pyx_t_27 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
      __pyx_t_27 = 1;
    }
  }
  __pyx_t_1 = PyTuple_New(3+__pyx_t_27); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 318, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (__pyx_t_6) {
    __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6); __pyx_t_6 = NULL;
  }
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_27, __pyx_int_0);
  __Pyx_INCREF(__pyx_int_1);
  __Pyx_GIVEREF(__pyx_int_1);
  PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_27, __pyx_int_1);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_1, 2+__pyx_t_27, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 318, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 318, __pyx_L1_error)
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_rsign.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_rsign.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_17, &__pyx_t_16, &__pyx_t_15);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_rsign.rcbuffer->pybuffer, (PyObject*)__pyx_v_rsign, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_17); Py_XDECREF(__pyx_t_16); Py_XDECREF(__pyx_t_15);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_17, __pyx_t_16, __pyx_t_15);
      }
    }
    __pyx_pybuffernd_rsign.diminfo[0].strides = __pyx_pybuffernd_rsign.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_rsign.diminfo[0].shape = __pyx_pybuffernd_rsign.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 318, __pyx_L1_error)
  }
  __pyx_t_7 = 0;
  __Pyx_DECREF_SET(__pyx_v_rsign, ((PyArrayObject *)__pyx_t_5));
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":319
 * 
 *     rsign = np.random.uniform(0, 1, [p, ])
 *     phi = np.random.uniform(0, 2 * pi, [p, ])             # <<<<<<<<<<<<<<
 *     U = np.random.uniform(0, 1, [p, ])
 *     lambdaa = np.random.uniform(0, 2 * pi, [p, ])
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 319, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_random); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 319, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_uniform); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 319, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyFloat_FromDouble((2.0 * __pyx_v_12libTEXTURIZE_pi)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 319, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 319, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = PyList_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 319, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_3);
  PyList_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_27 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
      __pyx_t_27 = 1;
    }
  }
  __pyx_t_28 = PyTuple_New(3+__pyx_t_27); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 319, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_28);
  if (__pyx_t_3) {
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_28, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_28, 0+__pyx_t_27, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_28, 1+__pyx_t_27, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_28, 2+__pyx_t_27, __pyx_t_6);
  __pyx_t_1 = 0;
  __pyx_t_6 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_28, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 319, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 319, __pyx_L1_error)
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_phi.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phi.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_15, &__pyx_t_16, &__pyx_t_17);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phi.rcbuffer->pybuffer, (PyObject*)__pyx_v_phi, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_15); Py_XDECREF(__pyx_t_16); Py_XDECREF(__pyx_t_17);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_15, __pyx_t_16, __pyx_t_17);
      }
    }
    __pyx_pybuffernd_phi.diminfo[0].strides = __pyx_pybuffernd_phi.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_phi.diminfo[0].shape = __pyx_pybuffernd_phi.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 319, __pyx_L1_error)
  }
  __pyx_t_8 = 0;
  __Pyx_DECREF_SET(__pyx_v_phi, ((PyArrayObject *)__pyx_t_5));
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":320
 *     rsign = np.random.uniform(0, 1, [p, ])
 *     phi = np.random.uniform(0, 2 * pi, [p, ])
 *     U = np.random.uniform(0, 1, [p, ])             # <<<<<<<<<<<<<<
 *     lambdaa = np.random.uniform(0, 2 * pi, [p, ])
 * 
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 320, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_28 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_random); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 320, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_28);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_28, __pyx_n_s_uniform); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 320, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;
  __pyx_t_28 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 320, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_28);
  __pyx_t_6 = PyList_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 320, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_28);
  PyList_SET_ITEM(__pyx_t_6, 0, __pyx_t_28);
  __pyx_t_28 = 0;
  __pyx_t_28 = NULL;
  __pyx_t_27 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_28 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_28)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_28);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
      __pyx_t_27 = 1;
    }
  }
  __pyx_t_1 = PyTuple_New(3+__pyx_t_27); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 320, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (__pyx_t_28) {
    __Pyx_GIVEREF(__pyx_t_28); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_28); __pyx_t_28 = NULL;
  }
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_27, __pyx_int_0);
  __Pyx_INCREF(__pyx_int_1);
  __Pyx_GIVEREF(__pyx_int_1);
  PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_27, __pyx_int_1);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_1, 2+__pyx_t_27, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 320, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 320, __pyx_L1_error)
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_U.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_U.rcbuffer->pybuffer, (PyObject*)__pyx_t_9, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_17, &__pyx_t_16, &__pyx_t_15);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_U.rcbuffer->pybuffer, (PyObject*)__pyx_v_U, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_17); Py_XDECREF(__pyx_t_16); Py_XDECREF(__pyx_t_15);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_17, __pyx_t_16, __pyx_t_15);
      }
    }
    __pyx_pybuffernd_U.diminfo[0].strides = __pyx_pybuffernd_U.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_U.diminfo[0].shape = __pyx_pybuffernd_U.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 320, __pyx_L1_error)
  }
  __pyx_t_9 = 0;
  __Pyx_DECREF_SET(__pyx_v_U, ((PyArrayObject *)__pyx_t_5));
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":321
 *     phi = np.random.uniform(0, 2 * pi, [p, ])
 *     U = np.random.uniform(0, 1, [p, ])
 *     lambdaa = np.random.uniform(0, 2 * pi, [p, ])             # <<<<<<<<<<<<<<
 * 
 *     for k in range(p):
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 321, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_random); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 321, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_uniform); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 321, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyFloat_FromDouble((2.0 * __pyx_v_12libTEXTURIZE_pi)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 321, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 321, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_28 = PyList_New(1); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 321, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_28);
  __Pyx_GIVEREF(__pyx_t_6);
  PyList_SET_ITEM(__pyx_t_28, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  __pyx_t_27 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
      __pyx_t_27 = 1;
    }
  }
  __pyx_t_3 = PyTuple_New(3+__pyx_t_27); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 321, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  if (__pyx_t_6) {
    __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_6); __pyx_t_6 = NULL;
  }
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_27, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_27, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_28);
  PyTuple_SET_ITEM(__pyx_t_3, 2+__pyx_t_27, __pyx_t_28);
  __pyx_t_1 = 0;
  __pyx_t_28 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_3, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 321, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 321, __pyx_L1_error)
  __pyx_t_10 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_lambdaa.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_lambdaa.rcbuffer->pybuffer, (PyObject*)__pyx_t_10, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_15, &__pyx_t_16, &__pyx_t_17);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_lambdaa.rcbuffer->pybuffer, (PyObject*)__pyx_v_lambdaa, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_15); Py_XDECREF(__pyx_t_16); Py_XDECREF(__pyx_t_17);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_15, __pyx_t_16, __pyx_t_17);
      }
    }
    __pyx_pybuffernd_lambdaa.diminfo[0].strides = __pyx_pybuffernd_lambdaa.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_lambdaa.diminfo[0].shape = __pyx_pybuffernd_lambdaa.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 321, __pyx_L1_error)
  }
  __pyx_t_10 = 0;
  __Pyx_DECREF_SET(__pyx_v_lambdaa, ((PyArrayObject *)__pyx_t_5));
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":323
 *     lambdaa = np.random.uniform(0, 2 * pi, [p, ])
 * 
 *     for k in range(p):             # <<<<<<<<<<<<<<
 *         ph = phi[k]
 *         cph = cos(ph)
 */
  __pyx_t_2 = __pyx_v_p;
  for (__pyx_t_29 = 0; __pyx_t_29 < __pyx_t_2; __pyx_t_29+=1) {
    __pyx_v_k = __pyx_t_29;

    /* "libTEXTURIZE.pyx":324
 * 
 *     for k in range(p):
 *         ph = phi[k]             # <<<<<<<<<<<<<<
 *         cph = cos(ph)
 *         sph = sin(ph)
 */
    __pyx_t_30 = __pyx_v_k;
    __pyx_v_ph = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_phi.rcbuffer->pybuffer.buf, __pyx_t_30, __pyx_pybuffernd_phi.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":325
 *     for k in range(p):
 *         ph = phi[k]
 *         cph = cos(ph)             # <<<<<<<<<<<<<<
 *         sph = sin(ph)
 *         u = U[k]
 */
    __pyx_v_cph = cos(__pyx_v_ph);

    /* "libTEXTURIZE.pyx":326
 *         ph = phi[k]
 *         cph = cos(ph)
 *         sph = sin(ph)             # <<<<<<<<<<<<<<
 *         u = U[k]
 *         lm = lambdaa[k]
 */
    __pyx_v_sph = sin(__pyx_v_ph);

    /* "libTEXTURIZE.pyx":327
 *         cph = cos(ph)
 *         sph = sin(ph)
 *         u = U[k]             # <<<<<<<<<<<<<<
 *         lm = lambdaa[k]
 *         squ = sqrt(u)
 */
    __pyx_t_31 = __pyx_v_k;
    __pyx_v_u = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_U.rcbuffer->pybuffer.buf, __pyx_t_31, __pyx_pybuffernd_U.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":328
 *         sph = sin(ph)
 *         u = U[k]
 *         lm = lambdaa[k]             # <<<<<<<<<<<<<<
 *         squ = sqrt(u)
 *         clm = cos(lm)
 */
    __pyx_t_32 = __pyx_v_k;
    __pyx_v_lm = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_lambdaa.rcbuffer->pybuffer.buf, __pyx_t_32, __pyx_pybuffernd_lambdaa.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":329
 *         u = U[k]
 *         lm = lambdaa[k]
 *         squ = sqrt(u)             # <<<<<<<<<<<<<<
 *         clm = cos(lm)
 *         slm = sin(lm)
 */
    __pyx_v_squ = sqrt(__pyx_v_u);

    /* "libTEXTURIZE.pyx":330
 *         lm = lambdaa[k]
 *         squ = sqrt(u)
 *         clm = cos(lm)             # <<<<<<<<<<<<<<
 *         slm = sin(lm)
 * 
 */
    __pyx_v_clm = cos(__pyx_v_lm);

    /* "libTEXTURIZE.pyx":331
 *         squ = sqrt(u)
 *         clm = cos(lm)
 *         slm = sin(lm)             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __pyx_v_slm = sin(__pyx_v_lm);

    /* "libTEXTURIZE.pyx":335
 * 
 *         # ROTAION MATRIX FOR UNIFORM RANDOM ROTATION ABOUT Z AXIS
 *         R[0, 0] = cph             # <<<<<<<<<<<<<<
 *         R[0, 1] = sph
 *         R[0, 2] = 0
 */
    __pyx_t_33 = 0;
    __pyx_t_34 = 0;
    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_R.rcbuffer->pybuffer.buf, __pyx_t_33, __pyx_pybuffernd_R.diminfo[0].strides, __pyx_t_34, __pyx_pybuffernd_R.diminfo[1].strides) = __pyx_v_cph;

    /* "libTEXTURIZE.pyx":336
 *         # ROTAION MATRIX FOR UNIFORM RANDOM ROTATION ABOUT Z AXIS
 *         R[0, 0] = cph
 *         R[0, 1] = sph             # <<<<<<<<<<<<<<
 *         R[0, 2] = 0
 *         R[1, 0] = -sph
 */
    __pyx_t_35 = 0;
    __pyx_t_36 = 1;
    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_R.rcbuffer->pybuffer.buf, __pyx_t_35, __pyx_pybuffernd_R.diminfo[0].strides, __pyx_t_36, __pyx_pybuffernd_R.diminfo[1].strides) = __pyx_v_sph;

    /* "libTEXTURIZE.pyx":337
 *         R[0, 0] = cph
 *         R[0, 1] = sph
 *         R[0, 2] = 0             # <<<<<<<<<<<<<<
 *         R[1, 0] = -sph
 *         R[1, 1] = cph
 */
    __pyx_t_37 = 0;
    __pyx_t_38 = 2;
    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_R.rcbuffer->pybuffer.buf, __pyx_t_37, __pyx_pybuffernd_R.diminfo[0].strides, __pyx_t_38, __pyx_pybuffernd_R.diminfo[1].strides) = 0.0;

    /* "libTEXTURIZE.pyx":338
 *         R[0, 1] = sph
 *         R[0, 2] = 0
 *         R[1, 0] = -sph             # <<<<<<<<<<<<<<
 *         R[1, 1] = cph
 *         R[1, 2] = 0
 */
    __pyx_t_39 = 1;
    __pyx_t_40 = 0;
    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_R.rcbuffer->pybuffer.buf, __pyx_t_39, __pyx_pybuffernd_R.diminfo[0].strides, __pyx_t_40, __pyx_pybuffernd_R.diminfo[1].strides) = (-__pyx_v_sph);

    /* "libTEXTURIZE.pyx":339
 *         R[0, 2] = 0
 *         R[1, 0] = -sph
 *         R[1, 1] = cph             # <<<<<<<<<<<<<<
 *         R[1, 2] = 0
 *         R[2, 0] = 0
 */
    __pyx_t_41 = 1;
    __pyx_t_42 = 1;
    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_R.rcbuffer->pybuffer.buf, __pyx_t_41, __pyx_pybuffernd_R.diminfo[0].strides, __pyx_t_42, __pyx_pybuffernd_R.diminfo[1].strides) = __pyx_v_cph;

    /* "libTEXTURIZE.pyx":340
 *         R[1, 0] = -sph
 *         R[1, 1] = cph
 *         R[1, 2] = 0             # <<<<<<<<<<<<<<
 *         R[2, 0] = 0
 *         R[2, 1] = 0
 */
    __pyx_t_43 = 1;
    __pyx_t_44 = 2;
    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_R.rcbuffer->pybuffer.buf, __pyx_t_43, __pyx_pybuffernd_R.diminfo[0].strides, __pyx_t_44, __pyx_pybuffernd_R.diminfo[1].strides) = 0.0;

    /* "libTEXTURIZE.pyx":341
 *         R[1, 1] = cph
 *         R[1, 2] = 0
 *         R[2, 0] = 0             # <<<<<<<<<<<<<<
 *         R[2, 1] = 0
 *         R[2, 2] = 1
 */
    __pyx_t_45 = 2;
    __pyx_t_46 = 0;
    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_R.rcbuffer->pybuffer.buf, __pyx_t_45, __pyx_pybuffernd_R.diminfo[0].strides, __pyx_t_46, __pyx_pybuffernd_R.diminfo[1].strides) = 0.0;

    /* "libTEXTURIZE.pyx":342
 *         R[1, 2] = 0
 *         R[2, 0] = 0
 *         R[2, 1] = 0             # <<<<<<<<<<<<<<
 *         R[2, 2] = 1
 * 
 */
    __pyx_t_47 = 2;
    __pyx_t_48 = 1;
    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_R.rcbuffer->pybuffer.buf, __pyx_t_47, __pyx_pybuffernd_R.diminfo[0].strides, __pyx_t_48, __pyx_pybuffernd_R.diminfo[1].strides) = 0.0;

    /* "libTEXTURIZE.pyx":343
 *         R[2, 0] = 0
 *         R[2, 1] = 0
 *         R[2, 2] = 1             # <<<<<<<<<<<<<<
 * 
 *         # UNIFORM RANDOM AUXILARY VECTOR
 */
    __pyx_t_49 = 2;
    __pyx_t_50 = 2;
    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_R.rcbuffer->pybuffer.buf, __pyx_t_49, __pyx_pybuffernd_R.diminfo[0].strides, __pyx_t_50, __pyx_pybuffernd_R.diminfo[1].strides) = 1.0;

    /* "libTEXTURIZE.pyx":346
 * 
 *         # UNIFORM RANDOM AUXILARY VECTOR
 *         V[0] = squ * clm             # <<<<<<<<<<<<<<
 *         V[1] = -squ * slm
 *         V[2] = sqrt(1 - u)
 */
    __pyx_t_51 = 0;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V.rcbuffer->pybuffer.buf, __pyx_t_51, __pyx_pybuffernd_V.diminfo[0].strides) = (__pyx_v_squ * __pyx_v_clm);

    /* "libTEXTURIZE.pyx":347
 *         # UNIFORM RANDOM AUXILARY VECTOR
 *         V[0] = squ * clm
 *         V[1] = -squ * slm             # <<<<<<<<<<<<<<
 *         V[2] = sqrt(1 - u)
 *         if rsign[k] < 0.5:
 */
    __pyx_t_52 = 1;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V.rcbuffer->pybuffer.buf, __pyx_t_52, __pyx_pybuffernd_V.diminfo[0].strides) = ((-__pyx_v_squ) * __pyx_v_slm);

    /* "libTEXTURIZE.pyx":348
 *         V[0] = squ * clm
 *         V[1] = -squ * slm
 *         V[2] = sqrt(1 - u)             # <<<<<<<<<<<<<<
 *         if rsign[k] < 0.5:
 *             V[2] = -V[2]
 */
    __pyx_t_53 = 2;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V.rcbuffer->pybuffer.buf, __pyx_t_53, __pyx_pybuffernd_V.diminfo[0].strides) = sqrt((1.0 - __pyx_v_u));

    /* "libTEXTURIZE.pyx":349
 *         V[1] = -squ * slm
 *         V[2] = sqrt(1 - u)
 *         if rsign[k] < 0.5:             # <<<<<<<<<<<<<<
 *             V[2] = -V[2]
 *         else:
 */
    __pyx_t_54 = __pyx_v_k;
    __pyx_t_55 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_rsign.rcbuffer->pybuffer.buf, __pyx_t_54, __pyx_pybuffernd_rsign.diminfo[0].strides)) < 0.5) != 0);
    if (__pyx_t_55) {

      /* "libTEXTURIZE.pyx":350
 *         V[2] = sqrt(1 - u)
 *         if rsign[k] < 0.5:
 *             V[2] = -V[2]             # <<<<<<<<<<<<<<
 *         else:
 *             pass
 */
      __pyx_t_56 = 2;
      __pyx_t_57 = 2;
      *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V.rcbuffer->pybuffer.buf, __pyx_t_57, __pyx_pybuffernd_V.diminfo[0].strides) = (-(*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V.rcbuffer->pybuffer.buf, __pyx_t_56, __pyx_pybuffernd_V.diminfo[0].strides)));

      /* "libTEXTURIZE.pyx":349
 *         V[1] = -squ * slm
 *         V[2] = sqrt(1 - u)
 *         if rsign[k] < 0.5:             # <<<<<<<<<<<<<<
 *             V[2] = -V[2]
 *         else:
 */
      goto __pyx_L5;
    }

    /* "libTEXTURIZE.pyx":352
 *             V[2] = -V[2]
 *         else:
 *             pass             # <<<<<<<<<<<<<<
 * 
 * 
 */
    /*else*/ {
    }
    __pyx_L5:;

    /* "libTEXTURIZE.pyx":356
 * 
 *         # HOUSEHOLDER MATRIX
 *         for i in range(3):             # <<<<<<<<<<<<<<
 *             for j in range(3):
 *                 H[i, j] = EYE[i, j] - 2 * V[i] * V[j]
 */
    for (__pyx_t_58 = 0; __pyx_t_58 < 3; __pyx_t_58+=1) {
      __pyx_v_i = __pyx_t_58;

      /* "libTEXTURIZE.pyx":357
 *         # HOUSEHOLDER MATRIX
 *         for i in range(3):
 *             for j in range(3):             # <<<<<<<<<<<<<<
 *                 H[i, j] = EYE[i, j] - 2 * V[i] * V[j]
 * 
 */
      for (__pyx_t_59 = 0; __pyx_t_59 < 3; __pyx_t_59+=1) {
        __pyx_v_j = __pyx_t_59;

        /* "libTEXTURIZE.pyx":358
 *         for i in range(3):
 *             for j in range(3):
 *                 H[i, j] = EYE[i, j] - 2 * V[i] * V[j]             # <<<<<<<<<<<<<<
 * 
 * 
 */
        __pyx_t_60 = __pyx_v_i;
        __pyx_t_61 = __pyx_v_j;
        __pyx_t_62 = __pyx_v_i;
        __pyx_t_63 = __pyx_v_j;
        __pyx_t_64 = __pyx_v_i;
        __pyx_t_65 = __pyx_v_j;
        *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_H.rcbuffer->pybuffer.buf, __pyx_t_64, __pyx_pybuffernd_H.diminfo[0].strides, __pyx_t_65, __pyx_pybuffernd_H.diminfo[1].strides) = ((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_EYE.rcbuffer->pybuffer.buf, __pyx_t_60, __pyx_pybuffernd_EYE.diminfo[0].strides, __pyx_t_61, __pyx_pybuffernd_EYE.diminfo[1].strides)) - ((2.0 * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V.rcbuffer->pybuffer.buf, __pyx_t_62, __pyx_pybuffernd_V.diminfo[0].strides))) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V.rcbuffer->pybuffer.buf, __pyx_t_63, __pyx_pybuffernd_V.diminfo[0].strides))));
      }
    }

    /* "libTEXTURIZE.pyx":362
 * 
 *         # ROTATION MATRIX
 *         for i in range(3):             # <<<<<<<<<<<<<<
 *             for j in range(3):
 *                 sum = 0
 */
    for (__pyx_t_58 = 0; __pyx_t_58 < 3; __pyx_t_58+=1) {
      __pyx_v_i = __pyx_t_58;

      /* "libTEXTURIZE.pyx":363
 *         # ROTATION MATRIX
 *         for i in range(3):
 *             for j in range(3):             # <<<<<<<<<<<<<<
 *                 sum = 0
 *                 for l in range(3):
 */
      for (__pyx_t_59 = 0; __pyx_t_59 < 3; __pyx_t_59+=1) {
        __pyx_v_j = __pyx_t_59;

        /* "libTEXTURIZE.pyx":364
 *         for i in range(3):
 *             for j in range(3):
 *                 sum = 0             # <<<<<<<<<<<<<<
 *                 for l in range(3):
 *                     sum = sum - H[i, l] * R[l, j]
 */
        __pyx_v_sum = 0.0;

        /* "libTEXTURIZE.pyx":365
 *             for j in range(3):
 *                 sum = 0
 *                 for l in range(3):             # <<<<<<<<<<<<<<
 *                     sum = sum - H[i, l] * R[l, j]
 *                 Rot[k, i, j] = sum
 */
        for (__pyx_t_66 = 0; __pyx_t_66 < 3; __pyx_t_66+=1) {
          __pyx_v_l = __pyx_t_66;

          /* "libTEXTURIZE.pyx":366
 *                 sum = 0
 *                 for l in range(3):
 *                     sum = sum - H[i, l] * R[l, j]             # <<<<<<<<<<<<<<
 *                 Rot[k, i, j] = sum
 * 
 */
          __pyx_t_67 = __pyx_v_i;
          __pyx_t_68 = __pyx_v_l;
          __pyx_t_69 = __pyx_v_l;
          __pyx_t_70 = __pyx_v_j;
          __pyx_v_sum = (__pyx_v_sum - ((*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_H.rcbuffer->pybuffer.buf, __pyx_t_67, __pyx_pybuffernd_H.diminfo[0].strides, __pyx_t_68, __pyx_pybuffernd_H.diminfo[1].strides)) * (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_R.rcbuffer->pybuffer.buf, __pyx_t_69, __pyx_pybuffernd_R.diminfo[0].strides, __pyx_t_70, __pyx_pybuffernd_R.diminfo[1].strides))));
        }

        /* "libTEXTURIZE.pyx":367
 *                 for l in range(3):
 *                     sum = sum - H[i, l] * R[l, j]
 *                 Rot[k, i, j] = sum             # <<<<<<<<<<<<<<
 * 
 *     Eul = conv.rm_to_zxz(Rot)
 */
        __pyx_t_71 = __pyx_v_k;
        __pyx_t_72 = __pyx_v_i;
        __pyx_t_73 = __pyx_v_j;
        *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_71, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_72, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_73, __pyx_pybuffernd_Rot.diminfo[2].strides) = __pyx_v_sum;
      }
    }
  }

  /* "libTEXTURIZE.pyx":369
 *                 Rot[k, i, j] = sum
 * 
 *     Eul = conv.rm_to_zxz(Rot)             # <<<<<<<<<<<<<<
 * 
 *     if makecanvas == 0:
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_conv); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 369, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_rm_to_zxz); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 369, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_3, ((PyObject *)__pyx_v_Rot)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 369, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  } else {
    __pyx_t_28 = PyTuple_New(1+1); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 369, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_28);
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_28, 0, __pyx_t_4); __pyx_t_4 = NULL;
    __Pyx_INCREF(((PyObject *)__pyx_v_Rot));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_Rot));
    PyTuple_SET_ITEM(__pyx_t_28, 0+1, ((PyObject *)__pyx_v_Rot));
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_28, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 369, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 369, __pyx_L1_error)
  __pyx_t_19 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_t_19, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_17, &__pyx_t_16, &__pyx_t_15);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_v_Eul, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_17); Py_XDECREF(__pyx_t_16); Py_XDECREF(__pyx_t_15);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_17, __pyx_t_16, __pyx_t_15);
      }
    }
    __pyx_pybuffernd_Eul.diminfo[0].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Eul.diminfo[0].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Eul.diminfo[1].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Eul.diminfo[1].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[1];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 369, __pyx_L1_error)
  }
  __pyx_t_19 = 0;
  __Pyx_DECREF_SET(__pyx_v_Eul, ((PyArrayObject *)__pyx_t_5));
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":371
 *     Eul = conv.rm_to_zxz(Rot)
 * 
 *     if makecanvas == 0:             # <<<<<<<<<<<<<<
 * 
 *         obj.Eul = Eul
 */
  __pyx_t_55 = ((__pyx_v_makecanvas == 0) != 0);
  if (__pyx_t_55) {

    /* "libTEXTURIZE.pyx":373
 *     if makecanvas == 0:
 * 
 *         obj.Eul = Eul             # <<<<<<<<<<<<<<
 * 
 *     else:
 */
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_Eul, ((PyObject *)__pyx_v_Eul)) < 0) __PYX_ERR(0, 373, __pyx_L1_error)

    /* "libTEXTURIZE.pyx":371
 *     Eul = conv.rm_to_zxz(Rot)
 * 
 *     if makecanvas == 0:             # <<<<<<<<<<<<<<
 * 
 *         obj.Eul = Eul
 */
    goto __pyx_L16;
  }

  /* "libTEXTURIZE.pyx":376
 * 
 *     else:
 *         obj.EUL = getcanvas(m, n, Eul)             # <<<<<<<<<<<<<<
 * 
 *     toc = time.time()
 */
  /*else*/ {
    __pyx_t_5 = __pyx_f_12libTEXTURIZE_getcanvas(__pyx_v_m, __pyx_v_n, ((PyArrayObject *)__pyx_v_Eul)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 376, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_EUL, __pyx_t_5) < 0) __PYX_ERR(0, 376, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }
  __pyx_L16:;

  /* "libTEXTURIZE.pyx":378
 *         obj.EUL = getcanvas(m, n, Eul)
 * 
 *     toc = time.time()             # <<<<<<<<<<<<<<
 *     obj.exetime = toc - tic
 *     return obj
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_time); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 378, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_28 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_time); if (unlikely(!__pyx_t_28)) __PYX_ERR(0, 378, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_28);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_28))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_28);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_28);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_28, function);
    }
  }
  if (__pyx_t_3) {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_28, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 378, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    __pyx_t_5 = __Pyx_PyObject_CallNoArg(__pyx_t_28); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 378, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_28); __pyx_t_28 = 0;
  __pyx_t_26 = __pyx_PyFloat_AsDouble(__pyx_t_5); if (unlikely((__pyx_t_26 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 378, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_toc = __pyx_t_26;

  /* "libTEXTURIZE.pyx":379
 * 
 *     toc = time.time()
 *     obj.exetime = toc - tic             # <<<<<<<<<<<<<<
 *     return obj
 * 
 */
  __pyx_t_5 = PyFloat_FromDouble((__pyx_v_toc - __pyx_v_tic)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 379, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_exetime, __pyx_t_5) < 0) __PYX_ERR(0, 379, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":380
 *     toc = time.time()
 *     obj.exetime = toc - tic
 *     return obj             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_obj);
  __pyx_r = __pyx_v_obj;
  goto __pyx_L0;

  /* "libTEXTURIZE.pyx":283
 * 
 * 
 * def Texture_URO_arvo(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_28);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_EYE.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_H.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Q.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_R.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_U.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_lambdaa.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_phi.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_rsign.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("libTEXTURIZE.Texture_URO_arvo", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_EYE.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_H.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Q.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_R.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_U.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_lambdaa.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_phi.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_rsign.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XDECREF((PyObject *)__pyx_v_rsign);
  __Pyx_XDECREF((PyObject *)__pyx_v_phi);
  __Pyx_XDECREF((PyObject *)__pyx_v_U);
  __Pyx_XDECREF((PyObject *)__pyx_v_lambdaa);
  __Pyx_XDECREF((PyObject *)__pyx_v_V);
  __Pyx_XDECREF((PyObject *)__pyx_v_R);
  __Pyx_XDECREF((PyObject *)__pyx_v_H);
  __Pyx_XDECREF((PyObject *)__pyx_v_EYE);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rot);
  __Pyx_XDECREF((PyObject *)__pyx_v_Eul);
  __Pyx_XDECREF((PyObject *)__pyx_v_Axis);
  __Pyx_XDECREF((PyObject *)__pyx_v_Angle);
  __Pyx_XDECREF((PyObject *)__pyx_v_Nd);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rd);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rv);
  __Pyx_XDECREF((PyObject *)__pyx_v_Q);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "libTEXTURIZE.pyx":383
 * 
 * 
 * def Texture_URO_mack(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */

/* Python wrapper */
static PyObject *__pyx_pw_12libTEXTURIZE_9Texture_URO_mack(PyObject *__pyx_self, PyObject *__pyx_v_obj); /*proto*/
static PyMethodDef __pyx_mdef_12libTEXTURIZE_9Texture_URO_mack = {"Texture_URO_mack", (PyCFunction)__pyx_pw_12libTEXTURIZE_9Texture_URO_mack, METH_O, 0};
static PyObject *__pyx_pw_12libTEXTURIZE_9Texture_URO_mack(PyObject *__pyx_self, PyObject *__pyx_v_obj) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Texture_URO_mack (wrapper)", 0);
  __pyx_r = __pyx_pf_12libTEXTURIZE_8Texture_URO_mack(__pyx_self, ((PyObject *)__pyx_v_obj));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_12libTEXTURIZE_8Texture_URO_mack(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_obj) {
  int __pyx_v_myseed;
  int __pyx_v_p;
  int __pyx_v_m;
  int __pyx_v_n;
  int __pyx_v_makecanvas;
  double __pyx_v_tic;
  double __pyx_v_toc;
  int __pyx_v_k;
  float __pyx_v_x1;
  float __pyx_v_x2;
  float __pyx_v_x3;
  float __pyx_v_v1;
  float __pyx_v_v2;
  float __pyx_v_v3;
  float __pyx_v_S;
  float __pyx_v_T;
  float __pyx_v_P;
  float __pyx_v_SQ;
  PyArrayObject *__pyx_v_X1 = 0;
  PyArrayObject *__pyx_v_X2 = 0;
  PyArrayObject *__pyx_v_X3 = 0;
  PyArrayObject *__pyx_v_V1 = 0;
  PyArrayObject *__pyx_v_V2 = 0;
  PyArrayObject *__pyx_v_V3 = 0;
  PyArrayObject *__pyx_v_EYE = 0;
  PyArrayObject *__pyx_v_Xc = 0;
  PyArrayObject *__pyx_v_Yc = 0;
  PyArrayObject *__pyx_v_Zc = 0;
  PyArrayObject *__pyx_v_Rot = 0;
  PyArrayObject *__pyx_v_Eul = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Axis = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Angle = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Nd = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Rd = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Rv = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Q = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Angle;
  __Pyx_Buffer __pyx_pybuffer_Angle;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Axis;
  __Pyx_Buffer __pyx_pybuffer_Axis;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_EYE;
  __Pyx_Buffer __pyx_pybuffer_EYE;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Eul;
  __Pyx_Buffer __pyx_pybuffer_Eul;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Nd;
  __Pyx_Buffer __pyx_pybuffer_Nd;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Q;
  __Pyx_Buffer __pyx_pybuffer_Q;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rd;
  __Pyx_Buffer __pyx_pybuffer_Rd;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rot;
  __Pyx_Buffer __pyx_pybuffer_Rot;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rv;
  __Pyx_Buffer __pyx_pybuffer_Rv;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_V1;
  __Pyx_Buffer __pyx_pybuffer_V1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_V2;
  __Pyx_Buffer __pyx_pybuffer_V2;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_V3;
  __Pyx_Buffer __pyx_pybuffer_V3;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_X1;
  __Pyx_Buffer __pyx_pybuffer_X1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_X2;
  __Pyx_Buffer __pyx_pybuffer_X2;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_X3;
  __Pyx_Buffer __pyx_pybuffer_X3;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Xc;
  __Pyx_Buffer __pyx_pybuffer_Xc;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Yc;
  __Pyx_Buffer __pyx_pybuffer_Yc;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Zc;
  __Pyx_Buffer __pyx_pybuffer_Zc;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyArrayObject *__pyx_t_7 = NULL;
  PyArrayObject *__pyx_t_8 = NULL;
  PyArrayObject *__pyx_t_9 = NULL;
  PyArrayObject *__pyx_t_10 = NULL;
  PyArrayObject *__pyx_t_11 = NULL;
  PyArrayObject *__pyx_t_12 = NULL;
  PyArrayObject *__pyx_t_13 = NULL;
  PyObject *__pyx_t_14 = NULL;
  PyObject *__pyx_t_15 = NULL;
  PyObject *__pyx_t_16 = NULL;
  PyArrayObject *__pyx_t_17 = NULL;
  PyArrayObject *__pyx_t_18 = NULL;
  PyArrayObject *__pyx_t_19 = NULL;
  PyArrayObject *__pyx_t_20 = NULL;
  PyArrayObject *__pyx_t_21 = NULL;
  PyArrayObject *__pyx_t_22 = NULL;
  PyArrayObject *__pyx_t_23 = NULL;
  PyArrayObject *__pyx_t_24 = NULL;
  PyArrayObject *__pyx_t_25 = NULL;
  PyArrayObject *__pyx_t_26 = NULL;
  PyArrayObject *__pyx_t_27 = NULL;
  double __pyx_t_28;
  Py_ssize_t __pyx_t_29;
  PyObject *__pyx_t_30 = NULL;
  PyObject *(*__pyx_t_31)(PyObject *);
  int __pyx_t_32;
  Py_ssize_t __pyx_t_33;
  Py_ssize_t __pyx_t_34;
  Py_ssize_t __pyx_t_35;
  Py_ssize_t __pyx_t_36;
  Py_ssize_t __pyx_t_37;
  Py_ssize_t __pyx_t_38;
  Py_ssize_t __pyx_t_39;
  Py_ssize_t __pyx_t_40;
  Py_ssize_t __pyx_t_41;
  Py_ssize_t __pyx_t_42;
  Py_ssize_t __pyx_t_43;
  Py_ssize_t __pyx_t_44;
  Py_ssize_t __pyx_t_45;
  Py_ssize_t __pyx_t_46;
  Py_ssize_t __pyx_t_47;
  Py_ssize_t __pyx_t_48;
  Py_ssize_t __pyx_t_49;
  Py_ssize_t __pyx_t_50;
  Py_ssize_t __pyx_t_51;
  Py_ssize_t __pyx_t_52;
  Py_ssize_t __pyx_t_53;
  Py_ssize_t __pyx_t_54;
  Py_ssize_t __pyx_t_55;
  Py_ssize_t __pyx_t_56;
  Py_ssize_t __pyx_t_57;
  Py_ssize_t __pyx_t_58;
  Py_ssize_t __pyx_t_59;
  Py_ssize_t __pyx_t_60;
  Py_ssize_t __pyx_t_61;
  Py_ssize_t __pyx_t_62;
  Py_ssize_t __pyx_t_63;
  Py_ssize_t __pyx_t_64;
  Py_ssize_t __pyx_t_65;
  Py_ssize_t __pyx_t_66;
  Py_ssize_t __pyx_t_67;
  Py_ssize_t __pyx_t_68;
  Py_ssize_t __pyx_t_69;
  Py_ssize_t __pyx_t_70;
  Py_ssize_t __pyx_t_71;
  Py_ssize_t __pyx_t_72;
  Py_ssize_t __pyx_t_73;
  Py_ssize_t __pyx_t_74;
  Py_ssize_t __pyx_t_75;
  Py_ssize_t __pyx_t_76;
  Py_ssize_t __pyx_t_77;
  Py_ssize_t __pyx_t_78;
  Py_ssize_t __pyx_t_79;
  Py_ssize_t __pyx_t_80;
  Py_ssize_t __pyx_t_81;
  Py_ssize_t __pyx_t_82;
  Py_ssize_t __pyx_t_83;
  Py_ssize_t __pyx_t_84;
  Py_ssize_t __pyx_t_85;
  Py_ssize_t __pyx_t_86;
  Py_ssize_t __pyx_t_87;
  Py_ssize_t __pyx_t_88;
  Py_ssize_t __pyx_t_89;
  Py_ssize_t __pyx_t_90;
  Py_ssize_t __pyx_t_91;
  Py_ssize_t __pyx_t_92;
  Py_ssize_t __pyx_t_93;
  Py_ssize_t __pyx_t_94;
  Py_ssize_t __pyx_t_95;
  int __pyx_t_96;
  __Pyx_RefNannySetupContext("Texture_URO_mack", 0);
  __pyx_pybuffer_X1.pybuffer.buf = NULL;
  __pyx_pybuffer_X1.refcount = 0;
  __pyx_pybuffernd_X1.data = NULL;
  __pyx_pybuffernd_X1.rcbuffer = &__pyx_pybuffer_X1;
  __pyx_pybuffer_X2.pybuffer.buf = NULL;
  __pyx_pybuffer_X2.refcount = 0;
  __pyx_pybuffernd_X2.data = NULL;
  __pyx_pybuffernd_X2.rcbuffer = &__pyx_pybuffer_X2;
  __pyx_pybuffer_X3.pybuffer.buf = NULL;
  __pyx_pybuffer_X3.refcount = 0;
  __pyx_pybuffernd_X3.data = NULL;
  __pyx_pybuffernd_X3.rcbuffer = &__pyx_pybuffer_X3;
  __pyx_pybuffer_V1.pybuffer.buf = NULL;
  __pyx_pybuffer_V1.refcount = 0;
  __pyx_pybuffernd_V1.data = NULL;
  __pyx_pybuffernd_V1.rcbuffer = &__pyx_pybuffer_V1;
  __pyx_pybuffer_V2.pybuffer.buf = NULL;
  __pyx_pybuffer_V2.refcount = 0;
  __pyx_pybuffernd_V2.data = NULL;
  __pyx_pybuffernd_V2.rcbuffer = &__pyx_pybuffer_V2;
  __pyx_pybuffer_V3.pybuffer.buf = NULL;
  __pyx_pybuffer_V3.refcount = 0;
  __pyx_pybuffernd_V3.data = NULL;
  __pyx_pybuffernd_V3.rcbuffer = &__pyx_pybuffer_V3;
  __pyx_pybuffer_EYE.pybuffer.buf = NULL;
  __pyx_pybuffer_EYE.refcount = 0;
  __pyx_pybuffernd_EYE.data = NULL;
  __pyx_pybuffernd_EYE.rcbuffer = &__pyx_pybuffer_EYE;
  __pyx_pybuffer_Xc.pybuffer.buf = NULL;
  __pyx_pybuffer_Xc.refcount = 0;
  __pyx_pybuffernd_Xc.data = NULL;
  __pyx_pybuffernd_Xc.rcbuffer = &__pyx_pybuffer_Xc;
  __pyx_pybuffer_Yc.pybuffer.buf = NULL;
  __pyx_pybuffer_Yc.refcount = 0;
  __pyx_pybuffernd_Yc.data = NULL;
  __pyx_pybuffernd_Yc.rcbuffer = &__pyx_pybuffer_Yc;
  __pyx_pybuffer_Zc.pybuffer.buf = NULL;
  __pyx_pybuffer_Zc.refcount = 0;
  __pyx_pybuffernd_Zc.data = NULL;
  __pyx_pybuffernd_Zc.rcbuffer = &__pyx_pybuffer_Zc;
  __pyx_pybuffer_Rot.pybuffer.buf = NULL;
  __pyx_pybuffer_Rot.refcount = 0;
  __pyx_pybuffernd_Rot.data = NULL;
  __pyx_pybuffernd_Rot.rcbuffer = &__pyx_pybuffer_Rot;
  __pyx_pybuffer_Eul.pybuffer.buf = NULL;
  __pyx_pybuffer_Eul.refcount = 0;
  __pyx_pybuffernd_Eul.data = NULL;
  __pyx_pybuffernd_Eul.rcbuffer = &__pyx_pybuffer_Eul;
  __pyx_pybuffer_Axis.pybuffer.buf = NULL;
  __pyx_pybuffer_Axis.refcount = 0;
  __pyx_pybuffernd_Axis.data = NULL;
  __pyx_pybuffernd_Axis.rcbuffer = &__pyx_pybuffer_Axis;
  __pyx_pybuffer_Angle.pybuffer.buf = NULL;
  __pyx_pybuffer_Angle.refcount = 0;
  __pyx_pybuffernd_Angle.data = NULL;
  __pyx_pybuffernd_Angle.rcbuffer = &__pyx_pybuffer_Angle;
  __pyx_pybuffer_Nd.pybuffer.buf = NULL;
  __pyx_pybuffer_Nd.refcount = 0;
  __pyx_pybuffernd_Nd.data = NULL;
  __pyx_pybuffernd_Nd.rcbuffer = &__pyx_pybuffer_Nd;
  __pyx_pybuffer_Rd.pybuffer.buf = NULL;
  __pyx_pybuffer_Rd.refcount = 0;
  __pyx_pybuffernd_Rd.data = NULL;
  __pyx_pybuffernd_Rd.rcbuffer = &__pyx_pybuffer_Rd;
  __pyx_pybuffer_Rv.pybuffer.buf = NULL;
  __pyx_pybuffer_Rv.refcount = 0;
  __pyx_pybuffernd_Rv.data = NULL;
  __pyx_pybuffernd_Rv.rcbuffer = &__pyx_pybuffer_Rv;
  __pyx_pybuffer_Q.pybuffer.buf = NULL;
  __pyx_pybuffer_Q.refcount = 0;
  __pyx_pybuffernd_Q.data = NULL;
  __pyx_pybuffernd_Q.rcbuffer = &__pyx_pybuffer_Q;

  /* "libTEXTURIZE.pyx":384
 * 
 * def Texture_URO_mack(obj):
 *     cdef int myseed = obj.myseed             # <<<<<<<<<<<<<<
 *     cdef int p = obj.p
 *     cdef int m = obj.m
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_myseed); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 384, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 384, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_myseed = __pyx_t_2;

  /* "libTEXTURIZE.pyx":385
 * def Texture_URO_mack(obj):
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p             # <<<<<<<<<<<<<<
 *     cdef int m = obj.m
 *     cdef int n = obj.n
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 385, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 385, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_p = __pyx_t_2;

  /* "libTEXTURIZE.pyx":386
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 *     cdef int m = obj.m             # <<<<<<<<<<<<<<
 *     cdef int n = obj.n
 *     cdef int makecanvas = obj.makecanvas
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_m); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 386, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 386, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_m = __pyx_t_2;

  /* "libTEXTURIZE.pyx":387
 *     cdef int p = obj.p
 *     cdef int m = obj.m
 *     cdef int n = obj.n             # <<<<<<<<<<<<<<
 *     cdef int makecanvas = obj.makecanvas
 *     cdef double tic, toc
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 387, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 387, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_n = __pyx_t_2;

  /* "libTEXTURIZE.pyx":388
 *     cdef int m = obj.m
 *     cdef int n = obj.n
 *     cdef int makecanvas = obj.makecanvas             # <<<<<<<<<<<<<<
 *     cdef double tic, toc
 * 
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_makecanvas); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 388, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 388, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_makecanvas = __pyx_t_2;

  /* "libTEXTURIZE.pyx":393
 *     cdef int k
 *     cdef float x1, x2, x3, v1, v2, v3, S, T, P, SQ
 *     cdef np.ndarray[np.float64_t, ndim = 1] X1 = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] X2 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3 = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 393, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 393, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 393, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 393, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 393, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 393, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 393, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 393, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 393, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 393, __pyx_L1_error)
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_X1.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_X1 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_X1.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 393, __pyx_L1_error)
    } else {__pyx_pybuffernd_X1.diminfo[0].strides = __pyx_pybuffernd_X1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_X1.diminfo[0].shape = __pyx_pybuffernd_X1.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_X1 = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":394
 *     cdef float x1, x2, x3, v1, v2, v3, S, T, P, SQ
 *     cdef np.ndarray[np.float64_t, ndim = 1] X1 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X2 = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 394, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 394, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 394, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 394, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 394, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 394, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 394, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 394, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 394, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 394, __pyx_L1_error)
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_X2.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_X2 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_X2.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 394, __pyx_L1_error)
    } else {__pyx_pybuffernd_X2.diminfo[0].strides = __pyx_pybuffernd_X2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_X2.diminfo[0].shape = __pyx_pybuffernd_X2.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_8 = 0;
  __pyx_v_X2 = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":395
 *     cdef np.ndarray[np.float64_t, ndim = 1] X1 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X2 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3 = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 395, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 395, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 395, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 395, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 395, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 395, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 395, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 395, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 395, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 395, __pyx_L1_error)
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_X3.rcbuffer->pybuffer, (PyObject*)__pyx_t_9, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_X3 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_X3.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 395, __pyx_L1_error)
    } else {__pyx_pybuffernd_X3.diminfo[0].strides = __pyx_pybuffernd_X3.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_X3.diminfo[0].shape = __pyx_pybuffernd_X3.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_9 = 0;
  __pyx_v_X3 = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":396
 *     cdef np.ndarray[np.float64_t, ndim = 1] X2 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V3 = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 396, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 396, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 396, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 396, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 396, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 396, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 396, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 396, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 396, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 396, __pyx_L1_error)
  __pyx_t_10 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_V1.rcbuffer->pybuffer, (PyObject*)__pyx_t_10, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_V1 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_V1.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 396, __pyx_L1_error)
    } else {__pyx_pybuffernd_V1.diminfo[0].strides = __pyx_pybuffernd_V1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_V1.diminfo[0].shape = __pyx_pybuffernd_V1.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_10 = 0;
  __pyx_v_V1 = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":397
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] V3 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] EYE = np.zeros((3, 3), dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 397, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 397, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 397, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 397, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 397, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 397, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 397, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 397, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 397, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 397, __pyx_L1_error)
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_V2.rcbuffer->pybuffer, (PyObject*)__pyx_t_11, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_V2 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_V2.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 397, __pyx_L1_error)
    } else {__pyx_pybuffernd_V2.diminfo[0].strides = __pyx_pybuffernd_V2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_V2.diminfo[0].shape = __pyx_pybuffernd_V2.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_11 = 0;
  __pyx_v_V2 = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":398
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V3 = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] EYE = np.zeros((3, 3), dtype=np.float64)
 *     EYE = np.eye(3)
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 398, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 398, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 398, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 398, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 398, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 398, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 398, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 398, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 398, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 398, __pyx_L1_error)
  __pyx_t_12 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_V3.rcbuffer->pybuffer, (PyObject*)__pyx_t_12, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_V3 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_V3.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 398, __pyx_L1_error)
    } else {__pyx_pybuffernd_V3.diminfo[0].strides = __pyx_pybuffernd_V3.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_V3.diminfo[0].shape = __pyx_pybuffernd_V3.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_12 = 0;
  __pyx_v_V3 = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":399
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V3 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] EYE = np.zeros((3, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     EYE = np.eye(3)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 399, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 399, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 399, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 399, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 399, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 399, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__21, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 399, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 399, __pyx_L1_error)
  __pyx_t_13 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_EYE.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_EYE = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_EYE.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 399, __pyx_L1_error)
    } else {__pyx_pybuffernd_EYE.diminfo[0].strides = __pyx_pybuffernd_EYE.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_EYE.diminfo[0].shape = __pyx_pybuffernd_EYE.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_EYE.diminfo[1].strides = __pyx_pybuffernd_EYE.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_EYE.diminfo[1].shape = __pyx_pybuffernd_EYE.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_13 = 0;
  __pyx_v_EYE = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":400
 *     cdef np.ndarray[np.float64_t, ndim = 1] V3 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] EYE = np.zeros((3, 3), dtype=np.float64)
 *     EYE = np.eye(3)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 400, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_eye); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 400, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__22, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 400, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 400, __pyx_L1_error)
  __pyx_t_13 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_EYE.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_EYE.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_14, &__pyx_t_15, &__pyx_t_16);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_EYE.rcbuffer->pybuffer, (PyObject*)__pyx_v_EYE, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_14); Py_XDECREF(__pyx_t_15); Py_XDECREF(__pyx_t_16);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_14, __pyx_t_15, __pyx_t_16);
      }
    }
    __pyx_pybuffernd_EYE.diminfo[0].strides = __pyx_pybuffernd_EYE.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_EYE.diminfo[0].shape = __pyx_pybuffernd_EYE.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_EYE.diminfo[1].strides = __pyx_pybuffernd_EYE.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_EYE.diminfo[1].shape = __pyx_pybuffernd_EYE.rcbuffer->pybuffer.shape[1];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 400, __pyx_L1_error)
  }
  __pyx_t_13 = 0;
  __Pyx_DECREF_SET(__pyx_v_EYE, ((PyArrayObject *)__pyx_t_1));
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":401
 *     cdef np.ndarray[np.float64_t, ndim = 2] EYE = np.zeros((3, 3), dtype=np.float64)
 *     EYE = np.eye(3)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zc = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 401, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 401, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 401, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 401, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 401, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 401, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 401, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 401, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 401, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 401, __pyx_L1_error)
  __pyx_t_17 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Xc.rcbuffer->pybuffer, (PyObject*)__pyx_t_17, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Xc = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 401, __pyx_L1_error)
    } else {__pyx_pybuffernd_Xc.diminfo[0].strides = __pyx_pybuffernd_Xc.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Xc.diminfo[0].shape = __pyx_pybuffernd_Xc.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_17 = 0;
  __pyx_v_Xc = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":402
 *     EYE = np.eye(3)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zc = np.zeros(p, dtype=np.float64)
 * 
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 402, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 402, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 402, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 402, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 402, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 402, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 402, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 402, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 402, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 402, __pyx_L1_error)
  __pyx_t_18 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Yc.rcbuffer->pybuffer, (PyObject*)__pyx_t_18, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Yc = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 402, __pyx_L1_error)
    } else {__pyx_pybuffernd_Yc.diminfo[0].strides = __pyx_pybuffernd_Yc.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Yc.diminfo[0].shape = __pyx_pybuffernd_Yc.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_18 = 0;
  __pyx_v_Yc = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":403
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zc = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 * 
 *     # DESCRIPTORS OF ORIENTATIONS
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 403, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 403, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 403, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 403, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 403, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 403, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 403, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 403, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 403, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 403, __pyx_L1_error)
  __pyx_t_19 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Zc.rcbuffer->pybuffer, (PyObject*)__pyx_t_19, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Zc = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Zc.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 403, __pyx_L1_error)
    } else {__pyx_pybuffernd_Zc.diminfo[0].strides = __pyx_pybuffernd_Zc.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Zc.diminfo[0].shape = __pyx_pybuffernd_Zc.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_19 = 0;
  __pyx_v_Zc = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":406
 * 
 *     # DESCRIPTORS OF ORIENTATIONS
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 406, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 406, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 406, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = PyTuple_New(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 406, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_int_3);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_int_3);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 406, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 406, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 406, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 406, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 406, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 406, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 406, __pyx_L1_error)
  __pyx_t_20 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer, (PyObject*)__pyx_t_20, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 3, 0, __pyx_stack) == -1)) {
      __pyx_v_Rot = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 406, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rot.diminfo[0].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rot.diminfo[0].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rot.diminfo[1].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rot.diminfo[1].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_Rot.diminfo[2].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_Rot.diminfo[2].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[2];
    }
  }
  __pyx_t_20 = 0;
  __pyx_v_Rot = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":407
 *     # DESCRIPTORS OF ORIENTATIONS
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 407, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 407, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 407, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 407, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_int_3);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 407, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 407, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 407, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 407, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 407, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 407, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 407, __pyx_L1_error)
  __pyx_t_21 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_t_21, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Eul = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Eul.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 407, __pyx_L1_error)
    } else {__pyx_pybuffernd_Eul.diminfo[0].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Eul.diminfo[0].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Eul.diminfo[1].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Eul.diminfo[1].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_21 = 0;
  __pyx_v_Eul = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":408
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 408, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 408, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 408, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 408, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 408, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 408, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 408, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 408, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 408, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 408, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 408, __pyx_L1_error)
  __pyx_t_22 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer, (PyObject*)__pyx_t_22, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Axis = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Axis.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 408, __pyx_L1_error)
    } else {__pyx_pybuffernd_Axis.diminfo[0].strides = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Axis.diminfo[0].shape = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Axis.diminfo[1].strides = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Axis.diminfo[1].shape = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_22 = 0;
  __pyx_v_Axis = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":409
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 409, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 409, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 409, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 409, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 409, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 409, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 409, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 409, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 409, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 409, __pyx_L1_error)
  __pyx_t_23 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer, (PyObject*)__pyx_t_23, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Angle = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Angle.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 409, __pyx_L1_error)
    } else {__pyx_pybuffernd_Angle.diminfo[0].strides = __pyx_pybuffernd_Angle.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Angle.diminfo[0].shape = __pyx_pybuffernd_Angle.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_23 = 0;
  __pyx_v_Angle = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":410
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 410, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 410, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 410, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 410, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_6);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_3);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 410, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 410, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 410, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 410, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 410, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 410, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 410, __pyx_L1_error)
  __pyx_t_24 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer, (PyObject*)__pyx_t_24, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Nd = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Nd.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 410, __pyx_L1_error)
    } else {__pyx_pybuffernd_Nd.diminfo[0].strides = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Nd.diminfo[0].shape = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Nd.diminfo[1].strides = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Nd.diminfo[1].shape = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_24 = 0;
  __pyx_v_Nd = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":411
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 411, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 411, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 411, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 411, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_int_3);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 411, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 411, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 411, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 411, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 411, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 411, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 411, __pyx_L1_error)
  __pyx_t_25 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer, (PyObject*)__pyx_t_25, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Rd = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rd.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 411, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rd.diminfo[0].strides = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rd.diminfo[0].shape = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rd.diminfo[1].strides = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rd.diminfo[1].shape = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_25 = 0;
  __pyx_v_Rd = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":412
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)
 * 
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 412, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 412, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 412, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 412, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_int_3);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 412, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 412, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 412, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 412, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 412, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 412, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 412, __pyx_L1_error)
  __pyx_t_26 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer, (PyObject*)__pyx_t_26, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Rv = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rv.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 412, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rv.diminfo[0].strides = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rv.diminfo[0].shape = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rv.diminfo[1].strides = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rv.diminfo[1].shape = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_26 = 0;
  __pyx_v_Rv = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":413
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 413, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 413, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 413, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 413, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
  __Pyx_INCREF(__pyx_int_4);
  __Pyx_GIVEREF(__pyx_int_4);
  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 413, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 413, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 413, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 413, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 413, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 413, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 413, __pyx_L1_error)
  __pyx_t_27 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Q.rcbuffer->pybuffer, (PyObject*)__pyx_t_27, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Q = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Q.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 413, __pyx_L1_error)
    } else {__pyx_pybuffernd_Q.diminfo[0].strides = __pyx_pybuffernd_Q.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Q.diminfo[0].shape = __pyx_pybuffernd_Q.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Q.diminfo[1].strides = __pyx_pybuffernd_Q.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Q.diminfo[1].shape = __pyx_pybuffernd_Q.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_27 = 0;
  __pyx_v_Q = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":416
 * 
 * 
 *     plantseed(myseed)             # <<<<<<<<<<<<<<
 *     tic = time.time()
 * 
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_plantseed); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 416, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_myseed); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 416, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 416, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_GOTREF(__pyx_t_3);
  } else {
    __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 416, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5); __pyx_t_5 = NULL;
    __Pyx_GIVEREF(__pyx_t_4);
    PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_t_4);
    __pyx_t_4 = 0;
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 416, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":417
 * 
 *     plantseed(myseed)
 *     tic = time.time()             # <<<<<<<<<<<<<<
 * 
 *     X1, X2, X3 = np.random.multivariate_normal([0, 0, 0], EYE, p).T
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_time); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 417, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_time); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 417, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
    }
  }
  if (__pyx_t_1) {
    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 417, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    __pyx_t_3 = __Pyx_PyObject_CallNoArg(__pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 417, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_28 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_28 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 417, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_tic = __pyx_t_28;

  /* "libTEXTURIZE.pyx":419
 *     tic = time.time()
 * 
 *     X1, X2, X3 = np.random.multivariate_normal([0, 0, 0], EYE, p).T             # <<<<<<<<<<<<<<
 *     V1, V2, V3 = np.random.multivariate_normal([0, 0, 0], EYE, p).T
 * 
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 419, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_random); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 419, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_multivariate_normal); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 419, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyList_New(3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 419, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_int_0);
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyList_SET_ITEM(__pyx_t_1, 1, __pyx_int_0);
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyList_SET_ITEM(__pyx_t_1, 2, __pyx_int_0);
  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 419, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = NULL;
  __pyx_t_29 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
      __pyx_t_29 = 1;
    }
  }
  __pyx_t_30 = PyTuple_New(3+__pyx_t_29); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 419, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_30);
  if (__pyx_t_5) {
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_30, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_30, 0+__pyx_t_29, __pyx_t_1);
  __Pyx_INCREF(((PyObject *)__pyx_v_EYE));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_EYE));
  PyTuple_SET_ITEM(__pyx_t_30, 1+__pyx_t_29, ((PyObject *)__pyx_v_EYE));
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_30, 2+__pyx_t_29, __pyx_t_4);
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_30, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 419, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_30); __pyx_t_30 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_T); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 419, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if ((likely(PyTuple_CheckExact(__pyx_t_6))) || (PyList_CheckExact(__pyx_t_6))) {
    PyObject* sequence = __pyx_t_6;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = PySequence_Size(sequence);
    #endif
    if (unlikely(size != 3)) {
      if (size > 3) __Pyx_RaiseTooManyValuesError(3);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 419, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
      __pyx_t_30 = PyTuple_GET_ITEM(sequence, 1); 
      __pyx_t_4 = PyTuple_GET_ITEM(sequence, 2); 
    } else {
      __pyx_t_3 = PyList_GET_ITEM(sequence, 0); 
      __pyx_t_30 = PyList_GET_ITEM(sequence, 1); 
      __pyx_t_4 = PyList_GET_ITEM(sequence, 2); 
    }
    __Pyx_INCREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_t_30);
    __Pyx_INCREF(__pyx_t_4);
    #else
    __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 419, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_30 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 419, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_30);
    __pyx_t_4 = PySequence_ITEM(sequence, 2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 419, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    #endif
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_1 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 419, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_31 = Py_TYPE(__pyx_t_1)->tp_iternext;
    index = 0; __pyx_t_3 = __pyx_t_31(__pyx_t_1); if (unlikely(!__pyx_t_3)) goto __pyx_L3_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_3);
    index = 1; __pyx_t_30 = __pyx_t_31(__pyx_t_1); if (unlikely(!__pyx_t_30)) goto __pyx_L3_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_30);
    index = 2; __pyx_t_4 = __pyx_t_31(__pyx_t_1); if (unlikely(!__pyx_t_4)) goto __pyx_L3_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_4);
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_31(__pyx_t_1), 3) < 0) __PYX_ERR(0, 419, __pyx_L1_error)
    __pyx_t_31 = NULL;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L4_unpacking_done;
    __pyx_L3_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_31 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 419, __pyx_L1_error)
    __pyx_L4_unpacking_done:;
  }
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 419, __pyx_L1_error)
  if (!(likely(((__pyx_t_30) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_30, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 419, __pyx_L1_error)
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 419, __pyx_L1_error)
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X1.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_X1.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_16, &__pyx_t_15, &__pyx_t_14);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_X1.rcbuffer->pybuffer, (PyObject*)__pyx_v_X1, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_16); Py_XDECREF(__pyx_t_15); Py_XDECREF(__pyx_t_14);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_16, __pyx_t_15, __pyx_t_14);
      }
    }
    __pyx_pybuffernd_X1.diminfo[0].strides = __pyx_pybuffernd_X1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_X1.diminfo[0].shape = __pyx_pybuffernd_X1.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 419, __pyx_L1_error)
  }
  __pyx_t_7 = 0;
  __Pyx_DECREF_SET(__pyx_v_X1, ((PyArrayObject *)__pyx_t_3));
  __pyx_t_3 = 0;
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_30);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X2.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_X2.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_14, &__pyx_t_15, &__pyx_t_16);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_X2.rcbuffer->pybuffer, (PyObject*)__pyx_v_X2, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_14); Py_XDECREF(__pyx_t_15); Py_XDECREF(__pyx_t_16);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_14, __pyx_t_15, __pyx_t_16);
      }
    }
    __pyx_pybuffernd_X2.diminfo[0].strides = __pyx_pybuffernd_X2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_X2.diminfo[0].shape = __pyx_pybuffernd_X2.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 419, __pyx_L1_error)
  }
  __pyx_t_8 = 0;
  __Pyx_DECREF_SET(__pyx_v_X2, ((PyArrayObject *)__pyx_t_30));
  __pyx_t_30 = 0;
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X3.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_X3.rcbuffer->pybuffer, (PyObject*)__pyx_t_9, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_16, &__pyx_t_15, &__pyx_t_14);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_X3.rcbuffer->pybuffer, (PyObject*)__pyx_v_X3, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_16); Py_XDECREF(__pyx_t_15); Py_XDECREF(__pyx_t_14);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_16, __pyx_t_15, __pyx_t_14);
      }
    }
    __pyx_pybuffernd_X3.diminfo[0].strides = __pyx_pybuffernd_X3.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_X3.diminfo[0].shape = __pyx_pybuffernd_X3.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 419, __pyx_L1_error)
  }
  __pyx_t_9 = 0;
  __Pyx_DECREF_SET(__pyx_v_X3, ((PyArrayObject *)__pyx_t_4));
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":420
 * 
 *     X1, X2, X3 = np.random.multivariate_normal([0, 0, 0], EYE, p).T
 *     V1, V2, V3 = np.random.multivariate_normal([0, 0, 0], EYE, p).T             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 420, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_30 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_random); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 420, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_30);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_30, __pyx_n_s_multivariate_normal); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 420, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_30); __pyx_t_30 = 0;
  __pyx_t_30 = PyList_New(3); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 420, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_30);
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyList_SET_ITEM(__pyx_t_30, 0, __pyx_int_0);
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyList_SET_ITEM(__pyx_t_30, 1, __pyx_int_0);
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyList_SET_ITEM(__pyx_t_30, 2, __pyx_int_0);
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 420, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = NULL;
  __pyx_t_29 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
      __pyx_t_29 = 1;
    }
  }
  __pyx_t_5 = PyTuple_New(3+__pyx_t_29); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 420, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__pyx_t_1) {
    __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1); __pyx_t_1 = NULL;
  }
  __Pyx_GIVEREF(__pyx_t_30);
  PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_29, __pyx_t_30);
  __Pyx_INCREF(((PyObject *)__pyx_v_EYE));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_EYE));
  PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_29, ((PyObject *)__pyx_v_EYE));
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_5, 2+__pyx_t_29, __pyx_t_3);
  __pyx_t_30 = 0;
  __pyx_t_3 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_5, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 420, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_T); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 420, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if ((likely(PyTuple_CheckExact(__pyx_t_4))) || (PyList_CheckExact(__pyx_t_4))) {
    PyObject* sequence = __pyx_t_4;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = PySequence_Size(sequence);
    #endif
    if (unlikely(size != 3)) {
      if (size > 3) __Pyx_RaiseTooManyValuesError(3);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 420, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_6 = PyTuple_GET_ITEM(sequence, 0); 
      __pyx_t_5 = PyTuple_GET_ITEM(sequence, 1); 
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 2); 
    } else {
      __pyx_t_6 = PyList_GET_ITEM(sequence, 0); 
      __pyx_t_5 = PyList_GET_ITEM(sequence, 1); 
      __pyx_t_3 = PyList_GET_ITEM(sequence, 2); 
    }
    __Pyx_INCREF(__pyx_t_6);
    __Pyx_INCREF(__pyx_t_5);
    __Pyx_INCREF(__pyx_t_3);
    #else
    __pyx_t_6 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 420, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __pyx_t_5 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 420, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_3 = PySequence_ITEM(sequence, 2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 420, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    #endif
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_30 = PyObject_GetIter(__pyx_t_4); if (unlikely(!__pyx_t_30)) __PYX_ERR(0, 420, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_30);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_31 = Py_TYPE(__pyx_t_30)->tp_iternext;
    index = 0; __pyx_t_6 = __pyx_t_31(__pyx_t_30); if (unlikely(!__pyx_t_6)) goto __pyx_L5_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_6);
    index = 1; __pyx_t_5 = __pyx_t_31(__pyx_t_30); if (unlikely(!__pyx_t_5)) goto __pyx_L5_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_5);
    index = 2; __pyx_t_3 = __pyx_t_31(__pyx_t_30); if (unlikely(!__pyx_t_3)) goto __pyx_L5_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_3);
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_31(__pyx_t_30), 3) < 0) __PYX_ERR(0, 420, __pyx_L1_error)
    __pyx_t_31 = NULL;
    __Pyx_DECREF(__pyx_t_30); __pyx_t_30 = 0;
    goto __pyx_L6_unpacking_done;
    __pyx_L5_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_30); __pyx_t_30 = 0;
    __pyx_t_31 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 420, __pyx_L1_error)
    __pyx_L6_unpacking_done:;
  }
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 420, __pyx_L1_error)
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 420, __pyx_L1_error)
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 420, __pyx_L1_error)
  __pyx_t_10 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V1.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_V1.rcbuffer->pybuffer, (PyObject*)__pyx_t_10, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_14, &__pyx_t_15, &__pyx_t_16);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_V1.rcbuffer->pybuffer, (PyObject*)__pyx_v_V1, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_14); Py_XDECREF(__pyx_t_15); Py_XDECREF(__pyx_t_16);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_14, __pyx_t_15, __pyx_t_16);
      }
    }
    __pyx_pybuffernd_V1.diminfo[0].strides = __pyx_pybuffernd_V1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_V1.diminfo[0].shape = __pyx_pybuffernd_V1.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 420, __pyx_L1_error)
  }
  __pyx_t_10 = 0;
  __Pyx_DECREF_SET(__pyx_v_V1, ((PyArrayObject *)__pyx_t_6));
  __pyx_t_6 = 0;
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V2.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_V2.rcbuffer->pybuffer, (PyObject*)__pyx_t_11, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_16, &__pyx_t_15, &__pyx_t_14);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_V2.rcbuffer->pybuffer, (PyObject*)__pyx_v_V2, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_16); Py_XDECREF(__pyx_t_15); Py_XDECREF(__pyx_t_14);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_16, __pyx_t_15, __pyx_t_14);
      }
    }
    __pyx_pybuffernd_V2.diminfo[0].strides = __pyx_pybuffernd_V2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_V2.diminfo[0].shape = __pyx_pybuffernd_V2.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 420, __pyx_L1_error)
  }
  __pyx_t_11 = 0;
  __Pyx_DECREF_SET(__pyx_v_V2, ((PyArrayObject *)__pyx_t_5));
  __pyx_t_5 = 0;
  __pyx_t_12 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V3.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_V3.rcbuffer->pybuffer, (PyObject*)__pyx_t_12, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_14, &__pyx_t_15, &__pyx_t_16);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_V3.rcbuffer->pybuffer, (PyObject*)__pyx_v_V3, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_14); Py_XDECREF(__pyx_t_15); Py_XDECREF(__pyx_t_16);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_14, __pyx_t_15, __pyx_t_16);
      }
    }
    __pyx_pybuffernd_V3.diminfo[0].strides = __pyx_pybuffernd_V3.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_V3.diminfo[0].shape = __pyx_pybuffernd_V3.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 420, __pyx_L1_error)
  }
  __pyx_t_12 = 0;
  __Pyx_DECREF_SET(__pyx_v_V3, ((PyArrayObject *)__pyx_t_3));
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":423
 * 
 * 
 *     for k in range(p):             # <<<<<<<<<<<<<<
 *         x1 = X1[k]
 *         x2 = X2[k]
 */
  __pyx_t_2 = __pyx_v_p;
  for (__pyx_t_32 = 0; __pyx_t_32 < __pyx_t_2; __pyx_t_32+=1) {
    __pyx_v_k = __pyx_t_32;

    /* "libTEXTURIZE.pyx":424
 * 
 *     for k in range(p):
 *         x1 = X1[k]             # <<<<<<<<<<<<<<
 *         x2 = X2[k]
 *         x3 = X3[k]
 */
    __pyx_t_33 = __pyx_v_k;
    __pyx_v_x1 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1.rcbuffer->pybuffer.buf, __pyx_t_33, __pyx_pybuffernd_X1.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":425
 *     for k in range(p):
 *         x1 = X1[k]
 *         x2 = X2[k]             # <<<<<<<<<<<<<<
 *         x3 = X3[k]
 *         v1 = V1[k]
 */
    __pyx_t_34 = __pyx_v_k;
    __pyx_v_x2 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2.rcbuffer->pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_X2.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":426
 *         x1 = X1[k]
 *         x2 = X2[k]
 *         x3 = X3[k]             # <<<<<<<<<<<<<<
 *         v1 = V1[k]
 *         v2 = V2[k]
 */
    __pyx_t_35 = __pyx_v_k;
    __pyx_v_x3 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3.rcbuffer->pybuffer.buf, __pyx_t_35, __pyx_pybuffernd_X3.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":427
 *         x2 = X2[k]
 *         x3 = X3[k]
 *         v1 = V1[k]             # <<<<<<<<<<<<<<
 *         v2 = V2[k]
 *         v3 = V3[k]
 */
    __pyx_t_36 = __pyx_v_k;
    __pyx_v_v1 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V1.rcbuffer->pybuffer.buf, __pyx_t_36, __pyx_pybuffernd_V1.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":428
 *         x3 = X3[k]
 *         v1 = V1[k]
 *         v2 = V2[k]             # <<<<<<<<<<<<<<
 *         v3 = V3[k]
 *         S = x1 ** 2 + x2 ** 2 + x3 ** 2
 */
    __pyx_t_37 = __pyx_v_k;
    __pyx_v_v2 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V2.rcbuffer->pybuffer.buf, __pyx_t_37, __pyx_pybuffernd_V2.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":429
 *         v1 = V1[k]
 *         v2 = V2[k]
 *         v3 = V3[k]             # <<<<<<<<<<<<<<
 *         S = x1 ** 2 + x2 ** 2 + x3 ** 2
 *         T = v1 ** 2 + v2 ** 2 + v3 ** 2
 */
    __pyx_t_38 = __pyx_v_k;
    __pyx_v_v3 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_V3.rcbuffer->pybuffer.buf, __pyx_t_38, __pyx_pybuffernd_V3.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":430
 *         v2 = V2[k]
 *         v3 = V3[k]
 *         S = x1 ** 2 + x2 ** 2 + x3 ** 2             # <<<<<<<<<<<<<<
 *         T = v1 ** 2 + v2 ** 2 + v3 ** 2
 *         P = x1 * v1 + x2 * v2 + x3 * v3
 */
    __pyx_v_S = ((powf(__pyx_v_x1, 2.0) + powf(__pyx_v_x2, 2.0)) + powf(__pyx_v_x3, 2.0));

    /* "libTEXTURIZE.pyx":431
 *         v3 = V3[k]
 *         S = x1 ** 2 + x2 ** 2 + x3 ** 2
 *         T = v1 ** 2 + v2 ** 2 + v3 ** 2             # <<<<<<<<<<<<<<
 *         P = x1 * v1 + x2 * v2 + x3 * v3
 * 
 */
    __pyx_v_T = ((powf(__pyx_v_v1, 2.0) + powf(__pyx_v_v2, 2.0)) + powf(__pyx_v_v3, 2.0));

    /* "libTEXTURIZE.pyx":432
 *         S = x1 ** 2 + x2 ** 2 + x3 ** 2
 *         T = v1 ** 2 + v2 ** 2 + v3 ** 2
 *         P = x1 * v1 + x2 * v2 + x3 * v3             # <<<<<<<<<<<<<<
 * 
 *         # CRYSTALLOGRAPHIC X AXIS
 */
    __pyx_v_P = (((__pyx_v_x1 * __pyx_v_v1) + (__pyx_v_x2 * __pyx_v_v2)) + (__pyx_v_x3 * __pyx_v_v3));

    /* "libTEXTURIZE.pyx":435
 * 
 *         # CRYSTALLOGRAPHIC X AXIS
 *         Xc[0] = x1 / sqrt(S)             # <<<<<<<<<<<<<<
 *         Xc[1] = x2 / sqrt(S)
 *         Xc[2] = x3 / sqrt(S)
 */
    __pyx_t_39 = 0;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_39, __pyx_pybuffernd_Xc.diminfo[0].strides) = (((double)__pyx_v_x1) / sqrt(__pyx_v_S));

    /* "libTEXTURIZE.pyx":436
 *         # CRYSTALLOGRAPHIC X AXIS
 *         Xc[0] = x1 / sqrt(S)
 *         Xc[1] = x2 / sqrt(S)             # <<<<<<<<<<<<<<
 *         Xc[2] = x3 / sqrt(S)
 * 
 */
    __pyx_t_40 = 1;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_40, __pyx_pybuffernd_Xc.diminfo[0].strides) = (((double)__pyx_v_x2) / sqrt(__pyx_v_S));

    /* "libTEXTURIZE.pyx":437
 *         Xc[0] = x1 / sqrt(S)
 *         Xc[1] = x2 / sqrt(S)
 *         Xc[2] = x3 / sqrt(S)             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __pyx_t_41 = 2;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_41, __pyx_pybuffernd_Xc.diminfo[0].strides) = (((double)__pyx_v_x3) / sqrt(__pyx_v_S));

    /* "libTEXTURIZE.pyx":441
 * 
 *         # CRYSTALLOGRAPHIC Y AXIS
 *         SQ = sqrt(S * (S * T - P ** 2))             # <<<<<<<<<<<<<<
 *         Yc[0] = (S * v1 - P * x1) / SQ
 *         Yc[1] = (S * v2 - P * x2) / SQ
 */
    __pyx_v_SQ = sqrt((__pyx_v_S * ((__pyx_v_S * __pyx_v_T) - powf(__pyx_v_P, 2.0))));

    /* "libTEXTURIZE.pyx":442
 *         # CRYSTALLOGRAPHIC Y AXIS
 *         SQ = sqrt(S * (S * T - P ** 2))
 *         Yc[0] = (S * v1 - P * x1) / SQ             # <<<<<<<<<<<<<<
 *         Yc[1] = (S * v2 - P * x2) / SQ
 *         Yc[2] = (S * v3 - P * x3) / SQ
 */
    __pyx_t_42 = 0;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_42, __pyx_pybuffernd_Yc.diminfo[0].strides) = (((__pyx_v_S * __pyx_v_v1) - (__pyx_v_P * __pyx_v_x1)) / __pyx_v_SQ);

    /* "libTEXTURIZE.pyx":443
 *         SQ = sqrt(S * (S * T - P ** 2))
 *         Yc[0] = (S * v1 - P * x1) / SQ
 *         Yc[1] = (S * v2 - P * x2) / SQ             # <<<<<<<<<<<<<<
 *         Yc[2] = (S * v3 - P * x3) / SQ
 * 
 */
    __pyx_t_43 = 1;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_43, __pyx_pybuffernd_Yc.diminfo[0].strides) = (((__pyx_v_S * __pyx_v_v2) - (__pyx_v_P * __pyx_v_x2)) / __pyx_v_SQ);

    /* "libTEXTURIZE.pyx":444
 *         Yc[0] = (S * v1 - P * x1) / SQ
 *         Yc[1] = (S * v2 - P * x2) / SQ
 *         Yc[2] = (S * v3 - P * x3) / SQ             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __pyx_t_44 = 2;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_44, __pyx_pybuffernd_Yc.diminfo[0].strides) = (((__pyx_v_S * __pyx_v_v3) - (__pyx_v_P * __pyx_v_x3)) / __pyx_v_SQ);

    /* "libTEXTURIZE.pyx":448
 * 
 *         # CRYSTALLOGRAPHIC Z AXIS
 *         Zc[0] = Xc[1] * Yc[2] - Yc[1] * Xc[2]             # <<<<<<<<<<<<<<
 *         Zc[1] = Xc[2] * Yc[0] - Yc[2] * Xc[0]
 *         Zc[2] = Xc[0] * Yc[1] - Yc[0] * Xc[1]
 */
    __pyx_t_45 = 1;
    __pyx_t_46 = 2;
    __pyx_t_47 = 1;
    __pyx_t_48 = 2;
    __pyx_t_49 = 0;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Zc.rcbuffer->pybuffer.buf, __pyx_t_49, __pyx_pybuffernd_Zc.diminfo[0].strides) = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_45, __pyx_pybuffernd_Xc.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_46, __pyx_pybuffernd_Yc.diminfo[0].strides))) - ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_47, __pyx_pybuffernd_Yc.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_48, __pyx_pybuffernd_Xc.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":449
 *         # CRYSTALLOGRAPHIC Z AXIS
 *         Zc[0] = Xc[1] * Yc[2] - Yc[1] * Xc[2]
 *         Zc[1] = Xc[2] * Yc[0] - Yc[2] * Xc[0]             # <<<<<<<<<<<<<<
 *         Zc[2] = Xc[0] * Yc[1] - Yc[0] * Xc[1]
 * 
 */
    __pyx_t_50 = 2;
    __pyx_t_51 = 0;
    __pyx_t_52 = 2;
    __pyx_t_53 = 0;
    __pyx_t_54 = 1;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Zc.rcbuffer->pybuffer.buf, __pyx_t_54, __pyx_pybuffernd_Zc.diminfo[0].strides) = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_50, __pyx_pybuffernd_Xc.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_51, __pyx_pybuffernd_Yc.diminfo[0].strides))) - ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_52, __pyx_pybuffernd_Yc.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_53, __pyx_pybuffernd_Xc.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":450
 *         Zc[0] = Xc[1] * Yc[2] - Yc[1] * Xc[2]
 *         Zc[1] = Xc[2] * Yc[0] - Yc[2] * Xc[0]
 *         Zc[2] = Xc[0] * Yc[1] - Yc[0] * Xc[1]             # <<<<<<<<<<<<<<
 * 
 *         # ROTATION MATRIX
 */
    __pyx_t_55 = 0;
    __pyx_t_56 = 1;
    __pyx_t_57 = 0;
    __pyx_t_58 = 1;
    __pyx_t_59 = 2;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Zc.rcbuffer->pybuffer.buf, __pyx_t_59, __pyx_pybuffernd_Zc.diminfo[0].strides) = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_55, __pyx_pybuffernd_Xc.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_56, __pyx_pybuffernd_Yc.diminfo[0].strides))) - ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_57, __pyx_pybuffernd_Yc.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_58, __pyx_pybuffernd_Xc.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":453
 * 
 *         # ROTATION MATRIX
 *         Rot[k, 0, 0] = Xc[0]             # <<<<<<<<<<<<<<
 *         Rot[k, 0, 1] = Xc[1]
 *         Rot[k, 0, 2] = Xc[2]
 */
    __pyx_t_60 = 0;
    __pyx_t_61 = __pyx_v_k;
    __pyx_t_62 = 0;
    __pyx_t_63 = 0;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_61, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_62, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_63, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_60, __pyx_pybuffernd_Xc.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":454
 *         # ROTATION MATRIX
 *         Rot[k, 0, 0] = Xc[0]
 *         Rot[k, 0, 1] = Xc[1]             # <<<<<<<<<<<<<<
 *         Rot[k, 0, 2] = Xc[2]
 *         Rot[k, 1, 0] = Yc[0]
 */
    __pyx_t_64 = 1;
    __pyx_t_65 = __pyx_v_k;
    __pyx_t_66 = 0;
    __pyx_t_67 = 1;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_65, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_66, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_67, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_64, __pyx_pybuffernd_Xc.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":455
 *         Rot[k, 0, 0] = Xc[0]
 *         Rot[k, 0, 1] = Xc[1]
 *         Rot[k, 0, 2] = Xc[2]             # <<<<<<<<<<<<<<
 *         Rot[k, 1, 0] = Yc[0]
 *         Rot[k, 1, 1] = Yc[1]
 */
    __pyx_t_68 = 2;
    __pyx_t_69 = __pyx_v_k;
    __pyx_t_70 = 0;
    __pyx_t_71 = 2;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_69, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_70, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_71, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf, __pyx_t_68, __pyx_pybuffernd_Xc.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":456
 *         Rot[k, 0, 1] = Xc[1]
 *         Rot[k, 0, 2] = Xc[2]
 *         Rot[k, 1, 0] = Yc[0]             # <<<<<<<<<<<<<<
 *         Rot[k, 1, 1] = Yc[1]
 *         Rot[k, 1, 2] = Yc[2]
 */
    __pyx_t_72 = 0;
    __pyx_t_73 = __pyx_v_k;
    __pyx_t_74 = 1;
    __pyx_t_75 = 0;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_73, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_74, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_75, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_72, __pyx_pybuffernd_Yc.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":457
 *         Rot[k, 0, 2] = Xc[2]
 *         Rot[k, 1, 0] = Yc[0]
 *         Rot[k, 1, 1] = Yc[1]             # <<<<<<<<<<<<<<
 *         Rot[k, 1, 2] = Yc[2]
 *         Rot[k, 2, 0] = Zc[0]
 */
    __pyx_t_76 = 1;
    __pyx_t_77 = __pyx_v_k;
    __pyx_t_78 = 1;
    __pyx_t_79 = 1;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_77, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_78, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_79, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_76, __pyx_pybuffernd_Yc.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":458
 *         Rot[k, 1, 0] = Yc[0]
 *         Rot[k, 1, 1] = Yc[1]
 *         Rot[k, 1, 2] = Yc[2]             # <<<<<<<<<<<<<<
 *         Rot[k, 2, 0] = Zc[0]
 *         Rot[k, 2, 1] = Zc[1]
 */
    __pyx_t_80 = 2;
    __pyx_t_81 = __pyx_v_k;
    __pyx_t_82 = 1;
    __pyx_t_83 = 2;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_81, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_82, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_83, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf, __pyx_t_80, __pyx_pybuffernd_Yc.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":459
 *         Rot[k, 1, 1] = Yc[1]
 *         Rot[k, 1, 2] = Yc[2]
 *         Rot[k, 2, 0] = Zc[0]             # <<<<<<<<<<<<<<
 *         Rot[k, 2, 1] = Zc[1]
 *         Rot[k, 2, 2] = Zc[2]
 */
    __pyx_t_84 = 0;
    __pyx_t_85 = __pyx_v_k;
    __pyx_t_86 = 2;
    __pyx_t_87 = 0;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_85, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_86, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_87, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Zc.rcbuffer->pybuffer.buf, __pyx_t_84, __pyx_pybuffernd_Zc.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":460
 *         Rot[k, 1, 2] = Yc[2]
 *         Rot[k, 2, 0] = Zc[0]
 *         Rot[k, 2, 1] = Zc[1]             # <<<<<<<<<<<<<<
 *         Rot[k, 2, 2] = Zc[2]
 * 
 */
    __pyx_t_88 = 1;
    __pyx_t_89 = __pyx_v_k;
    __pyx_t_90 = 2;
    __pyx_t_91 = 1;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_89, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_90, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_91, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Zc.rcbuffer->pybuffer.buf, __pyx_t_88, __pyx_pybuffernd_Zc.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":461
 *         Rot[k, 2, 0] = Zc[0]
 *         Rot[k, 2, 1] = Zc[1]
 *         Rot[k, 2, 2] = Zc[2]             # <<<<<<<<<<<<<<
 * 
 *     Eul = conv.rm_to_zxz(Rot)
 */
    __pyx_t_92 = 2;
    __pyx_t_93 = __pyx_v_k;
    __pyx_t_94 = 2;
    __pyx_t_95 = 2;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_93, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_94, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_95, __pyx_pybuffernd_Rot.diminfo[2].strides) = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Zc.rcbuffer->pybuffer.buf, __pyx_t_92, __pyx_pybuffernd_Zc.diminfo[0].strides));
  }

  /* "libTEXTURIZE.pyx":463
 *         Rot[k, 2, 2] = Zc[2]
 * 
 *     Eul = conv.rm_to_zxz(Rot)             # <<<<<<<<<<<<<<
 * 
 *     if makecanvas == 0:
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_conv); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 463, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_rm_to_zxz); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 463, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_5, ((PyObject *)__pyx_v_Rot)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 463, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
  } else {
    __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 463, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3); __pyx_t_3 = NULL;
    __Pyx_INCREF(((PyObject *)__pyx_v_Rot));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_Rot));
    PyTuple_SET_ITEM(__pyx_t_6, 0+1, ((PyObject *)__pyx_v_Rot));
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_6, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 463, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 463, __pyx_L1_error)
  __pyx_t_21 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_t_21, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_16, &__pyx_t_15, &__pyx_t_14);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_v_Eul, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_16); Py_XDECREF(__pyx_t_15); Py_XDECREF(__pyx_t_14);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_16, __pyx_t_15, __pyx_t_14);
      }
    }
    __pyx_pybuffernd_Eul.diminfo[0].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Eul.diminfo[0].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Eul.diminfo[1].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Eul.diminfo[1].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[1];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 463, __pyx_L1_error)
  }
  __pyx_t_21 = 0;
  __Pyx_DECREF_SET(__pyx_v_Eul, ((PyArrayObject *)__pyx_t_4));
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":465
 *     Eul = conv.rm_to_zxz(Rot)
 * 
 *     if makecanvas == 0:             # <<<<<<<<<<<<<<
 * 
 *         obj.Eul = Eul
 */
  __pyx_t_96 = ((__pyx_v_makecanvas == 0) != 0);
  if (__pyx_t_96) {

    /* "libTEXTURIZE.pyx":467
 *     if makecanvas == 0:
 * 
 *         obj.Eul = Eul             # <<<<<<<<<<<<<<
 * 
 *     else:
 */
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_Eul, ((PyObject *)__pyx_v_Eul)) < 0) __PYX_ERR(0, 467, __pyx_L1_error)

    /* "libTEXTURIZE.pyx":465
 *     Eul = conv.rm_to_zxz(Rot)
 * 
 *     if makecanvas == 0:             # <<<<<<<<<<<<<<
 * 
 *         obj.Eul = Eul
 */
    goto __pyx_L9;
  }

  /* "libTEXTURIZE.pyx":470
 * 
 *     else:
 *         obj.EUL = getcanvas(m, n, Eul)             # <<<<<<<<<<<<<<
 * 
 *     toc = time.time()
 */
  /*else*/ {
    __pyx_t_4 = __pyx_f_12libTEXTURIZE_getcanvas(__pyx_v_m, __pyx_v_n, ((PyArrayObject *)__pyx_v_Eul)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 470, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_EUL, __pyx_t_4) < 0) __PYX_ERR(0, 470, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __pyx_L9:;

  /* "libTEXTURIZE.pyx":472
 *         obj.EUL = getcanvas(m, n, Eul)
 * 
 *     toc = time.time()             # <<<<<<<<<<<<<<
 *     obj.exetime = toc - tic
 *     return obj
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_time); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 472, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_time); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 472, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
    }
  }
  if (__pyx_t_5) {
    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 472, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  } else {
    __pyx_t_4 = __Pyx_PyObject_CallNoArg(__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 472, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_28 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_28 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 472, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_toc = __pyx_t_28;

  /* "libTEXTURIZE.pyx":473
 * 
 *     toc = time.time()
 *     obj.exetime = toc - tic             # <<<<<<<<<<<<<<
 *     return obj
 * 
 */
  __pyx_t_4 = PyFloat_FromDouble((__pyx_v_toc - __pyx_v_tic)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 473, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_exetime, __pyx_t_4) < 0) __PYX_ERR(0, 473, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":474
 *     toc = time.time()
 *     obj.exetime = toc - tic
 *     return obj             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_obj);
  __pyx_r = __pyx_v_obj;
  goto __pyx_L0;

  /* "libTEXTURIZE.pyx":383
 * 
 * 
 * def Texture_URO_mack(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_30);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_EYE.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Q.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V1.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V2.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V3.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X1.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X2.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X3.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Xc.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Yc.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Zc.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("libTEXTURIZE.Texture_URO_mack", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_EYE.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Q.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V1.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V2.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V3.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X1.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X2.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X3.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Xc.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Yc.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Zc.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XDECREF((PyObject *)__pyx_v_X1);
  __Pyx_XDECREF((PyObject *)__pyx_v_X2);
  __Pyx_XDECREF((PyObject *)__pyx_v_X3);
  __Pyx_XDECREF((PyObject *)__pyx_v_V1);
  __Pyx_XDECREF((PyObject *)__pyx_v_V2);
  __Pyx_XDECREF((PyObject *)__pyx_v_V3);
  __Pyx_XDECREF((PyObject *)__pyx_v_EYE);
  __Pyx_XDECREF((PyObject *)__pyx_v_Xc);
  __Pyx_XDECREF((PyObject *)__pyx_v_Yc);
  __Pyx_XDECREF((PyObject *)__pyx_v_Zc);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rot);
  __Pyx_XDECREF((PyObject *)__pyx_v_Eul);
  __Pyx_XDECREF((PyObject *)__pyx_v_Axis);
  __Pyx_XDECREF((PyObject *)__pyx_v_Angle);
  __Pyx_XDECREF((PyObject *)__pyx_v_Nd);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rd);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rv);
  __Pyx_XDECREF((PyObject *)__pyx_v_Q);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "libTEXTURIZE.pyx":477
 * 
 * 
 * def Texture_URO_sm1(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */

/* Python wrapper */
static PyObject *__pyx_pw_12libTEXTURIZE_11Texture_URO_sm1(PyObject *__pyx_self, PyObject *__pyx_v_obj); /*proto*/
static PyMethodDef __pyx_mdef_12libTEXTURIZE_11Texture_URO_sm1 = {"Texture_URO_sm1", (PyCFunction)__pyx_pw_12libTEXTURIZE_11Texture_URO_sm1, METH_O, 0};
static PyObject *__pyx_pw_12libTEXTURIZE_11Texture_URO_sm1(PyObject *__pyx_self, PyObject *__pyx_v_obj) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Texture_URO_sm1 (wrapper)", 0);
  __pyx_r = __pyx_pf_12libTEXTURIZE_10Texture_URO_sm1(__pyx_self, ((PyObject *)__pyx_v_obj));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_12libTEXTURIZE_10Texture_URO_sm1(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_obj) {
  int __pyx_v_myseed;
  int __pyx_v_p;
  int __pyx_v_m;
  int __pyx_v_n;
  int __pyx_v_makecanvas;
  double __pyx_v_tic;
  double __pyx_v_toc;
  int __pyx_v_k;
  float __pyx_v_u0;
  float __pyx_v_u1;
  float __pyx_v_u2;
  float __pyx_v_c1;
  float __pyx_v_s1;
  float __pyx_v_c2;
  float __pyx_v_s2;
  float __pyx_v_r1;
  float __pyx_v_r2;
  float __pyx_v_gamma1;
  float __pyx_v_gamma2;
  PyArrayObject *__pyx_v_U0 = 0;
  PyArrayObject *__pyx_v_U1 = 0;
  PyArrayObject *__pyx_v_U2 = 0;
  PyArrayObject *__pyx_v_Rot = 0;
  PyArrayObject *__pyx_v_Eul = 0;
  PyArrayObject *__pyx_v_Axis = 0;
  PyArrayObject *__pyx_v_Angle = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Nd = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Rd = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Rv = 0;
  PyArrayObject *__pyx_v_Q = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Angle;
  __Pyx_Buffer __pyx_pybuffer_Angle;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Axis;
  __Pyx_Buffer __pyx_pybuffer_Axis;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Eul;
  __Pyx_Buffer __pyx_pybuffer_Eul;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Nd;
  __Pyx_Buffer __pyx_pybuffer_Nd;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Q;
  __Pyx_Buffer __pyx_pybuffer_Q;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rd;
  __Pyx_Buffer __pyx_pybuffer_Rd;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rot;
  __Pyx_Buffer __pyx_pybuffer_Rot;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rv;
  __Pyx_Buffer __pyx_pybuffer_Rv;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_U0;
  __Pyx_Buffer __pyx_pybuffer_U0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_U1;
  __Pyx_Buffer __pyx_pybuffer_U1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_U2;
  __Pyx_Buffer __pyx_pybuffer_U2;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyArrayObject *__pyx_t_7 = NULL;
  PyArrayObject *__pyx_t_8 = NULL;
  PyArrayObject *__pyx_t_9 = NULL;
  PyArrayObject *__pyx_t_10 = NULL;
  PyArrayObject *__pyx_t_11 = NULL;
  PyArrayObject *__pyx_t_12 = NULL;
  PyArrayObject *__pyx_t_13 = NULL;
  PyArrayObject *__pyx_t_14 = NULL;
  PyArrayObject *__pyx_t_15 = NULL;
  PyArrayObject *__pyx_t_16 = NULL;
  PyArrayObject *__pyx_t_17 = NULL;
  double __pyx_t_18;
  Py_ssize_t __pyx_t_19;
  PyObject *__pyx_t_20 = NULL;
  PyObject *__pyx_t_21 = NULL;
  PyObject *__pyx_t_22 = NULL;
  int __pyx_t_23;
  Py_ssize_t __pyx_t_24;
  Py_ssize_t __pyx_t_25;
  Py_ssize_t __pyx_t_26;
  Py_ssize_t __pyx_t_27;
  Py_ssize_t __pyx_t_28;
  Py_ssize_t __pyx_t_29;
  Py_ssize_t __pyx_t_30;
  Py_ssize_t __pyx_t_31;
  Py_ssize_t __pyx_t_32;
  Py_ssize_t __pyx_t_33;
  Py_ssize_t __pyx_t_34;
  PyObject *(*__pyx_t_35)(PyObject *);
  int __pyx_t_36;
  __Pyx_RefNannySetupContext("Texture_URO_sm1", 0);
  __pyx_pybuffer_U0.pybuffer.buf = NULL;
  __pyx_pybuffer_U0.refcount = 0;
  __pyx_pybuffernd_U0.data = NULL;
  __pyx_pybuffernd_U0.rcbuffer = &__pyx_pybuffer_U0;
  __pyx_pybuffer_U1.pybuffer.buf = NULL;
  __pyx_pybuffer_U1.refcount = 0;
  __pyx_pybuffernd_U1.data = NULL;
  __pyx_pybuffernd_U1.rcbuffer = &__pyx_pybuffer_U1;
  __pyx_pybuffer_U2.pybuffer.buf = NULL;
  __pyx_pybuffer_U2.refcount = 0;
  __pyx_pybuffernd_U2.data = NULL;
  __pyx_pybuffernd_U2.rcbuffer = &__pyx_pybuffer_U2;
  __pyx_pybuffer_Rot.pybuffer.buf = NULL;
  __pyx_pybuffer_Rot.refcount = 0;
  __pyx_pybuffernd_Rot.data = NULL;
  __pyx_pybuffernd_Rot.rcbuffer = &__pyx_pybuffer_Rot;
  __pyx_pybuffer_Eul.pybuffer.buf = NULL;
  __pyx_pybuffer_Eul.refcount = 0;
  __pyx_pybuffernd_Eul.data = NULL;
  __pyx_pybuffernd_Eul.rcbuffer = &__pyx_pybuffer_Eul;
  __pyx_pybuffer_Axis.pybuffer.buf = NULL;
  __pyx_pybuffer_Axis.refcount = 0;
  __pyx_pybuffernd_Axis.data = NULL;
  __pyx_pybuffernd_Axis.rcbuffer = &__pyx_pybuffer_Axis;
  __pyx_pybuffer_Angle.pybuffer.buf = NULL;
  __pyx_pybuffer_Angle.refcount = 0;
  __pyx_pybuffernd_Angle.data = NULL;
  __pyx_pybuffernd_Angle.rcbuffer = &__pyx_pybuffer_Angle;
  __pyx_pybuffer_Nd.pybuffer.buf = NULL;
  __pyx_pybuffer_Nd.refcount = 0;
  __pyx_pybuffernd_Nd.data = NULL;
  __pyx_pybuffernd_Nd.rcbuffer = &__pyx_pybuffer_Nd;
  __pyx_pybuffer_Rd.pybuffer.buf = NULL;
  __pyx_pybuffer_Rd.refcount = 0;
  __pyx_pybuffernd_Rd.data = NULL;
  __pyx_pybuffernd_Rd.rcbuffer = &__pyx_pybuffer_Rd;
  __pyx_pybuffer_Rv.pybuffer.buf = NULL;
  __pyx_pybuffer_Rv.refcount = 0;
  __pyx_pybuffernd_Rv.data = NULL;
  __pyx_pybuffernd_Rv.rcbuffer = &__pyx_pybuffer_Rv;
  __pyx_pybuffer_Q.pybuffer.buf = NULL;
  __pyx_pybuffer_Q.refcount = 0;
  __pyx_pybuffernd_Q.data = NULL;
  __pyx_pybuffernd_Q.rcbuffer = &__pyx_pybuffer_Q;

  /* "libTEXTURIZE.pyx":478
 * 
 * def Texture_URO_sm1(obj):
 *     cdef int myseed = obj.myseed             # <<<<<<<<<<<<<<
 *     cdef int p = obj.p
 *     cdef int m = obj.m
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_myseed); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 478, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 478, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_myseed = __pyx_t_2;

  /* "libTEXTURIZE.pyx":479
 * def Texture_URO_sm1(obj):
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p             # <<<<<<<<<<<<<<
 *     cdef int m = obj.m
 *     cdef int n = obj.n
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 479, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 479, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_p = __pyx_t_2;

  /* "libTEXTURIZE.pyx":480
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 *     cdef int m = obj.m             # <<<<<<<<<<<<<<
 *     cdef int n = obj.n
 *     cdef int makecanvas = obj.makecanvas
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_m); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 480, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 480, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_m = __pyx_t_2;

  /* "libTEXTURIZE.pyx":481
 *     cdef int p = obj.p
 *     cdef int m = obj.m
 *     cdef int n = obj.n             # <<<<<<<<<<<<<<
 *     cdef int makecanvas = obj.makecanvas
 *     cdef double tic, toc
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 481, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 481, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_n = __pyx_t_2;

  /* "libTEXTURIZE.pyx":482
 *     cdef int m = obj.m
 *     cdef int n = obj.n
 *     cdef int makecanvas = obj.makecanvas             # <<<<<<<<<<<<<<
 *     cdef double tic, toc
 * 
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_makecanvas); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 482, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 482, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_makecanvas = __pyx_t_2;

  /* "libTEXTURIZE.pyx":488
 *     cdef float u0, u1, u2, c1, s1, c2, s2, r1, r2, gamma1, gamma2
 * 
 *     cdef np.ndarray[np.float64_t, ndim = 1] U0 = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] U1 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] U2 = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 488, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 488, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 488, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 488, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 488, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 488, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 488, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 488, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 488, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 488, __pyx_L1_error)
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_U0.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_U0 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_U0.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 488, __pyx_L1_error)
    } else {__pyx_pybuffernd_U0.diminfo[0].strides = __pyx_pybuffernd_U0.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_U0.diminfo[0].shape = __pyx_pybuffernd_U0.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_U0 = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":489
 * 
 *     cdef np.ndarray[np.float64_t, ndim = 1] U0 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] U1 = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] U2 = np.zeros(p, dtype=np.float64)
 * 
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 489, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 489, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 489, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 489, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 489, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 489, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 489, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 489, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 489, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 489, __pyx_L1_error)
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_U1.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_U1 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_U1.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 489, __pyx_L1_error)
    } else {__pyx_pybuffernd_U1.diminfo[0].strides = __pyx_pybuffernd_U1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_U1.diminfo[0].shape = __pyx_pybuffernd_U1.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_8 = 0;
  __pyx_v_U1 = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":490
 *     cdef np.ndarray[np.float64_t, ndim = 1] U0 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] U1 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] U2 = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 * 
 *     # DESCRIPTORS OF ORIENTATIONS
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 490, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 490, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 490, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 490, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 490, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 490, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 490, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 490, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 490, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 490, __pyx_L1_error)
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_U2.rcbuffer->pybuffer, (PyObject*)__pyx_t_9, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_U2 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_U2.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 490, __pyx_L1_error)
    } else {__pyx_pybuffernd_U2.diminfo[0].strides = __pyx_pybuffernd_U2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_U2.diminfo[0].shape = __pyx_pybuffernd_U2.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_9 = 0;
  __pyx_v_U2 = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":493
 * 
 *     # DESCRIPTORS OF ORIENTATIONS
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 493, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 493, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 493, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 493, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_3);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_int_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 493, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 493, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 493, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 493, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 493, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 493, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 493, __pyx_L1_error)
  __pyx_t_10 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer, (PyObject*)__pyx_t_10, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
      __pyx_v_Rot = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 493, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rot.diminfo[0].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rot.diminfo[0].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rot.diminfo[1].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rot.diminfo[1].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_Rot.diminfo[2].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_Rot.diminfo[2].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[2];
    }
  }
  __pyx_t_10 = 0;
  __pyx_v_Rot = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":494
 *     # DESCRIPTORS OF ORIENTATIONS
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 494, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 494, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 494, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 494, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_3);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 494, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 494, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 494, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 494, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 494, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 494, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 494, __pyx_L1_error)
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_t_11, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Eul = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Eul.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 494, __pyx_L1_error)
    } else {__pyx_pybuffernd_Eul.diminfo[0].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Eul.diminfo[0].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Eul.diminfo[1].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Eul.diminfo[1].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_11 = 0;
  __pyx_v_Eul = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":495
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 495, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 495, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 495, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 495, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_3);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 495, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 495, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 495, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 495, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 495, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 495, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 495, __pyx_L1_error)
  __pyx_t_12 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer, (PyObject*)__pyx_t_12, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Axis = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Axis.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 495, __pyx_L1_error)
    } else {__pyx_pybuffernd_Axis.diminfo[0].strides = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Axis.diminfo[0].shape = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Axis.diminfo[1].strides = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Axis.diminfo[1].shape = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_12 = 0;
  __pyx_v_Axis = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":496
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 496, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 496, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 496, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 496, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 496, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 496, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 496, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 496, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 496, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 496, __pyx_L1_error)
  __pyx_t_13 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Angle = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Angle.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 496, __pyx_L1_error)
    } else {__pyx_pybuffernd_Angle.diminfo[0].strides = __pyx_pybuffernd_Angle.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Angle.diminfo[0].shape = __pyx_pybuffernd_Angle.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_13 = 0;
  __pyx_v_Angle = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":497
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 497, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 497, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 497, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 497, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_int_3);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 497, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 497, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 497, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 497, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 497, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 497, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 497, __pyx_L1_error)
  __pyx_t_14 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer, (PyObject*)__pyx_t_14, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Nd = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Nd.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 497, __pyx_L1_error)
    } else {__pyx_pybuffernd_Nd.diminfo[0].strides = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Nd.diminfo[0].shape = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Nd.diminfo[1].strides = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Nd.diminfo[1].shape = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_14 = 0;
  __pyx_v_Nd = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":498
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 498, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 498, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 498, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 498, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 498, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 498, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 498, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 498, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 498, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 498, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 498, __pyx_L1_error)
  __pyx_t_15 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer, (PyObject*)__pyx_t_15, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Rd = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rd.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 498, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rd.diminfo[0].strides = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rd.diminfo[0].shape = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rd.diminfo[1].strides = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rd.diminfo[1].shape = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_15 = 0;
  __pyx_v_Rd = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":499
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)
 * 
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 499, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 499, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 499, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 499, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_3);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 499, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 499, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 499, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 499, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 499, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 499, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 499, __pyx_L1_error)
  __pyx_t_16 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer, (PyObject*)__pyx_t_16, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Rv = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rv.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 499, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rv.diminfo[0].strides = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rv.diminfo[0].shape = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rv.diminfo[1].strides = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rv.diminfo[1].shape = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_16 = 0;
  __pyx_v_Rv = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":500
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)             # <<<<<<<<<<<<<<
 * 
 *     plantseed(myseed)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 500, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 500, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 500, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 500, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
  __Pyx_INCREF(__pyx_int_4);
  __Pyx_GIVEREF(__pyx_int_4);
  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_4);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 500, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 500, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 500, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 500, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 500, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 500, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 500, __pyx_L1_error)
  __pyx_t_17 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Q.rcbuffer->pybuffer, (PyObject*)__pyx_t_17, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Q = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Q.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 500, __pyx_L1_error)
    } else {__pyx_pybuffernd_Q.diminfo[0].strides = __pyx_pybuffernd_Q.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Q.diminfo[0].shape = __pyx_pybuffernd_Q.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Q.diminfo[1].strides = __pyx_pybuffernd_Q.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Q.diminfo[1].shape = __pyx_pybuffernd_Q.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_17 = 0;
  __pyx_v_Q = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":502
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)
 * 
 *     plantseed(myseed)             # <<<<<<<<<<<<<<
 *     tic = time.time()
 * 
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_plantseed); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 502, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_myseed); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 502, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 502, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_GOTREF(__pyx_t_6);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 502, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
    __Pyx_GIVEREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 502, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":503
 * 
 *     plantseed(myseed)
 *     tic = time.time()             # <<<<<<<<<<<<<<
 * 
 *     U0 = np.random.uniform(0, 1, [p, ])
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_time); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 503, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_time); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 503, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  if (__pyx_t_1) {
    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 503, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    __pyx_t_6 = __Pyx_PyObject_CallNoArg(__pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 503, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_18 = __pyx_PyFloat_AsDouble(__pyx_t_6); if (unlikely((__pyx_t_18 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 503, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_tic = __pyx_t_18;

  /* "libTEXTURIZE.pyx":505
 *     tic = time.time()
 * 
 *     U0 = np.random.uniform(0, 1, [p, ])             # <<<<<<<<<<<<<<
 *     U1 = np.random.uniform(0, 1, [p, ])
 *     U2 = np.random.uniform(0, 1, [p, ])
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 505, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_random); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 505, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_uniform); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 505, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 505, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = PyList_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 505, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_1);
  PyList_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  __pyx_t_19 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
      __pyx_t_19 = 1;
    }
  }
  __pyx_t_3 = PyTuple_New(3+__pyx_t_19); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 505, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  if (__pyx_t_1) {
    __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1); __pyx_t_1 = NULL;
  }
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_19, __pyx_int_0);
  __Pyx_INCREF(__pyx_int_1);
  __Pyx_GIVEREF(__pyx_int_1);
  PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_19, __pyx_int_1);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_3, 2+__pyx_t_19, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_3, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 505, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 505, __pyx_L1_error)
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_U0.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_U0.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_20, &__pyx_t_21, &__pyx_t_22);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_U0.rcbuffer->pybuffer, (PyObject*)__pyx_v_U0, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_21); Py_XDECREF(__pyx_t_22);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_20, __pyx_t_21, __pyx_t_22);
      }
    }
    __pyx_pybuffernd_U0.diminfo[0].strides = __pyx_pybuffernd_U0.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_U0.diminfo[0].shape = __pyx_pybuffernd_U0.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 505, __pyx_L1_error)
  }
  __pyx_t_7 = 0;
  __Pyx_DECREF_SET(__pyx_v_U0, ((PyArrayObject *)__pyx_t_6));
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":506
 * 
 *     U0 = np.random.uniform(0, 1, [p, ])
 *     U1 = np.random.uniform(0, 1, [p, ])             # <<<<<<<<<<<<<<
 *     U2 = np.random.uniform(0, 1, [p, ])
 * 
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 506, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_random); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 506, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_uniform); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 506, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 506, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = PyList_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 506, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_3);
  PyList_SET_ITEM(__pyx_t_5, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_19 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
      __pyx_t_19 = 1;
    }
  }
  __pyx_t_1 = PyTuple_New(3+__pyx_t_19); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 506, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (__pyx_t_3) {
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_19, __pyx_int_0);
  __Pyx_INCREF(__pyx_int_1);
  __Pyx_GIVEREF(__pyx_int_1);
  PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_19, __pyx_int_1);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_1, 2+__pyx_t_19, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 506, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 506, __pyx_L1_error)
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_U1.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_U1.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_22, &__pyx_t_21, &__pyx_t_20);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_U1.rcbuffer->pybuffer, (PyObject*)__pyx_v_U1, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_22); Py_XDECREF(__pyx_t_21); Py_XDECREF(__pyx_t_20);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_22, __pyx_t_21, __pyx_t_20);
      }
    }
    __pyx_pybuffernd_U1.diminfo[0].strides = __pyx_pybuffernd_U1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_U1.diminfo[0].shape = __pyx_pybuffernd_U1.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 506, __pyx_L1_error)
  }
  __pyx_t_8 = 0;
  __Pyx_DECREF_SET(__pyx_v_U1, ((PyArrayObject *)__pyx_t_6));
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":507
 *     U0 = np.random.uniform(0, 1, [p, ])
 *     U1 = np.random.uniform(0, 1, [p, ])
 *     U2 = np.random.uniform(0, 1, [p, ])             # <<<<<<<<<<<<<<
 * 
 *     for k in range(p):
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 507, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_random); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 507, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_uniform); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 507, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 507, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = PyList_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 507, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_1);
  PyList_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  __pyx_t_19 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
      __pyx_t_19 = 1;
    }
  }
  __pyx_t_3 = PyTuple_New(3+__pyx_t_19); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 507, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  if (__pyx_t_1) {
    __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1); __pyx_t_1 = NULL;
  }
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_19, __pyx_int_0);
  __Pyx_INCREF(__pyx_int_1);
  __Pyx_GIVEREF(__pyx_int_1);
  PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_19, __pyx_int_1);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_3, 2+__pyx_t_19, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_3, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 507, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 507, __pyx_L1_error)
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_U2.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_U2.rcbuffer->pybuffer, (PyObject*)__pyx_t_9, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_20, &__pyx_t_21, &__pyx_t_22);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_U2.rcbuffer->pybuffer, (PyObject*)__pyx_v_U2, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_21); Py_XDECREF(__pyx_t_22);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_20, __pyx_t_21, __pyx_t_22);
      }
    }
    __pyx_pybuffernd_U2.diminfo[0].strides = __pyx_pybuffernd_U2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_U2.diminfo[0].shape = __pyx_pybuffernd_U2.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 507, __pyx_L1_error)
  }
  __pyx_t_9 = 0;
  __Pyx_DECREF_SET(__pyx_v_U2, ((PyArrayObject *)__pyx_t_6));
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":509
 *     U2 = np.random.uniform(0, 1, [p, ])
 * 
 *     for k in range(p):             # <<<<<<<<<<<<<<
 *         u0 = U0[k]
 *         u1 = U1[k]
 */
  __pyx_t_2 = __pyx_v_p;
  for (__pyx_t_23 = 0; __pyx_t_23 < __pyx_t_2; __pyx_t_23+=1) {
    __pyx_v_k = __pyx_t_23;

    /* "libTEXTURIZE.pyx":510
 * 
 *     for k in range(p):
 *         u0 = U0[k]             # <<<<<<<<<<<<<<
 *         u1 = U1[k]
 *         u2 = U2[k]
 */
    __pyx_t_24 = __pyx_v_k;
    __pyx_v_u0 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_U0.rcbuffer->pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_U0.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":511
 *     for k in range(p):
 *         u0 = U0[k]
 *         u1 = U1[k]             # <<<<<<<<<<<<<<
 *         u2 = U2[k]
 *         gamma1 = 2 * pi * u1
 */
    __pyx_t_25 = __pyx_v_k;
    __pyx_v_u1 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_U1.rcbuffer->pybuffer.buf, __pyx_t_25, __pyx_pybuffernd_U1.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":512
 *         u0 = U0[k]
 *         u1 = U1[k]
 *         u2 = U2[k]             # <<<<<<<<<<<<<<
 *         gamma1 = 2 * pi * u1
 *         gamma2 = 2 * pi * u2
 */
    __pyx_t_26 = __pyx_v_k;
    __pyx_v_u2 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_U2.rcbuffer->pybuffer.buf, __pyx_t_26, __pyx_pybuffernd_U2.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":513
 *         u1 = U1[k]
 *         u2 = U2[k]
 *         gamma1 = 2 * pi * u1             # <<<<<<<<<<<<<<
 *         gamma2 = 2 * pi * u2
 *         r1 = sqrt(1 - u0)
 */
    __pyx_v_gamma1 = ((2.0 * __pyx_v_12libTEXTURIZE_pi) * __pyx_v_u1);

    /* "libTEXTURIZE.pyx":514
 *         u2 = U2[k]
 *         gamma1 = 2 * pi * u1
 *         gamma2 = 2 * pi * u2             # <<<<<<<<<<<<<<
 *         r1 = sqrt(1 - u0)
 *         r2 = sqrt(u0)
 */
    __pyx_v_gamma2 = ((2.0 * __pyx_v_12libTEXTURIZE_pi) * __pyx_v_u2);

    /* "libTEXTURIZE.pyx":515
 *         gamma1 = 2 * pi * u1
 *         gamma2 = 2 * pi * u2
 *         r1 = sqrt(1 - u0)             # <<<<<<<<<<<<<<
 *         r2 = sqrt(u0)
 *         c1 = cos(gamma1)
 */
    __pyx_v_r1 = sqrt((1.0 - __pyx_v_u0));

    /* "libTEXTURIZE.pyx":516
 *         gamma2 = 2 * pi * u2
 *         r1 = sqrt(1 - u0)
 *         r2 = sqrt(u0)             # <<<<<<<<<<<<<<
 *         c1 = cos(gamma1)
 *         s1 = sin(gamma1)
 */
    __pyx_v_r2 = sqrt(__pyx_v_u0);

    /* "libTEXTURIZE.pyx":517
 *         r1 = sqrt(1 - u0)
 *         r2 = sqrt(u0)
 *         c1 = cos(gamma1)             # <<<<<<<<<<<<<<
 *         s1 = sin(gamma1)
 *         c2 = cos(gamma2)
 */
    __pyx_v_c1 = cos(__pyx_v_gamma1);

    /* "libTEXTURIZE.pyx":518
 *         r2 = sqrt(u0)
 *         c1 = cos(gamma1)
 *         s1 = sin(gamma1)             # <<<<<<<<<<<<<<
 *         c2 = cos(gamma2)
 *         s2 = sin(gamma2)
 */
    __pyx_v_s1 = sin(__pyx_v_gamma1);

    /* "libTEXTURIZE.pyx":519
 *         c1 = cos(gamma1)
 *         s1 = sin(gamma1)
 *         c2 = cos(gamma2)             # <<<<<<<<<<<<<<
 *         s2 = sin(gamma2)
 * 
 */
    __pyx_v_c2 = cos(__pyx_v_gamma2);

    /* "libTEXTURIZE.pyx":520
 *         s1 = sin(gamma1)
 *         c2 = cos(gamma2)
 *         s2 = sin(gamma2)             # <<<<<<<<<<<<<<
 * 
 *         Q[k, 0] = c2 * r2
 */
    __pyx_v_s2 = sin(__pyx_v_gamma2);

    /* "libTEXTURIZE.pyx":522
 *         s2 = sin(gamma2)
 * 
 *         Q[k, 0] = c2 * r2             # <<<<<<<<<<<<<<
 *         Q[k, 1] = s1 * r1
 *         Q[k, 2] = c1 * r1
 */
    __pyx_t_27 = __pyx_v_k;
    __pyx_t_28 = 0;
    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Q.rcbuffer->pybuffer.buf, __pyx_t_27, __pyx_pybuffernd_Q.diminfo[0].strides, __pyx_t_28, __pyx_pybuffernd_Q.diminfo[1].strides) = (__pyx_v_c2 * __pyx_v_r2);

    /* "libTEXTURIZE.pyx":523
 * 
 *         Q[k, 0] = c2 * r2
 *         Q[k, 1] = s1 * r1             # <<<<<<<<<<<<<<
 *         Q[k, 2] = c1 * r1
 *         Q[k, 3] = s2 * r2
 */
    __pyx_t_29 = __pyx_v_k;
    __pyx_t_30 = 1;
    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Q.rcbuffer->pybuffer.buf, __pyx_t_29, __pyx_pybuffernd_Q.diminfo[0].strides, __pyx_t_30, __pyx_pybuffernd_Q.diminfo[1].strides) = (__pyx_v_s1 * __pyx_v_r1);

    /* "libTEXTURIZE.pyx":524
 *         Q[k, 0] = c2 * r2
 *         Q[k, 1] = s1 * r1
 *         Q[k, 2] = c1 * r1             # <<<<<<<<<<<<<<
 *         Q[k, 3] = s2 * r2
 * 
 */
    __pyx_t_31 = __pyx_v_k;
    __pyx_t_32 = 2;
    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Q.rcbuffer->pybuffer.buf, __pyx_t_31, __pyx_pybuffernd_Q.diminfo[0].strides, __pyx_t_32, __pyx_pybuffernd_Q.diminfo[1].strides) = (__pyx_v_c1 * __pyx_v_r1);

    /* "libTEXTURIZE.pyx":525
 *         Q[k, 1] = s1 * r1
 *         Q[k, 2] = c1 * r1
 *         Q[k, 3] = s2 * r2             # <<<<<<<<<<<<<<
 * 
 *     Axis, Angle = conv.qn_to_aap(Q)
 */
    __pyx_t_33 = __pyx_v_k;
    __pyx_t_34 = 3;
    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Q.rcbuffer->pybuffer.buf, __pyx_t_33, __pyx_pybuffernd_Q.diminfo[0].strides, __pyx_t_34, __pyx_pybuffernd_Q.diminfo[1].strides) = (__pyx_v_s2 * __pyx_v_r2);
  }

  /* "libTEXTURIZE.pyx":527
 *         Q[k, 3] = s2 * r2
 * 
 *     Axis, Angle = conv.qn_to_aap(Q)             # <<<<<<<<<<<<<<
 *     Rot = conv.aap_to_rm(Axis, Angle)
 *     Eul = conv.rm_to_zxz(Rot)
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_conv); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 527, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_qn_to_aap); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 527, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_3, ((PyObject *)__pyx_v_Q)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 527, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
  } else {
    __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 527, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
    __Pyx_INCREF(((PyObject *)__pyx_v_Q));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_Q));
    PyTuple_SET_ITEM(__pyx_t_5, 0+1, ((PyObject *)__pyx_v_Q));
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 527, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if ((likely(PyTuple_CheckExact(__pyx_t_6))) || (PyList_CheckExact(__pyx_t_6))) {
    PyObject* sequence = __pyx_t_6;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = PySequence_Size(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size > 2) __Pyx_RaiseTooManyValuesError(2);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 527, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
      __pyx_t_5 = PyTuple_GET_ITEM(sequence, 1); 
    } else {
      __pyx_t_3 = PyList_GET_ITEM(sequence, 0); 
      __pyx_t_5 = PyList_GET_ITEM(sequence, 1); 
    }
    __Pyx_INCREF(__pyx_t_3);
    __Pyx_INCREF(__pyx_t_5);
    #else
    __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 527, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __pyx_t_5 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 527, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    #endif
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_4 = PyObject_GetIter(__pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 527, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_35 = Py_TYPE(__pyx_t_4)->tp_iternext;
    index = 0; __pyx_t_3 = __pyx_t_35(__pyx_t_4); if (unlikely(!__pyx_t_3)) goto __pyx_L5_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_3);
    index = 1; __pyx_t_5 = __pyx_t_35(__pyx_t_4); if (unlikely(!__pyx_t_5)) goto __pyx_L5_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_5);
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_35(__pyx_t_4), 2) < 0) __PYX_ERR(0, 527, __pyx_L1_error)
    __pyx_t_35 = NULL;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L6_unpacking_done;
    __pyx_L5_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_35 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 527, __pyx_L1_error)
    __pyx_L6_unpacking_done:;
  }
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 527, __pyx_L1_error)
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 527, __pyx_L1_error)
  __pyx_t_12 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer, (PyObject*)__pyx_t_12, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_22, &__pyx_t_21, &__pyx_t_20);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer, (PyObject*)__pyx_v_Axis, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_22); Py_XDECREF(__pyx_t_21); Py_XDECREF(__pyx_t_20);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_22, __pyx_t_21, __pyx_t_20);
      }
    }
    __pyx_pybuffernd_Axis.diminfo[0].strides = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Axis.diminfo[0].shape = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Axis.diminfo[1].strides = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Axis.diminfo[1].shape = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.shape[1];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 527, __pyx_L1_error)
  }
  __pyx_t_12 = 0;
  __Pyx_DECREF_SET(__pyx_v_Axis, ((PyArrayObject *)__pyx_t_3));
  __pyx_t_3 = 0;
  __pyx_t_13 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_20, &__pyx_t_21, &__pyx_t_22);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer, (PyObject*)__pyx_v_Angle, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_21); Py_XDECREF(__pyx_t_22);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_20, __pyx_t_21, __pyx_t_22);
      }
    }
    __pyx_pybuffernd_Angle.diminfo[0].strides = __pyx_pybuffernd_Angle.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Angle.diminfo[0].shape = __pyx_pybuffernd_Angle.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 527, __pyx_L1_error)
  }
  __pyx_t_13 = 0;
  __Pyx_DECREF_SET(__pyx_v_Angle, ((PyArrayObject *)__pyx_t_5));
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":528
 * 
 *     Axis, Angle = conv.qn_to_aap(Q)
 *     Rot = conv.aap_to_rm(Axis, Angle)             # <<<<<<<<<<<<<<
 *     Eul = conv.rm_to_zxz(Rot)
 * 
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_conv); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 528, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_aap_to_rm); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 528, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_19 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
      __pyx_t_19 = 1;
    }
  }
  __pyx_t_4 = PyTuple_New(2+__pyx_t_19); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 528, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__pyx_t_5) {
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  __Pyx_INCREF(((PyObject *)__pyx_v_Axis));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_Axis));
  PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_19, ((PyObject *)__pyx_v_Axis));
  __Pyx_INCREF(((PyObject *)__pyx_v_Angle));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_Angle));
  PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_19, ((PyObject *)__pyx_v_Angle));
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 528, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 528, __pyx_L1_error)
  __pyx_t_10 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer, (PyObject*)__pyx_t_10, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_22, &__pyx_t_21, &__pyx_t_20);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer, (PyObject*)__pyx_v_Rot, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_22); Py_XDECREF(__pyx_t_21); Py_XDECREF(__pyx_t_20);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_22, __pyx_t_21, __pyx_t_20);
      }
    }
    __pyx_pybuffernd_Rot.diminfo[0].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rot.diminfo[0].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rot.diminfo[1].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rot.diminfo[1].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_Rot.diminfo[2].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_Rot.diminfo[2].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[2];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 528, __pyx_L1_error)
  }
  __pyx_t_10 = 0;
  __Pyx_DECREF_SET(__pyx_v_Rot, ((PyArrayObject *)__pyx_t_6));
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":529
 *     Axis, Angle = conv.qn_to_aap(Q)
 *     Rot = conv.aap_to_rm(Axis, Angle)
 *     Eul = conv.rm_to_zxz(Rot)             # <<<<<<<<<<<<<<
 * 
 *     if makecanvas == 0:
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_conv); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 529, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_rm_to_zxz); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 529, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_4, ((PyObject *)__pyx_v_Rot)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 529, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
  } else {
    __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 529, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
    __Pyx_INCREF(((PyObject *)__pyx_v_Rot));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_Rot));
    PyTuple_SET_ITEM(__pyx_t_5, 0+1, ((PyObject *)__pyx_v_Rot));
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_5, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 529, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 529, __pyx_L1_error)
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_t_11, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_20, &__pyx_t_21, &__pyx_t_22);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_v_Eul, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_21); Py_XDECREF(__pyx_t_22);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_20, __pyx_t_21, __pyx_t_22);
      }
    }
    __pyx_pybuffernd_Eul.diminfo[0].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Eul.diminfo[0].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Eul.diminfo[1].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Eul.diminfo[1].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[1];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 529, __pyx_L1_error)
  }
  __pyx_t_11 = 0;
  __Pyx_DECREF_SET(__pyx_v_Eul, ((PyArrayObject *)__pyx_t_6));
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":531
 *     Eul = conv.rm_to_zxz(Rot)
 * 
 *     if makecanvas == 0:             # <<<<<<<<<<<<<<
 * 
 *         obj.Eul = Eul
 */
  __pyx_t_36 = ((__pyx_v_makecanvas == 0) != 0);
  if (__pyx_t_36) {

    /* "libTEXTURIZE.pyx":533
 *     if makecanvas == 0:
 * 
 *         obj.Eul = Eul             # <<<<<<<<<<<<<<
 * 
 *     else:
 */
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_Eul, ((PyObject *)__pyx_v_Eul)) < 0) __PYX_ERR(0, 533, __pyx_L1_error)

    /* "libTEXTURIZE.pyx":531
 *     Eul = conv.rm_to_zxz(Rot)
 * 
 *     if makecanvas == 0:             # <<<<<<<<<<<<<<
 * 
 *         obj.Eul = Eul
 */
    goto __pyx_L7;
  }

  /* "libTEXTURIZE.pyx":536
 * 
 *     else:
 *         obj.EUL = getcanvas(m, n, Eul)             # <<<<<<<<<<<<<<
 * 
 *     toc = time.time()
 */
  /*else*/ {
    __pyx_t_6 = __pyx_f_12libTEXTURIZE_getcanvas(__pyx_v_m, __pyx_v_n, ((PyArrayObject *)__pyx_v_Eul)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 536, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_EUL, __pyx_t_6) < 0) __PYX_ERR(0, 536, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __pyx_L7:;

  /* "libTEXTURIZE.pyx":538
 *         obj.EUL = getcanvas(m, n, Eul)
 * 
 *     toc = time.time()             # <<<<<<<<<<<<<<
 *     obj.exetime = toc - tic
 *     return obj
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_time); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 538, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_time); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 538, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
    }
  }
  if (__pyx_t_4) {
    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 538, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    __pyx_t_6 = __Pyx_PyObject_CallNoArg(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 538, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_18 = __pyx_PyFloat_AsDouble(__pyx_t_6); if (unlikely((__pyx_t_18 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 538, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_toc = __pyx_t_18;

  /* "libTEXTURIZE.pyx":539
 * 
 *     toc = time.time()
 *     obj.exetime = toc - tic             # <<<<<<<<<<<<<<
 *     return obj
 * 
 */
  __pyx_t_6 = PyFloat_FromDouble((__pyx_v_toc - __pyx_v_tic)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 539, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_exetime, __pyx_t_6) < 0) __PYX_ERR(0, 539, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":540
 *     toc = time.time()
 *     obj.exetime = toc - tic
 *     return obj             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_obj);
  __pyx_r = __pyx_v_obj;
  goto __pyx_L0;

  /* "libTEXTURIZE.pyx":477
 * 
 * 
 * def Texture_URO_sm1(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Q.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_U0.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_U1.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_U2.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("libTEXTURIZE.Texture_URO_sm1", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Q.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_U0.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_U1.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_U2.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XDECREF((PyObject *)__pyx_v_U0);
  __Pyx_XDECREF((PyObject *)__pyx_v_U1);
  __Pyx_XDECREF((PyObject *)__pyx_v_U2);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rot);
  __Pyx_XDECREF((PyObject *)__pyx_v_Eul);
  __Pyx_XDECREF((PyObject *)__pyx_v_Axis);
  __Pyx_XDECREF((PyObject *)__pyx_v_Angle);
  __Pyx_XDECREF((PyObject *)__pyx_v_Nd);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rd);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rv);
  __Pyx_XDECREF((PyObject *)__pyx_v_Q);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "libTEXTURIZE.pyx":543
 * 
 * 
 * def Texture_URO_sm2(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */

/* Python wrapper */
static PyObject *__pyx_pw_12libTEXTURIZE_13Texture_URO_sm2(PyObject *__pyx_self, PyObject *__pyx_v_obj); /*proto*/
static PyMethodDef __pyx_mdef_12libTEXTURIZE_13Texture_URO_sm2 = {"Texture_URO_sm2", (PyCFunction)__pyx_pw_12libTEXTURIZE_13Texture_URO_sm2, METH_O, 0};
static PyObject *__pyx_pw_12libTEXTURIZE_13Texture_URO_sm2(PyObject *__pyx_self, PyObject *__pyx_v_obj) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Texture_URO_sm2 (wrapper)", 0);
  __pyx_r = __pyx_pf_12libTEXTURIZE_12Texture_URO_sm2(__pyx_self, ((PyObject *)__pyx_v_obj));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_12libTEXTURIZE_12Texture_URO_sm2(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_obj) {
  int __pyx_v_myseed;
  int __pyx_v_p;
  int __pyx_v_m;
  int __pyx_v_n;
  int __pyx_v_makecanvas;
  double __pyx_v_tic;
  double __pyx_v_toc;
  int __pyx_v_k;
  float __pyx_v_beta;
  float __pyx_v_theta;
  float __pyx_v_phi;
  float __pyx_v_cb;
  float __pyx_v_sb;
  float __pyx_v_st;
  float __pyx_v_cp;
  float __pyx_v_sp;
  float __pyx_v_ct;
  PyArrayObject *__pyx_v_r1 = 0;
  PyArrayObject *__pyx_v_Beta = 0;
  PyArrayObject *__pyx_v_Theta = 0;
  PyArrayObject *__pyx_v_Phi = 0;
  PyArrayObject *__pyx_v_Rot = 0;
  PyArrayObject *__pyx_v_Eul = 0;
  PyArrayObject *__pyx_v_Axis = 0;
  PyArrayObject *__pyx_v_Angle = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Nd = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Rd = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Rv = 0;
  PyArrayObject *__pyx_v_Q = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Angle;
  __Pyx_Buffer __pyx_pybuffer_Angle;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Axis;
  __Pyx_Buffer __pyx_pybuffer_Axis;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Beta;
  __Pyx_Buffer __pyx_pybuffer_Beta;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Eul;
  __Pyx_Buffer __pyx_pybuffer_Eul;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Nd;
  __Pyx_Buffer __pyx_pybuffer_Nd;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Phi;
  __Pyx_Buffer __pyx_pybuffer_Phi;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Q;
  __Pyx_Buffer __pyx_pybuffer_Q;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rd;
  __Pyx_Buffer __pyx_pybuffer_Rd;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rot;
  __Pyx_Buffer __pyx_pybuffer_Rot;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rv;
  __Pyx_Buffer __pyx_pybuffer_Rv;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Theta;
  __Pyx_Buffer __pyx_pybuffer_Theta;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_r1;
  __Pyx_Buffer __pyx_pybuffer_r1;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyArrayObject *__pyx_t_7 = NULL;
  PyArrayObject *__pyx_t_8 = NULL;
  PyArrayObject *__pyx_t_9 = NULL;
  PyArrayObject *__pyx_t_10 = NULL;
  PyArrayObject *__pyx_t_11 = NULL;
  PyArrayObject *__pyx_t_12 = NULL;
  PyArrayObject *__pyx_t_13 = NULL;
  PyArrayObject *__pyx_t_14 = NULL;
  PyArrayObject *__pyx_t_15 = NULL;
  PyArrayObject *__pyx_t_16 = NULL;
  PyArrayObject *__pyx_t_17 = NULL;
  PyArrayObject *__pyx_t_18 = NULL;
  double __pyx_t_19;
  PyObject *__pyx_t_20 = NULL;
  PyObject *__pyx_t_21 = NULL;
  PyObject *__pyx_t_22 = NULL;
  Py_ssize_t __pyx_t_23;
  PyObject *__pyx_t_24 = NULL;
  int __pyx_t_25;
  Py_ssize_t __pyx_t_26;
  Py_ssize_t __pyx_t_27;
  Py_ssize_t __pyx_t_28;
  Py_ssize_t __pyx_t_29;
  Py_ssize_t __pyx_t_30;
  Py_ssize_t __pyx_t_31;
  Py_ssize_t __pyx_t_32;
  Py_ssize_t __pyx_t_33;
  Py_ssize_t __pyx_t_34;
  Py_ssize_t __pyx_t_35;
  Py_ssize_t __pyx_t_36;
  PyObject *(*__pyx_t_37)(PyObject *);
  int __pyx_t_38;
  __Pyx_RefNannySetupContext("Texture_URO_sm2", 0);
  __pyx_pybuffer_r1.pybuffer.buf = NULL;
  __pyx_pybuffer_r1.refcount = 0;
  __pyx_pybuffernd_r1.data = NULL;
  __pyx_pybuffernd_r1.rcbuffer = &__pyx_pybuffer_r1;
  __pyx_pybuffer_Beta.pybuffer.buf = NULL;
  __pyx_pybuffer_Beta.refcount = 0;
  __pyx_pybuffernd_Beta.data = NULL;
  __pyx_pybuffernd_Beta.rcbuffer = &__pyx_pybuffer_Beta;
  __pyx_pybuffer_Theta.pybuffer.buf = NULL;
  __pyx_pybuffer_Theta.refcount = 0;
  __pyx_pybuffernd_Theta.data = NULL;
  __pyx_pybuffernd_Theta.rcbuffer = &__pyx_pybuffer_Theta;
  __pyx_pybuffer_Phi.pybuffer.buf = NULL;
  __pyx_pybuffer_Phi.refcount = 0;
  __pyx_pybuffernd_Phi.data = NULL;
  __pyx_pybuffernd_Phi.rcbuffer = &__pyx_pybuffer_Phi;
  __pyx_pybuffer_Rot.pybuffer.buf = NULL;
  __pyx_pybuffer_Rot.refcount = 0;
  __pyx_pybuffernd_Rot.data = NULL;
  __pyx_pybuffernd_Rot.rcbuffer = &__pyx_pybuffer_Rot;
  __pyx_pybuffer_Eul.pybuffer.buf = NULL;
  __pyx_pybuffer_Eul.refcount = 0;
  __pyx_pybuffernd_Eul.data = NULL;
  __pyx_pybuffernd_Eul.rcbuffer = &__pyx_pybuffer_Eul;
  __pyx_pybuffer_Axis.pybuffer.buf = NULL;
  __pyx_pybuffer_Axis.refcount = 0;
  __pyx_pybuffernd_Axis.data = NULL;
  __pyx_pybuffernd_Axis.rcbuffer = &__pyx_pybuffer_Axis;
  __pyx_pybuffer_Angle.pybuffer.buf = NULL;
  __pyx_pybuffer_Angle.refcount = 0;
  __pyx_pybuffernd_Angle.data = NULL;
  __pyx_pybuffernd_Angle.rcbuffer = &__pyx_pybuffer_Angle;
  __pyx_pybuffer_Nd.pybuffer.buf = NULL;
  __pyx_pybuffer_Nd.refcount = 0;
  __pyx_pybuffernd_Nd.data = NULL;
  __pyx_pybuffernd_Nd.rcbuffer = &__pyx_pybuffer_Nd;
  __pyx_pybuffer_Rd.pybuffer.buf = NULL;
  __pyx_pybuffer_Rd.refcount = 0;
  __pyx_pybuffernd_Rd.data = NULL;
  __pyx_pybuffernd_Rd.rcbuffer = &__pyx_pybuffer_Rd;
  __pyx_pybuffer_Rv.pybuffer.buf = NULL;
  __pyx_pybuffer_Rv.refcount = 0;
  __pyx_pybuffernd_Rv.data = NULL;
  __pyx_pybuffernd_Rv.rcbuffer = &__pyx_pybuffer_Rv;
  __pyx_pybuffer_Q.pybuffer.buf = NULL;
  __pyx_pybuffer_Q.refcount = 0;
  __pyx_pybuffernd_Q.data = NULL;
  __pyx_pybuffernd_Q.rcbuffer = &__pyx_pybuffer_Q;

  /* "libTEXTURIZE.pyx":544
 * 
 * def Texture_URO_sm2(obj):
 *     cdef int myseed = obj.myseed             # <<<<<<<<<<<<<<
 *     cdef int p = obj.p
 *     cdef int m = obj.m
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_myseed); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 544, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 544, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_myseed = __pyx_t_2;

  /* "libTEXTURIZE.pyx":545
 * def Texture_URO_sm2(obj):
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p             # <<<<<<<<<<<<<<
 *     cdef int m = obj.m
 *     cdef int n = obj.n
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 545, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 545, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_p = __pyx_t_2;

  /* "libTEXTURIZE.pyx":546
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 *     cdef int m = obj.m             # <<<<<<<<<<<<<<
 *     cdef int n = obj.n
 *     cdef int makecanvas = obj.makecanvas
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_m); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 546, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 546, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_m = __pyx_t_2;

  /* "libTEXTURIZE.pyx":547
 *     cdef int p = obj.p
 *     cdef int m = obj.m
 *     cdef int n = obj.n             # <<<<<<<<<<<<<<
 *     cdef int makecanvas = obj.makecanvas
 *     cdef double tic, toc
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 547, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 547, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_n = __pyx_t_2;

  /* "libTEXTURIZE.pyx":548
 *     cdef int m = obj.m
 *     cdef int n = obj.n
 *     cdef int makecanvas = obj.makecanvas             # <<<<<<<<<<<<<<
 *     cdef double tic, toc
 * 
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_makecanvas); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 548, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 548, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_makecanvas = __pyx_t_2;

  /* "libTEXTURIZE.pyx":554
 *     cdef float beta, theta, phi, cb, sb, st, cp, sp , ct
 * 
 *     cdef np.ndarray[np.float64_t, ndim = 1] r1 = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Beta = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Theta = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 554, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 554, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 554, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 554, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 554, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 554, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 554, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 554, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 554, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 554, __pyx_L1_error)
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_r1.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_r1 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_r1.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 554, __pyx_L1_error)
    } else {__pyx_pybuffernd_r1.diminfo[0].strides = __pyx_pybuffernd_r1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_r1.diminfo[0].shape = __pyx_pybuffernd_r1.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_r1 = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":555
 * 
 *     cdef np.ndarray[np.float64_t, ndim = 1] r1 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Beta = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Theta = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Phi = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 555, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 555, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 555, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 555, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 555, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 555, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 555, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 555, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 555, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 555, __pyx_L1_error)
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Beta.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Beta = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Beta.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 555, __pyx_L1_error)
    } else {__pyx_pybuffernd_Beta.diminfo[0].strides = __pyx_pybuffernd_Beta.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Beta.diminfo[0].shape = __pyx_pybuffernd_Beta.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_8 = 0;
  __pyx_v_Beta = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":556
 *     cdef np.ndarray[np.float64_t, ndim = 1] r1 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Beta = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Theta = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Phi = np.zeros(p, dtype=np.float64)
 * 
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 556, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 556, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 556, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 556, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 556, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 556, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 556, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 556, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 556, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 556, __pyx_L1_error)
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Theta.rcbuffer->pybuffer, (PyObject*)__pyx_t_9, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Theta = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Theta.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 556, __pyx_L1_error)
    } else {__pyx_pybuffernd_Theta.diminfo[0].strides = __pyx_pybuffernd_Theta.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Theta.diminfo[0].shape = __pyx_pybuffernd_Theta.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_9 = 0;
  __pyx_v_Theta = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":557
 *     cdef np.ndarray[np.float64_t, ndim = 1] Beta = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Theta = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Phi = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 * 
 *     # DESCRIPTORS OF ORIENTATIONS
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 557, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 557, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 557, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 557, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 557, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 557, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 557, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 557, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 557, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 557, __pyx_L1_error)
  __pyx_t_10 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Phi.rcbuffer->pybuffer, (PyObject*)__pyx_t_10, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Phi = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Phi.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 557, __pyx_L1_error)
    } else {__pyx_pybuffernd_Phi.diminfo[0].strides = __pyx_pybuffernd_Phi.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Phi.diminfo[0].shape = __pyx_pybuffernd_Phi.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_10 = 0;
  __pyx_v_Phi = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":560
 * 
 *     # DESCRIPTORS OF ORIENTATIONS
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 560, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 560, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 560, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 560, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_3);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_int_3);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 560, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 560, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 560, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 560, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 560, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 560, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 560, __pyx_L1_error)
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer, (PyObject*)__pyx_t_11, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
      __pyx_v_Rot = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 560, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rot.diminfo[0].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rot.diminfo[0].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rot.diminfo[1].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rot.diminfo[1].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_Rot.diminfo[2].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_Rot.diminfo[2].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[2];
    }
  }
  __pyx_t_11 = 0;
  __pyx_v_Rot = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":561
 *     # DESCRIPTORS OF ORIENTATIONS
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 561, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 561, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 561, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 561, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_3);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 561, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 561, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 561, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 561, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 561, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 561, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 561, __pyx_L1_error)
  __pyx_t_12 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_t_12, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Eul = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Eul.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 561, __pyx_L1_error)
    } else {__pyx_pybuffernd_Eul.diminfo[0].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Eul.diminfo[0].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Eul.diminfo[1].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Eul.diminfo[1].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_12 = 0;
  __pyx_v_Eul = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":562
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 562, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 562, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 562, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 562, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_int_3);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 562, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 562, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 562, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 562, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 562, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 562, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 562, __pyx_L1_error)
  __pyx_t_13 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Axis = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Axis.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 562, __pyx_L1_error)
    } else {__pyx_pybuffernd_Axis.diminfo[0].strides = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Axis.diminfo[0].shape = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Axis.diminfo[1].strides = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Axis.diminfo[1].shape = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_13 = 0;
  __pyx_v_Axis = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":563
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 563, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 563, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 563, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 563, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 563, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 563, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 563, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 563, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_5, __pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 563, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 563, __pyx_L1_error)
  __pyx_t_14 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer, (PyObject*)__pyx_t_14, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Angle = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Angle.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 563, __pyx_L1_error)
    } else {__pyx_pybuffernd_Angle.diminfo[0].strides = __pyx_pybuffernd_Angle.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Angle.diminfo[0].shape = __pyx_pybuffernd_Angle.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_14 = 0;
  __pyx_v_Angle = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":564
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 564, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 564, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 564, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 564, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_int_3);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 564, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 564, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 564, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 564, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 564, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 564, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 564, __pyx_L1_error)
  __pyx_t_15 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer, (PyObject*)__pyx_t_15, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Nd = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Nd.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 564, __pyx_L1_error)
    } else {__pyx_pybuffernd_Nd.diminfo[0].strides = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Nd.diminfo[0].shape = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Nd.diminfo[1].strides = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Nd.diminfo[1].shape = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_15 = 0;
  __pyx_v_Nd = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":565
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 565, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 565, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 565, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 565, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_3);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 565, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 565, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 565, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 565, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 565, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 565, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 565, __pyx_L1_error)
  __pyx_t_16 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer, (PyObject*)__pyx_t_16, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Rd = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rd.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 565, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rd.diminfo[0].strides = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rd.diminfo[0].shape = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rd.diminfo[1].strides = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rd.diminfo[1].shape = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_16 = 0;
  __pyx_v_Rd = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":566
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)
 * 
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 566, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 566, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 566, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 566, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_3);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 566, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 566, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 566, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 566, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 566, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 566, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 566, __pyx_L1_error)
  __pyx_t_17 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer, (PyObject*)__pyx_t_17, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Rv = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rv.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 566, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rv.diminfo[0].strides = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rv.diminfo[0].shape = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rv.diminfo[1].strides = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rv.diminfo[1].shape = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_17 = 0;
  __pyx_v_Rv = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":567
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)             # <<<<<<<<<<<<<<
 * 
 *     plantseed(myseed)
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 567, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 567, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 567, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 567, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
  __Pyx_INCREF(__pyx_int_4);
  __Pyx_GIVEREF(__pyx_int_4);
  PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_int_4);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 567, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 567, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 567, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 567, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 567, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 567, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 567, __pyx_L1_error)
  __pyx_t_18 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Q.rcbuffer->pybuffer, (PyObject*)__pyx_t_18, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Q = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Q.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 567, __pyx_L1_error)
    } else {__pyx_pybuffernd_Q.diminfo[0].strides = __pyx_pybuffernd_Q.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Q.diminfo[0].shape = __pyx_pybuffernd_Q.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Q.diminfo[1].strides = __pyx_pybuffernd_Q.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Q.diminfo[1].shape = __pyx_pybuffernd_Q.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_18 = 0;
  __pyx_v_Q = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":569
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)
 * 
 *     plantseed(myseed)             # <<<<<<<<<<<<<<
 *     tic = time.time()
 * 
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_plantseed); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 569, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_myseed); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 569, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 569, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_GOTREF(__pyx_t_5);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 569, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1); __pyx_t_1 = NULL;
    __Pyx_GIVEREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 569, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":570
 * 
 *     plantseed(myseed)
 *     tic = time.time()             # <<<<<<<<<<<<<<
 * 
 *     Beta = ProbSinSquare(0, pi, 1, p)
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_time); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 570, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_time); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 570, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  if (__pyx_t_6) {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 570, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  } else {
    __pyx_t_5 = __Pyx_PyObject_CallNoArg(__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 570, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_19 = __pyx_PyFloat_AsDouble(__pyx_t_5); if (unlikely((__pyx_t_19 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 570, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_tic = __pyx_t_19;

  /* "libTEXTURIZE.pyx":572
 *     tic = time.time()
 * 
 *     Beta = ProbSinSquare(0, pi, 1, p)             # <<<<<<<<<<<<<<
 *     r1 = np.random.uniform(0, 1, [p, ])
 *     Theta = np.arccos(2 * r1 - 1)
 */
  __pyx_t_5 = ((PyObject *)__pyx_f_12libTEXTURIZE_ProbSinSquare(0.0, __pyx_v_12libTEXTURIZE_pi, 1.0, __pyx_v_p)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 572, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Beta.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Beta.rcbuffer->pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_5), &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_20, &__pyx_t_21, &__pyx_t_22);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Beta.rcbuffer->pybuffer, (PyObject*)__pyx_v_Beta, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_21); Py_XDECREF(__pyx_t_22);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_20, __pyx_t_21, __pyx_t_22);
      }
    }
    __pyx_pybuffernd_Beta.diminfo[0].strides = __pyx_pybuffernd_Beta.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Beta.diminfo[0].shape = __pyx_pybuffernd_Beta.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 572, __pyx_L1_error)
  }
  __Pyx_DECREF_SET(__pyx_v_Beta, ((PyArrayObject *)__pyx_t_5));
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":573
 * 
 *     Beta = ProbSinSquare(0, pi, 1, p)
 *     r1 = np.random.uniform(0, 1, [p, ])             # <<<<<<<<<<<<<<
 *     Theta = np.arccos(2 * r1 - 1)
 *     Phi = np.random.uniform(0, 2 * pi, [p, ])
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 573, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_random); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 573, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_uniform); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 573, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 573, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = PyList_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 573, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_6);
  PyList_SET_ITEM(__pyx_t_3, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  __pyx_t_23 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
      __pyx_t_23 = 1;
    }
  }
  __pyx_t_1 = PyTuple_New(3+__pyx_t_23); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 573, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (__pyx_t_6) {
    __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6); __pyx_t_6 = NULL;
  }
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_23, __pyx_int_0);
  __Pyx_INCREF(__pyx_int_1);
  __Pyx_GIVEREF(__pyx_int_1);
  PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_23, __pyx_int_1);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_1, 2+__pyx_t_23, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 573, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 573, __pyx_L1_error)
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_r1.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_r1.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_22, &__pyx_t_21, &__pyx_t_20);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_r1.rcbuffer->pybuffer, (PyObject*)__pyx_v_r1, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_22); Py_XDECREF(__pyx_t_21); Py_XDECREF(__pyx_t_20);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_22, __pyx_t_21, __pyx_t_20);
      }
    }
    __pyx_pybuffernd_r1.diminfo[0].strides = __pyx_pybuffernd_r1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_r1.diminfo[0].shape = __pyx_pybuffernd_r1.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 573, __pyx_L1_error)
  }
  __pyx_t_7 = 0;
  __Pyx_DECREF_SET(__pyx_v_r1, ((PyArrayObject *)__pyx_t_5));
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":574
 *     Beta = ProbSinSquare(0, pi, 1, p)
 *     r1 = np.random.uniform(0, 1, [p, ])
 *     Theta = np.arccos(2 * r1 - 1)             # <<<<<<<<<<<<<<
 *     Phi = np.random.uniform(0, 2 * pi, [p, ])
 * 
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 574, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arccos); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 574, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = PyNumber_Multiply(__pyx_int_2, ((PyObject *)__pyx_v_r1)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 574, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __Pyx_PyInt_SubtractObjC(__pyx_t_4, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 574, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 574, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __Pyx_GOTREF(__pyx_t_5);
  } else {
    __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 574, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
    __Pyx_GIVEREF(__pyx_t_3);
    PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 574, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 574, __pyx_L1_error)
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Theta.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Theta.rcbuffer->pybuffer, (PyObject*)__pyx_t_9, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_20, &__pyx_t_21, &__pyx_t_22);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Theta.rcbuffer->pybuffer, (PyObject*)__pyx_v_Theta, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_21); Py_XDECREF(__pyx_t_22);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_20, __pyx_t_21, __pyx_t_22);
      }
    }
    __pyx_pybuffernd_Theta.diminfo[0].strides = __pyx_pybuffernd_Theta.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Theta.diminfo[0].shape = __pyx_pybuffernd_Theta.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 574, __pyx_L1_error)
  }
  __pyx_t_9 = 0;
  __Pyx_DECREF_SET(__pyx_v_Theta, ((PyArrayObject *)__pyx_t_5));
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":575
 *     r1 = np.random.uniform(0, 1, [p, ])
 *     Theta = np.arccos(2 * r1 - 1)
 *     Phi = np.random.uniform(0, 2 * pi, [p, ])             # <<<<<<<<<<<<<<
 * 
 *     for k in range(p):
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 575, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_random); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 575, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_uniform); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 575, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = PyFloat_FromDouble((2.0 * __pyx_v_12libTEXTURIZE_pi)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 575, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 575, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 575, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_3);
  PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_23 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
      __pyx_t_23 = 1;
    }
  }
  __pyx_t_24 = PyTuple_New(3+__pyx_t_23); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 575, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_24);
  if (__pyx_t_3) {
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_24, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_24, 0+__pyx_t_23, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_24, 1+__pyx_t_23, __pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_24, 2+__pyx_t_23, __pyx_t_4);
  __pyx_t_6 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_24, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 575, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 575, __pyx_L1_error)
  __pyx_t_10 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Phi.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Phi.rcbuffer->pybuffer, (PyObject*)__pyx_t_10, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_22, &__pyx_t_21, &__pyx_t_20);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Phi.rcbuffer->pybuffer, (PyObject*)__pyx_v_Phi, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_22); Py_XDECREF(__pyx_t_21); Py_XDECREF(__pyx_t_20);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_22, __pyx_t_21, __pyx_t_20);
      }
    }
    __pyx_pybuffernd_Phi.diminfo[0].strides = __pyx_pybuffernd_Phi.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Phi.diminfo[0].shape = __pyx_pybuffernd_Phi.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 575, __pyx_L1_error)
  }
  __pyx_t_10 = 0;
  __Pyx_DECREF_SET(__pyx_v_Phi, ((PyArrayObject *)__pyx_t_5));
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":577
 *     Phi = np.random.uniform(0, 2 * pi, [p, ])
 * 
 *     for k in range(p):             # <<<<<<<<<<<<<<
 *         beta = Beta[k]
 *         theta = Theta[k]
 */
  __pyx_t_2 = __pyx_v_p;
  for (__pyx_t_25 = 0; __pyx_t_25 < __pyx_t_2; __pyx_t_25+=1) {
    __pyx_v_k = __pyx_t_25;

    /* "libTEXTURIZE.pyx":578
 * 
 *     for k in range(p):
 *         beta = Beta[k]             # <<<<<<<<<<<<<<
 *         theta = Theta[k]
 *         phi = Phi[k]
 */
    __pyx_t_26 = __pyx_v_k;
    __pyx_v_beta = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Beta.rcbuffer->pybuffer.buf, __pyx_t_26, __pyx_pybuffernd_Beta.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":579
 *     for k in range(p):
 *         beta = Beta[k]
 *         theta = Theta[k]             # <<<<<<<<<<<<<<
 *         phi = Phi[k]
 *         cb = cos(beta)
 */
    __pyx_t_27 = __pyx_v_k;
    __pyx_v_theta = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Theta.rcbuffer->pybuffer.buf, __pyx_t_27, __pyx_pybuffernd_Theta.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":580
 *         beta = Beta[k]
 *         theta = Theta[k]
 *         phi = Phi[k]             # <<<<<<<<<<<<<<
 *         cb = cos(beta)
 *         sb = sin(beta)
 */
    __pyx_t_28 = __pyx_v_k;
    __pyx_v_phi = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Phi.rcbuffer->pybuffer.buf, __pyx_t_28, __pyx_pybuffernd_Phi.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":581
 *         theta = Theta[k]
 *         phi = Phi[k]
 *         cb = cos(beta)             # <<<<<<<<<<<<<<
 *         sb = sin(beta)
 *         st = sin(theta)
 */
    __pyx_v_cb = cos(__pyx_v_beta);

    /* "libTEXTURIZE.pyx":582
 *         phi = Phi[k]
 *         cb = cos(beta)
 *         sb = sin(beta)             # <<<<<<<<<<<<<<
 *         st = sin(theta)
 *         cp = cos(phi)
 */
    __pyx_v_sb = sin(__pyx_v_beta);

    /* "libTEXTURIZE.pyx":583
 *         cb = cos(beta)
 *         sb = sin(beta)
 *         st = sin(theta)             # <<<<<<<<<<<<<<
 *         cp = cos(phi)
 *         sp = sin(phi)
 */
    __pyx_v_st = sin(__pyx_v_theta);

    /* "libTEXTURIZE.pyx":584
 *         sb = sin(beta)
 *         st = sin(theta)
 *         cp = cos(phi)             # <<<<<<<<<<<<<<
 *         sp = sin(phi)
 *         ct = cos(theta)
 */
    __pyx_v_cp = cos(__pyx_v_phi);

    /* "libTEXTURIZE.pyx":585
 *         st = sin(theta)
 *         cp = cos(phi)
 *         sp = sin(phi)             # <<<<<<<<<<<<<<
 *         ct = cos(theta)
 * 
 */
    __pyx_v_sp = sin(__pyx_v_phi);

    /* "libTEXTURIZE.pyx":586
 *         cp = cos(phi)
 *         sp = sin(phi)
 *         ct = cos(theta)             # <<<<<<<<<<<<<<
 * 
 *         Q[k, 0] = cb
 */
    __pyx_v_ct = cos(__pyx_v_theta);

    /* "libTEXTURIZE.pyx":588
 *         ct = cos(theta)
 * 
 *         Q[k, 0] = cb             # <<<<<<<<<<<<<<
 *         Q[k, 1] = sb * st * cp
 *         Q[k, 2] = sb * st * sp
 */
    __pyx_t_29 = __pyx_v_k;
    __pyx_t_30 = 0;
    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Q.rcbuffer->pybuffer.buf, __pyx_t_29, __pyx_pybuffernd_Q.diminfo[0].strides, __pyx_t_30, __pyx_pybuffernd_Q.diminfo[1].strides) = __pyx_v_cb;

    /* "libTEXTURIZE.pyx":589
 * 
 *         Q[k, 0] = cb
 *         Q[k, 1] = sb * st * cp             # <<<<<<<<<<<<<<
 *         Q[k, 2] = sb * st * sp
 *         Q[k, 3] = sb * ct
 */
    __pyx_t_31 = __pyx_v_k;
    __pyx_t_32 = 1;
    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Q.rcbuffer->pybuffer.buf, __pyx_t_31, __pyx_pybuffernd_Q.diminfo[0].strides, __pyx_t_32, __pyx_pybuffernd_Q.diminfo[1].strides) = ((__pyx_v_sb * __pyx_v_st) * __pyx_v_cp);

    /* "libTEXTURIZE.pyx":590
 *         Q[k, 0] = cb
 *         Q[k, 1] = sb * st * cp
 *         Q[k, 2] = sb * st * sp             # <<<<<<<<<<<<<<
 *         Q[k, 3] = sb * ct
 * 
 */
    __pyx_t_33 = __pyx_v_k;
    __pyx_t_34 = 2;
    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Q.rcbuffer->pybuffer.buf, __pyx_t_33, __pyx_pybuffernd_Q.diminfo[0].strides, __pyx_t_34, __pyx_pybuffernd_Q.diminfo[1].strides) = ((__pyx_v_sb * __pyx_v_st) * __pyx_v_sp);

    /* "libTEXTURIZE.pyx":591
 *         Q[k, 1] = sb * st * cp
 *         Q[k, 2] = sb * st * sp
 *         Q[k, 3] = sb * ct             # <<<<<<<<<<<<<<
 * 
 *     Axis, Angle = conv.qn_to_aap(Q)
 */
    __pyx_t_35 = __pyx_v_k;
    __pyx_t_36 = 3;
    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Q.rcbuffer->pybuffer.buf, __pyx_t_35, __pyx_pybuffernd_Q.diminfo[0].strides, __pyx_t_36, __pyx_pybuffernd_Q.diminfo[1].strides) = (__pyx_v_sb * __pyx_v_ct);
  }

  /* "libTEXTURIZE.pyx":593
 *         Q[k, 3] = sb * ct
 * 
 *     Axis, Angle = conv.qn_to_aap(Q)             # <<<<<<<<<<<<<<
 *     Rot = conv.aap_to_rm(Axis, Angle)
 *     Eul = conv.rm_to_zxz(Rot)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_conv); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 593, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_24 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_qn_to_aap); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 593, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_24);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_24))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_24);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_24);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_24, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_24, ((PyObject *)__pyx_v_Q)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 593, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 593, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1); __pyx_t_1 = NULL;
    __Pyx_INCREF(((PyObject *)__pyx_v_Q));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_Q));
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, ((PyObject *)__pyx_v_Q));
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_24, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 593, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
  if ((likely(PyTuple_CheckExact(__pyx_t_5))) || (PyList_CheckExact(__pyx_t_5))) {
    PyObject* sequence = __pyx_t_5;
    #if CYTHON_COMPILING_IN_CPYTHON
    Py_ssize_t size = Py_SIZE(sequence);
    #else
    Py_ssize_t size = PySequence_Size(sequence);
    #endif
    if (unlikely(size != 2)) {
      if (size > 2) __Pyx_RaiseTooManyValuesError(2);
      else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
      __PYX_ERR(0, 593, __pyx_L1_error)
    }
    #if CYTHON_COMPILING_IN_CPYTHON
    if (likely(PyTuple_CheckExact(sequence))) {
      __pyx_t_24 = PyTuple_GET_ITEM(sequence, 0); 
      __pyx_t_4 = PyTuple_GET_ITEM(sequence, 1); 
    } else {
      __pyx_t_24 = PyList_GET_ITEM(sequence, 0); 
      __pyx_t_4 = PyList_GET_ITEM(sequence, 1); 
    }
    __Pyx_INCREF(__pyx_t_24);
    __Pyx_INCREF(__pyx_t_4);
    #else
    __pyx_t_24 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 593, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_24);
    __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 593, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    #endif
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  } else {
    Py_ssize_t index = -1;
    __pyx_t_1 = PyObject_GetIter(__pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 593, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_37 = Py_TYPE(__pyx_t_1)->tp_iternext;
    index = 0; __pyx_t_24 = __pyx_t_37(__pyx_t_1); if (unlikely(!__pyx_t_24)) goto __pyx_L5_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_24);
    index = 1; __pyx_t_4 = __pyx_t_37(__pyx_t_1); if (unlikely(!__pyx_t_4)) goto __pyx_L5_unpacking_failed;
    __Pyx_GOTREF(__pyx_t_4);
    if (__Pyx_IternextUnpackEndCheck(__pyx_t_37(__pyx_t_1), 2) < 0) __PYX_ERR(0, 593, __pyx_L1_error)
    __pyx_t_37 = NULL;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L6_unpacking_done;
    __pyx_L5_unpacking_failed:;
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_37 = NULL;
    if (__Pyx_IterFinish() == 0) __Pyx_RaiseNeedMoreValuesError(index);
    __PYX_ERR(0, 593, __pyx_L1_error)
    __pyx_L6_unpacking_done:;
  }
  if (!(likely(((__pyx_t_24) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_24, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 593, __pyx_L1_error)
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 593, __pyx_L1_error)
  __pyx_t_13 = ((PyArrayObject *)__pyx_t_24);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_20, &__pyx_t_21, &__pyx_t_22);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer, (PyObject*)__pyx_v_Axis, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_21); Py_XDECREF(__pyx_t_22);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_20, __pyx_t_21, __pyx_t_22);
      }
    }
    __pyx_pybuffernd_Axis.diminfo[0].strides = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Axis.diminfo[0].shape = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Axis.diminfo[1].strides = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Axis.diminfo[1].shape = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.shape[1];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 593, __pyx_L1_error)
  }
  __pyx_t_13 = 0;
  __Pyx_DECREF_SET(__pyx_v_Axis, ((PyArrayObject *)__pyx_t_24));
  __pyx_t_24 = 0;
  __pyx_t_14 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer, (PyObject*)__pyx_t_14, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_22, &__pyx_t_21, &__pyx_t_20);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer, (PyObject*)__pyx_v_Angle, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_22); Py_XDECREF(__pyx_t_21); Py_XDECREF(__pyx_t_20);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_22, __pyx_t_21, __pyx_t_20);
      }
    }
    __pyx_pybuffernd_Angle.diminfo[0].strides = __pyx_pybuffernd_Angle.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Angle.diminfo[0].shape = __pyx_pybuffernd_Angle.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 593, __pyx_L1_error)
  }
  __pyx_t_14 = 0;
  __Pyx_DECREF_SET(__pyx_v_Angle, ((PyArrayObject *)__pyx_t_4));
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":594
 * 
 *     Axis, Angle = conv.qn_to_aap(Q)
 *     Rot = conv.aap_to_rm(Axis, Angle)             # <<<<<<<<<<<<<<
 *     Eul = conv.rm_to_zxz(Rot)
 * 
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_conv); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 594, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_24 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_aap_to_rm); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 594, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_24);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_23 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_24))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_24);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_24);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_24, function);
      __pyx_t_23 = 1;
    }
  }
  __pyx_t_1 = PyTuple_New(2+__pyx_t_23); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 594, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (__pyx_t_4) {
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4); __pyx_t_4 = NULL;
  }
  __Pyx_INCREF(((PyObject *)__pyx_v_Axis));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_Axis));
  PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_23, ((PyObject *)__pyx_v_Axis));
  __Pyx_INCREF(((PyObject *)__pyx_v_Angle));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_Angle));
  PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_23, ((PyObject *)__pyx_v_Angle));
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_24, __pyx_t_1, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 594, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 594, __pyx_L1_error)
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer, (PyObject*)__pyx_t_11, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_20, &__pyx_t_21, &__pyx_t_22);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer, (PyObject*)__pyx_v_Rot, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_21); Py_XDECREF(__pyx_t_22);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_20, __pyx_t_21, __pyx_t_22);
      }
    }
    __pyx_pybuffernd_Rot.diminfo[0].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rot.diminfo[0].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rot.diminfo[1].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rot.diminfo[1].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_Rot.diminfo[2].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_Rot.diminfo[2].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[2];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 594, __pyx_L1_error)
  }
  __pyx_t_11 = 0;
  __Pyx_DECREF_SET(__pyx_v_Rot, ((PyArrayObject *)__pyx_t_5));
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":595
 *     Axis, Angle = conv.qn_to_aap(Q)
 *     Rot = conv.aap_to_rm(Axis, Angle)
 *     Eul = conv.rm_to_zxz(Rot)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_t_24 = __Pyx_GetModuleGlobalName(__pyx_n_s_conv); if (unlikely(!__pyx_t_24)) __PYX_ERR(0, 595, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_24);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_24, __pyx_n_s_rm_to_zxz); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 595, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_24); __pyx_t_24 = 0;
  __pyx_t_24 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_24 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_24)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_24);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_24) {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_1, ((PyObject *)__pyx_v_Rot)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 595, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 595, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_24); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_24); __pyx_t_24 = NULL;
    __Pyx_INCREF(((PyObject *)__pyx_v_Rot));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_Rot));
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, ((PyObject *)__pyx_v_Rot));
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 595, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 595, __pyx_L1_error)
  __pyx_t_12 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_t_12, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_22, &__pyx_t_21, &__pyx_t_20);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_v_Eul, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_22); Py_XDECREF(__pyx_t_21); Py_XDECREF(__pyx_t_20);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_22, __pyx_t_21, __pyx_t_20);
      }
    }
    __pyx_pybuffernd_Eul.diminfo[0].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Eul.diminfo[0].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Eul.diminfo[1].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Eul.diminfo[1].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[1];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 595, __pyx_L1_error)
  }
  __pyx_t_12 = 0;
  __Pyx_DECREF_SET(__pyx_v_Eul, ((PyArrayObject *)__pyx_t_5));
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":599
 * 
 * 
 *     if makecanvas == 0:             # <<<<<<<<<<<<<<
 * 
 *         obj.Eul = Eul
 */
  __pyx_t_38 = ((__pyx_v_makecanvas == 0) != 0);
  if (__pyx_t_38) {

    /* "libTEXTURIZE.pyx":601
 *     if makecanvas == 0:
 * 
 *         obj.Eul = Eul             # <<<<<<<<<<<<<<
 * 
 *     else:
 */
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_Eul, ((PyObject *)__pyx_v_Eul)) < 0) __PYX_ERR(0, 601, __pyx_L1_error)

    /* "libTEXTURIZE.pyx":599
 * 
 * 
 *     if makecanvas == 0:             # <<<<<<<<<<<<<<
 * 
 *         obj.Eul = Eul
 */
    goto __pyx_L7;
  }

  /* "libTEXTURIZE.pyx":604
 * 
 *     else:
 *         obj.EUL = getcanvas(m, n, Eul)             # <<<<<<<<<<<<<<
 * 
 *     toc = time.time()
 */
  /*else*/ {
    __pyx_t_5 = __pyx_f_12libTEXTURIZE_getcanvas(__pyx_v_m, __pyx_v_n, ((PyArrayObject *)__pyx_v_Eul)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 604, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_EUL, __pyx_t_5) < 0) __PYX_ERR(0, 604, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }
  __pyx_L7:;

  /* "libTEXTURIZE.pyx":606
 *         obj.EUL = getcanvas(m, n, Eul)
 * 
 *     toc = time.time()             # <<<<<<<<<<<<<<
 *     obj.exetime = toc - tic
 *     return obj
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_time); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 606, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_time); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 606, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  if (__pyx_t_1) {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 606, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    __pyx_t_5 = __Pyx_PyObject_CallNoArg(__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 606, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_19 = __pyx_PyFloat_AsDouble(__pyx_t_5); if (unlikely((__pyx_t_19 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 606, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_toc = __pyx_t_19;

  /* "libTEXTURIZE.pyx":607
 * 
 *     toc = time.time()
 *     obj.exetime = toc - tic             # <<<<<<<<<<<<<<
 *     return obj
 * 
 */
  __pyx_t_5 = PyFloat_FromDouble((__pyx_v_toc - __pyx_v_tic)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 607, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_exetime, __pyx_t_5) < 0) __PYX_ERR(0, 607, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":608
 *     toc = time.time()
 *     obj.exetime = toc - tic
 *     return obj             # <<<<<<<<<<<<<<
 * 
 * def Texture_URO_miles(obj):  # AXIS ANGLE PAIRS
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_obj);
  __pyx_r = __pyx_v_obj;
  goto __pyx_L0;

  /* "libTEXTURIZE.pyx":543
 * 
 * 
 * def Texture_URO_sm2(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_24);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Beta.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Phi.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Q.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Theta.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_r1.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("libTEXTURIZE.Texture_URO_sm2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Beta.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Phi.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Q.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Theta.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_r1.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XDECREF((PyObject *)__pyx_v_r1);
  __Pyx_XDECREF((PyObject *)__pyx_v_Beta);
  __Pyx_XDECREF((PyObject *)__pyx_v_Theta);
  __Pyx_XDECREF((PyObject *)__pyx_v_Phi);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rot);
  __Pyx_XDECREF((PyObject *)__pyx_v_Eul);
  __Pyx_XDECREF((PyObject *)__pyx_v_Axis);
  __Pyx_XDECREF((PyObject *)__pyx_v_Angle);
  __Pyx_XDECREF((PyObject *)__pyx_v_Nd);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rd);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rv);
  __Pyx_XDECREF((PyObject *)__pyx_v_Q);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "libTEXTURIZE.pyx":610
 *     return obj
 * 
 * def Texture_URO_miles(obj):  # AXIS ANGLE PAIRS             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */

/* Python wrapper */
static PyObject *__pyx_pw_12libTEXTURIZE_15Texture_URO_miles(PyObject *__pyx_self, PyObject *__pyx_v_obj); /*proto*/
static PyMethodDef __pyx_mdef_12libTEXTURIZE_15Texture_URO_miles = {"Texture_URO_miles", (PyCFunction)__pyx_pw_12libTEXTURIZE_15Texture_URO_miles, METH_O, 0};
static PyObject *__pyx_pw_12libTEXTURIZE_15Texture_URO_miles(PyObject *__pyx_self, PyObject *__pyx_v_obj) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Texture_URO_miles (wrapper)", 0);
  __pyx_r = __pyx_pf_12libTEXTURIZE_14Texture_URO_miles(__pyx_self, ((PyObject *)__pyx_v_obj));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_12libTEXTURIZE_14Texture_URO_miles(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_obj) {
  int __pyx_v_myseed;
  int __pyx_v_p;
  int __pyx_v_m;
  int __pyx_v_n;
  int __pyx_v_makecanvas;
  double __pyx_v_tic;
  double __pyx_v_toc;
  int __pyx_v_k;
  float __pyx_v_st;
  float __pyx_v_sp;
  float __pyx_v_ct;
  float __pyx_v_cp;
  float __pyx_v_theta;
  float __pyx_v_phi;
  PyArrayObject *__pyx_v_r1 = 0;
  PyArrayObject *__pyx_v_Theta = 0;
  PyArrayObject *__pyx_v_Phi = 0;
  PyArrayObject *__pyx_v_Rot = 0;
  PyArrayObject *__pyx_v_Eul = 0;
  PyArrayObject *__pyx_v_Axis = 0;
  PyArrayObject *__pyx_v_Angle = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Nd = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Rd = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Rv = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Q = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Angle;
  __Pyx_Buffer __pyx_pybuffer_Angle;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Axis;
  __Pyx_Buffer __pyx_pybuffer_Axis;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Eul;
  __Pyx_Buffer __pyx_pybuffer_Eul;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Nd;
  __Pyx_Buffer __pyx_pybuffer_Nd;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Phi;
  __Pyx_Buffer __pyx_pybuffer_Phi;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Q;
  __Pyx_Buffer __pyx_pybuffer_Q;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rd;
  __Pyx_Buffer __pyx_pybuffer_Rd;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rot;
  __Pyx_Buffer __pyx_pybuffer_Rot;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rv;
  __Pyx_Buffer __pyx_pybuffer_Rv;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Theta;
  __Pyx_Buffer __pyx_pybuffer_Theta;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_r1;
  __Pyx_Buffer __pyx_pybuffer_r1;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyArrayObject *__pyx_t_7 = NULL;
  PyArrayObject *__pyx_t_8 = NULL;
  PyArrayObject *__pyx_t_9 = NULL;
  PyArrayObject *__pyx_t_10 = NULL;
  PyArrayObject *__pyx_t_11 = NULL;
  PyArrayObject *__pyx_t_12 = NULL;
  PyArrayObject *__pyx_t_13 = NULL;
  PyArrayObject *__pyx_t_14 = NULL;
  PyArrayObject *__pyx_t_15 = NULL;
  PyArrayObject *__pyx_t_16 = NULL;
  PyArrayObject *__pyx_t_17 = NULL;
  double __pyx_t_18;
  PyObject *__pyx_t_19 = NULL;
  PyObject *__pyx_t_20 = NULL;
  PyObject *__pyx_t_21 = NULL;
  Py_ssize_t __pyx_t_22;
  PyObject *__pyx_t_23 = NULL;
  int __pyx_t_24;
  Py_ssize_t __pyx_t_25;
  Py_ssize_t __pyx_t_26;
  Py_ssize_t __pyx_t_27;
  Py_ssize_t __pyx_t_28;
  Py_ssize_t __pyx_t_29;
  Py_ssize_t __pyx_t_30;
  Py_ssize_t __pyx_t_31;
  Py_ssize_t __pyx_t_32;
  int __pyx_t_33;
  __Pyx_RefNannySetupContext("Texture_URO_miles", 0);
  __pyx_pybuffer_r1.pybuffer.buf = NULL;
  __pyx_pybuffer_r1.refcount = 0;
  __pyx_pybuffernd_r1.data = NULL;
  __pyx_pybuffernd_r1.rcbuffer = &__pyx_pybuffer_r1;
  __pyx_pybuffer_Theta.pybuffer.buf = NULL;
  __pyx_pybuffer_Theta.refcount = 0;
  __pyx_pybuffernd_Theta.data = NULL;
  __pyx_pybuffernd_Theta.rcbuffer = &__pyx_pybuffer_Theta;
  __pyx_pybuffer_Phi.pybuffer.buf = NULL;
  __pyx_pybuffer_Phi.refcount = 0;
  __pyx_pybuffernd_Phi.data = NULL;
  __pyx_pybuffernd_Phi.rcbuffer = &__pyx_pybuffer_Phi;
  __pyx_pybuffer_Rot.pybuffer.buf = NULL;
  __pyx_pybuffer_Rot.refcount = 0;
  __pyx_pybuffernd_Rot.data = NULL;
  __pyx_pybuffernd_Rot.rcbuffer = &__pyx_pybuffer_Rot;
  __pyx_pybuffer_Eul.pybuffer.buf = NULL;
  __pyx_pybuffer_Eul.refcount = 0;
  __pyx_pybuffernd_Eul.data = NULL;
  __pyx_pybuffernd_Eul.rcbuffer = &__pyx_pybuffer_Eul;
  __pyx_pybuffer_Axis.pybuffer.buf = NULL;
  __pyx_pybuffer_Axis.refcount = 0;
  __pyx_pybuffernd_Axis.data = NULL;
  __pyx_pybuffernd_Axis.rcbuffer = &__pyx_pybuffer_Axis;
  __pyx_pybuffer_Angle.pybuffer.buf = NULL;
  __pyx_pybuffer_Angle.refcount = 0;
  __pyx_pybuffernd_Angle.data = NULL;
  __pyx_pybuffernd_Angle.rcbuffer = &__pyx_pybuffer_Angle;
  __pyx_pybuffer_Nd.pybuffer.buf = NULL;
  __pyx_pybuffer_Nd.refcount = 0;
  __pyx_pybuffernd_Nd.data = NULL;
  __pyx_pybuffernd_Nd.rcbuffer = &__pyx_pybuffer_Nd;
  __pyx_pybuffer_Rd.pybuffer.buf = NULL;
  __pyx_pybuffer_Rd.refcount = 0;
  __pyx_pybuffernd_Rd.data = NULL;
  __pyx_pybuffernd_Rd.rcbuffer = &__pyx_pybuffer_Rd;
  __pyx_pybuffer_Rv.pybuffer.buf = NULL;
  __pyx_pybuffer_Rv.refcount = 0;
  __pyx_pybuffernd_Rv.data = NULL;
  __pyx_pybuffernd_Rv.rcbuffer = &__pyx_pybuffer_Rv;
  __pyx_pybuffer_Q.pybuffer.buf = NULL;
  __pyx_pybuffer_Q.refcount = 0;
  __pyx_pybuffernd_Q.data = NULL;
  __pyx_pybuffernd_Q.rcbuffer = &__pyx_pybuffer_Q;

  /* "libTEXTURIZE.pyx":611
 * 
 * def Texture_URO_miles(obj):  # AXIS ANGLE PAIRS
 *     cdef int myseed = obj.myseed             # <<<<<<<<<<<<<<
 *     cdef int p = obj.p
 *     cdef int m = obj.m
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_myseed); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 611, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 611, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_myseed = __pyx_t_2;

  /* "libTEXTURIZE.pyx":612
 * def Texture_URO_miles(obj):  # AXIS ANGLE PAIRS
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p             # <<<<<<<<<<<<<<
 *     cdef int m = obj.m
 *     cdef int n = obj.n
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 612, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 612, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_p = __pyx_t_2;

  /* "libTEXTURIZE.pyx":613
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 *     cdef int m = obj.m             # <<<<<<<<<<<<<<
 *     cdef int n = obj.n
 *     cdef int makecanvas = obj.makecanvas
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_m); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 613, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 613, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_m = __pyx_t_2;

  /* "libTEXTURIZE.pyx":614
 *     cdef int p = obj.p
 *     cdef int m = obj.m
 *     cdef int n = obj.n             # <<<<<<<<<<<<<<
 *     cdef int makecanvas = obj.makecanvas
 *     cdef double tic, toc
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 614, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 614, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_n = __pyx_t_2;

  /* "libTEXTURIZE.pyx":615
 *     cdef int m = obj.m
 *     cdef int n = obj.n
 *     cdef int makecanvas = obj.makecanvas             # <<<<<<<<<<<<<<
 *     cdef double tic, toc
 * 
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_makecanvas); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 615, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 615, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_makecanvas = __pyx_t_2;

  /* "libTEXTURIZE.pyx":621
 *     cdef float st, sp, ct, cp, theta, phi
 * 
 *     cdef np.ndarray[np.float64_t, ndim = 1] r1 = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Theta = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Phi = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 621, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 621, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 621, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 621, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 621, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 621, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 621, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 621, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 621, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 621, __pyx_L1_error)
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_r1.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_r1 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_r1.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 621, __pyx_L1_error)
    } else {__pyx_pybuffernd_r1.diminfo[0].strides = __pyx_pybuffernd_r1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_r1.diminfo[0].shape = __pyx_pybuffernd_r1.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_r1 = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":622
 * 
 *     cdef np.ndarray[np.float64_t, ndim = 1] r1 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Theta = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Phi = np.zeros(p, dtype=np.float64)
 * 
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 622, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 622, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 622, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 622, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 622, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 622, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 622, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 622, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 622, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 622, __pyx_L1_error)
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Theta.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Theta = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Theta.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 622, __pyx_L1_error)
    } else {__pyx_pybuffernd_Theta.diminfo[0].strides = __pyx_pybuffernd_Theta.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Theta.diminfo[0].shape = __pyx_pybuffernd_Theta.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_8 = 0;
  __pyx_v_Theta = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":623
 *     cdef np.ndarray[np.float64_t, ndim = 1] r1 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Theta = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Phi = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 * 
 *     # DESCRIPTORS OF ORIENTATIONS
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 623, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 623, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 623, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 623, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 623, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 623, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 623, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 623, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 623, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 623, __pyx_L1_error)
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Phi.rcbuffer->pybuffer, (PyObject*)__pyx_t_9, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Phi = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Phi.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 623, __pyx_L1_error)
    } else {__pyx_pybuffernd_Phi.diminfo[0].strides = __pyx_pybuffernd_Phi.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Phi.diminfo[0].shape = __pyx_pybuffernd_Phi.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_9 = 0;
  __pyx_v_Phi = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":626
 * 
 *     # DESCRIPTORS OF ORIENTATIONS
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 626, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 626, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 626, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 626, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_3);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_int_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 626, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 626, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 626, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 626, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 626, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 626, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 626, __pyx_L1_error)
  __pyx_t_10 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer, (PyObject*)__pyx_t_10, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
      __pyx_v_Rot = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 626, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rot.diminfo[0].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rot.diminfo[0].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rot.diminfo[1].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rot.diminfo[1].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_Rot.diminfo[2].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_Rot.diminfo[2].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[2];
    }
  }
  __pyx_t_10 = 0;
  __pyx_v_Rot = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":627
 *     # DESCRIPTORS OF ORIENTATIONS
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 627, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 627, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 627, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 627, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_3);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 627, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 627, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 627, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 627, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 627, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 627, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 627, __pyx_L1_error)
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_t_11, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Eul = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Eul.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 627, __pyx_L1_error)
    } else {__pyx_pybuffernd_Eul.diminfo[0].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Eul.diminfo[0].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Eul.diminfo[1].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Eul.diminfo[1].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_11 = 0;
  __pyx_v_Eul = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":628
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 628, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 628, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 628, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 628, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_3);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 628, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 628, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 628, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 628, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 628, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 628, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 628, __pyx_L1_error)
  __pyx_t_12 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer, (PyObject*)__pyx_t_12, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Axis = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Axis.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 628, __pyx_L1_error)
    } else {__pyx_pybuffernd_Axis.diminfo[0].strides = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Axis.diminfo[0].shape = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Axis.diminfo[1].strides = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Axis.diminfo[1].shape = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_12 = 0;
  __pyx_v_Axis = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":629
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 629, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 629, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 629, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 629, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 629, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 629, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 629, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 629, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 629, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 629, __pyx_L1_error)
  __pyx_t_13 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Angle = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Angle.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 629, __pyx_L1_error)
    } else {__pyx_pybuffernd_Angle.diminfo[0].strides = __pyx_pybuffernd_Angle.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Angle.diminfo[0].shape = __pyx_pybuffernd_Angle.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_13 = 0;
  __pyx_v_Angle = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":630
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 630, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 630, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 630, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 630, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_int_3);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 630, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 630, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 630, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 630, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 630, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 630, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 630, __pyx_L1_error)
  __pyx_t_14 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer, (PyObject*)__pyx_t_14, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Nd = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Nd.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 630, __pyx_L1_error)
    } else {__pyx_pybuffernd_Nd.diminfo[0].strides = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Nd.diminfo[0].shape = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Nd.diminfo[1].strides = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Nd.diminfo[1].shape = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_14 = 0;
  __pyx_v_Nd = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":631
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 631, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 631, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 631, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 631, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 631, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 631, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 631, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 631, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 631, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 631, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 631, __pyx_L1_error)
  __pyx_t_15 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer, (PyObject*)__pyx_t_15, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Rd = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rd.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 631, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rd.diminfo[0].strides = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rd.diminfo[0].shape = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rd.diminfo[1].strides = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rd.diminfo[1].shape = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_15 = 0;
  __pyx_v_Rd = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":632
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)
 * 
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 632, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 632, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 632, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 632, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_3);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 632, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 632, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 632, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 632, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 632, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 632, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 632, __pyx_L1_error)
  __pyx_t_16 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer, (PyObject*)__pyx_t_16, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Rv = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rv.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 632, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rv.diminfo[0].strides = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rv.diminfo[0].shape = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rv.diminfo[1].strides = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rv.diminfo[1].shape = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_16 = 0;
  __pyx_v_Rv = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":633
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)             # <<<<<<<<<<<<<<
 * 
 *     plantseed(myseed)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 633, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 633, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 633, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = PyTuple_New(2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 633, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
  __Pyx_INCREF(__pyx_int_4);
  __Pyx_GIVEREF(__pyx_int_4);
  PyTuple_SET_ITEM(__pyx_t_1, 1, __pyx_int_4);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 633, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 633, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 633, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 633, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 633, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 633, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 633, __pyx_L1_error)
  __pyx_t_17 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Q.rcbuffer->pybuffer, (PyObject*)__pyx_t_17, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Q = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Q.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 633, __pyx_L1_error)
    } else {__pyx_pybuffernd_Q.diminfo[0].strides = __pyx_pybuffernd_Q.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Q.diminfo[0].shape = __pyx_pybuffernd_Q.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Q.diminfo[1].strides = __pyx_pybuffernd_Q.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Q.diminfo[1].shape = __pyx_pybuffernd_Q.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_17 = 0;
  __pyx_v_Q = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":635
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)
 * 
 *     plantseed(myseed)             # <<<<<<<<<<<<<<
 *     tic = time.time()
 * 
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_plantseed); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 635, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_myseed); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 635, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 635, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_GOTREF(__pyx_t_6);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 635, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
    __Pyx_GIVEREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 635, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":636
 * 
 *     plantseed(myseed)
 *     tic = time.time()             # <<<<<<<<<<<<<<
 * 
 *     Angle = ProbSinSquare(0, pi, 2, p)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_time); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 636, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_time); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 636, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  if (__pyx_t_1) {
    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 636, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    __pyx_t_6 = __Pyx_PyObject_CallNoArg(__pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 636, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_18 = __pyx_PyFloat_AsDouble(__pyx_t_6); if (unlikely((__pyx_t_18 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 636, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_tic = __pyx_t_18;

  /* "libTEXTURIZE.pyx":638
 *     tic = time.time()
 * 
 *     Angle = ProbSinSquare(0, pi, 2, p)             # <<<<<<<<<<<<<<
 *     r1 = np.random.uniform(0, 1, [p, ])
 *     Theta = np.arccos(2 * r1 - 1)
 */
  __pyx_t_6 = ((PyObject *)__pyx_f_12libTEXTURIZE_ProbSinSquare(0.0, __pyx_v_12libTEXTURIZE_pi, 2.0, __pyx_v_p)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 638, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer, (PyObject*)((PyArrayObject *)__pyx_t_6), &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_19, &__pyx_t_20, &__pyx_t_21);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer, (PyObject*)__pyx_v_Angle, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_19); Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_21);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_19, __pyx_t_20, __pyx_t_21);
      }
    }
    __pyx_pybuffernd_Angle.diminfo[0].strides = __pyx_pybuffernd_Angle.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Angle.diminfo[0].shape = __pyx_pybuffernd_Angle.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 638, __pyx_L1_error)
  }
  __Pyx_DECREF_SET(__pyx_v_Angle, ((PyArrayObject *)__pyx_t_6));
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":639
 * 
 *     Angle = ProbSinSquare(0, pi, 2, p)
 *     r1 = np.random.uniform(0, 1, [p, ])             # <<<<<<<<<<<<<<
 *     Theta = np.arccos(2 * r1 - 1)
 *     Phi = np.random.uniform(0, 2 * pi, [p, ])
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 639, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_random); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 639, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_uniform); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 639, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 639, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = PyList_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 639, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_1);
  PyList_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  __pyx_t_22 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
      __pyx_t_22 = 1;
    }
  }
  __pyx_t_3 = PyTuple_New(3+__pyx_t_22); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 639, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  if (__pyx_t_1) {
    __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1); __pyx_t_1 = NULL;
  }
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_3, 0+__pyx_t_22, __pyx_int_0);
  __Pyx_INCREF(__pyx_int_1);
  __Pyx_GIVEREF(__pyx_int_1);
  PyTuple_SET_ITEM(__pyx_t_3, 1+__pyx_t_22, __pyx_int_1);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_3, 2+__pyx_t_22, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_3, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 639, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 639, __pyx_L1_error)
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_r1.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_r1.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_21, &__pyx_t_20, &__pyx_t_19);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_r1.rcbuffer->pybuffer, (PyObject*)__pyx_v_r1, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_21); Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_19);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_21, __pyx_t_20, __pyx_t_19);
      }
    }
    __pyx_pybuffernd_r1.diminfo[0].strides = __pyx_pybuffernd_r1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_r1.diminfo[0].shape = __pyx_pybuffernd_r1.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 639, __pyx_L1_error)
  }
  __pyx_t_7 = 0;
  __Pyx_DECREF_SET(__pyx_v_r1, ((PyArrayObject *)__pyx_t_6));
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":640
 *     Angle = ProbSinSquare(0, pi, 2, p)
 *     r1 = np.random.uniform(0, 1, [p, ])
 *     Theta = np.arccos(2 * r1 - 1)             # <<<<<<<<<<<<<<
 *     Phi = np.random.uniform(0, 2 * pi, [p, ])
 * 
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 640, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arccos); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 640, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = PyNumber_Multiply(__pyx_int_2, ((PyObject *)__pyx_v_r1)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 640, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyInt_SubtractObjC(__pyx_t_4, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 640, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 640, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __Pyx_GOTREF(__pyx_t_6);
  } else {
    __pyx_t_1 = PyTuple_New(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 640, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4); __pyx_t_4 = NULL;
    __Pyx_GIVEREF(__pyx_t_5);
    PyTuple_SET_ITEM(__pyx_t_1, 0+1, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_1, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 640, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 640, __pyx_L1_error)
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Theta.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Theta.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_19, &__pyx_t_20, &__pyx_t_21);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Theta.rcbuffer->pybuffer, (PyObject*)__pyx_v_Theta, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_19); Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_21);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_19, __pyx_t_20, __pyx_t_21);
      }
    }
    __pyx_pybuffernd_Theta.diminfo[0].strides = __pyx_pybuffernd_Theta.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Theta.diminfo[0].shape = __pyx_pybuffernd_Theta.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 640, __pyx_L1_error)
  }
  __pyx_t_8 = 0;
  __Pyx_DECREF_SET(__pyx_v_Theta, ((PyArrayObject *)__pyx_t_6));
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":641
 *     r1 = np.random.uniform(0, 1, [p, ])
 *     Theta = np.arccos(2 * r1 - 1)
 *     Phi = np.random.uniform(0, 2 * pi, [p, ])             # <<<<<<<<<<<<<<
 * 
 *     for k in range(p):
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 641, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_random); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 641, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_uniform); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 641, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyFloat_FromDouble((2.0 * __pyx_v_12libTEXTURIZE_pi)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 641, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 641, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 641, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_5);
  PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_22 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
      __pyx_t_22 = 1;
    }
  }
  __pyx_t_23 = PyTuple_New(3+__pyx_t_22); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 641, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_23);
  if (__pyx_t_5) {
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_23, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_23, 0+__pyx_t_22, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_23, 1+__pyx_t_22, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_23, 2+__pyx_t_22, __pyx_t_4);
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_23, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 641, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 641, __pyx_L1_error)
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Phi.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Phi.rcbuffer->pybuffer, (PyObject*)__pyx_t_9, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_21, &__pyx_t_20, &__pyx_t_19);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Phi.rcbuffer->pybuffer, (PyObject*)__pyx_v_Phi, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_21); Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_19);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_21, __pyx_t_20, __pyx_t_19);
      }
    }
    __pyx_pybuffernd_Phi.diminfo[0].strides = __pyx_pybuffernd_Phi.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Phi.diminfo[0].shape = __pyx_pybuffernd_Phi.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 641, __pyx_L1_error)
  }
  __pyx_t_9 = 0;
  __Pyx_DECREF_SET(__pyx_v_Phi, ((PyArrayObject *)__pyx_t_6));
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":643
 *     Phi = np.random.uniform(0, 2 * pi, [p, ])
 * 
 *     for k in range(p):             # <<<<<<<<<<<<<<
 *         theta = Theta[k]
 *         phi = Phi[k]
 */
  __pyx_t_2 = __pyx_v_p;
  for (__pyx_t_24 = 0; __pyx_t_24 < __pyx_t_2; __pyx_t_24+=1) {
    __pyx_v_k = __pyx_t_24;

    /* "libTEXTURIZE.pyx":644
 * 
 *     for k in range(p):
 *         theta = Theta[k]             # <<<<<<<<<<<<<<
 *         phi = Phi[k]
 *         st = sin(theta)
 */
    __pyx_t_25 = __pyx_v_k;
    __pyx_v_theta = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Theta.rcbuffer->pybuffer.buf, __pyx_t_25, __pyx_pybuffernd_Theta.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":645
 *     for k in range(p):
 *         theta = Theta[k]
 *         phi = Phi[k]             # <<<<<<<<<<<<<<
 *         st = sin(theta)
 *         cp = cos(phi)
 */
    __pyx_t_26 = __pyx_v_k;
    __pyx_v_phi = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Phi.rcbuffer->pybuffer.buf, __pyx_t_26, __pyx_pybuffernd_Phi.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":646
 *         theta = Theta[k]
 *         phi = Phi[k]
 *         st = sin(theta)             # <<<<<<<<<<<<<<
 *         cp = cos(phi)
 *         sp = sin(phi)
 */
    __pyx_v_st = sin(__pyx_v_theta);

    /* "libTEXTURIZE.pyx":647
 *         phi = Phi[k]
 *         st = sin(theta)
 *         cp = cos(phi)             # <<<<<<<<<<<<<<
 *         sp = sin(phi)
 *         ct = cos(theta)
 */
    __pyx_v_cp = cos(__pyx_v_phi);

    /* "libTEXTURIZE.pyx":648
 *         st = sin(theta)
 *         cp = cos(phi)
 *         sp = sin(phi)             # <<<<<<<<<<<<<<
 *         ct = cos(theta)
 * 
 */
    __pyx_v_sp = sin(__pyx_v_phi);

    /* "libTEXTURIZE.pyx":649
 *         cp = cos(phi)
 *         sp = sin(phi)
 *         ct = cos(theta)             # <<<<<<<<<<<<<<
 * 
 *         Axis[k, 0] = st * cp
 */
    __pyx_v_ct = cos(__pyx_v_theta);

    /* "libTEXTURIZE.pyx":651
 *         ct = cos(theta)
 * 
 *         Axis[k, 0] = st * cp             # <<<<<<<<<<<<<<
 *         Axis[k, 1] = st * sp
 *         Axis[k, 2] = ct
 */
    __pyx_t_27 = __pyx_v_k;
    __pyx_t_28 = 0;
    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Axis.rcbuffer->pybuffer.buf, __pyx_t_27, __pyx_pybuffernd_Axis.diminfo[0].strides, __pyx_t_28, __pyx_pybuffernd_Axis.diminfo[1].strides) = (__pyx_v_st * __pyx_v_cp);

    /* "libTEXTURIZE.pyx":652
 * 
 *         Axis[k, 0] = st * cp
 *         Axis[k, 1] = st * sp             # <<<<<<<<<<<<<<
 *         Axis[k, 2] = ct
 * 
 */
    __pyx_t_29 = __pyx_v_k;
    __pyx_t_30 = 1;
    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Axis.rcbuffer->pybuffer.buf, __pyx_t_29, __pyx_pybuffernd_Axis.diminfo[0].strides, __pyx_t_30, __pyx_pybuffernd_Axis.diminfo[1].strides) = (__pyx_v_st * __pyx_v_sp);

    /* "libTEXTURIZE.pyx":653
 *         Axis[k, 0] = st * cp
 *         Axis[k, 1] = st * sp
 *         Axis[k, 2] = ct             # <<<<<<<<<<<<<<
 * 
 *     Rot = conv.aap_to_rm(Axis, Angle)
 */
    __pyx_t_31 = __pyx_v_k;
    __pyx_t_32 = 2;
    *__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Axis.rcbuffer->pybuffer.buf, __pyx_t_31, __pyx_pybuffernd_Axis.diminfo[0].strides, __pyx_t_32, __pyx_pybuffernd_Axis.diminfo[1].strides) = __pyx_v_ct;
  }

  /* "libTEXTURIZE.pyx":655
 *         Axis[k, 2] = ct
 * 
 *     Rot = conv.aap_to_rm(Axis, Angle)             # <<<<<<<<<<<<<<
 *     Eul = conv.rm_to_zxz(Rot)
 * 
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_conv); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 655, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_23 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_aap_to_rm); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 655, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_23);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  __pyx_t_22 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_23))) {
    __pyx_t_3 = PyMethod_GET_SELF(__pyx_t_23);
    if (likely(__pyx_t_3)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_23);
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_23, function);
      __pyx_t_22 = 1;
    }
  }
  __pyx_t_4 = PyTuple_New(2+__pyx_t_22); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 655, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__pyx_t_3) {
    __Pyx_GIVEREF(__pyx_t_3); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3); __pyx_t_3 = NULL;
  }
  __Pyx_INCREF(((PyObject *)__pyx_v_Axis));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_Axis));
  PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_22, ((PyObject *)__pyx_v_Axis));
  __Pyx_INCREF(((PyObject *)__pyx_v_Angle));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_Angle));
  PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_22, ((PyObject *)__pyx_v_Angle));
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_23, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 655, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 655, __pyx_L1_error)
  __pyx_t_10 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer, (PyObject*)__pyx_t_10, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_19, &__pyx_t_20, &__pyx_t_21);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer, (PyObject*)__pyx_v_Rot, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_19); Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_21);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_19, __pyx_t_20, __pyx_t_21);
      }
    }
    __pyx_pybuffernd_Rot.diminfo[0].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rot.diminfo[0].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rot.diminfo[1].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rot.diminfo[1].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_Rot.diminfo[2].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_Rot.diminfo[2].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[2];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 655, __pyx_L1_error)
  }
  __pyx_t_10 = 0;
  __Pyx_DECREF_SET(__pyx_v_Rot, ((PyArrayObject *)__pyx_t_6));
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":656
 * 
 *     Rot = conv.aap_to_rm(Axis, Angle)
 *     Eul = conv.rm_to_zxz(Rot)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_t_23 = __Pyx_GetModuleGlobalName(__pyx_n_s_conv); if (unlikely(!__pyx_t_23)) __PYX_ERR(0, 656, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_23);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_23, __pyx_n_s_rm_to_zxz); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 656, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_23); __pyx_t_23 = 0;
  __pyx_t_23 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_23 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_23)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_23);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_23) {
    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_4, ((PyObject *)__pyx_v_Rot)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 656, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
  } else {
    __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 656, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_23); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_23); __pyx_t_23 = NULL;
    __Pyx_INCREF(((PyObject *)__pyx_v_Rot));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_Rot));
    PyTuple_SET_ITEM(__pyx_t_3, 0+1, ((PyObject *)__pyx_v_Rot));
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_3, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 656, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 656, __pyx_L1_error)
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_t_11, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_21, &__pyx_t_20, &__pyx_t_19);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_v_Eul, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_21); Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_19);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_21, __pyx_t_20, __pyx_t_19);
      }
    }
    __pyx_pybuffernd_Eul.diminfo[0].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Eul.diminfo[0].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Eul.diminfo[1].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Eul.diminfo[1].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[1];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 656, __pyx_L1_error)
  }
  __pyx_t_11 = 0;
  __Pyx_DECREF_SET(__pyx_v_Eul, ((PyArrayObject *)__pyx_t_6));
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":660
 * 
 * 
 *     if makecanvas == 0:             # <<<<<<<<<<<<<<
 * 
 *         obj.Eul = Eul
 */
  __pyx_t_33 = ((__pyx_v_makecanvas == 0) != 0);
  if (__pyx_t_33) {

    /* "libTEXTURIZE.pyx":662
 *     if makecanvas == 0:
 * 
 *         obj.Eul = Eul             # <<<<<<<<<<<<<<
 *     else:
 *         obj.EUL = getcanvas(m, n, Eul)
 */
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_Eul, ((PyObject *)__pyx_v_Eul)) < 0) __PYX_ERR(0, 662, __pyx_L1_error)

    /* "libTEXTURIZE.pyx":660
 * 
 * 
 *     if makecanvas == 0:             # <<<<<<<<<<<<<<
 * 
 *         obj.Eul = Eul
 */
    goto __pyx_L5;
  }

  /* "libTEXTURIZE.pyx":664
 *         obj.Eul = Eul
 *     else:
 *         obj.EUL = getcanvas(m, n, Eul)             # <<<<<<<<<<<<<<
 * 
 *     toc = time.time()
 */
  /*else*/ {
    __pyx_t_6 = __pyx_f_12libTEXTURIZE_getcanvas(__pyx_v_m, __pyx_v_n, ((PyArrayObject *)__pyx_v_Eul)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 664, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_EUL, __pyx_t_6) < 0) __PYX_ERR(0, 664, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __pyx_L5:;

  /* "libTEXTURIZE.pyx":666
 *         obj.EUL = getcanvas(m, n, Eul)
 * 
 *     toc = time.time()             # <<<<<<<<<<<<<<
 *     obj.exetime = toc - tic
 *     return obj
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_time); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 666, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_time); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 666, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  if (__pyx_t_4) {
    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 666, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    __pyx_t_6 = __Pyx_PyObject_CallNoArg(__pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 666, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_18 = __pyx_PyFloat_AsDouble(__pyx_t_6); if (unlikely((__pyx_t_18 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 666, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_toc = __pyx_t_18;

  /* "libTEXTURIZE.pyx":667
 * 
 *     toc = time.time()
 *     obj.exetime = toc - tic             # <<<<<<<<<<<<<<
 *     return obj
 * 
 */
  __pyx_t_6 = PyFloat_FromDouble((__pyx_v_toc - __pyx_v_tic)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 667, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_exetime, __pyx_t_6) < 0) __PYX_ERR(0, 667, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":668
 *     toc = time.time()
 *     obj.exetime = toc - tic
 *     return obj             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_obj);
  __pyx_r = __pyx_v_obj;
  goto __pyx_L0;

  /* "libTEXTURIZE.pyx":610
 *     return obj
 * 
 * def Texture_URO_miles(obj):  # AXIS ANGLE PAIRS             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_23);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Phi.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Q.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Theta.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_r1.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("libTEXTURIZE.Texture_URO_miles", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Phi.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Q.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Theta.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_r1.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XDECREF((PyObject *)__pyx_v_r1);
  __Pyx_XDECREF((PyObject *)__pyx_v_Theta);
  __Pyx_XDECREF((PyObject *)__pyx_v_Phi);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rot);
  __Pyx_XDECREF((PyObject *)__pyx_v_Eul);
  __Pyx_XDECREF((PyObject *)__pyx_v_Axis);
  __Pyx_XDECREF((PyObject *)__pyx_v_Angle);
  __Pyx_XDECREF((PyObject *)__pyx_v_Nd);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rd);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rv);
  __Pyx_XDECREF((PyObject *)__pyx_v_Q);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "libTEXTURIZE.pyx":671
 * 
 * 
 * def Texture_URO_mur(obj):  # EULER TRIPLET BASED             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */

/* Python wrapper */
static PyObject *__pyx_pw_12libTEXTURIZE_17Texture_URO_mur(PyObject *__pyx_self, PyObject *__pyx_v_obj); /*proto*/
static PyMethodDef __pyx_mdef_12libTEXTURIZE_17Texture_URO_mur = {"Texture_URO_mur", (PyCFunction)__pyx_pw_12libTEXTURIZE_17Texture_URO_mur, METH_O, 0};
static PyObject *__pyx_pw_12libTEXTURIZE_17Texture_URO_mur(PyObject *__pyx_self, PyObject *__pyx_v_obj) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Texture_URO_mur (wrapper)", 0);
  __pyx_r = __pyx_pf_12libTEXTURIZE_16Texture_URO_mur(__pyx_self, ((PyObject *)__pyx_v_obj));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_12libTEXTURIZE_16Texture_URO_mur(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_obj) {
  int __pyx_v_myseed;
  int __pyx_v_p;
  int __pyx_v_m;
  int __pyx_v_n;
  int __pyx_v_makecanvas;
  double __pyx_v_tic;
  double __pyx_v_toc;
  PyArrayObject *__pyx_v_r1 = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Rot = 0;
  PyArrayObject *__pyx_v_Eul = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Axis = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Angle = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Nd = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Rd = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Rv = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Q = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Angle;
  __Pyx_Buffer __pyx_pybuffer_Angle;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Axis;
  __Pyx_Buffer __pyx_pybuffer_Axis;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Eul;
  __Pyx_Buffer __pyx_pybuffer_Eul;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Nd;
  __Pyx_Buffer __pyx_pybuffer_Nd;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Q;
  __Pyx_Buffer __pyx_pybuffer_Q;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rd;
  __Pyx_Buffer __pyx_pybuffer_Rd;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rot;
  __Pyx_Buffer __pyx_pybuffer_Rot;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rv;
  __Pyx_Buffer __pyx_pybuffer_Rv;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_r1;
  __Pyx_Buffer __pyx_pybuffer_r1;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyArrayObject *__pyx_t_7 = NULL;
  PyArrayObject *__pyx_t_8 = NULL;
  PyArrayObject *__pyx_t_9 = NULL;
  PyArrayObject *__pyx_t_10 = NULL;
  PyArrayObject *__pyx_t_11 = NULL;
  PyArrayObject *__pyx_t_12 = NULL;
  PyArrayObject *__pyx_t_13 = NULL;
  PyArrayObject *__pyx_t_14 = NULL;
  PyArrayObject *__pyx_t_15 = NULL;
  double __pyx_t_16;
  Py_ssize_t __pyx_t_17;
  PyObject *__pyx_t_18 = NULL;
  PyObject *__pyx_t_19 = NULL;
  PyObject *__pyx_t_20 = NULL;
  PyObject *__pyx_t_21 = NULL;
  int __pyx_t_22;
  __Pyx_RefNannySetupContext("Texture_URO_mur", 0);
  __pyx_pybuffer_r1.pybuffer.buf = NULL;
  __pyx_pybuffer_r1.refcount = 0;
  __pyx_pybuffernd_r1.data = NULL;
  __pyx_pybuffernd_r1.rcbuffer = &__pyx_pybuffer_r1;
  __pyx_pybuffer_Rot.pybuffer.buf = NULL;
  __pyx_pybuffer_Rot.refcount = 0;
  __pyx_pybuffernd_Rot.data = NULL;
  __pyx_pybuffernd_Rot.rcbuffer = &__pyx_pybuffer_Rot;
  __pyx_pybuffer_Eul.pybuffer.buf = NULL;
  __pyx_pybuffer_Eul.refcount = 0;
  __pyx_pybuffernd_Eul.data = NULL;
  __pyx_pybuffernd_Eul.rcbuffer = &__pyx_pybuffer_Eul;
  __pyx_pybuffer_Axis.pybuffer.buf = NULL;
  __pyx_pybuffer_Axis.refcount = 0;
  __pyx_pybuffernd_Axis.data = NULL;
  __pyx_pybuffernd_Axis.rcbuffer = &__pyx_pybuffer_Axis;
  __pyx_pybuffer_Angle.pybuffer.buf = NULL;
  __pyx_pybuffer_Angle.refcount = 0;
  __pyx_pybuffernd_Angle.data = NULL;
  __pyx_pybuffernd_Angle.rcbuffer = &__pyx_pybuffer_Angle;
  __pyx_pybuffer_Nd.pybuffer.buf = NULL;
  __pyx_pybuffer_Nd.refcount = 0;
  __pyx_pybuffernd_Nd.data = NULL;
  __pyx_pybuffernd_Nd.rcbuffer = &__pyx_pybuffer_Nd;
  __pyx_pybuffer_Rd.pybuffer.buf = NULL;
  __pyx_pybuffer_Rd.refcount = 0;
  __pyx_pybuffernd_Rd.data = NULL;
  __pyx_pybuffernd_Rd.rcbuffer = &__pyx_pybuffer_Rd;
  __pyx_pybuffer_Rv.pybuffer.buf = NULL;
  __pyx_pybuffer_Rv.refcount = 0;
  __pyx_pybuffernd_Rv.data = NULL;
  __pyx_pybuffernd_Rv.rcbuffer = &__pyx_pybuffer_Rv;
  __pyx_pybuffer_Q.pybuffer.buf = NULL;
  __pyx_pybuffer_Q.refcount = 0;
  __pyx_pybuffernd_Q.data = NULL;
  __pyx_pybuffernd_Q.rcbuffer = &__pyx_pybuffer_Q;

  /* "libTEXTURIZE.pyx":672
 * 
 * def Texture_URO_mur(obj):  # EULER TRIPLET BASED
 *     cdef int myseed = obj.myseed             # <<<<<<<<<<<<<<
 *     cdef int p = obj.p
 *     cdef int m = obj.m
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_myseed); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 672, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 672, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_myseed = __pyx_t_2;

  /* "libTEXTURIZE.pyx":673
 * def Texture_URO_mur(obj):  # EULER TRIPLET BASED
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p             # <<<<<<<<<<<<<<
 *     cdef int m = obj.m
 *     cdef int n = obj.n
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 673, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 673, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_p = __pyx_t_2;

  /* "libTEXTURIZE.pyx":674
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 *     cdef int m = obj.m             # <<<<<<<<<<<<<<
 *     cdef int n = obj.n
 *     cdef int makecanvas = obj.makecanvas
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_m); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 674, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 674, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_m = __pyx_t_2;

  /* "libTEXTURIZE.pyx":675
 *     cdef int p = obj.p
 *     cdef int m = obj.m
 *     cdef int n = obj.n             # <<<<<<<<<<<<<<
 *     cdef int makecanvas = obj.makecanvas
 *     cdef double tic, toc
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 675, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 675, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_n = __pyx_t_2;

  /* "libTEXTURIZE.pyx":676
 *     cdef int m = obj.m
 *     cdef int n = obj.n
 *     cdef int makecanvas = obj.makecanvas             # <<<<<<<<<<<<<<
 *     cdef double tic, toc
 * 
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_makecanvas); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 676, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 676, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_makecanvas = __pyx_t_2;

  /* "libTEXTURIZE.pyx":680
 * 
 * 
 *     cdef np.ndarray[np.float64_t, ndim = 1] r1 = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 * 
 *     # DESCRIPTORS OF ORIENTATIONS
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 680, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 680, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 680, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 680, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 680, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 680, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 680, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 680, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 680, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 680, __pyx_L1_error)
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_r1.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_r1 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_r1.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 680, __pyx_L1_error)
    } else {__pyx_pybuffernd_r1.diminfo[0].strides = __pyx_pybuffernd_r1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_r1.diminfo[0].shape = __pyx_pybuffernd_r1.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_r1 = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":683
 * 
 *     # DESCRIPTORS OF ORIENTATIONS
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 683, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 683, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 683, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 683, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_3);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_int_3);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 683, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 683, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 683, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 683, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 683, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 683, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 683, __pyx_L1_error)
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
      __pyx_v_Rot = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 683, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rot.diminfo[0].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rot.diminfo[0].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rot.diminfo[1].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rot.diminfo[1].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_Rot.diminfo[2].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_Rot.diminfo[2].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[2];
    }
  }
  __pyx_t_8 = 0;
  __pyx_v_Rot = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":684
 *     # DESCRIPTORS OF ORIENTATIONS
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 684, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 684, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 684, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 684, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_int_3);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 684, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 684, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 684, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 684, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 684, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 684, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 684, __pyx_L1_error)
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_t_9, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Eul = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Eul.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 684, __pyx_L1_error)
    } else {__pyx_pybuffernd_Eul.diminfo[0].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Eul.diminfo[0].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Eul.diminfo[1].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Eul.diminfo[1].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_9 = 0;
  __pyx_v_Eul = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":685
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 685, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 685, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 685, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 685, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_3);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_int_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 685, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 685, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 685, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 685, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 685, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 685, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 685, __pyx_L1_error)
  __pyx_t_10 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer, (PyObject*)__pyx_t_10, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Axis = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Axis.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 685, __pyx_L1_error)
    } else {__pyx_pybuffernd_Axis.diminfo[0].strides = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Axis.diminfo[0].shape = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Axis.diminfo[1].strides = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Axis.diminfo[1].shape = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_10 = 0;
  __pyx_v_Axis = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":686
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 686, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 686, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 686, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 686, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 686, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 686, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 686, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 686, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 686, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 686, __pyx_L1_error)
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer, (PyObject*)__pyx_t_11, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Angle = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Angle.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 686, __pyx_L1_error)
    } else {__pyx_pybuffernd_Angle.diminfo[0].strides = __pyx_pybuffernd_Angle.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Angle.diminfo[0].shape = __pyx_pybuffernd_Angle.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_11 = 0;
  __pyx_v_Angle = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":687
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 687, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 687, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 687, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 687, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_3);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 687, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 687, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 687, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 687, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 687, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 687, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 687, __pyx_L1_error)
  __pyx_t_12 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer, (PyObject*)__pyx_t_12, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Nd = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Nd.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 687, __pyx_L1_error)
    } else {__pyx_pybuffernd_Nd.diminfo[0].strides = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Nd.diminfo[0].shape = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Nd.diminfo[1].strides = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Nd.diminfo[1].shape = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_12 = 0;
  __pyx_v_Nd = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":688
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 688, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 688, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 688, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 688, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_3);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 688, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 688, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 688, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 688, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 688, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 688, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 688, __pyx_L1_error)
  __pyx_t_13 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Rd = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rd.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 688, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rd.diminfo[0].strides = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rd.diminfo[0].shape = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rd.diminfo[1].strides = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rd.diminfo[1].shape = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_13 = 0;
  __pyx_v_Rd = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":689
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)
 * 
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 689, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 689, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 689, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 689, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_int_3);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 689, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 689, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 689, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 689, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 689, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 689, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 689, __pyx_L1_error)
  __pyx_t_14 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer, (PyObject*)__pyx_t_14, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Rv = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rv.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 689, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rv.diminfo[0].strides = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rv.diminfo[0].shape = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rv.diminfo[1].strides = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rv.diminfo[1].shape = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_14 = 0;
  __pyx_v_Rv = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":690
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)             # <<<<<<<<<<<<<<
 * 
 *     plantseed(myseed)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 690, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 690, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 690, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 690, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
  __Pyx_INCREF(__pyx_int_4);
  __Pyx_GIVEREF(__pyx_int_4);
  PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_int_4);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 690, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 690, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 690, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 690, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 690, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 690, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 690, __pyx_L1_error)
  __pyx_t_15 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Q.rcbuffer->pybuffer, (PyObject*)__pyx_t_15, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Q = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Q.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 690, __pyx_L1_error)
    } else {__pyx_pybuffernd_Q.diminfo[0].strides = __pyx_pybuffernd_Q.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Q.diminfo[0].shape = __pyx_pybuffernd_Q.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Q.diminfo[1].strides = __pyx_pybuffernd_Q.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Q.diminfo[1].shape = __pyx_pybuffernd_Q.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_15 = 0;
  __pyx_v_Q = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":692
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)
 * 
 *     plantseed(myseed)             # <<<<<<<<<<<<<<
 *     tic = time.time()
 * 
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_plantseed); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 692, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_myseed); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 692, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_6) {
    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 692, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_GOTREF(__pyx_t_3);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 692, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6); __pyx_t_6 = NULL;
    __Pyx_GIVEREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 692, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":693
 * 
 *     plantseed(myseed)
 *     tic = time.time()             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_time); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 693, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_time); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 693, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  if (__pyx_t_5) {
    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 693, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  } else {
    __pyx_t_3 = __Pyx_PyObject_CallNoArg(__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 693, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_16 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_16 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 693, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_tic = __pyx_t_16;

  /* "libTEXTURIZE.pyx":696
 * 
 * 
 *     Eul[0:, 0] = np.random.uniform(0, 2 * pi, [p, ])             # <<<<<<<<<<<<<<
 *     r1 = np.random.uniform(0, 1, [p, ])
 *     Eul[0:, 1] = np.arccos(2 * r1 - 1)
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 696, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_random); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 696, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_uniform); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 696, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = PyFloat_FromDouble((2.0 * __pyx_v_12libTEXTURIZE_pi)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 696, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 696, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = PyList_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 696, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_1);
  PyList_SET_ITEM(__pyx_t_6, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  __pyx_t_17 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
      __pyx_t_17 = 1;
    }
  }
  __pyx_t_18 = PyTuple_New(3+__pyx_t_17); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 696, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_18);
  if (__pyx_t_1) {
    __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_t_1); __pyx_t_1 = NULL;
  }
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_18, 0+__pyx_t_17, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_18, 1+__pyx_t_17, __pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_18, 2+__pyx_t_17, __pyx_t_6);
  __pyx_t_5 = 0;
  __pyx_t_6 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_18, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 696, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_Eul), __pyx_tuple__24, __pyx_t_3) < 0)) __PYX_ERR(0, 696, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":697
 * 
 *     Eul[0:, 0] = np.random.uniform(0, 2 * pi, [p, ])
 *     r1 = np.random.uniform(0, 1, [p, ])             # <<<<<<<<<<<<<<
 *     Eul[0:, 1] = np.arccos(2 * r1 - 1)
 *     Eul[0:, 2] = np.random.uniform(0, 2 * pi, [p, ])
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 697, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_random); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 697, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_18);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_18, __pyx_n_s_uniform); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 697, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_t_18 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 697, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_18);
  __pyx_t_6 = PyList_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 697, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_18);
  PyList_SET_ITEM(__pyx_t_6, 0, __pyx_t_18);
  __pyx_t_18 = 0;
  __pyx_t_18 = NULL;
  __pyx_t_17 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_18 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_18)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_18);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
      __pyx_t_17 = 1;
    }
  }
  __pyx_t_5 = PyTuple_New(3+__pyx_t_17); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 697, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__pyx_t_18) {
    __Pyx_GIVEREF(__pyx_t_18); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_18); __pyx_t_18 = NULL;
  }
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_17, __pyx_int_0);
  __Pyx_INCREF(__pyx_int_1);
  __Pyx_GIVEREF(__pyx_int_1);
  PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_17, __pyx_int_1);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_5, 2+__pyx_t_17, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_5, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 697, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 697, __pyx_L1_error)
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_r1.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_r1.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_19, &__pyx_t_20, &__pyx_t_21);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_r1.rcbuffer->pybuffer, (PyObject*)__pyx_v_r1, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_19); Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_21);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_19, __pyx_t_20, __pyx_t_21);
      }
    }
    __pyx_pybuffernd_r1.diminfo[0].strides = __pyx_pybuffernd_r1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_r1.diminfo[0].shape = __pyx_pybuffernd_r1.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 697, __pyx_L1_error)
  }
  __pyx_t_7 = 0;
  __Pyx_DECREF_SET(__pyx_v_r1, ((PyArrayObject *)__pyx_t_3));
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":698
 *     Eul[0:, 0] = np.random.uniform(0, 2 * pi, [p, ])
 *     r1 = np.random.uniform(0, 1, [p, ])
 *     Eul[0:, 1] = np.arccos(2 * r1 - 1)             # <<<<<<<<<<<<<<
 *     Eul[0:, 2] = np.random.uniform(0, 2 * pi, [p, ])
 * 
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 698, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_arccos); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 698, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = PyNumber_Multiply(__pyx_int_2, ((PyObject *)__pyx_v_r1)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 698, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = __Pyx_PyInt_SubtractObjC(__pyx_t_4, __pyx_int_1, 1, 0); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 698, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 698, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
    __Pyx_GOTREF(__pyx_t_3);
  } else {
    __pyx_t_18 = PyTuple_New(1+1); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 698, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_18);
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_18, 0, __pyx_t_4); __pyx_t_4 = NULL;
    __Pyx_GIVEREF(__pyx_t_6);
    PyTuple_SET_ITEM(__pyx_t_18, 0+1, __pyx_t_6);
    __pyx_t_6 = 0;
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_18, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 698, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_Eul), __pyx_tuple__26, __pyx_t_3) < 0)) __PYX_ERR(0, 698, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":699
 *     r1 = np.random.uniform(0, 1, [p, ])
 *     Eul[0:, 1] = np.arccos(2 * r1 - 1)
 *     Eul[0:, 2] = np.random.uniform(0, 2 * pi, [p, ])             # <<<<<<<<<<<<<<
 * 
 *     Rot = conv.zxz_to_rm(Eul)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 699, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_18 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_random); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 699, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_18);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_18, __pyx_n_s_uniform); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 699, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_18); __pyx_t_18 = 0;
  __pyx_t_18 = PyFloat_FromDouble((2.0 * __pyx_v_12libTEXTURIZE_pi)); if (unlikely(!__pyx_t_18)) __PYX_ERR(0, 699, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_18);
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 699, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = PyList_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 699, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_6);
  PyList_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  __pyx_t_17 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
      __pyx_t_17 = 1;
    }
  }
  __pyx_t_1 = PyTuple_New(3+__pyx_t_17); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 699, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (__pyx_t_6) {
    __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6); __pyx_t_6 = NULL;
  }
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_17, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_t_18);
  PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_17, __pyx_t_18);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_1, 2+__pyx_t_17, __pyx_t_4);
  __pyx_t_18 = 0;
  __pyx_t_4 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 699, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_Eul), __pyx_tuple__28, __pyx_t_3) < 0)) __PYX_ERR(0, 699, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":701
 *     Eul[0:, 2] = np.random.uniform(0, 2 * pi, [p, ])
 * 
 *     Rot = conv.zxz_to_rm(Eul)             # <<<<<<<<<<<<<<
 * 
 *     if makecanvas == 0:
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_conv); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 701, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zxz_to_rm); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 701, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_1, ((PyObject *)__pyx_v_Eul)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 701, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 701, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5); __pyx_t_5 = NULL;
    __Pyx_INCREF(((PyObject *)__pyx_v_Eul));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_Eul));
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, ((PyObject *)__pyx_v_Eul));
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 701, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 701, __pyx_L1_error)
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_21, &__pyx_t_20, &__pyx_t_19);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer, (PyObject*)__pyx_v_Rot, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_21); Py_XDECREF(__pyx_t_20); Py_XDECREF(__pyx_t_19);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_21, __pyx_t_20, __pyx_t_19);
      }
    }
    __pyx_pybuffernd_Rot.diminfo[0].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rot.diminfo[0].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rot.diminfo[1].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rot.diminfo[1].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_Rot.diminfo[2].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_Rot.diminfo[2].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[2];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 701, __pyx_L1_error)
  }
  __pyx_t_8 = 0;
  __Pyx_DECREF_SET(__pyx_v_Rot, ((PyArrayObject *)__pyx_t_3));
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":703
 *     Rot = conv.zxz_to_rm(Eul)
 * 
 *     if makecanvas == 0:             # <<<<<<<<<<<<<<
 * 
 *         obj.Eul = Eul
 */
  __pyx_t_22 = ((__pyx_v_makecanvas == 0) != 0);
  if (__pyx_t_22) {

    /* "libTEXTURIZE.pyx":705
 *     if makecanvas == 0:
 * 
 *         obj.Eul = Eul             # <<<<<<<<<<<<<<
 * 
 *     else:
 */
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_Eul, ((PyObject *)__pyx_v_Eul)) < 0) __PYX_ERR(0, 705, __pyx_L1_error)

    /* "libTEXTURIZE.pyx":703
 *     Rot = conv.zxz_to_rm(Eul)
 * 
 *     if makecanvas == 0:             # <<<<<<<<<<<<<<
 * 
 *         obj.Eul = Eul
 */
    goto __pyx_L3;
  }

  /* "libTEXTURIZE.pyx":708
 * 
 *     else:
 *         obj.EUL = getcanvas(m, n, Eul)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  /*else*/ {
    __pyx_t_3 = __pyx_f_12libTEXTURIZE_getcanvas(__pyx_v_m, __pyx_v_n, ((PyArrayObject *)__pyx_v_Eul)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 708, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_EUL, __pyx_t_3) < 0) __PYX_ERR(0, 708, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  }
  __pyx_L3:;

  /* "libTEXTURIZE.pyx":711
 * 
 * 
 *     toc = time.time()             # <<<<<<<<<<<<<<
 *     obj.exetime = toc - tic
 *     return obj
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_time); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 711, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_time); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 711, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  if (__pyx_t_1) {
    __pyx_t_3 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 711, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  } else {
    __pyx_t_3 = __Pyx_PyObject_CallNoArg(__pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 711, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_16 = __pyx_PyFloat_AsDouble(__pyx_t_3); if (unlikely((__pyx_t_16 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 711, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_toc = __pyx_t_16;

  /* "libTEXTURIZE.pyx":712
 * 
 *     toc = time.time()
 *     obj.exetime = toc - tic             # <<<<<<<<<<<<<<
 *     return obj
 * 
 */
  __pyx_t_3 = PyFloat_FromDouble((__pyx_v_toc - __pyx_v_tic)); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 712, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_exetime, __pyx_t_3) < 0) __PYX_ERR(0, 712, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":713
 *     toc = time.time()
 *     obj.exetime = toc - tic
 *     return obj             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_obj);
  __pyx_r = __pyx_v_obj;
  goto __pyx_L0;

  /* "libTEXTURIZE.pyx":671
 * 
 * 
 * def Texture_URO_mur(obj):  # EULER TRIPLET BASED             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_18);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Q.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_r1.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("libTEXTURIZE.Texture_URO_mur", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Q.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_r1.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XDECREF((PyObject *)__pyx_v_r1);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rot);
  __Pyx_XDECREF((PyObject *)__pyx_v_Eul);
  __Pyx_XDECREF((PyObject *)__pyx_v_Axis);
  __Pyx_XDECREF((PyObject *)__pyx_v_Angle);
  __Pyx_XDECREF((PyObject *)__pyx_v_Nd);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rd);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rv);
  __Pyx_XDECREF((PyObject *)__pyx_v_Q);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "libTEXTURIZE.pyx":716
 * 
 * 
 * def Texture_Fiber(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */

/* Python wrapper */
static PyObject *__pyx_pw_12libTEXTURIZE_19Texture_Fiber(PyObject *__pyx_self, PyObject *__pyx_v_obj); /*proto*/
static PyMethodDef __pyx_mdef_12libTEXTURIZE_19Texture_Fiber = {"Texture_Fiber", (PyCFunction)__pyx_pw_12libTEXTURIZE_19Texture_Fiber, METH_O, 0};
static PyObject *__pyx_pw_12libTEXTURIZE_19Texture_Fiber(PyObject *__pyx_self, PyObject *__pyx_v_obj) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Texture_Fiber (wrapper)", 0);
  __pyx_r = __pyx_pf_12libTEXTURIZE_18Texture_Fiber(__pyx_self, ((PyObject *)__pyx_v_obj));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_12libTEXTURIZE_18Texture_Fiber(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_obj) {
  int __pyx_v_myseed;
  int __pyx_v_p;
  int __pyx_v_m;
  int __pyx_v_n;
  int __pyx_v_makecanvas;
  double __pyx_v_tic;
  double __pyx_v_toc;
  float __pyx_v_xs;
  float __pyx_v_ys;
  float __pyx_v_zs;
  float __pyx_v_xc;
  float __pyx_v_yc;
  float __pyx_v_zc;
  float __pyx_v_thetamax;
  float __pyx_v_thetamin;
  PyObject *__pyx_v_axisdist = NULL;
  float __pyx_v_normC;
  float __pyx_v_normS;
  int __pyx_v_k;
  float __pyx_v_th;
  float __pyx_v_ph;
  float __pyx_v_lm;
  float __pyx_v_sth;
  float __pyx_v_sph;
  float __pyx_v_cth;
  float __pyx_v_cph;
  float __pyx_v_clm;
  float __pyx_v_slm;
  float __pyx_v_STH;
  float __pyx_v_SPH;
  float __pyx_v_CTH;
  float __pyx_v_CPH;
  float __pyx_v_sthcph;
  float __pyx_v_sthsph;
  float __pyx_v_alpha;
  float __pyx_v_beta;
  float __pyx_v_gamma;
  float __pyx_v_den1;
  float __pyx_v_den2;
  float __pyx_v_den3;
  float __pyx_v_den;
  PyArrayObject *__pyx_v_Lambdaa = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Phi = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_V1 = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_V2 = 0;
  PyArrayObject *__pyx_v_X1C = 0;
  PyArrayObject *__pyx_v_X2C = 0;
  PyArrayObject *__pyx_v_X3C = 0;
  PyArrayObject *__pyx_v_X1S = 0;
  PyArrayObject *__pyx_v_X2S = 0;
  PyArrayObject *__pyx_v_X3S = 0;
  PyArrayObject *__pyx_v_aux1 = 0;
  PyArrayObject *__pyx_v_aux2 = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_aux3 = 0;
  PyArrayObject *__pyx_v_Aux1 = 0;
  PyArrayObject *__pyx_v_Aux2 = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Aux3 = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_PHI1 = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_PHI2 = 0;
  PyArrayObject *__pyx_v_Rot = 0;
  PyArrayObject *__pyx_v_Eul = 0;
  PyObject *__pyx_v_PHI = NULL;
  PyObject *__pyx_v_Theta = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Aux1;
  __Pyx_Buffer __pyx_pybuffer_Aux1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Aux2;
  __Pyx_Buffer __pyx_pybuffer_Aux2;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Aux3;
  __Pyx_Buffer __pyx_pybuffer_Aux3;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Eul;
  __Pyx_Buffer __pyx_pybuffer_Eul;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Lambdaa;
  __Pyx_Buffer __pyx_pybuffer_Lambdaa;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_PHI1;
  __Pyx_Buffer __pyx_pybuffer_PHI1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_PHI2;
  __Pyx_Buffer __pyx_pybuffer_PHI2;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Phi;
  __Pyx_Buffer __pyx_pybuffer_Phi;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rot;
  __Pyx_Buffer __pyx_pybuffer_Rot;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_V1;
  __Pyx_Buffer __pyx_pybuffer_V1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_V2;
  __Pyx_Buffer __pyx_pybuffer_V2;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_X1C;
  __Pyx_Buffer __pyx_pybuffer_X1C;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_X1S;
  __Pyx_Buffer __pyx_pybuffer_X1S;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_X2C;
  __Pyx_Buffer __pyx_pybuffer_X2C;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_X2S;
  __Pyx_Buffer __pyx_pybuffer_X2S;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_X3C;
  __Pyx_Buffer __pyx_pybuffer_X3C;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_X3S;
  __Pyx_Buffer __pyx_pybuffer_X3S;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_aux1;
  __Pyx_Buffer __pyx_pybuffer_aux1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_aux2;
  __Pyx_Buffer __pyx_pybuffer_aux2;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_aux3;
  __Pyx_Buffer __pyx_pybuffer_aux3;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  float __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  PyArrayObject *__pyx_t_8 = NULL;
  PyArrayObject *__pyx_t_9 = NULL;
  PyArrayObject *__pyx_t_10 = NULL;
  PyArrayObject *__pyx_t_11 = NULL;
  PyArrayObject *__pyx_t_12 = NULL;
  PyArrayObject *__pyx_t_13 = NULL;
  PyArrayObject *__pyx_t_14 = NULL;
  PyArrayObject *__pyx_t_15 = NULL;
  PyArrayObject *__pyx_t_16 = NULL;
  PyArrayObject *__pyx_t_17 = NULL;
  PyArrayObject *__pyx_t_18 = NULL;
  PyArrayObject *__pyx_t_19 = NULL;
  PyArrayObject *__pyx_t_20 = NULL;
  PyArrayObject *__pyx_t_21 = NULL;
  PyArrayObject *__pyx_t_22 = NULL;
  PyArrayObject *__pyx_t_23 = NULL;
  PyArrayObject *__pyx_t_24 = NULL;
  PyArrayObject *__pyx_t_25 = NULL;
  PyArrayObject *__pyx_t_26 = NULL;
  PyArrayObject *__pyx_t_27 = NULL;
  double __pyx_t_28;
  Py_ssize_t __pyx_t_29;
  Py_ssize_t __pyx_t_30;
  Py_ssize_t __pyx_t_31;
  Py_ssize_t __pyx_t_32;
  Py_ssize_t __pyx_t_33;
  Py_ssize_t __pyx_t_34;
  Py_ssize_t __pyx_t_35;
  PyObject *__pyx_t_36 = NULL;
  Py_ssize_t __pyx_t_37;
  Py_ssize_t __pyx_t_38;
  Py_ssize_t __pyx_t_39;
  Py_ssize_t __pyx_t_40;
  Py_ssize_t __pyx_t_41;
  Py_ssize_t __pyx_t_42;
  PyObject *__pyx_t_43 = NULL;
  PyObject *__pyx_t_44 = NULL;
  PyObject *__pyx_t_45 = NULL;
  Py_ssize_t __pyx_t_46;
  Py_ssize_t __pyx_t_47;
  Py_ssize_t __pyx_t_48;
  Py_ssize_t __pyx_t_49;
  Py_ssize_t __pyx_t_50;
  Py_ssize_t __pyx_t_51;
  PyObject *__pyx_t_52 = NULL;
  int __pyx_t_53;
  Py_ssize_t __pyx_t_54;
  Py_ssize_t __pyx_t_55;
  Py_ssize_t __pyx_t_56;
  Py_ssize_t __pyx_t_57;
  Py_ssize_t __pyx_t_58;
  Py_ssize_t __pyx_t_59;
  Py_ssize_t __pyx_t_60;
  Py_ssize_t __pyx_t_61;
  Py_ssize_t __pyx_t_62;
  Py_ssize_t __pyx_t_63;
  Py_ssize_t __pyx_t_64;
  Py_ssize_t __pyx_t_65;
  Py_ssize_t __pyx_t_66;
  Py_ssize_t __pyx_t_67;
  Py_ssize_t __pyx_t_68;
  Py_ssize_t __pyx_t_69;
  Py_ssize_t __pyx_t_70;
  Py_ssize_t __pyx_t_71;
  Py_ssize_t __pyx_t_72;
  Py_ssize_t __pyx_t_73;
  Py_ssize_t __pyx_t_74;
  Py_ssize_t __pyx_t_75;
  Py_ssize_t __pyx_t_76;
  Py_ssize_t __pyx_t_77;
  Py_ssize_t __pyx_t_78;
  Py_ssize_t __pyx_t_79;
  Py_ssize_t __pyx_t_80;
  Py_ssize_t __pyx_t_81;
  Py_ssize_t __pyx_t_82;
  Py_ssize_t __pyx_t_83;
  Py_ssize_t __pyx_t_84;
  Py_ssize_t __pyx_t_85;
  Py_ssize_t __pyx_t_86;
  Py_ssize_t __pyx_t_87;
  Py_ssize_t __pyx_t_88;
  Py_ssize_t __pyx_t_89;
  Py_ssize_t __pyx_t_90;
  Py_ssize_t __pyx_t_91;
  Py_ssize_t __pyx_t_92;
  Py_ssize_t __pyx_t_93;
  Py_ssize_t __pyx_t_94;
  Py_ssize_t __pyx_t_95;
  Py_ssize_t __pyx_t_96;
  Py_ssize_t __pyx_t_97;
  Py_ssize_t __pyx_t_98;
  Py_ssize_t __pyx_t_99;
  Py_ssize_t __pyx_t_100;
  Py_ssize_t __pyx_t_101;
  Py_ssize_t __pyx_t_102;
  Py_ssize_t __pyx_t_103;
  Py_ssize_t __pyx_t_104;
  Py_ssize_t __pyx_t_105;
  Py_ssize_t __pyx_t_106;
  Py_ssize_t __pyx_t_107;
  Py_ssize_t __pyx_t_108;
  Py_ssize_t __pyx_t_109;
  Py_ssize_t __pyx_t_110;
  Py_ssize_t __pyx_t_111;
  Py_ssize_t __pyx_t_112;
  Py_ssize_t __pyx_t_113;
  Py_ssize_t __pyx_t_114;
  Py_ssize_t __pyx_t_115;
  Py_ssize_t __pyx_t_116;
  Py_ssize_t __pyx_t_117;
  Py_ssize_t __pyx_t_118;
  Py_ssize_t __pyx_t_119;
  Py_ssize_t __pyx_t_120;
  Py_ssize_t __pyx_t_121;
  Py_ssize_t __pyx_t_122;
  Py_ssize_t __pyx_t_123;
  Py_ssize_t __pyx_t_124;
  Py_ssize_t __pyx_t_125;
  Py_ssize_t __pyx_t_126;
  Py_ssize_t __pyx_t_127;
  Py_ssize_t __pyx_t_128;
  Py_ssize_t __pyx_t_129;
  Py_ssize_t __pyx_t_130;
  Py_ssize_t __pyx_t_131;
  Py_ssize_t __pyx_t_132;
  Py_ssize_t __pyx_t_133;
  Py_ssize_t __pyx_t_134;
  Py_ssize_t __pyx_t_135;
  Py_ssize_t __pyx_t_136;
  Py_ssize_t __pyx_t_137;
  Py_ssize_t __pyx_t_138;
  Py_ssize_t __pyx_t_139;
  Py_ssize_t __pyx_t_140;
  Py_ssize_t __pyx_t_141;
  Py_ssize_t __pyx_t_142;
  Py_ssize_t __pyx_t_143;
  Py_ssize_t __pyx_t_144;
  Py_ssize_t __pyx_t_145;
  Py_ssize_t __pyx_t_146;
  Py_ssize_t __pyx_t_147;
  Py_ssize_t __pyx_t_148;
  Py_ssize_t __pyx_t_149;
  Py_ssize_t __pyx_t_150;
  Py_ssize_t __pyx_t_151;
  Py_ssize_t __pyx_t_152;
  Py_ssize_t __pyx_t_153;
  Py_ssize_t __pyx_t_154;
  Py_ssize_t __pyx_t_155;
  Py_ssize_t __pyx_t_156;
  Py_ssize_t __pyx_t_157;
  Py_ssize_t __pyx_t_158;
  Py_ssize_t __pyx_t_159;
  Py_ssize_t __pyx_t_160;
  Py_ssize_t __pyx_t_161;
  Py_ssize_t __pyx_t_162;
  Py_ssize_t __pyx_t_163;
  Py_ssize_t __pyx_t_164;
  Py_ssize_t __pyx_t_165;
  Py_ssize_t __pyx_t_166;
  Py_ssize_t __pyx_t_167;
  Py_ssize_t __pyx_t_168;
  Py_ssize_t __pyx_t_169;
  Py_ssize_t __pyx_t_170;
  Py_ssize_t __pyx_t_171;
  Py_ssize_t __pyx_t_172;
  Py_ssize_t __pyx_t_173;
  Py_ssize_t __pyx_t_174;
  Py_ssize_t __pyx_t_175;
  Py_ssize_t __pyx_t_176;
  Py_ssize_t __pyx_t_177;
  Py_ssize_t __pyx_t_178;
  Py_ssize_t __pyx_t_179;
  Py_ssize_t __pyx_t_180;
  Py_ssize_t __pyx_t_181;
  Py_ssize_t __pyx_t_182;
  Py_ssize_t __pyx_t_183;
  Py_ssize_t __pyx_t_184;
  Py_ssize_t __pyx_t_185;
  Py_ssize_t __pyx_t_186;
  int __pyx_t_187;
  __Pyx_RefNannySetupContext("Texture_Fiber", 0);
  __pyx_pybuffer_Lambdaa.pybuffer.buf = NULL;
  __pyx_pybuffer_Lambdaa.refcount = 0;
  __pyx_pybuffernd_Lambdaa.data = NULL;
  __pyx_pybuffernd_Lambdaa.rcbuffer = &__pyx_pybuffer_Lambdaa;
  __pyx_pybuffer_Phi.pybuffer.buf = NULL;
  __pyx_pybuffer_Phi.refcount = 0;
  __pyx_pybuffernd_Phi.data = NULL;
  __pyx_pybuffernd_Phi.rcbuffer = &__pyx_pybuffer_Phi;
  __pyx_pybuffer_V1.pybuffer.buf = NULL;
  __pyx_pybuffer_V1.refcount = 0;
  __pyx_pybuffernd_V1.data = NULL;
  __pyx_pybuffernd_V1.rcbuffer = &__pyx_pybuffer_V1;
  __pyx_pybuffer_V2.pybuffer.buf = NULL;
  __pyx_pybuffer_V2.refcount = 0;
  __pyx_pybuffernd_V2.data = NULL;
  __pyx_pybuffernd_V2.rcbuffer = &__pyx_pybuffer_V2;
  __pyx_pybuffer_X1C.pybuffer.buf = NULL;
  __pyx_pybuffer_X1C.refcount = 0;
  __pyx_pybuffernd_X1C.data = NULL;
  __pyx_pybuffernd_X1C.rcbuffer = &__pyx_pybuffer_X1C;
  __pyx_pybuffer_X2C.pybuffer.buf = NULL;
  __pyx_pybuffer_X2C.refcount = 0;
  __pyx_pybuffernd_X2C.data = NULL;
  __pyx_pybuffernd_X2C.rcbuffer = &__pyx_pybuffer_X2C;
  __pyx_pybuffer_X3C.pybuffer.buf = NULL;
  __pyx_pybuffer_X3C.refcount = 0;
  __pyx_pybuffernd_X3C.data = NULL;
  __pyx_pybuffernd_X3C.rcbuffer = &__pyx_pybuffer_X3C;
  __pyx_pybuffer_X1S.pybuffer.buf = NULL;
  __pyx_pybuffer_X1S.refcount = 0;
  __pyx_pybuffernd_X1S.data = NULL;
  __pyx_pybuffernd_X1S.rcbuffer = &__pyx_pybuffer_X1S;
  __pyx_pybuffer_X2S.pybuffer.buf = NULL;
  __pyx_pybuffer_X2S.refcount = 0;
  __pyx_pybuffernd_X2S.data = NULL;
  __pyx_pybuffernd_X2S.rcbuffer = &__pyx_pybuffer_X2S;
  __pyx_pybuffer_X3S.pybuffer.buf = NULL;
  __pyx_pybuffer_X3S.refcount = 0;
  __pyx_pybuffernd_X3S.data = NULL;
  __pyx_pybuffernd_X3S.rcbuffer = &__pyx_pybuffer_X3S;
  __pyx_pybuffer_aux1.pybuffer.buf = NULL;
  __pyx_pybuffer_aux1.refcount = 0;
  __pyx_pybuffernd_aux1.data = NULL;
  __pyx_pybuffernd_aux1.rcbuffer = &__pyx_pybuffer_aux1;
  __pyx_pybuffer_aux2.pybuffer.buf = NULL;
  __pyx_pybuffer_aux2.refcount = 0;
  __pyx_pybuffernd_aux2.data = NULL;
  __pyx_pybuffernd_aux2.rcbuffer = &__pyx_pybuffer_aux2;
  __pyx_pybuffer_aux3.pybuffer.buf = NULL;
  __pyx_pybuffer_aux3.refcount = 0;
  __pyx_pybuffernd_aux3.data = NULL;
  __pyx_pybuffernd_aux3.rcbuffer = &__pyx_pybuffer_aux3;
  __pyx_pybuffer_Aux1.pybuffer.buf = NULL;
  __pyx_pybuffer_Aux1.refcount = 0;
  __pyx_pybuffernd_Aux1.data = NULL;
  __pyx_pybuffernd_Aux1.rcbuffer = &__pyx_pybuffer_Aux1;
  __pyx_pybuffer_Aux2.pybuffer.buf = NULL;
  __pyx_pybuffer_Aux2.refcount = 0;
  __pyx_pybuffernd_Aux2.data = NULL;
  __pyx_pybuffernd_Aux2.rcbuffer = &__pyx_pybuffer_Aux2;
  __pyx_pybuffer_Aux3.pybuffer.buf = NULL;
  __pyx_pybuffer_Aux3.refcount = 0;
  __pyx_pybuffernd_Aux3.data = NULL;
  __pyx_pybuffernd_Aux3.rcbuffer = &__pyx_pybuffer_Aux3;
  __pyx_pybuffer_PHI1.pybuffer.buf = NULL;
  __pyx_pybuffer_PHI1.refcount = 0;
  __pyx_pybuffernd_PHI1.data = NULL;
  __pyx_pybuffernd_PHI1.rcbuffer = &__pyx_pybuffer_PHI1;
  __pyx_pybuffer_PHI2.pybuffer.buf = NULL;
  __pyx_pybuffer_PHI2.refcount = 0;
  __pyx_pybuffernd_PHI2.data = NULL;
  __pyx_pybuffernd_PHI2.rcbuffer = &__pyx_pybuffer_PHI2;
  __pyx_pybuffer_Rot.pybuffer.buf = NULL;
  __pyx_pybuffer_Rot.refcount = 0;
  __pyx_pybuffernd_Rot.data = NULL;
  __pyx_pybuffernd_Rot.rcbuffer = &__pyx_pybuffer_Rot;
  __pyx_pybuffer_Eul.pybuffer.buf = NULL;
  __pyx_pybuffer_Eul.refcount = 0;
  __pyx_pybuffernd_Eul.data = NULL;
  __pyx_pybuffernd_Eul.rcbuffer = &__pyx_pybuffer_Eul;

  /* "libTEXTURIZE.pyx":717
 * 
 * def Texture_Fiber(obj):
 *     cdef int myseed = obj.myseed             # <<<<<<<<<<<<<<
 *     cdef int p = obj.p
 *     cdef int m = obj.m
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_myseed); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 717, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 717, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_myseed = __pyx_t_2;

  /* "libTEXTURIZE.pyx":718
 * def Texture_Fiber(obj):
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p             # <<<<<<<<<<<<<<
 *     cdef int m = obj.m
 *     cdef int n = obj.n
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 718, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 718, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_p = __pyx_t_2;

  /* "libTEXTURIZE.pyx":719
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 *     cdef int m = obj.m             # <<<<<<<<<<<<<<
 *     cdef int n = obj.n
 *     cdef int makecanvas = obj.makecanvas
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_m); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 719, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 719, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_m = __pyx_t_2;

  /* "libTEXTURIZE.pyx":720
 *     cdef int p = obj.p
 *     cdef int m = obj.m
 *     cdef int n = obj.n             # <<<<<<<<<<<<<<
 *     cdef int makecanvas = obj.makecanvas
 *     cdef double tic, toc
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 720, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 720, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_n = __pyx_t_2;

  /* "libTEXTURIZE.pyx":721
 *     cdef int m = obj.m
 *     cdef int n = obj.n
 *     cdef int makecanvas = obj.makecanvas             # <<<<<<<<<<<<<<
 *     cdef double tic, toc
 * 
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_makecanvas); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 721, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 721, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_makecanvas = __pyx_t_2;

  /* "libTEXTURIZE.pyx":724
 *     cdef double tic, toc
 * 
 *     cdef float xs = obj.xs             # <<<<<<<<<<<<<<
 *     cdef float ys = obj.ys
 *     cdef float zs = obj.zs
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_xs); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 724, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_1); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 724, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_xs = __pyx_t_3;

  /* "libTEXTURIZE.pyx":725
 * 
 *     cdef float xs = obj.xs
 *     cdef float ys = obj.ys             # <<<<<<<<<<<<<<
 *     cdef float zs = obj.zs
 *     cdef float xc = obj.xc
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_ys); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 725, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_1); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 725, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_ys = __pyx_t_3;

  /* "libTEXTURIZE.pyx":726
 *     cdef float xs = obj.xs
 *     cdef float ys = obj.ys
 *     cdef float zs = obj.zs             # <<<<<<<<<<<<<<
 *     cdef float xc = obj.xc
 *     cdef float yc = obj.yc
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_zs); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 726, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_1); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 726, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_zs = __pyx_t_3;

  /* "libTEXTURIZE.pyx":727
 *     cdef float ys = obj.ys
 *     cdef float zs = obj.zs
 *     cdef float xc = obj.xc             # <<<<<<<<<<<<<<
 *     cdef float yc = obj.yc
 *     cdef float zc = obj.zc
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_xc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 727, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_1); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 727, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_xc = __pyx_t_3;

  /* "libTEXTURIZE.pyx":728
 *     cdef float zs = obj.zs
 *     cdef float xc = obj.xc
 *     cdef float yc = obj.yc             # <<<<<<<<<<<<<<
 *     cdef float zc = obj.zc
 *     cdef float thetamax = obj.thetamax
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_yc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 728, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_1); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 728, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_yc = __pyx_t_3;

  /* "libTEXTURIZE.pyx":729
 *     cdef float xc = obj.xc
 *     cdef float yc = obj.yc
 *     cdef float zc = obj.zc             # <<<<<<<<<<<<<<
 *     cdef float thetamax = obj.thetamax
 *     cdef float thetamin = obj.thetamin
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_zc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 729, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_1); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 729, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_zc = __pyx_t_3;

  /* "libTEXTURIZE.pyx":730
 *     cdef float yc = obj.yc
 *     cdef float zc = obj.zc
 *     cdef float thetamax = obj.thetamax             # <<<<<<<<<<<<<<
 *     cdef float thetamin = obj.thetamin
 *     axisdist = obj.axisdist
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_thetamax); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 730, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_1); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 730, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_thetamax = __pyx_t_3;

  /* "libTEXTURIZE.pyx":731
 *     cdef float zc = obj.zc
 *     cdef float thetamax = obj.thetamax
 *     cdef float thetamin = obj.thetamin             # <<<<<<<<<<<<<<
 *     axisdist = obj.axisdist
 * 
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_thetamin); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 731, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_1); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 731, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_thetamin = __pyx_t_3;

  /* "libTEXTURIZE.pyx":732
 *     cdef float thetamax = obj.thetamax
 *     cdef float thetamin = obj.thetamin
 *     axisdist = obj.axisdist             # <<<<<<<<<<<<<<
 * 
 *     cdef float normC
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_axisdist); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 732, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_axisdist = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":740
 *     cdef float th, ph, lm , sth, sph, cth, cph, clm, slm, STH, SPH, CTH, CPH, sthcph, sthsph, a
 *     cdef float alpha, beta, gamma, den1, den2, den3, den
 *     cdef np.ndarray[np.float64_t, ndim = 1] Lambdaa = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Phi = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 740, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 740, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 740, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 740, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 740, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 740, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 740, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 740, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 740, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 740, __pyx_L1_error)
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_7);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Lambdaa.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Lambdaa = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Lambdaa.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 740, __pyx_L1_error)
    } else {__pyx_pybuffernd_Lambdaa.diminfo[0].strides = __pyx_pybuffernd_Lambdaa.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Lambdaa.diminfo[0].shape = __pyx_pybuffernd_Lambdaa.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_8 = 0;
  __pyx_v_Lambdaa = ((PyArrayObject *)__pyx_t_7);
  __pyx_t_7 = 0;

  /* "libTEXTURIZE.pyx":741
 *     cdef float alpha, beta, gamma, den1, den2, den3, den
 *     cdef np.ndarray[np.float64_t, ndim = 1] Lambdaa = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Phi = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 741, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 741, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 741, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 741, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_7);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_7);
  __pyx_t_7 = 0;
  __pyx_t_7 = PyDict_New(); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 741, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 741, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 741, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 741, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_5, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 741, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 741, __pyx_L1_error)
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Phi.rcbuffer->pybuffer, (PyObject*)__pyx_t_9, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Phi = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Phi.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 741, __pyx_L1_error)
    } else {__pyx_pybuffernd_Phi.diminfo[0].strides = __pyx_pybuffernd_Phi.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Phi.diminfo[0].shape = __pyx_pybuffernd_Phi.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_9 = 0;
  __pyx_v_Phi = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":742
 *     cdef np.ndarray[np.float64_t, ndim = 1] Lambdaa = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Phi = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X1C = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 742, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 742, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 742, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 742, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 742, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 742, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_tuple__29, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 742, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 742, __pyx_L1_error)
  __pyx_t_10 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_V1.rcbuffer->pybuffer, (PyObject*)__pyx_t_10, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_V1 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_V1.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 742, __pyx_L1_error)
    } else {__pyx_pybuffernd_V1.diminfo[0].strides = __pyx_pybuffernd_V1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_V1.diminfo[0].shape = __pyx_pybuffernd_V1.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_10 = 0;
  __pyx_v_V1 = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":743
 *     cdef np.ndarray[np.float64_t, ndim = 1] Phi = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] X1C = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X2C = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 743, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 743, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 743, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 743, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 743, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 743, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__30, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 743, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 743, __pyx_L1_error)
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_V2.rcbuffer->pybuffer, (PyObject*)__pyx_t_11, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_V2 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_V2.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 743, __pyx_L1_error)
    } else {__pyx_pybuffernd_V2.diminfo[0].strides = __pyx_pybuffernd_V2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_V2.diminfo[0].shape = __pyx_pybuffernd_V2.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_11 = 0;
  __pyx_v_V2 = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":744
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X1C = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] X2C = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3C = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 744, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 744, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 744, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 744, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 744, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 744, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__31, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 744, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 744, __pyx_L1_error)
  __pyx_t_12 = ((PyArrayObject *)__pyx_t_7);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_X1C.rcbuffer->pybuffer, (PyObject*)__pyx_t_12, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_X1C = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_X1C.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 744, __pyx_L1_error)
    } else {__pyx_pybuffernd_X1C.diminfo[0].strides = __pyx_pybuffernd_X1C.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_X1C.diminfo[0].shape = __pyx_pybuffernd_X1C.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_12 = 0;
  __pyx_v_X1C = ((PyArrayObject *)__pyx_t_7);
  __pyx_t_7 = 0;

  /* "libTEXTURIZE.pyx":745
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X1C = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X2C = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3C = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X1S = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 745, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 745, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = PyDict_New(); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 745, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 745, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 745, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 745, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__32, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 745, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 745, __pyx_L1_error)
  __pyx_t_13 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_X2C.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_X2C = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_X2C.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 745, __pyx_L1_error)
    } else {__pyx_pybuffernd_X2C.diminfo[0].strides = __pyx_pybuffernd_X2C.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_X2C.diminfo[0].shape = __pyx_pybuffernd_X2C.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_13 = 0;
  __pyx_v_X2C = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":746
 *     cdef np.ndarray[np.float64_t, ndim = 1] X1C = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X2C = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3C = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] X1S = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X2S = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 746, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 746, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 746, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 746, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 746, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 746, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_tuple__33, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 746, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 746, __pyx_L1_error)
  __pyx_t_14 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_X3C.rcbuffer->pybuffer, (PyObject*)__pyx_t_14, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_X3C = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_X3C.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 746, __pyx_L1_error)
    } else {__pyx_pybuffernd_X3C.diminfo[0].strides = __pyx_pybuffernd_X3C.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_X3C.diminfo[0].shape = __pyx_pybuffernd_X3C.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_14 = 0;
  __pyx_v_X3C = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":747
 *     cdef np.ndarray[np.float64_t, ndim = 1] X2C = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3C = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X1S = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] X2S = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3S = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 747, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 747, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 747, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 747, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 747, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 747, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__34, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 747, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 747, __pyx_L1_error)
  __pyx_t_15 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_X1S.rcbuffer->pybuffer, (PyObject*)__pyx_t_15, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_X1S = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 747, __pyx_L1_error)
    } else {__pyx_pybuffernd_X1S.diminfo[0].strides = __pyx_pybuffernd_X1S.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_X1S.diminfo[0].shape = __pyx_pybuffernd_X1S.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_15 = 0;
  __pyx_v_X1S = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":748
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3C = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X1S = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X2S = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3S = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux1 = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 748, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 748, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 748, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 748, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 748, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 748, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__35, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 748, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 748, __pyx_L1_error)
  __pyx_t_16 = ((PyArrayObject *)__pyx_t_7);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_X2S.rcbuffer->pybuffer, (PyObject*)__pyx_t_16, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_X2S = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_X2S.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 748, __pyx_L1_error)
    } else {__pyx_pybuffernd_X2S.diminfo[0].strides = __pyx_pybuffernd_X2S.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_X2S.diminfo[0].shape = __pyx_pybuffernd_X2S.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_16 = 0;
  __pyx_v_X2S = ((PyArrayObject *)__pyx_t_7);
  __pyx_t_7 = 0;

  /* "libTEXTURIZE.pyx":749
 *     cdef np.ndarray[np.float64_t, ndim = 1] X1S = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X2S = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3S = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux2 = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 749, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 749, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = PyDict_New(); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 749, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 749, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 749, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 749, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__36, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 749, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 749, __pyx_L1_error)
  __pyx_t_17 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_X3S.rcbuffer->pybuffer, (PyObject*)__pyx_t_17, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_X3S = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_X3S.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 749, __pyx_L1_error)
    } else {__pyx_pybuffernd_X3S.diminfo[0].strides = __pyx_pybuffernd_X3S.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_X3S.diminfo[0].shape = __pyx_pybuffernd_X3S.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_17 = 0;
  __pyx_v_X3S = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":750
 *     cdef np.ndarray[np.float64_t, ndim = 1] X2S = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3S = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux1 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux3 = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 750, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 750, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 750, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 750, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 750, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 750, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_tuple__37, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 750, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 750, __pyx_L1_error)
  __pyx_t_18 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_aux1.rcbuffer->pybuffer, (PyObject*)__pyx_t_18, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_aux1 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_aux1.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 750, __pyx_L1_error)
    } else {__pyx_pybuffernd_aux1.diminfo[0].strides = __pyx_pybuffernd_aux1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_aux1.diminfo[0].shape = __pyx_pybuffernd_aux1.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_18 = 0;
  __pyx_v_aux1 = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":751
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3S = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux2 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux3 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux1 = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 751, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 751, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 751, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 751, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 751, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 751, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__38, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 751, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 751, __pyx_L1_error)
  __pyx_t_19 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_aux2.rcbuffer->pybuffer, (PyObject*)__pyx_t_19, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_aux2 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_aux2.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 751, __pyx_L1_error)
    } else {__pyx_pybuffernd_aux2.diminfo[0].strides = __pyx_pybuffernd_aux2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_aux2.diminfo[0].shape = __pyx_pybuffernd_aux2.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_19 = 0;
  __pyx_v_aux2 = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":752
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux3 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux2 = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 752, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 752, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 752, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 752, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 752, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 752, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__39, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 752, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 752, __pyx_L1_error)
  __pyx_t_20 = ((PyArrayObject *)__pyx_t_7);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_aux3.rcbuffer->pybuffer, (PyObject*)__pyx_t_20, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_aux3 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_aux3.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 752, __pyx_L1_error)
    } else {__pyx_pybuffernd_aux3.diminfo[0].strides = __pyx_pybuffernd_aux3.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_aux3.diminfo[0].shape = __pyx_pybuffernd_aux3.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_20 = 0;
  __pyx_v_aux3 = ((PyArrayObject *)__pyx_t_7);
  __pyx_t_7 = 0;

  /* "libTEXTURIZE.pyx":753
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux3 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux1 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux3 = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 753, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 753, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = PyDict_New(); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 753, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 753, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 753, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 753, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__40, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 753, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 753, __pyx_L1_error)
  __pyx_t_21 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Aux1.rcbuffer->pybuffer, (PyObject*)__pyx_t_21, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Aux1 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Aux1.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 753, __pyx_L1_error)
    } else {__pyx_pybuffernd_Aux1.diminfo[0].strides = __pyx_pybuffernd_Aux1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Aux1.diminfo[0].shape = __pyx_pybuffernd_Aux1.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_21 = 0;
  __pyx_v_Aux1 = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":754
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux3 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux2 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux3 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] PHI1 = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 754, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 754, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 754, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 754, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 754, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 754, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_tuple__41, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 754, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 754, __pyx_L1_error)
  __pyx_t_22 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Aux2.rcbuffer->pybuffer, (PyObject*)__pyx_t_22, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Aux2 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Aux2.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 754, __pyx_L1_error)
    } else {__pyx_pybuffernd_Aux2.diminfo[0].strides = __pyx_pybuffernd_Aux2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Aux2.diminfo[0].shape = __pyx_pybuffernd_Aux2.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_22 = 0;
  __pyx_v_Aux2 = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":755
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux3 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] PHI1 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] PHI2 = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 755, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 755, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 755, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 755, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 755, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 755, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__42, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 755, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 755, __pyx_L1_error)
  __pyx_t_23 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Aux3.rcbuffer->pybuffer, (PyObject*)__pyx_t_23, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Aux3 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Aux3.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 755, __pyx_L1_error)
    } else {__pyx_pybuffernd_Aux3.diminfo[0].strides = __pyx_pybuffernd_Aux3.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Aux3.diminfo[0].shape = __pyx_pybuffernd_Aux3.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_23 = 0;
  __pyx_v_Aux3 = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":756
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux3 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] PHI1 = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] PHI2 = np.zeros(p, dtype=np.float64)
 * 
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 756, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 756, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 756, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 756, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 756, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 756, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 756, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 756, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 756, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 756, __pyx_L1_error)
  __pyx_t_24 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_PHI1.rcbuffer->pybuffer, (PyObject*)__pyx_t_24, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_PHI1 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_PHI1.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 756, __pyx_L1_error)
    } else {__pyx_pybuffernd_PHI1.diminfo[0].strides = __pyx_pybuffernd_PHI1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_PHI1.diminfo[0].shape = __pyx_pybuffernd_PHI1.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_24 = 0;
  __pyx_v_PHI1 = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":757
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux3 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] PHI1 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] PHI2 = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 * 
 *     # DESCRIPTORS OF ORIENTATIONS
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 757, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 757, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 757, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 757, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 757, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 757, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 757, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 757, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_6, __pyx_t_4); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 757, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 757, __pyx_L1_error)
  __pyx_t_25 = ((PyArrayObject *)__pyx_t_7);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_PHI2.rcbuffer->pybuffer, (PyObject*)__pyx_t_25, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_PHI2 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_PHI2.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 757, __pyx_L1_error)
    } else {__pyx_pybuffernd_PHI2.diminfo[0].strides = __pyx_pybuffernd_PHI2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_PHI2.diminfo[0].shape = __pyx_pybuffernd_PHI2.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_25 = 0;
  __pyx_v_PHI2 = ((PyArrayObject *)__pyx_t_7);
  __pyx_t_7 = 0;

  /* "libTEXTURIZE.pyx":760
 * 
 *     # DESCRIPTORS OF ORIENTATIONS
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 * 
 */
  __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 760, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 760, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 760, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_6 = PyTuple_New(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 760, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_7);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_7);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_int_3);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_int_3);
  __pyx_t_7 = 0;
  __pyx_t_7 = PyTuple_New(1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 760, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 760, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 760, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 760, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 760, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 760, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 760, __pyx_L1_error)
  __pyx_t_26 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer, (PyObject*)__pyx_t_26, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 3, 0, __pyx_stack) == -1)) {
      __pyx_v_Rot = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 760, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rot.diminfo[0].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rot.diminfo[0].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rot.diminfo[1].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rot.diminfo[1].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_Rot.diminfo[2].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_Rot.diminfo[2].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[2];
    }
  }
  __pyx_t_26 = 0;
  __pyx_v_Rot = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":761
 *     # DESCRIPTORS OF ORIENTATIONS
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 761, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 761, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 761, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_7 = PyTuple_New(2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 761, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_1);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_7, 1, __pyx_int_3);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 761, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_7);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_7);
  __pyx_t_7 = 0;
  __pyx_t_7 = PyDict_New(); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 761, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 761, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 761, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_7, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 761, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 761, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 761, __pyx_L1_error)
  __pyx_t_27 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_t_27, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Eul = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Eul.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 761, __pyx_L1_error)
    } else {__pyx_pybuffernd_Eul.diminfo[0].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Eul.diminfo[0].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Eul.diminfo[1].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Eul.diminfo[1].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_27 = 0;
  __pyx_v_Eul = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":764
 * 
 * 
 *     plantseed(myseed)             # <<<<<<<<<<<<<<
 *     tic = time.time()
 *     normC = sqrt(xc ** 2 + yc ** 2 + zc ** 2)
 */
  __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_plantseed); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 764, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_myseed); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 764, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_7);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_7, function);
    }
  }
  if (!__pyx_t_6) {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 764, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_GOTREF(__pyx_t_5);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 764, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6); __pyx_t_6 = NULL;
    __Pyx_GIVEREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 764, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":765
 * 
 *     plantseed(myseed)
 *     tic = time.time()             # <<<<<<<<<<<<<<
 *     normC = sqrt(xc ** 2 + yc ** 2 + zc ** 2)
 *     normS = sqrt(xs ** 2 + ys ** 2 + zs ** 2)
 */
  __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_time); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 765, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_time); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 765, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_7)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_7);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  if (__pyx_t_7) {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 765, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  } else {
    __pyx_t_5 = __Pyx_PyObject_CallNoArg(__pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 765, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_28 = __pyx_PyFloat_AsDouble(__pyx_t_5); if (unlikely((__pyx_t_28 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 765, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_tic = __pyx_t_28;

  /* "libTEXTURIZE.pyx":766
 *     plantseed(myseed)
 *     tic = time.time()
 *     normC = sqrt(xc ** 2 + yc ** 2 + zc ** 2)             # <<<<<<<<<<<<<<
 *     normS = sqrt(xs ** 2 + ys ** 2 + zs ** 2)
 *     xs = xs / normS; ys = ys / normS; zs = zs / normS;
 */
  __pyx_v_normC = sqrt(((powf(__pyx_v_xc, 2.0) + powf(__pyx_v_yc, 2.0)) + powf(__pyx_v_zc, 2.0)));

  /* "libTEXTURIZE.pyx":767
 *     tic = time.time()
 *     normC = sqrt(xc ** 2 + yc ** 2 + zc ** 2)
 *     normS = sqrt(xs ** 2 + ys ** 2 + zs ** 2)             # <<<<<<<<<<<<<<
 *     xs = xs / normS; ys = ys / normS; zs = zs / normS;
 *     xc = xc / normC; yc = yc / normC; zc = zc / normC;
 */
  __pyx_v_normS = sqrt(((powf(__pyx_v_xs, 2.0) + powf(__pyx_v_ys, 2.0)) + powf(__pyx_v_zs, 2.0)));

  /* "libTEXTURIZE.pyx":768
 *     normC = sqrt(xc ** 2 + yc ** 2 + zc ** 2)
 *     normS = sqrt(xs ** 2 + ys ** 2 + zs ** 2)
 *     xs = xs / normS; ys = ys / normS; zs = zs / normS;             # <<<<<<<<<<<<<<
 *     xc = xc / normC; yc = yc / normC; zc = zc / normC;
 * 
 */
  __pyx_v_xs = (__pyx_v_xs / __pyx_v_normS);
  __pyx_v_ys = (__pyx_v_ys / __pyx_v_normS);
  __pyx_v_zs = (__pyx_v_zs / __pyx_v_normS);

  /* "libTEXTURIZE.pyx":769
 *     normS = sqrt(xs ** 2 + ys ** 2 + zs ** 2)
 *     xs = xs / normS; ys = ys / normS; zs = zs / normS;
 *     xc = xc / normC; yc = yc / normC; zc = zc / normC;             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_v_xc = (__pyx_v_xc / __pyx_v_normC);
  __pyx_v_yc = (__pyx_v_yc / __pyx_v_normC);
  __pyx_v_zc = (__pyx_v_zc / __pyx_v_normC);

  /* "libTEXTURIZE.pyx":773
 * 
 *     # CONSTRUCTING CRYSTAL BASIS VECTORS
 *     X1C[0] = xc             # <<<<<<<<<<<<<<
 *     X1C[1] = yc
 *     X1C[2] = zc
 */
  __pyx_t_29 = 0;
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1C.rcbuffer->pybuffer.buf, __pyx_t_29, __pyx_pybuffernd_X1C.diminfo[0].strides) = __pyx_v_xc;

  /* "libTEXTURIZE.pyx":774
 *     # CONSTRUCTING CRYSTAL BASIS VECTORS
 *     X1C[0] = xc
 *     X1C[1] = yc             # <<<<<<<<<<<<<<
 *     X1C[2] = zc
 *     th = acos(X1C[2])
 */
  __pyx_t_30 = 1;
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1C.rcbuffer->pybuffer.buf, __pyx_t_30, __pyx_pybuffernd_X1C.diminfo[0].strides) = __pyx_v_yc;

  /* "libTEXTURIZE.pyx":775
 *     X1C[0] = xc
 *     X1C[1] = yc
 *     X1C[2] = zc             # <<<<<<<<<<<<<<
 *     th = acos(X1C[2])
 *     ph = atan2(X1C[1], X1C[0])
 */
  __pyx_t_31 = 2;
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1C.rcbuffer->pybuffer.buf, __pyx_t_31, __pyx_pybuffernd_X1C.diminfo[0].strides) = __pyx_v_zc;

  /* "libTEXTURIZE.pyx":776
 *     X1C[1] = yc
 *     X1C[2] = zc
 *     th = acos(X1C[2])             # <<<<<<<<<<<<<<
 *     ph = atan2(X1C[1], X1C[0])
 *     sth = sin(th)
 */
  __pyx_t_32 = 2;
  __pyx_v_th = acos((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1C.rcbuffer->pybuffer.buf, __pyx_t_32, __pyx_pybuffernd_X1C.diminfo[0].strides)));

  /* "libTEXTURIZE.pyx":777
 *     X1C[2] = zc
 *     th = acos(X1C[2])
 *     ph = atan2(X1C[1], X1C[0])             # <<<<<<<<<<<<<<
 *     sth = sin(th)
 *     cth = cos(th)
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_atan2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 777, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_33 = 1;
  __pyx_t_7 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1C.rcbuffer->pybuffer.buf, __pyx_t_33, __pyx_pybuffernd_X1C.diminfo[0].strides))); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 777, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_34 = 0;
  __pyx_t_1 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1C.rcbuffer->pybuffer.buf, __pyx_t_34, __pyx_pybuffernd_X1C.diminfo[0].strides))); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 777, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = NULL;
  __pyx_t_35 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
      __pyx_t_35 = 1;
    }
  }
  __pyx_t_36 = PyTuple_New(2+__pyx_t_35); if (unlikely(!__pyx_t_36)) __PYX_ERR(0, 777, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_36);
  if (__pyx_t_6) {
    __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_36, 0, __pyx_t_6); __pyx_t_6 = NULL;
  }
  __Pyx_GIVEREF(__pyx_t_7);
  PyTuple_SET_ITEM(__pyx_t_36, 0+__pyx_t_35, __pyx_t_7);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_36, 1+__pyx_t_35, __pyx_t_1);
  __pyx_t_7 = 0;
  __pyx_t_1 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_36, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 777, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_36); __pyx_t_36 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_5); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 777, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_ph = __pyx_t_3;

  /* "libTEXTURIZE.pyx":778
 *     th = acos(X1C[2])
 *     ph = atan2(X1C[1], X1C[0])
 *     sth = sin(th)             # <<<<<<<<<<<<<<
 *     cth = cos(th)
 *     sph = sin(ph)
 */
  __pyx_v_sth = sin(__pyx_v_th);

  /* "libTEXTURIZE.pyx":779
 *     ph = atan2(X1C[1], X1C[0])
 *     sth = sin(th)
 *     cth = cos(th)             # <<<<<<<<<<<<<<
 *     sph = sin(ph)
 *     cph = cos(ph)
 */
  __pyx_v_cth = cos(__pyx_v_th);

  /* "libTEXTURIZE.pyx":780
 *     sth = sin(th)
 *     cth = cos(th)
 *     sph = sin(ph)             # <<<<<<<<<<<<<<
 *     cph = cos(ph)
 *     aux1[0] = sph
 */
  __pyx_v_sph = sin(__pyx_v_ph);

  /* "libTEXTURIZE.pyx":781
 *     cth = cos(th)
 *     sph = sin(ph)
 *     cph = cos(ph)             # <<<<<<<<<<<<<<
 *     aux1[0] = sph
 *     aux1[1] = -cph
 */
  __pyx_v_cph = cos(__pyx_v_ph);

  /* "libTEXTURIZE.pyx":782
 *     sph = sin(ph)
 *     cph = cos(ph)
 *     aux1[0] = sph             # <<<<<<<<<<<<<<
 *     aux1[1] = -cph
 *     aux1[2] = 0
 */
  __pyx_t_37 = 0;
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_aux1.rcbuffer->pybuffer.buf, __pyx_t_37, __pyx_pybuffernd_aux1.diminfo[0].strides) = __pyx_v_sph;

  /* "libTEXTURIZE.pyx":783
 *     cph = cos(ph)
 *     aux1[0] = sph
 *     aux1[1] = -cph             # <<<<<<<<<<<<<<
 *     aux1[2] = 0
 *     aux2[0] = cph * cth
 */
  __pyx_t_38 = 1;
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_aux1.rcbuffer->pybuffer.buf, __pyx_t_38, __pyx_pybuffernd_aux1.diminfo[0].strides) = (-__pyx_v_cph);

  /* "libTEXTURIZE.pyx":784
 *     aux1[0] = sph
 *     aux1[1] = -cph
 *     aux1[2] = 0             # <<<<<<<<<<<<<<
 *     aux2[0] = cph * cth
 *     aux2[1] = sph * cth
 */
  __pyx_t_39 = 2;
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_aux1.rcbuffer->pybuffer.buf, __pyx_t_39, __pyx_pybuffernd_aux1.diminfo[0].strides) = 0.0;

  /* "libTEXTURIZE.pyx":785
 *     aux1[1] = -cph
 *     aux1[2] = 0
 *     aux2[0] = cph * cth             # <<<<<<<<<<<<<<
 *     aux2[1] = sph * cth
 *     aux2[2] = -sth
 */
  __pyx_t_40 = 0;
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_aux2.rcbuffer->pybuffer.buf, __pyx_t_40, __pyx_pybuffernd_aux2.diminfo[0].strides) = (__pyx_v_cph * __pyx_v_cth);

  /* "libTEXTURIZE.pyx":786
 *     aux1[2] = 0
 *     aux2[0] = cph * cth
 *     aux2[1] = sph * cth             # <<<<<<<<<<<<<<
 *     aux2[2] = -sth
 *     lm = np.random.uniform(0, 2 * pi, 1)
 */
  __pyx_t_41 = 1;
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_aux2.rcbuffer->pybuffer.buf, __pyx_t_41, __pyx_pybuffernd_aux2.diminfo[0].strides) = (__pyx_v_sph * __pyx_v_cth);

  /* "libTEXTURIZE.pyx":787
 *     aux2[0] = cph * cth
 *     aux2[1] = sph * cth
 *     aux2[2] = -sth             # <<<<<<<<<<<<<<
 *     lm = np.random.uniform(0, 2 * pi, 1)
 *     clm = cos(lm)
 */
  __pyx_t_42 = 2;
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_aux2.rcbuffer->pybuffer.buf, __pyx_t_42, __pyx_pybuffernd_aux2.diminfo[0].strides) = (-__pyx_v_sth);

  /* "libTEXTURIZE.pyx":788
 *     aux2[1] = sph * cth
 *     aux2[2] = -sth
 *     lm = np.random.uniform(0, 2 * pi, 1)             # <<<<<<<<<<<<<<
 *     clm = cos(lm)
 *     slm = sin(lm)
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 788, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_36 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_random); if (unlikely(!__pyx_t_36)) __PYX_ERR(0, 788, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_36);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_36, __pyx_n_s_uniform); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 788, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_36); __pyx_t_36 = 0;
  __pyx_t_36 = PyFloat_FromDouble((2.0 * __pyx_v_12libTEXTURIZE_pi)); if (unlikely(!__pyx_t_36)) __PYX_ERR(0, 788, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_36);
  __pyx_t_1 = NULL;
  __pyx_t_35 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
      __pyx_t_35 = 1;
    }
  }
  __pyx_t_7 = PyTuple_New(3+__pyx_t_35); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 788, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  if (__pyx_t_1) {
    __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_7, 0, __pyx_t_1); __pyx_t_1 = NULL;
  }
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_7, 0+__pyx_t_35, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_t_36);
  PyTuple_SET_ITEM(__pyx_t_7, 1+__pyx_t_35, __pyx_t_36);
  __Pyx_INCREF(__pyx_int_1);
  __Pyx_GIVEREF(__pyx_int_1);
  PyTuple_SET_ITEM(__pyx_t_7, 2+__pyx_t_35, __pyx_int_1);
  __pyx_t_36 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_7, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 788, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_5); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 788, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_lm = __pyx_t_3;

  /* "libTEXTURIZE.pyx":789
 *     aux2[2] = -sth
 *     lm = np.random.uniform(0, 2 * pi, 1)
 *     clm = cos(lm)             # <<<<<<<<<<<<<<
 *     slm = sin(lm)
 *     X2C = clm * aux1 + slm * aux2
 */
  __pyx_v_clm = cos(__pyx_v_lm);

  /* "libTEXTURIZE.pyx":790
 *     lm = np.random.uniform(0, 2 * pi, 1)
 *     clm = cos(lm)
 *     slm = sin(lm)             # <<<<<<<<<<<<<<
 *     X2C = clm * aux1 + slm * aux2
 *     X3C = np.cross(X1C, X2C)
 */
  __pyx_v_slm = sin(__pyx_v_lm);

  /* "libTEXTURIZE.pyx":791
 *     clm = cos(lm)
 *     slm = sin(lm)
 *     X2C = clm * aux1 + slm * aux2             # <<<<<<<<<<<<<<
 *     X3C = np.cross(X1C, X2C)
 * 
 */
  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_clm); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 791, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = PyNumber_Multiply(__pyx_t_5, ((PyObject *)__pyx_v_aux1)); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 791, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_slm); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 791, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_7 = PyNumber_Multiply(__pyx_t_5, ((PyObject *)__pyx_v_aux2)); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 791, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = PyNumber_Add(__pyx_t_4, __pyx_t_7); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 791, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 791, __pyx_L1_error)
  __pyx_t_13 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X2C.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_X2C.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_43, &__pyx_t_44, &__pyx_t_45);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_X2C.rcbuffer->pybuffer, (PyObject*)__pyx_v_X2C, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_43); Py_XDECREF(__pyx_t_44); Py_XDECREF(__pyx_t_45);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_43, __pyx_t_44, __pyx_t_45);
      }
    }
    __pyx_pybuffernd_X2C.diminfo[0].strides = __pyx_pybuffernd_X2C.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_X2C.diminfo[0].shape = __pyx_pybuffernd_X2C.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 791, __pyx_L1_error)
  }
  __pyx_t_13 = 0;
  __Pyx_DECREF_SET(__pyx_v_X2C, ((PyArrayObject *)__pyx_t_5));
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":792
 *     slm = sin(lm)
 *     X2C = clm * aux1 + slm * aux2
 *     X3C = np.cross(X1C, X2C)             # <<<<<<<<<<<<<<
 * 
 *     # CONSTRUCTING SAMPLE BASIS VECTORS
 */
  __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 792, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_cross); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 792, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  __pyx_t_35 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_7)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_7);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
      __pyx_t_35 = 1;
    }
  }
  __pyx_t_36 = PyTuple_New(2+__pyx_t_35); if (unlikely(!__pyx_t_36)) __PYX_ERR(0, 792, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_36);
  if (__pyx_t_7) {
    __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_36, 0, __pyx_t_7); __pyx_t_7 = NULL;
  }
  __Pyx_INCREF(((PyObject *)__pyx_v_X1C));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_X1C));
  PyTuple_SET_ITEM(__pyx_t_36, 0+__pyx_t_35, ((PyObject *)__pyx_v_X1C));
  __Pyx_INCREF(((PyObject *)__pyx_v_X2C));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_X2C));
  PyTuple_SET_ITEM(__pyx_t_36, 1+__pyx_t_35, ((PyObject *)__pyx_v_X2C));
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_36, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 792, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_36); __pyx_t_36 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 792, __pyx_L1_error)
  __pyx_t_14 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X3C.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_X3C.rcbuffer->pybuffer, (PyObject*)__pyx_t_14, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_45, &__pyx_t_44, &__pyx_t_43);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_X3C.rcbuffer->pybuffer, (PyObject*)__pyx_v_X3C, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_45); Py_XDECREF(__pyx_t_44); Py_XDECREF(__pyx_t_43);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_45, __pyx_t_44, __pyx_t_43);
      }
    }
    __pyx_pybuffernd_X3C.diminfo[0].strides = __pyx_pybuffernd_X3C.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_X3C.diminfo[0].shape = __pyx_pybuffernd_X3C.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 792, __pyx_L1_error)
  }
  __pyx_t_14 = 0;
  __Pyx_DECREF_SET(__pyx_v_X3C, ((PyArrayObject *)__pyx_t_5));
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":795
 * 
 *     # CONSTRUCTING SAMPLE BASIS VECTORS
 *     th = acos(zs)             # <<<<<<<<<<<<<<
 *     ph = atan2(ys, xs)
 *     sth = sin(th)
 */
  __pyx_v_th = acos(__pyx_v_zs);

  /* "libTEXTURIZE.pyx":796
 *     # CONSTRUCTING SAMPLE BASIS VECTORS
 *     th = acos(zs)
 *     ph = atan2(ys, xs)             # <<<<<<<<<<<<<<
 *     sth = sin(th)
 *     cth = cos(th)
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_atan2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 796, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_36 = PyFloat_FromDouble(__pyx_v_ys); if (unlikely(!__pyx_t_36)) __PYX_ERR(0, 796, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_36);
  __pyx_t_7 = PyFloat_FromDouble(__pyx_v_xs); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 796, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_1 = NULL;
  __pyx_t_35 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
      __pyx_t_35 = 1;
    }
  }
  __pyx_t_6 = PyTuple_New(2+__pyx_t_35); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 796, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__pyx_t_1) {
    __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1); __pyx_t_1 = NULL;
  }
  __Pyx_GIVEREF(__pyx_t_36);
  PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_35, __pyx_t_36);
  __Pyx_GIVEREF(__pyx_t_7);
  PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_35, __pyx_t_7);
  __pyx_t_36 = 0;
  __pyx_t_7 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_6, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 796, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_5); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 796, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_ph = __pyx_t_3;

  /* "libTEXTURIZE.pyx":797
 *     th = acos(zs)
 *     ph = atan2(ys, xs)
 *     sth = sin(th)             # <<<<<<<<<<<<<<
 *     cth = cos(th)
 *     sph = sin(ph)
 */
  __pyx_v_sth = sin(__pyx_v_th);

  /* "libTEXTURIZE.pyx":798
 *     ph = atan2(ys, xs)
 *     sth = sin(th)
 *     cth = cos(th)             # <<<<<<<<<<<<<<
 *     sph = sin(ph)
 *     cph = cos(ph)
 */
  __pyx_v_cth = cos(__pyx_v_th);

  /* "libTEXTURIZE.pyx":799
 *     sth = sin(th)
 *     cth = cos(th)
 *     sph = sin(ph)             # <<<<<<<<<<<<<<
 *     cph = cos(ph)
 *     Aux1[0] = sph
 */
  __pyx_v_sph = sin(__pyx_v_ph);

  /* "libTEXTURIZE.pyx":800
 *     cth = cos(th)
 *     sph = sin(ph)
 *     cph = cos(ph)             # <<<<<<<<<<<<<<
 *     Aux1[0] = sph
 *     Aux1[1] = -cph
 */
  __pyx_v_cph = cos(__pyx_v_ph);

  /* "libTEXTURIZE.pyx":801
 *     sph = sin(ph)
 *     cph = cos(ph)
 *     Aux1[0] = sph             # <<<<<<<<<<<<<<
 *     Aux1[1] = -cph
 *     Aux1[2] = 0
 */
  __pyx_t_46 = 0;
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Aux1.rcbuffer->pybuffer.buf, __pyx_t_46, __pyx_pybuffernd_Aux1.diminfo[0].strides) = __pyx_v_sph;

  /* "libTEXTURIZE.pyx":802
 *     cph = cos(ph)
 *     Aux1[0] = sph
 *     Aux1[1] = -cph             # <<<<<<<<<<<<<<
 *     Aux1[2] = 0
 *     Aux2[0] = cph * cth
 */
  __pyx_t_47 = 1;
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Aux1.rcbuffer->pybuffer.buf, __pyx_t_47, __pyx_pybuffernd_Aux1.diminfo[0].strides) = (-__pyx_v_cph);

  /* "libTEXTURIZE.pyx":803
 *     Aux1[0] = sph
 *     Aux1[1] = -cph
 *     Aux1[2] = 0             # <<<<<<<<<<<<<<
 *     Aux2[0] = cph * cth
 *     Aux2[1] = sph * cth
 */
  __pyx_t_48 = 2;
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Aux1.rcbuffer->pybuffer.buf, __pyx_t_48, __pyx_pybuffernd_Aux1.diminfo[0].strides) = 0.0;

  /* "libTEXTURIZE.pyx":804
 *     Aux1[1] = -cph
 *     Aux1[2] = 0
 *     Aux2[0] = cph * cth             # <<<<<<<<<<<<<<
 *     Aux2[1] = sph * cth
 *     Aux2[2] = -sth
 */
  __pyx_t_49 = 0;
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Aux2.rcbuffer->pybuffer.buf, __pyx_t_49, __pyx_pybuffernd_Aux2.diminfo[0].strides) = (__pyx_v_cph * __pyx_v_cth);

  /* "libTEXTURIZE.pyx":805
 *     Aux1[2] = 0
 *     Aux2[0] = cph * cth
 *     Aux2[1] = sph * cth             # <<<<<<<<<<<<<<
 *     Aux2[2] = -sth
 * 
 */
  __pyx_t_50 = 1;
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Aux2.rcbuffer->pybuffer.buf, __pyx_t_50, __pyx_pybuffernd_Aux2.diminfo[0].strides) = (__pyx_v_sph * __pyx_v_cth);

  /* "libTEXTURIZE.pyx":806
 *     Aux2[0] = cph * cth
 *     Aux2[1] = sph * cth
 *     Aux2[2] = -sth             # <<<<<<<<<<<<<<
 * 
 *     STH = sin(thetamax)
 */
  __pyx_t_51 = 2;
  *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Aux2.rcbuffer->pybuffer.buf, __pyx_t_51, __pyx_pybuffernd_Aux2.diminfo[0].strides) = (-__pyx_v_sth);

  /* "libTEXTURIZE.pyx":808
 *     Aux2[2] = -sth
 * 
 *     STH = sin(thetamax)             # <<<<<<<<<<<<<<
 *     CTH = cos(thetamax)
 * 
 */
  __pyx_v_STH = sin(__pyx_v_thetamax);

  /* "libTEXTURIZE.pyx":809
 * 
 *     STH = sin(thetamax)
 *     CTH = cos(thetamax)             # <<<<<<<<<<<<<<
 * 
 *     PHI = np.random.uniform(0, 2 * pi, p)
 */
  __pyx_v_CTH = cos(__pyx_v_thetamax);

  /* "libTEXTURIZE.pyx":811
 *     CTH = cos(thetamax)
 * 
 *     PHI = np.random.uniform(0, 2 * pi, p)             # <<<<<<<<<<<<<<
 *     Lambdaa = np.random.uniform(0, 2 * pi, p)
 *     Theta = met.INVCDF1D(axisdist, thetamin, thetamax, p)
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 811, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_random); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 811, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_uniform); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 811, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = PyFloat_FromDouble((2.0 * __pyx_v_12libTEXTURIZE_pi)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 811, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 811, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_36 = NULL;
  __pyx_t_35 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_36 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_36)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_36);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
      __pyx_t_35 = 1;
    }
  }
  __pyx_t_1 = PyTuple_New(3+__pyx_t_35); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 811, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (__pyx_t_36) {
    __Pyx_GIVEREF(__pyx_t_36); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_36); __pyx_t_36 = NULL;
  }
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_35, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_35, __pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_7);
  PyTuple_SET_ITEM(__pyx_t_1, 2+__pyx_t_35, __pyx_t_7);
  __pyx_t_6 = 0;
  __pyx_t_7 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 811, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_PHI = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":812
 * 
 *     PHI = np.random.uniform(0, 2 * pi, p)
 *     Lambdaa = np.random.uniform(0, 2 * pi, p)             # <<<<<<<<<<<<<<
 *     Theta = met.INVCDF1D(axisdist, thetamin, thetamax, p)
 * 
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 812, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_random); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 812, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_uniform); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 812, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyFloat_FromDouble((2.0 * __pyx_v_12libTEXTURIZE_pi)); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 812, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_7 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 812, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_6 = NULL;
  __pyx_t_35 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
      __pyx_t_35 = 1;
    }
  }
  __pyx_t_36 = PyTuple_New(3+__pyx_t_35); if (unlikely(!__pyx_t_36)) __PYX_ERR(0, 812, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_36);
  if (__pyx_t_6) {
    __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_36, 0, __pyx_t_6); __pyx_t_6 = NULL;
  }
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_36, 0+__pyx_t_35, __pyx_int_0);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_36, 1+__pyx_t_35, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_7);
  PyTuple_SET_ITEM(__pyx_t_36, 2+__pyx_t_35, __pyx_t_7);
  __pyx_t_1 = 0;
  __pyx_t_7 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_36, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 812, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_36); __pyx_t_36 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 812, __pyx_L1_error)
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Lambdaa.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Lambdaa.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_43, &__pyx_t_44, &__pyx_t_45);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Lambdaa.rcbuffer->pybuffer, (PyObject*)__pyx_v_Lambdaa, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_43); Py_XDECREF(__pyx_t_44); Py_XDECREF(__pyx_t_45);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_43, __pyx_t_44, __pyx_t_45);
      }
    }
    __pyx_pybuffernd_Lambdaa.diminfo[0].strides = __pyx_pybuffernd_Lambdaa.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Lambdaa.diminfo[0].shape = __pyx_pybuffernd_Lambdaa.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 812, __pyx_L1_error)
  }
  __pyx_t_8 = 0;
  __Pyx_DECREF_SET(__pyx_v_Lambdaa, ((PyArrayObject *)__pyx_t_5));
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":813
 *     PHI = np.random.uniform(0, 2 * pi, p)
 *     Lambdaa = np.random.uniform(0, 2 * pi, p)
 *     Theta = met.INVCDF1D(axisdist, thetamin, thetamax, p)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_met); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 813, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_36 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_INVCDF1D); if (unlikely(!__pyx_t_36)) __PYX_ERR(0, 813, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_36);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_thetamin); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 813, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_7 = PyFloat_FromDouble(__pyx_v_thetamax); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 813, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 813, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = NULL;
  __pyx_t_35 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_36))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_36);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_36);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_36, function);
      __pyx_t_35 = 1;
    }
  }
  __pyx_t_52 = PyTuple_New(4+__pyx_t_35); if (unlikely(!__pyx_t_52)) __PYX_ERR(0, 813, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_52);
  if (__pyx_t_6) {
    __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_52, 0, __pyx_t_6); __pyx_t_6 = NULL;
  }
  __Pyx_INCREF(__pyx_v_axisdist);
  __Pyx_GIVEREF(__pyx_v_axisdist);
  PyTuple_SET_ITEM(__pyx_t_52, 0+__pyx_t_35, __pyx_v_axisdist);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_52, 1+__pyx_t_35, __pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_7);
  PyTuple_SET_ITEM(__pyx_t_52, 2+__pyx_t_35, __pyx_t_7);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_52, 3+__pyx_t_35, __pyx_t_1);
  __pyx_t_4 = 0;
  __pyx_t_7 = 0;
  __pyx_t_1 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_36, __pyx_t_52, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 813, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_52); __pyx_t_52 = 0;
  __Pyx_DECREF(__pyx_t_36); __pyx_t_36 = 0;
  __pyx_v_Theta = __pyx_t_5;
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":816
 * 
 * 
 *     for k in range(p):             # <<<<<<<<<<<<<<
 *         ph = PHI[k]
 *         th = Theta[k]
 */
  __pyx_t_2 = __pyx_v_p;
  for (__pyx_t_53 = 0; __pyx_t_53 < __pyx_t_2; __pyx_t_53+=1) {
    __pyx_v_k = __pyx_t_53;

    /* "libTEXTURIZE.pyx":817
 * 
 *     for k in range(p):
 *         ph = PHI[k]             # <<<<<<<<<<<<<<
 *         th = Theta[k]
 *         SPH = sin(ph)
 */
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_PHI, __pyx_v_k, int, 1, __Pyx_PyInt_From_int, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 817, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_5); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 817, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_ph = __pyx_t_3;

    /* "libTEXTURIZE.pyx":818
 *     for k in range(p):
 *         ph = PHI[k]
 *         th = Theta[k]             # <<<<<<<<<<<<<<
 *         SPH = sin(ph)
 *         CPH = cos(ph)
 */
    __pyx_t_5 = __Pyx_GetItemInt(__pyx_v_Theta, __pyx_v_k, int, 1, __Pyx_PyInt_From_int, 0, 0, 0); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 818, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_5); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 818, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_th = __pyx_t_3;

    /* "libTEXTURIZE.pyx":819
 *         ph = PHI[k]
 *         th = Theta[k]
 *         SPH = sin(ph)             # <<<<<<<<<<<<<<
 *         CPH = cos(ph)
 *         STH = sin(th)
 */
    __pyx_v_SPH = sin(__pyx_v_ph);

    /* "libTEXTURIZE.pyx":820
 *         th = Theta[k]
 *         SPH = sin(ph)
 *         CPH = cos(ph)             # <<<<<<<<<<<<<<
 *         STH = sin(th)
 *         CTH = cos(th)
 */
    __pyx_v_CPH = cos(__pyx_v_ph);

    /* "libTEXTURIZE.pyx":821
 *         SPH = sin(ph)
 *         CPH = cos(ph)
 *         STH = sin(th)             # <<<<<<<<<<<<<<
 *         CTH = cos(th)
 *         sthcph = STH * CPH
 */
    __pyx_v_STH = sin(__pyx_v_th);

    /* "libTEXTURIZE.pyx":822
 *         CPH = cos(ph)
 *         STH = sin(th)
 *         CTH = cos(th)             # <<<<<<<<<<<<<<
 *         sthcph = STH * CPH
 *         sthsph = STH * SPH
 */
    __pyx_v_CTH = cos(__pyx_v_th);

    /* "libTEXTURIZE.pyx":823
 *         STH = sin(th)
 *         CTH = cos(th)
 *         sthcph = STH * CPH             # <<<<<<<<<<<<<<
 *         sthsph = STH * SPH
 *         X1S[0] = sthcph * Aux1[0] + sthsph * Aux2[0] + CTH * xs
 */
    __pyx_v_sthcph = (__pyx_v_STH * __pyx_v_CPH);

    /* "libTEXTURIZE.pyx":824
 *         CTH = cos(th)
 *         sthcph = STH * CPH
 *         sthsph = STH * SPH             # <<<<<<<<<<<<<<
 *         X1S[0] = sthcph * Aux1[0] + sthsph * Aux2[0] + CTH * xs
 *         X1S[1] = sthcph * Aux1[1] + sthsph * Aux2[1] + CTH * ys
 */
    __pyx_v_sthsph = (__pyx_v_STH * __pyx_v_SPH);

    /* "libTEXTURIZE.pyx":825
 *         sthcph = STH * CPH
 *         sthsph = STH * SPH
 *         X1S[0] = sthcph * Aux1[0] + sthsph * Aux2[0] + CTH * xs             # <<<<<<<<<<<<<<
 *         X1S[1] = sthcph * Aux1[1] + sthsph * Aux2[1] + CTH * ys
 *         X1S[2] = sthcph * Aux1[2] + sthsph * Aux2[2] + CTH * zs
 */
    __pyx_t_54 = 0;
    __pyx_t_55 = 0;
    __pyx_t_56 = 0;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf, __pyx_t_56, __pyx_pybuffernd_X1S.diminfo[0].strides) = (((__pyx_v_sthcph * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Aux1.rcbuffer->pybuffer.buf, __pyx_t_54, __pyx_pybuffernd_Aux1.diminfo[0].strides))) + (__pyx_v_sthsph * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Aux2.rcbuffer->pybuffer.buf, __pyx_t_55, __pyx_pybuffernd_Aux2.diminfo[0].strides)))) + (__pyx_v_CTH * __pyx_v_xs));

    /* "libTEXTURIZE.pyx":826
 *         sthsph = STH * SPH
 *         X1S[0] = sthcph * Aux1[0] + sthsph * Aux2[0] + CTH * xs
 *         X1S[1] = sthcph * Aux1[1] + sthsph * Aux2[1] + CTH * ys             # <<<<<<<<<<<<<<
 *         X1S[2] = sthcph * Aux1[2] + sthsph * Aux2[2] + CTH * zs
 *         th = acos(X1S[2])
 */
    __pyx_t_57 = 1;
    __pyx_t_58 = 1;
    __pyx_t_59 = 1;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf, __pyx_t_59, __pyx_pybuffernd_X1S.diminfo[0].strides) = (((__pyx_v_sthcph * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Aux1.rcbuffer->pybuffer.buf, __pyx_t_57, __pyx_pybuffernd_Aux1.diminfo[0].strides))) + (__pyx_v_sthsph * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Aux2.rcbuffer->pybuffer.buf, __pyx_t_58, __pyx_pybuffernd_Aux2.diminfo[0].strides)))) + (__pyx_v_CTH * __pyx_v_ys));

    /* "libTEXTURIZE.pyx":827
 *         X1S[0] = sthcph * Aux1[0] + sthsph * Aux2[0] + CTH * xs
 *         X1S[1] = sthcph * Aux1[1] + sthsph * Aux2[1] + CTH * ys
 *         X1S[2] = sthcph * Aux1[2] + sthsph * Aux2[2] + CTH * zs             # <<<<<<<<<<<<<<
 *         th = acos(X1S[2])
 *         ph = atan2(X1S[1], X1S[0])
 */
    __pyx_t_60 = 2;
    __pyx_t_61 = 2;
    __pyx_t_62 = 2;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf, __pyx_t_62, __pyx_pybuffernd_X1S.diminfo[0].strides) = (((__pyx_v_sthcph * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Aux1.rcbuffer->pybuffer.buf, __pyx_t_60, __pyx_pybuffernd_Aux1.diminfo[0].strides))) + (__pyx_v_sthsph * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Aux2.rcbuffer->pybuffer.buf, __pyx_t_61, __pyx_pybuffernd_Aux2.diminfo[0].strides)))) + (__pyx_v_CTH * __pyx_v_zs));

    /* "libTEXTURIZE.pyx":828
 *         X1S[1] = sthcph * Aux1[1] + sthsph * Aux2[1] + CTH * ys
 *         X1S[2] = sthcph * Aux1[2] + sthsph * Aux2[2] + CTH * zs
 *         th = acos(X1S[2])             # <<<<<<<<<<<<<<
 *         ph = atan2(X1S[1], X1S[0])
 *         sth = sin(th)
 */
    __pyx_t_63 = 2;
    __pyx_v_th = acos((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf, __pyx_t_63, __pyx_pybuffernd_X1S.diminfo[0].strides)));

    /* "libTEXTURIZE.pyx":829
 *         X1S[2] = sthcph * Aux1[2] + sthsph * Aux2[2] + CTH * zs
 *         th = acos(X1S[2])
 *         ph = atan2(X1S[1], X1S[0])             # <<<<<<<<<<<<<<
 *         sth = sin(th)
 *         cth = cos(th)
 */
    __pyx_t_36 = __Pyx_GetModuleGlobalName(__pyx_n_s_atan2); if (unlikely(!__pyx_t_36)) __PYX_ERR(0, 829, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_36);
    __pyx_t_64 = 1;
    __pyx_t_52 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf, __pyx_t_64, __pyx_pybuffernd_X1S.diminfo[0].strides))); if (unlikely(!__pyx_t_52)) __PYX_ERR(0, 829, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_52);
    __pyx_t_65 = 0;
    __pyx_t_1 = PyFloat_FromDouble((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf, __pyx_t_65, __pyx_pybuffernd_X1S.diminfo[0].strides))); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 829, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __pyx_t_7 = NULL;
    __pyx_t_35 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_36))) {
      __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_36);
      if (likely(__pyx_t_7)) {
        PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_36);
        __Pyx_INCREF(__pyx_t_7);
        __Pyx_INCREF(function);
        __Pyx_DECREF_SET(__pyx_t_36, function);
        __pyx_t_35 = 1;
      }
    }
    __pyx_t_4 = PyTuple_New(2+__pyx_t_35); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 829, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    if (__pyx_t_7) {
      __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_7); __pyx_t_7 = NULL;
    }
    __Pyx_GIVEREF(__pyx_t_52);
    PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_35, __pyx_t_52);
    __Pyx_GIVEREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_35, __pyx_t_1);
    __pyx_t_52 = 0;
    __pyx_t_1 = 0;
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_36, __pyx_t_4, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 829, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __Pyx_DECREF(__pyx_t_36); __pyx_t_36 = 0;
    __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_5); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 829, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_v_ph = __pyx_t_3;

    /* "libTEXTURIZE.pyx":830
 *         th = acos(X1S[2])
 *         ph = atan2(X1S[1], X1S[0])
 *         sth = sin(th)             # <<<<<<<<<<<<<<
 *         cth = cos(th)
 *         sph = sin(ph)
 */
    __pyx_v_sth = sin(__pyx_v_th);

    /* "libTEXTURIZE.pyx":831
 *         ph = atan2(X1S[1], X1S[0])
 *         sth = sin(th)
 *         cth = cos(th)             # <<<<<<<<<<<<<<
 *         sph = sin(ph)
 *         cph = cos(ph)
 */
    __pyx_v_cth = cos(__pyx_v_th);

    /* "libTEXTURIZE.pyx":832
 *         sth = sin(th)
 *         cth = cos(th)
 *         sph = sin(ph)             # <<<<<<<<<<<<<<
 *         cph = cos(ph)
 *         aux1[0] = sph
 */
    __pyx_v_sph = sin(__pyx_v_ph);

    /* "libTEXTURIZE.pyx":833
 *         cth = cos(th)
 *         sph = sin(ph)
 *         cph = cos(ph)             # <<<<<<<<<<<<<<
 *         aux1[0] = sph
 *         aux1[1] = -cph
 */
    __pyx_v_cph = cos(__pyx_v_ph);

    /* "libTEXTURIZE.pyx":834
 *         sph = sin(ph)
 *         cph = cos(ph)
 *         aux1[0] = sph             # <<<<<<<<<<<<<<
 *         aux1[1] = -cph
 *         aux1[2] = 0
 */
    __pyx_t_66 = 0;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_aux1.rcbuffer->pybuffer.buf, __pyx_t_66, __pyx_pybuffernd_aux1.diminfo[0].strides) = __pyx_v_sph;

    /* "libTEXTURIZE.pyx":835
 *         cph = cos(ph)
 *         aux1[0] = sph
 *         aux1[1] = -cph             # <<<<<<<<<<<<<<
 *         aux1[2] = 0
 *         aux2[0] = cph * cth
 */
    __pyx_t_67 = 1;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_aux1.rcbuffer->pybuffer.buf, __pyx_t_67, __pyx_pybuffernd_aux1.diminfo[0].strides) = (-__pyx_v_cph);

    /* "libTEXTURIZE.pyx":836
 *         aux1[0] = sph
 *         aux1[1] = -cph
 *         aux1[2] = 0             # <<<<<<<<<<<<<<
 *         aux2[0] = cph * cth
 *         aux2[1] = sph * cth
 */
    __pyx_t_68 = 2;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_aux1.rcbuffer->pybuffer.buf, __pyx_t_68, __pyx_pybuffernd_aux1.diminfo[0].strides) = 0.0;

    /* "libTEXTURIZE.pyx":837
 *         aux1[1] = -cph
 *         aux1[2] = 0
 *         aux2[0] = cph * cth             # <<<<<<<<<<<<<<
 *         aux2[1] = sph * cth
 *         aux2[2] = -sth
 */
    __pyx_t_69 = 0;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_aux2.rcbuffer->pybuffer.buf, __pyx_t_69, __pyx_pybuffernd_aux2.diminfo[0].strides) = (__pyx_v_cph * __pyx_v_cth);

    /* "libTEXTURIZE.pyx":838
 *         aux1[2] = 0
 *         aux2[0] = cph * cth
 *         aux2[1] = sph * cth             # <<<<<<<<<<<<<<
 *         aux2[2] = -sth
 * 
 */
    __pyx_t_70 = 1;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_aux2.rcbuffer->pybuffer.buf, __pyx_t_70, __pyx_pybuffernd_aux2.diminfo[0].strides) = (__pyx_v_sph * __pyx_v_cth);

    /* "libTEXTURIZE.pyx":839
 *         aux2[0] = cph * cth
 *         aux2[1] = sph * cth
 *         aux2[2] = -sth             # <<<<<<<<<<<<<<
 * 
 *         lm = Lambdaa[k]
 */
    __pyx_t_71 = 2;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_aux2.rcbuffer->pybuffer.buf, __pyx_t_71, __pyx_pybuffernd_aux2.diminfo[0].strides) = (-__pyx_v_sth);

    /* "libTEXTURIZE.pyx":841
 *         aux2[2] = -sth
 * 
 *         lm = Lambdaa[k]             # <<<<<<<<<<<<<<
 *         clm = cos(lm)
 *         slm = sin(lm)
 */
    __pyx_t_72 = __pyx_v_k;
    __pyx_v_lm = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Lambdaa.rcbuffer->pybuffer.buf, __pyx_t_72, __pyx_pybuffernd_Lambdaa.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":842
 * 
 *         lm = Lambdaa[k]
 *         clm = cos(lm)             # <<<<<<<<<<<<<<
 *         slm = sin(lm)
 *         X2S[0] = clm * aux1[0] + slm * aux2[0]
 */
    __pyx_v_clm = cos(__pyx_v_lm);

    /* "libTEXTURIZE.pyx":843
 *         lm = Lambdaa[k]
 *         clm = cos(lm)
 *         slm = sin(lm)             # <<<<<<<<<<<<<<
 *         X2S[0] = clm * aux1[0] + slm * aux2[0]
 *         X2S[1] = clm * aux1[1] + slm * aux2[1]
 */
    __pyx_v_slm = sin(__pyx_v_lm);

    /* "libTEXTURIZE.pyx":844
 *         clm = cos(lm)
 *         slm = sin(lm)
 *         X2S[0] = clm * aux1[0] + slm * aux2[0]             # <<<<<<<<<<<<<<
 *         X2S[1] = clm * aux1[1] + slm * aux2[1]
 *         X2S[2] = clm * aux1[2] + slm * aux2[2]
 */
    __pyx_t_73 = 0;
    __pyx_t_74 = 0;
    __pyx_t_75 = 0;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2S.rcbuffer->pybuffer.buf, __pyx_t_75, __pyx_pybuffernd_X2S.diminfo[0].strides) = ((__pyx_v_clm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_aux1.rcbuffer->pybuffer.buf, __pyx_t_73, __pyx_pybuffernd_aux1.diminfo[0].strides))) + (__pyx_v_slm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_aux2.rcbuffer->pybuffer.buf, __pyx_t_74, __pyx_pybuffernd_aux2.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":845
 *         slm = sin(lm)
 *         X2S[0] = clm * aux1[0] + slm * aux2[0]
 *         X2S[1] = clm * aux1[1] + slm * aux2[1]             # <<<<<<<<<<<<<<
 *         X2S[2] = clm * aux1[2] + slm * aux2[2]
 * 
 */
    __pyx_t_76 = 1;
    __pyx_t_77 = 1;
    __pyx_t_78 = 1;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2S.rcbuffer->pybuffer.buf, __pyx_t_78, __pyx_pybuffernd_X2S.diminfo[0].strides) = ((__pyx_v_clm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_aux1.rcbuffer->pybuffer.buf, __pyx_t_76, __pyx_pybuffernd_aux1.diminfo[0].strides))) + (__pyx_v_slm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_aux2.rcbuffer->pybuffer.buf, __pyx_t_77, __pyx_pybuffernd_aux2.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":846
 *         X2S[0] = clm * aux1[0] + slm * aux2[0]
 *         X2S[1] = clm * aux1[1] + slm * aux2[1]
 *         X2S[2] = clm * aux1[2] + slm * aux2[2]             # <<<<<<<<<<<<<<
 * 
 *         X3S[0] = X1S[1] * X2S[2] - X2S[1] * X1S[2]
 */
    __pyx_t_79 = 2;
    __pyx_t_80 = 2;
    __pyx_t_81 = 2;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2S.rcbuffer->pybuffer.buf, __pyx_t_81, __pyx_pybuffernd_X2S.diminfo[0].strides) = ((__pyx_v_clm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_aux1.rcbuffer->pybuffer.buf, __pyx_t_79, __pyx_pybuffernd_aux1.diminfo[0].strides))) + (__pyx_v_slm * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_aux2.rcbuffer->pybuffer.buf, __pyx_t_80, __pyx_pybuffernd_aux2.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":848
 *         X2S[2] = clm * aux1[2] + slm * aux2[2]
 * 
 *         X3S[0] = X1S[1] * X2S[2] - X2S[1] * X1S[2]             # <<<<<<<<<<<<<<
 *         X3S[1] = X1S[2] * X2S[0] - X2S[2] * X1S[0]
 *         X3S[2] = X1S[0] * X2S[1] - X2S[0] * X1S[1]
 */
    __pyx_t_82 = 1;
    __pyx_t_83 = 2;
    __pyx_t_84 = 1;
    __pyx_t_85 = 2;
    __pyx_t_86 = 0;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3S.rcbuffer->pybuffer.buf, __pyx_t_86, __pyx_pybuffernd_X3S.diminfo[0].strides) = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf, __pyx_t_82, __pyx_pybuffernd_X1S.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2S.rcbuffer->pybuffer.buf, __pyx_t_83, __pyx_pybuffernd_X2S.diminfo[0].strides))) - ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2S.rcbuffer->pybuffer.buf, __pyx_t_84, __pyx_pybuffernd_X2S.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf, __pyx_t_85, __pyx_pybuffernd_X1S.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":849
 * 
 *         X3S[0] = X1S[1] * X2S[2] - X2S[1] * X1S[2]
 *         X3S[1] = X1S[2] * X2S[0] - X2S[2] * X1S[0]             # <<<<<<<<<<<<<<
 *         X3S[2] = X1S[0] * X2S[1] - X2S[0] * X1S[1]
 * 
 */
    __pyx_t_87 = 2;
    __pyx_t_88 = 0;
    __pyx_t_89 = 2;
    __pyx_t_90 = 0;
    __pyx_t_91 = 1;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3S.rcbuffer->pybuffer.buf, __pyx_t_91, __pyx_pybuffernd_X3S.diminfo[0].strides) = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf, __pyx_t_87, __pyx_pybuffernd_X1S.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2S.rcbuffer->pybuffer.buf, __pyx_t_88, __pyx_pybuffernd_X2S.diminfo[0].strides))) - ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2S.rcbuffer->pybuffer.buf, __pyx_t_89, __pyx_pybuffernd_X2S.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf, __pyx_t_90, __pyx_pybuffernd_X1S.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":850
 *         X3S[0] = X1S[1] * X2S[2] - X2S[1] * X1S[2]
 *         X3S[1] = X1S[2] * X2S[0] - X2S[2] * X1S[0]
 *         X3S[2] = X1S[0] * X2S[1] - X2S[0] * X1S[1]             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __pyx_t_92 = 0;
    __pyx_t_93 = 1;
    __pyx_t_94 = 0;
    __pyx_t_95 = 1;
    __pyx_t_96 = 2;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3S.rcbuffer->pybuffer.buf, __pyx_t_96, __pyx_pybuffernd_X3S.diminfo[0].strides) = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf, __pyx_t_92, __pyx_pybuffernd_X1S.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2S.rcbuffer->pybuffer.buf, __pyx_t_93, __pyx_pybuffernd_X2S.diminfo[0].strides))) - ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2S.rcbuffer->pybuffer.buf, __pyx_t_94, __pyx_pybuffernd_X2S.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf, __pyx_t_95, __pyx_pybuffernd_X1S.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":853
 * 
 * 
 *         den1 = X2S[1] * X3S[2] - X2S[2] * X3S[1]             # <<<<<<<<<<<<<<
 *         den2 = X3S[1] * X1S[2] - X3S[2] * X1S[1]
 *         den3 = X1S[1] * X2S[2] - X1S[2] * X2S[1]
 */
    __pyx_t_97 = 1;
    __pyx_t_98 = 2;
    __pyx_t_99 = 2;
    __pyx_t_100 = 1;
    __pyx_v_den1 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2S.rcbuffer->pybuffer.buf, __pyx_t_97, __pyx_pybuffernd_X2S.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3S.rcbuffer->pybuffer.buf, __pyx_t_98, __pyx_pybuffernd_X3S.diminfo[0].strides))) - ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2S.rcbuffer->pybuffer.buf, __pyx_t_99, __pyx_pybuffernd_X2S.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3S.rcbuffer->pybuffer.buf, __pyx_t_100, __pyx_pybuffernd_X3S.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":854
 * 
 *         den1 = X2S[1] * X3S[2] - X2S[2] * X3S[1]
 *         den2 = X3S[1] * X1S[2] - X3S[2] * X1S[1]             # <<<<<<<<<<<<<<
 *         den3 = X1S[1] * X2S[2] - X1S[2] * X2S[1]
 *         den = sqrt (den1 ** 2 + den2 ** 2 + den3 ** 2)
 */
    __pyx_t_101 = 1;
    __pyx_t_102 = 2;
    __pyx_t_103 = 2;
    __pyx_t_104 = 1;
    __pyx_v_den2 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3S.rcbuffer->pybuffer.buf, __pyx_t_101, __pyx_pybuffernd_X3S.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf, __pyx_t_102, __pyx_pybuffernd_X1S.diminfo[0].strides))) - ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3S.rcbuffer->pybuffer.buf, __pyx_t_103, __pyx_pybuffernd_X3S.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf, __pyx_t_104, __pyx_pybuffernd_X1S.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":855
 *         den1 = X2S[1] * X3S[2] - X2S[2] * X3S[1]
 *         den2 = X3S[1] * X1S[2] - X3S[2] * X1S[1]
 *         den3 = X1S[1] * X2S[2] - X1S[2] * X2S[1]             # <<<<<<<<<<<<<<
 *         den = sqrt (den1 ** 2 + den2 ** 2 + den3 ** 2)
 * 
 */
    __pyx_t_105 = 1;
    __pyx_t_106 = 2;
    __pyx_t_107 = 2;
    __pyx_t_108 = 1;
    __pyx_v_den3 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf, __pyx_t_105, __pyx_pybuffernd_X1S.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2S.rcbuffer->pybuffer.buf, __pyx_t_106, __pyx_pybuffernd_X2S.diminfo[0].strides))) - ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf, __pyx_t_107, __pyx_pybuffernd_X1S.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2S.rcbuffer->pybuffer.buf, __pyx_t_108, __pyx_pybuffernd_X2S.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":856
 *         den2 = X3S[1] * X1S[2] - X3S[2] * X1S[1]
 *         den3 = X1S[1] * X2S[2] - X1S[2] * X2S[1]
 *         den = sqrt (den1 ** 2 + den2 ** 2 + den3 ** 2)             # <<<<<<<<<<<<<<
 * 
 *         alpha = den1 / den
 */
    __pyx_v_den = sqrt(((powf(__pyx_v_den1, 2.0) + powf(__pyx_v_den2, 2.0)) + powf(__pyx_v_den3, 2.0)));

    /* "libTEXTURIZE.pyx":858
 *         den = sqrt (den1 ** 2 + den2 ** 2 + den3 ** 2)
 * 
 *         alpha = den1 / den             # <<<<<<<<<<<<<<
 *         beta = den2 / den
 *         gamma = den3 / den
 */
    __pyx_v_alpha = (__pyx_v_den1 / __pyx_v_den);

    /* "libTEXTURIZE.pyx":859
 * 
 *         alpha = den1 / den
 *         beta = den2 / den             # <<<<<<<<<<<<<<
 *         gamma = den3 / den
 * 
 */
    __pyx_v_beta = (__pyx_v_den2 / __pyx_v_den);

    /* "libTEXTURIZE.pyx":860
 *         alpha = den1 / den
 *         beta = den2 / den
 *         gamma = den3 / den             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __pyx_v_gamma = (__pyx_v_den3 / __pyx_v_den);

    /* "libTEXTURIZE.pyx":864
 * 
 * 
 *         Rot[k, 0, 0] = alpha * X1C[0] + beta * X2C[0] + gamma * X3C[0]             # <<<<<<<<<<<<<<
 *         Rot[k, 1, 0] = alpha * X1C[1] + beta * X2C[1] + gamma * X3C[1]
 *         Rot[k, 2, 0] = alpha * X1C[2] + beta * X2C[2] + gamma * X3C[2]
 */
    __pyx_t_109 = 0;
    __pyx_t_110 = 0;
    __pyx_t_111 = 0;
    __pyx_t_112 = __pyx_v_k;
    __pyx_t_113 = 0;
    __pyx_t_114 = 0;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_112, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_113, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_114, __pyx_pybuffernd_Rot.diminfo[2].strides) = (((__pyx_v_alpha * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1C.rcbuffer->pybuffer.buf, __pyx_t_109, __pyx_pybuffernd_X1C.diminfo[0].strides))) + (__pyx_v_beta * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2C.rcbuffer->pybuffer.buf, __pyx_t_110, __pyx_pybuffernd_X2C.diminfo[0].strides)))) + (__pyx_v_gamma * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3C.rcbuffer->pybuffer.buf, __pyx_t_111, __pyx_pybuffernd_X3C.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":865
 * 
 *         Rot[k, 0, 0] = alpha * X1C[0] + beta * X2C[0] + gamma * X3C[0]
 *         Rot[k, 1, 0] = alpha * X1C[1] + beta * X2C[1] + gamma * X3C[1]             # <<<<<<<<<<<<<<
 *         Rot[k, 2, 0] = alpha * X1C[2] + beta * X2C[2] + gamma * X3C[2]
 * 
 */
    __pyx_t_115 = 1;
    __pyx_t_116 = 1;
    __pyx_t_117 = 1;
    __pyx_t_118 = __pyx_v_k;
    __pyx_t_119 = 1;
    __pyx_t_120 = 0;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_118, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_119, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_120, __pyx_pybuffernd_Rot.diminfo[2].strides) = (((__pyx_v_alpha * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1C.rcbuffer->pybuffer.buf, __pyx_t_115, __pyx_pybuffernd_X1C.diminfo[0].strides))) + (__pyx_v_beta * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2C.rcbuffer->pybuffer.buf, __pyx_t_116, __pyx_pybuffernd_X2C.diminfo[0].strides)))) + (__pyx_v_gamma * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3C.rcbuffer->pybuffer.buf, __pyx_t_117, __pyx_pybuffernd_X3C.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":866
 *         Rot[k, 0, 0] = alpha * X1C[0] + beta * X2C[0] + gamma * X3C[0]
 *         Rot[k, 1, 0] = alpha * X1C[1] + beta * X2C[1] + gamma * X3C[1]
 *         Rot[k, 2, 0] = alpha * X1C[2] + beta * X2C[2] + gamma * X3C[2]             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __pyx_t_121 = 2;
    __pyx_t_122 = 2;
    __pyx_t_123 = 2;
    __pyx_t_124 = __pyx_v_k;
    __pyx_t_125 = 2;
    __pyx_t_126 = 0;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_124, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_125, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_126, __pyx_pybuffernd_Rot.diminfo[2].strides) = (((__pyx_v_alpha * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1C.rcbuffer->pybuffer.buf, __pyx_t_121, __pyx_pybuffernd_X1C.diminfo[0].strides))) + (__pyx_v_beta * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2C.rcbuffer->pybuffer.buf, __pyx_t_122, __pyx_pybuffernd_X2C.diminfo[0].strides)))) + (__pyx_v_gamma * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3C.rcbuffer->pybuffer.buf, __pyx_t_123, __pyx_pybuffernd_X3C.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":870
 * 
 * 
 *         den1 = X2S[2] * X3S[0] - X2S[0] * X3S[2]             # <<<<<<<<<<<<<<
 *         den2 = X3S[2] * X1S[0] - X3S[0] * X1S[2]
 *         den3 = X1S[2] * X2S[0] - X1S[0] * X2S[2]
 */
    __pyx_t_127 = 2;
    __pyx_t_128 = 0;
    __pyx_t_129 = 0;
    __pyx_t_130 = 2;
    __pyx_v_den1 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2S.rcbuffer->pybuffer.buf, __pyx_t_127, __pyx_pybuffernd_X2S.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3S.rcbuffer->pybuffer.buf, __pyx_t_128, __pyx_pybuffernd_X3S.diminfo[0].strides))) - ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2S.rcbuffer->pybuffer.buf, __pyx_t_129, __pyx_pybuffernd_X2S.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3S.rcbuffer->pybuffer.buf, __pyx_t_130, __pyx_pybuffernd_X3S.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":871
 * 
 *         den1 = X2S[2] * X3S[0] - X2S[0] * X3S[2]
 *         den2 = X3S[2] * X1S[0] - X3S[0] * X1S[2]             # <<<<<<<<<<<<<<
 *         den3 = X1S[2] * X2S[0] - X1S[0] * X2S[2]
 *         den = sqrt (den1 ** 2 + den2 ** 2 + den3 ** 2)
 */
    __pyx_t_131 = 2;
    __pyx_t_132 = 0;
    __pyx_t_133 = 0;
    __pyx_t_134 = 2;
    __pyx_v_den2 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3S.rcbuffer->pybuffer.buf, __pyx_t_131, __pyx_pybuffernd_X3S.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf, __pyx_t_132, __pyx_pybuffernd_X1S.diminfo[0].strides))) - ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3S.rcbuffer->pybuffer.buf, __pyx_t_133, __pyx_pybuffernd_X3S.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf, __pyx_t_134, __pyx_pybuffernd_X1S.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":872
 *         den1 = X2S[2] * X3S[0] - X2S[0] * X3S[2]
 *         den2 = X3S[2] * X1S[0] - X3S[0] * X1S[2]
 *         den3 = X1S[2] * X2S[0] - X1S[0] * X2S[2]             # <<<<<<<<<<<<<<
 *         den = sqrt (den1 ** 2 + den2 ** 2 + den3 ** 2)
 * 
 */
    __pyx_t_135 = 2;
    __pyx_t_136 = 0;
    __pyx_t_137 = 0;
    __pyx_t_138 = 2;
    __pyx_v_den3 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf, __pyx_t_135, __pyx_pybuffernd_X1S.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2S.rcbuffer->pybuffer.buf, __pyx_t_136, __pyx_pybuffernd_X2S.diminfo[0].strides))) - ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf, __pyx_t_137, __pyx_pybuffernd_X1S.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2S.rcbuffer->pybuffer.buf, __pyx_t_138, __pyx_pybuffernd_X2S.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":873
 *         den2 = X3S[2] * X1S[0] - X3S[0] * X1S[2]
 *         den3 = X1S[2] * X2S[0] - X1S[0] * X2S[2]
 *         den = sqrt (den1 ** 2 + den2 ** 2 + den3 ** 2)             # <<<<<<<<<<<<<<
 * 
 *         alpha = den1 / den
 */
    __pyx_v_den = sqrt(((powf(__pyx_v_den1, 2.0) + powf(__pyx_v_den2, 2.0)) + powf(__pyx_v_den3, 2.0)));

    /* "libTEXTURIZE.pyx":875
 *         den = sqrt (den1 ** 2 + den2 ** 2 + den3 ** 2)
 * 
 *         alpha = den1 / den             # <<<<<<<<<<<<<<
 *         beta = den2 / den
 *         gamma = den3 / den
 */
    __pyx_v_alpha = (__pyx_v_den1 / __pyx_v_den);

    /* "libTEXTURIZE.pyx":876
 * 
 *         alpha = den1 / den
 *         beta = den2 / den             # <<<<<<<<<<<<<<
 *         gamma = den3 / den
 * 
 */
    __pyx_v_beta = (__pyx_v_den2 / __pyx_v_den);

    /* "libTEXTURIZE.pyx":877
 *         alpha = den1 / den
 *         beta = den2 / den
 *         gamma = den3 / den             # <<<<<<<<<<<<<<
 * 
 *         Rot[k, 0, 1] = alpha * X1C[0] + beta * X2C[0] + gamma * X3C[0]
 */
    __pyx_v_gamma = (__pyx_v_den3 / __pyx_v_den);

    /* "libTEXTURIZE.pyx":879
 *         gamma = den3 / den
 * 
 *         Rot[k, 0, 1] = alpha * X1C[0] + beta * X2C[0] + gamma * X3C[0]             # <<<<<<<<<<<<<<
 *         Rot[k, 1, 1] = alpha * X1C[1] + beta * X2C[1] + gamma * X3C[1]
 *         Rot[k, 2, 1] = alpha * X1C[2] + beta * X2C[2] + gamma * X3C[2]
 */
    __pyx_t_139 = 0;
    __pyx_t_140 = 0;
    __pyx_t_141 = 0;
    __pyx_t_142 = __pyx_v_k;
    __pyx_t_143 = 0;
    __pyx_t_144 = 1;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_142, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_143, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_144, __pyx_pybuffernd_Rot.diminfo[2].strides) = (((__pyx_v_alpha * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1C.rcbuffer->pybuffer.buf, __pyx_t_139, __pyx_pybuffernd_X1C.diminfo[0].strides))) + (__pyx_v_beta * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2C.rcbuffer->pybuffer.buf, __pyx_t_140, __pyx_pybuffernd_X2C.diminfo[0].strides)))) + (__pyx_v_gamma * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3C.rcbuffer->pybuffer.buf, __pyx_t_141, __pyx_pybuffernd_X3C.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":880
 * 
 *         Rot[k, 0, 1] = alpha * X1C[0] + beta * X2C[0] + gamma * X3C[0]
 *         Rot[k, 1, 1] = alpha * X1C[1] + beta * X2C[1] + gamma * X3C[1]             # <<<<<<<<<<<<<<
 *         Rot[k, 2, 1] = alpha * X1C[2] + beta * X2C[2] + gamma * X3C[2]
 * 
 */
    __pyx_t_145 = 1;
    __pyx_t_146 = 1;
    __pyx_t_147 = 1;
    __pyx_t_148 = __pyx_v_k;
    __pyx_t_149 = 1;
    __pyx_t_150 = 1;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_148, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_149, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_150, __pyx_pybuffernd_Rot.diminfo[2].strides) = (((__pyx_v_alpha * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1C.rcbuffer->pybuffer.buf, __pyx_t_145, __pyx_pybuffernd_X1C.diminfo[0].strides))) + (__pyx_v_beta * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2C.rcbuffer->pybuffer.buf, __pyx_t_146, __pyx_pybuffernd_X2C.diminfo[0].strides)))) + (__pyx_v_gamma * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3C.rcbuffer->pybuffer.buf, __pyx_t_147, __pyx_pybuffernd_X3C.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":881
 *         Rot[k, 0, 1] = alpha * X1C[0] + beta * X2C[0] + gamma * X3C[0]
 *         Rot[k, 1, 1] = alpha * X1C[1] + beta * X2C[1] + gamma * X3C[1]
 *         Rot[k, 2, 1] = alpha * X1C[2] + beta * X2C[2] + gamma * X3C[2]             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __pyx_t_151 = 2;
    __pyx_t_152 = 2;
    __pyx_t_153 = 2;
    __pyx_t_154 = __pyx_v_k;
    __pyx_t_155 = 2;
    __pyx_t_156 = 1;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_154, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_155, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_156, __pyx_pybuffernd_Rot.diminfo[2].strides) = (((__pyx_v_alpha * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1C.rcbuffer->pybuffer.buf, __pyx_t_151, __pyx_pybuffernd_X1C.diminfo[0].strides))) + (__pyx_v_beta * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2C.rcbuffer->pybuffer.buf, __pyx_t_152, __pyx_pybuffernd_X2C.diminfo[0].strides)))) + (__pyx_v_gamma * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3C.rcbuffer->pybuffer.buf, __pyx_t_153, __pyx_pybuffernd_X3C.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":885
 * 
 * 
 *         den1 = X2S[0] * X3S[1] - X2S[1] * X3S[0]             # <<<<<<<<<<<<<<
 *         den2 = X3S[0] * X1S[1] - X3S[1] * X1S[0]
 *         den3 = X1S[0] * X2S[1] - X1S[1] * X2S[0]
 */
    __pyx_t_157 = 0;
    __pyx_t_158 = 1;
    __pyx_t_159 = 1;
    __pyx_t_160 = 0;
    __pyx_v_den1 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2S.rcbuffer->pybuffer.buf, __pyx_t_157, __pyx_pybuffernd_X2S.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3S.rcbuffer->pybuffer.buf, __pyx_t_158, __pyx_pybuffernd_X3S.diminfo[0].strides))) - ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2S.rcbuffer->pybuffer.buf, __pyx_t_159, __pyx_pybuffernd_X2S.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3S.rcbuffer->pybuffer.buf, __pyx_t_160, __pyx_pybuffernd_X3S.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":886
 * 
 *         den1 = X2S[0] * X3S[1] - X2S[1] * X3S[0]
 *         den2 = X3S[0] * X1S[1] - X3S[1] * X1S[0]             # <<<<<<<<<<<<<<
 *         den3 = X1S[0] * X2S[1] - X1S[1] * X2S[0]
 *         den = sqrt (den1 ** 2 + den2 ** 2 + den3 ** 2)
 */
    __pyx_t_161 = 0;
    __pyx_t_162 = 1;
    __pyx_t_163 = 1;
    __pyx_t_164 = 0;
    __pyx_v_den2 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3S.rcbuffer->pybuffer.buf, __pyx_t_161, __pyx_pybuffernd_X3S.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf, __pyx_t_162, __pyx_pybuffernd_X1S.diminfo[0].strides))) - ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3S.rcbuffer->pybuffer.buf, __pyx_t_163, __pyx_pybuffernd_X3S.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf, __pyx_t_164, __pyx_pybuffernd_X1S.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":887
 *         den1 = X2S[0] * X3S[1] - X2S[1] * X3S[0]
 *         den2 = X3S[0] * X1S[1] - X3S[1] * X1S[0]
 *         den3 = X1S[0] * X2S[1] - X1S[1] * X2S[0]             # <<<<<<<<<<<<<<
 *         den = sqrt (den1 ** 2 + den2 ** 2 + den3 ** 2)
 * 
 */
    __pyx_t_165 = 0;
    __pyx_t_166 = 1;
    __pyx_t_167 = 1;
    __pyx_t_168 = 0;
    __pyx_v_den3 = (((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf, __pyx_t_165, __pyx_pybuffernd_X1S.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2S.rcbuffer->pybuffer.buf, __pyx_t_166, __pyx_pybuffernd_X2S.diminfo[0].strides))) - ((*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1S.rcbuffer->pybuffer.buf, __pyx_t_167, __pyx_pybuffernd_X1S.diminfo[0].strides)) * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2S.rcbuffer->pybuffer.buf, __pyx_t_168, __pyx_pybuffernd_X2S.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":888
 *         den2 = X3S[0] * X1S[1] - X3S[1] * X1S[0]
 *         den3 = X1S[0] * X2S[1] - X1S[1] * X2S[0]
 *         den = sqrt (den1 ** 2 + den2 ** 2 + den3 ** 2)             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __pyx_v_den = sqrt(((powf(__pyx_v_den1, 2.0) + powf(__pyx_v_den2, 2.0)) + powf(__pyx_v_den3, 2.0)));

    /* "libTEXTURIZE.pyx":891
 * 
 * 
 *         alpha = den1 / den             # <<<<<<<<<<<<<<
 *         beta = den2 / den
 *         gamma = den3 / den
 */
    __pyx_v_alpha = (__pyx_v_den1 / __pyx_v_den);

    /* "libTEXTURIZE.pyx":892
 * 
 *         alpha = den1 / den
 *         beta = den2 / den             # <<<<<<<<<<<<<<
 *         gamma = den3 / den
 * 
 */
    __pyx_v_beta = (__pyx_v_den2 / __pyx_v_den);

    /* "libTEXTURIZE.pyx":893
 *         alpha = den1 / den
 *         beta = den2 / den
 *         gamma = den3 / den             # <<<<<<<<<<<<<<
 * 
 *         Rot[k, 0, 2] = alpha * X1C[0] + beta * X2C[0] + gamma * X3C[0]
 */
    __pyx_v_gamma = (__pyx_v_den3 / __pyx_v_den);

    /* "libTEXTURIZE.pyx":895
 *         gamma = den3 / den
 * 
 *         Rot[k, 0, 2] = alpha * X1C[0] + beta * X2C[0] + gamma * X3C[0]             # <<<<<<<<<<<<<<
 *         Rot[k, 1, 2] = alpha * X1C[1] + beta * X2C[1] + gamma * X3C[1]
 *         Rot[k, 2, 2] = alpha * X1C[2] + beta * X2C[2] + gamma * X3C[2]
 */
    __pyx_t_169 = 0;
    __pyx_t_170 = 0;
    __pyx_t_171 = 0;
    __pyx_t_172 = __pyx_v_k;
    __pyx_t_173 = 0;
    __pyx_t_174 = 2;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_172, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_173, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_174, __pyx_pybuffernd_Rot.diminfo[2].strides) = (((__pyx_v_alpha * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1C.rcbuffer->pybuffer.buf, __pyx_t_169, __pyx_pybuffernd_X1C.diminfo[0].strides))) + (__pyx_v_beta * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2C.rcbuffer->pybuffer.buf, __pyx_t_170, __pyx_pybuffernd_X2C.diminfo[0].strides)))) + (__pyx_v_gamma * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3C.rcbuffer->pybuffer.buf, __pyx_t_171, __pyx_pybuffernd_X3C.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":896
 * 
 *         Rot[k, 0, 2] = alpha * X1C[0] + beta * X2C[0] + gamma * X3C[0]
 *         Rot[k, 1, 2] = alpha * X1C[1] + beta * X2C[1] + gamma * X3C[1]             # <<<<<<<<<<<<<<
 *         Rot[k, 2, 2] = alpha * X1C[2] + beta * X2C[2] + gamma * X3C[2]
 * 
 */
    __pyx_t_175 = 1;
    __pyx_t_176 = 1;
    __pyx_t_177 = 1;
    __pyx_t_178 = __pyx_v_k;
    __pyx_t_179 = 1;
    __pyx_t_180 = 2;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_178, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_179, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_180, __pyx_pybuffernd_Rot.diminfo[2].strides) = (((__pyx_v_alpha * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1C.rcbuffer->pybuffer.buf, __pyx_t_175, __pyx_pybuffernd_X1C.diminfo[0].strides))) + (__pyx_v_beta * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2C.rcbuffer->pybuffer.buf, __pyx_t_176, __pyx_pybuffernd_X2C.diminfo[0].strides)))) + (__pyx_v_gamma * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3C.rcbuffer->pybuffer.buf, __pyx_t_177, __pyx_pybuffernd_X3C.diminfo[0].strides))));

    /* "libTEXTURIZE.pyx":897
 *         Rot[k, 0, 2] = alpha * X1C[0] + beta * X2C[0] + gamma * X3C[0]
 *         Rot[k, 1, 2] = alpha * X1C[1] + beta * X2C[1] + gamma * X3C[1]
 *         Rot[k, 2, 2] = alpha * X1C[2] + beta * X2C[2] + gamma * X3C[2]             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __pyx_t_181 = 2;
    __pyx_t_182 = 2;
    __pyx_t_183 = 2;
    __pyx_t_184 = __pyx_v_k;
    __pyx_t_185 = 2;
    __pyx_t_186 = 2;
    *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf, __pyx_t_184, __pyx_pybuffernd_Rot.diminfo[0].strides, __pyx_t_185, __pyx_pybuffernd_Rot.diminfo[1].strides, __pyx_t_186, __pyx_pybuffernd_Rot.diminfo[2].strides) = (((__pyx_v_alpha * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X1C.rcbuffer->pybuffer.buf, __pyx_t_181, __pyx_pybuffernd_X1C.diminfo[0].strides))) + (__pyx_v_beta * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X2C.rcbuffer->pybuffer.buf, __pyx_t_182, __pyx_pybuffernd_X2C.diminfo[0].strides)))) + (__pyx_v_gamma * (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X3C.rcbuffer->pybuffer.buf, __pyx_t_183, __pyx_pybuffernd_X3C.diminfo[0].strides))));
  }

  /* "libTEXTURIZE.pyx":900
 * 
 * 
 *     Eul = conv.rm_to_zxz(Rot)             # <<<<<<<<<<<<<<
 *     if makecanvas == 0:
 * 
 */
  __pyx_t_36 = __Pyx_GetModuleGlobalName(__pyx_n_s_conv); if (unlikely(!__pyx_t_36)) __PYX_ERR(0, 900, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_36);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_36, __pyx_n_s_rm_to_zxz); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 900, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_36); __pyx_t_36 = 0;
  __pyx_t_36 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_36 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_36)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_36);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_36) {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_4, ((PyObject *)__pyx_v_Rot)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 900, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
  } else {
    __pyx_t_1 = PyTuple_New(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 900, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_36); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_36); __pyx_t_36 = NULL;
    __Pyx_INCREF(((PyObject *)__pyx_v_Rot));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_Rot));
    PyTuple_SET_ITEM(__pyx_t_1, 0+1, ((PyObject *)__pyx_v_Rot));
    __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, NULL); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 900, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 900, __pyx_L1_error)
  __pyx_t_27 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
    __pyx_t_2 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_t_27, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack);
    if (unlikely(__pyx_t_2 < 0)) {
      PyErr_Fetch(&__pyx_t_45, &__pyx_t_44, &__pyx_t_43);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_v_Eul, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_45); Py_XDECREF(__pyx_t_44); Py_XDECREF(__pyx_t_43);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_45, __pyx_t_44, __pyx_t_43);
      }
    }
    __pyx_pybuffernd_Eul.diminfo[0].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Eul.diminfo[0].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Eul.diminfo[1].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Eul.diminfo[1].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[1];
    if (unlikely(__pyx_t_2 < 0)) __PYX_ERR(0, 900, __pyx_L1_error)
  }
  __pyx_t_27 = 0;
  __Pyx_DECREF_SET(__pyx_v_Eul, ((PyArrayObject *)__pyx_t_5));
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":901
 * 
 *     Eul = conv.rm_to_zxz(Rot)
 *     if makecanvas == 0:             # <<<<<<<<<<<<<<
 * 
 *         obj.Eul = Eul
 */
  __pyx_t_187 = ((__pyx_v_makecanvas == 0) != 0);
  if (__pyx_t_187) {

    /* "libTEXTURIZE.pyx":903
 *     if makecanvas == 0:
 * 
 *         obj.Eul = Eul             # <<<<<<<<<<<<<<
 *     else:
 *         obj.EUL = getcanvas(m, n, Eul)
 */
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_Eul, ((PyObject *)__pyx_v_Eul)) < 0) __PYX_ERR(0, 903, __pyx_L1_error)

    /* "libTEXTURIZE.pyx":901
 * 
 *     Eul = conv.rm_to_zxz(Rot)
 *     if makecanvas == 0:             # <<<<<<<<<<<<<<
 * 
 *         obj.Eul = Eul
 */
    goto __pyx_L5;
  }

  /* "libTEXTURIZE.pyx":905
 *         obj.Eul = Eul
 *     else:
 *         obj.EUL = getcanvas(m, n, Eul)             # <<<<<<<<<<<<<<
 * 
 *     toc = time.time()
 */
  /*else*/ {
    __pyx_t_5 = __pyx_f_12libTEXTURIZE_getcanvas(__pyx_v_m, __pyx_v_n, ((PyArrayObject *)__pyx_v_Eul)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 905, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_EUL, __pyx_t_5) < 0) __PYX_ERR(0, 905, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }
  __pyx_L5:;

  /* "libTEXTURIZE.pyx":907
 *         obj.EUL = getcanvas(m, n, Eul)
 * 
 *     toc = time.time()             # <<<<<<<<<<<<<<
 *     obj.exetime = toc - tic
 *     return obj
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_time); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 907, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_time); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 907, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  if (__pyx_t_4) {
    __pyx_t_5 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 907, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    __pyx_t_5 = __Pyx_PyObject_CallNoArg(__pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 907, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_28 = __pyx_PyFloat_AsDouble(__pyx_t_5); if (unlikely((__pyx_t_28 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 907, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_toc = __pyx_t_28;

  /* "libTEXTURIZE.pyx":908
 * 
 *     toc = time.time()
 *     obj.exetime = toc - tic             # <<<<<<<<<<<<<<
 *     return obj
 * 
 */
  __pyx_t_5 = PyFloat_FromDouble((__pyx_v_toc - __pyx_v_tic)); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 908, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_exetime, __pyx_t_5) < 0) __PYX_ERR(0, 908, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":909
 *     toc = time.time()
 *     obj.exetime = toc - tic
 *     return obj             # <<<<<<<<<<<<<<
 * 
 * def Texture_Sheet(obj):
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_obj);
  __pyx_r = __pyx_v_obj;
  goto __pyx_L0;

  /* "libTEXTURIZE.pyx":716
 * 
 * 
 * def Texture_Fiber(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_36);
  __Pyx_XDECREF(__pyx_t_52);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Aux1.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Aux2.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Aux3.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Lambdaa.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_PHI1.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_PHI2.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Phi.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V1.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V2.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X1C.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X1S.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X2C.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X2S.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X3C.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X3S.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_aux1.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_aux2.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_aux3.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("libTEXTURIZE.Texture_Fiber", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Aux1.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Aux2.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Aux3.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Lambdaa.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_PHI1.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_PHI2.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Phi.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V1.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V2.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X1C.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X1S.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X2C.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X2S.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X3C.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X3S.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_aux1.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_aux2.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_aux3.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XDECREF(__pyx_v_axisdist);
  __Pyx_XDECREF((PyObject *)__pyx_v_Lambdaa);
  __Pyx_XDECREF((PyObject *)__pyx_v_Phi);
  __Pyx_XDECREF((PyObject *)__pyx_v_V1);
  __Pyx_XDECREF((PyObject *)__pyx_v_V2);
  __Pyx_XDECREF((PyObject *)__pyx_v_X1C);
  __Pyx_XDECREF((PyObject *)__pyx_v_X2C);
  __Pyx_XDECREF((PyObject *)__pyx_v_X3C);
  __Pyx_XDECREF((PyObject *)__pyx_v_X1S);
  __Pyx_XDECREF((PyObject *)__pyx_v_X2S);
  __Pyx_XDECREF((PyObject *)__pyx_v_X3S);
  __Pyx_XDECREF((PyObject *)__pyx_v_aux1);
  __Pyx_XDECREF((PyObject *)__pyx_v_aux2);
  __Pyx_XDECREF((PyObject *)__pyx_v_aux3);
  __Pyx_XDECREF((PyObject *)__pyx_v_Aux1);
  __Pyx_XDECREF((PyObject *)__pyx_v_Aux2);
  __Pyx_XDECREF((PyObject *)__pyx_v_Aux3);
  __Pyx_XDECREF((PyObject *)__pyx_v_PHI1);
  __Pyx_XDECREF((PyObject *)__pyx_v_PHI2);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rot);
  __Pyx_XDECREF((PyObject *)__pyx_v_Eul);
  __Pyx_XDECREF(__pyx_v_PHI);
  __Pyx_XDECREF(__pyx_v_Theta);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "libTEXTURIZE.pyx":911
 *     return obj
 * 
 * def Texture_Sheet(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */

/* Python wrapper */
static PyObject *__pyx_pw_12libTEXTURIZE_21Texture_Sheet(PyObject *__pyx_self, PyObject *__pyx_v_obj); /*proto*/
static PyMethodDef __pyx_mdef_12libTEXTURIZE_21Texture_Sheet = {"Texture_Sheet", (PyCFunction)__pyx_pw_12libTEXTURIZE_21Texture_Sheet, METH_O, 0};
static PyObject *__pyx_pw_12libTEXTURIZE_21Texture_Sheet(PyObject *__pyx_self, PyObject *__pyx_v_obj) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Texture_Sheet (wrapper)", 0);
  __pyx_r = __pyx_pf_12libTEXTURIZE_20Texture_Sheet(__pyx_self, ((PyObject *)__pyx_v_obj));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_12libTEXTURIZE_20Texture_Sheet(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_obj) {
  int __pyx_v_myseed;
  int __pyx_v_p;
  int __pyx_v_m;
  int __pyx_v_n;
  int __pyx_v_makecanvas;
  double __pyx_v_tic;
  double __pyx_v_toc;
  float __pyx_v_eul1;
  float __pyx_v_eul;
  float __pyx_v_eul2;
  float __pyx_v_gammamin;
  float __pyx_v_gammamax;
  float __pyx_v_thetamin;
  float __pyx_v_thetamax;
  float __pyx_v_phimin;
  float __pyx_v_phimax;
  PyObject *__pyx_v_gammadist = NULL;
  PyObject *__pyx_v_thetadist = NULL;
  PyObject *__pyx_v_phidist = NULL;
  PyArrayObject *__pyx_v_Axis = 0;
  PyObject *__pyx_v_Angle = NULL;
  PyObject *__pyx_v_theta = NULL;
  PyObject *__pyx_v_phi = NULL;
  PyObject *__pyx_v_Roo = NULL;
  PyObject *__pyx_v_Ro = NULL;
  PyObject *__pyx_v_delR = NULL;
  PyObject *__pyx_v_Rot = NULL;
  PyObject *__pyx_v_Eul = NULL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Axis;
  __Pyx_Buffer __pyx_pybuffer_Axis;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  float __pyx_t_3;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyObject *__pyx_t_7 = NULL;
  PyArrayObject *__pyx_t_8 = NULL;
  double __pyx_t_9;
  PyObject *__pyx_t_10 = NULL;
  Py_ssize_t __pyx_t_11;
  PyObject *__pyx_t_12 = NULL;
  PyObject *__pyx_t_13 = NULL;
  int __pyx_t_14;
  __Pyx_RefNannySetupContext("Texture_Sheet", 0);
  __pyx_pybuffer_Axis.pybuffer.buf = NULL;
  __pyx_pybuffer_Axis.refcount = 0;
  __pyx_pybuffernd_Axis.data = NULL;
  __pyx_pybuffernd_Axis.rcbuffer = &__pyx_pybuffer_Axis;

  /* "libTEXTURIZE.pyx":912
 * 
 * def Texture_Sheet(obj):
 *     cdef int myseed = obj.myseed             # <<<<<<<<<<<<<<
 *     cdef int p = obj.p
 *     cdef int m = obj.m
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_myseed); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 912, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 912, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_myseed = __pyx_t_2;

  /* "libTEXTURIZE.pyx":913
 * def Texture_Sheet(obj):
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p             # <<<<<<<<<<<<<<
 *     cdef int m = obj.m
 *     cdef int n = obj.n
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 913, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 913, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_p = __pyx_t_2;

  /* "libTEXTURIZE.pyx":914
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 *     cdef int m = obj.m             # <<<<<<<<<<<<<<
 *     cdef int n = obj.n
 *     cdef int makecanvas = obj.makecanvas
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_m); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 914, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 914, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_m = __pyx_t_2;

  /* "libTEXTURIZE.pyx":915
 *     cdef int p = obj.p
 *     cdef int m = obj.m
 *     cdef int n = obj.n             # <<<<<<<<<<<<<<
 *     cdef int makecanvas = obj.makecanvas
 *     cdef double tic, toc
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 915, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 915, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_n = __pyx_t_2;

  /* "libTEXTURIZE.pyx":916
 *     cdef int m = obj.m
 *     cdef int n = obj.n
 *     cdef int makecanvas = obj.makecanvas             # <<<<<<<<<<<<<<
 *     cdef double tic, toc
 * 
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_makecanvas); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 916, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 916, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_makecanvas = __pyx_t_2;

  /* "libTEXTURIZE.pyx":919
 *     cdef double tic, toc
 * 
 *     cdef float eul1 = obj.eul1             # <<<<<<<<<<<<<<
 *     cdef float eul = obj.eul
 *     cdef float eul2 = obj.eul2
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_eul1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 919, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_1); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 919, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_eul1 = __pyx_t_3;

  /* "libTEXTURIZE.pyx":920
 * 
 *     cdef float eul1 = obj.eul1
 *     cdef float eul = obj.eul             # <<<<<<<<<<<<<<
 *     cdef float eul2 = obj.eul2
 *     cdef float gammamin = obj.gammamin
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_eul); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 920, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_1); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 920, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_eul = __pyx_t_3;

  /* "libTEXTURIZE.pyx":921
 *     cdef float eul1 = obj.eul1
 *     cdef float eul = obj.eul
 *     cdef float eul2 = obj.eul2             # <<<<<<<<<<<<<<
 *     cdef float gammamin = obj.gammamin
 *     cdef float gammamax = obj.gammamax
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_eul2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 921, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_1); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 921, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_eul2 = __pyx_t_3;

  /* "libTEXTURIZE.pyx":922
 *     cdef float eul = obj.eul
 *     cdef float eul2 = obj.eul2
 *     cdef float gammamin = obj.gammamin             # <<<<<<<<<<<<<<
 *     cdef float gammamax = obj.gammamax
 *     cdef float thetamin = obj.thetamin
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_gammamin); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 922, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_1); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 922, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_gammamin = __pyx_t_3;

  /* "libTEXTURIZE.pyx":923
 *     cdef float eul2 = obj.eul2
 *     cdef float gammamin = obj.gammamin
 *     cdef float gammamax = obj.gammamax             # <<<<<<<<<<<<<<
 *     cdef float thetamin = obj.thetamin
 *     cdef float thetamax = obj.thetamax
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_gammamax); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 923, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_1); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 923, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_gammamax = __pyx_t_3;

  /* "libTEXTURIZE.pyx":924
 *     cdef float gammamin = obj.gammamin
 *     cdef float gammamax = obj.gammamax
 *     cdef float thetamin = obj.thetamin             # <<<<<<<<<<<<<<
 *     cdef float thetamax = obj.thetamax
 *     cdef float phimin = obj.phimin
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_thetamin); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 924, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_1); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 924, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_thetamin = __pyx_t_3;

  /* "libTEXTURIZE.pyx":925
 *     cdef float gammamax = obj.gammamax
 *     cdef float thetamin = obj.thetamin
 *     cdef float thetamax = obj.thetamax             # <<<<<<<<<<<<<<
 *     cdef float phimin = obj.phimin
 *     cdef float phimax = obj.phimax
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_thetamax); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 925, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_1); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 925, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_thetamax = __pyx_t_3;

  /* "libTEXTURIZE.pyx":926
 *     cdef float thetamin = obj.thetamin
 *     cdef float thetamax = obj.thetamax
 *     cdef float phimin = obj.phimin             # <<<<<<<<<<<<<<
 *     cdef float phimax = obj.phimax
 *     gammadist = obj.gammadist
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_phimin); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 926, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_1); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 926, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_phimin = __pyx_t_3;

  /* "libTEXTURIZE.pyx":927
 *     cdef float thetamax = obj.thetamax
 *     cdef float phimin = obj.phimin
 *     cdef float phimax = obj.phimax             # <<<<<<<<<<<<<<
 *     gammadist = obj.gammadist
 *     thetadist = obj.thetadist
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_phimax); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 927, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_1); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 927, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_phimax = __pyx_t_3;

  /* "libTEXTURIZE.pyx":928
 *     cdef float phimin = obj.phimin
 *     cdef float phimax = obj.phimax
 *     gammadist = obj.gammadist             # <<<<<<<<<<<<<<
 *     thetadist = obj.thetadist
 *     phidist = obj.phidist
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_gammadist); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 928, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_gammadist = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":929
 *     cdef float phimax = obj.phimax
 *     gammadist = obj.gammadist
 *     thetadist = obj.thetadist             # <<<<<<<<<<<<<<
 *     phidist = obj.phidist
 * 
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_thetadist); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 929, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_thetadist = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":930
 *     gammadist = obj.gammadist
 *     thetadist = obj.thetadist
 *     phidist = obj.phidist             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_phidist); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 930, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_phidist = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":933
 * 
 * 
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 * 
 *     plantseed(myseed)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 933, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 933, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 933, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 933, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_int_3);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 933, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 933, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 933, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 933, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_7) < 0) __PYX_ERR(0, 933, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 933, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_7) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_7, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 933, __pyx_L1_error)
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_7);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Axis = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Axis.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 933, __pyx_L1_error)
    } else {__pyx_pybuffernd_Axis.diminfo[0].strides = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Axis.diminfo[0].shape = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Axis.diminfo[1].strides = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Axis.diminfo[1].shape = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_8 = 0;
  __pyx_v_Axis = ((PyArrayObject *)__pyx_t_7);
  __pyx_t_7 = 0;

  /* "libTEXTURIZE.pyx":935
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 * 
 *     plantseed(myseed)             # <<<<<<<<<<<<<<
 *     tic = time.time()
 * 
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_plantseed); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 935, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_myseed); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 935, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 935, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_GOTREF(__pyx_t_7);
  } else {
    __pyx_t_6 = PyTuple_New(1+1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 935, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_4); __pyx_t_4 = NULL;
    __Pyx_GIVEREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_6, 0+1, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_6, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 935, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;

  /* "libTEXTURIZE.pyx":936
 * 
 *     plantseed(myseed)
 *     tic = time.time()             # <<<<<<<<<<<<<<
 * 
 *     Angle = met.INVCDF1D(gammadist, gammamin, gammamax, p)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_time); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 936, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_time); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 936, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
    }
  }
  if (__pyx_t_5) {
    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_t_5); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 936, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  } else {
    __pyx_t_7 = __Pyx_PyObject_CallNoArg(__pyx_t_6); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 936, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_9 = __pyx_PyFloat_AsDouble(__pyx_t_7); if (unlikely((__pyx_t_9 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 936, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_v_tic = __pyx_t_9;

  /* "libTEXTURIZE.pyx":938
 *     tic = time.time()
 * 
 *     Angle = met.INVCDF1D(gammadist, gammamin, gammamax, p)             # <<<<<<<<<<<<<<
 *     theta = met.INVCDF1D(thetadist, thetamin, thetamax, p)
 *     phi = met.INVCDF1D(phidist, phimin, phimax, p)
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_met); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 938, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_INVCDF1D); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 938, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = PyFloat_FromDouble(__pyx_v_gammamin); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 938, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_gammamax); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 938, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 938, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_10 = NULL;
  __pyx_t_11 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_10)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_10);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
      __pyx_t_11 = 1;
    }
  }
  __pyx_t_12 = PyTuple_New(4+__pyx_t_11); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 938, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_12);
  if (__pyx_t_10) {
    __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_12, 0, __pyx_t_10); __pyx_t_10 = NULL;
  }
  __Pyx_INCREF(__pyx_v_gammadist);
  __Pyx_GIVEREF(__pyx_v_gammadist);
  PyTuple_SET_ITEM(__pyx_t_12, 0+__pyx_t_11, __pyx_v_gammadist);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_12, 1+__pyx_t_11, __pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_12, 2+__pyx_t_11, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_12, 3+__pyx_t_11, __pyx_t_4);
  __pyx_t_6 = 0;
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_12, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 938, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_Angle = __pyx_t_7;
  __pyx_t_7 = 0;

  /* "libTEXTURIZE.pyx":939
 * 
 *     Angle = met.INVCDF1D(gammadist, gammamin, gammamax, p)
 *     theta = met.INVCDF1D(thetadist, thetamin, thetamax, p)             # <<<<<<<<<<<<<<
 *     phi = met.INVCDF1D(phidist, phimin, phimax, p)
 *     Axis[:, 0] = np.sin(theta) * np.cos(phi)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_met); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 939, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_12 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_INVCDF1D); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 939, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_12);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = PyFloat_FromDouble(__pyx_v_thetamin); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 939, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = PyFloat_FromDouble(__pyx_v_thetamax); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 939, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 939, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = NULL;
  __pyx_t_11 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_12))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_12);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_12);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_12, function);
      __pyx_t_11 = 1;
    }
  }
  __pyx_t_10 = PyTuple_New(4+__pyx_t_11); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 939, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_10);
  if (__pyx_t_6) {
    __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_10, 0, __pyx_t_6); __pyx_t_6 = NULL;
  }
  __Pyx_INCREF(__pyx_v_thetadist);
  __Pyx_GIVEREF(__pyx_v_thetadist);
  PyTuple_SET_ITEM(__pyx_t_10, 0+__pyx_t_11, __pyx_v_thetadist);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_10, 1+__pyx_t_11, __pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_10, 2+__pyx_t_11, __pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_10, 3+__pyx_t_11, __pyx_t_1);
  __pyx_t_5 = 0;
  __pyx_t_4 = 0;
  __pyx_t_1 = 0;
  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_12, __pyx_t_10, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 939, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
  __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_v_theta = __pyx_t_7;
  __pyx_t_7 = 0;

  /* "libTEXTURIZE.pyx":940
 *     Angle = met.INVCDF1D(gammadist, gammamin, gammamax, p)
 *     theta = met.INVCDF1D(thetadist, thetamin, thetamax, p)
 *     phi = met.INVCDF1D(phidist, phimin, phimax, p)             # <<<<<<<<<<<<<<
 *     Axis[:, 0] = np.sin(theta) * np.cos(phi)
 *     Axis[:, 1] = np.sin(theta) * np.sin(phi)
 */
  __pyx_t_12 = __Pyx_GetModuleGlobalName(__pyx_n_s_met); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 940, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_12);
  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_12, __pyx_n_s_INVCDF1D); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 940, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_10);
  __Pyx_DECREF(__pyx_t_12); __pyx_t_12 = 0;
  __pyx_t_12 = PyFloat_FromDouble(__pyx_v_phimin); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 940, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_12);
  __pyx_t_1 = PyFloat_FromDouble(__pyx_v_phimax); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 940, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 940, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = NULL;
  __pyx_t_11 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_10))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_10);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_10, function);
      __pyx_t_11 = 1;
    }
  }
  __pyx_t_6 = PyTuple_New(4+__pyx_t_11); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 940, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__pyx_t_5) {
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  __Pyx_INCREF(__pyx_v_phidist);
  __Pyx_GIVEREF(__pyx_v_phidist);
  PyTuple_SET_ITEM(__pyx_t_6, 0+__pyx_t_11, __pyx_v_phidist);
  __Pyx_GIVEREF(__pyx_t_12);
  PyTuple_SET_ITEM(__pyx_t_6, 1+__pyx_t_11, __pyx_t_12);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_6, 2+__pyx_t_11, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_6, 3+__pyx_t_11, __pyx_t_4);
  __pyx_t_12 = 0;
  __pyx_t_1 = 0;
  __pyx_t_4 = 0;
  __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_6, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 940, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_v_phi = __pyx_t_7;
  __pyx_t_7 = 0;

  /* "libTEXTURIZE.pyx":941
 *     theta = met.INVCDF1D(thetadist, thetamin, thetamax, p)
 *     phi = met.INVCDF1D(phidist, phimin, phimax, p)
 *     Axis[:, 0] = np.sin(theta) * np.cos(phi)             # <<<<<<<<<<<<<<
 *     Axis[:, 1] = np.sin(theta) * np.sin(phi)
 *     Axis[:, 2] = np.cos(theta)
 */
  __pyx_t_10 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 941, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_10);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_sin); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 941, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_10)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_10);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
    }
  }
  if (!__pyx_t_10) {
    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_theta); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 941, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 941, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_10); __pyx_t_10 = NULL;
    __Pyx_INCREF(__pyx_v_theta);
    __Pyx_GIVEREF(__pyx_v_theta);
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_theta);
    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_4, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 941, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 941, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_cos); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 941, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_10);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_10))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_10);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_10, function);
    }
  }
  if (!__pyx_t_4) {
    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_v_phi); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 941, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
  } else {
    __pyx_t_1 = PyTuple_New(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 941, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4); __pyx_t_4 = NULL;
    __Pyx_INCREF(__pyx_v_phi);
    __Pyx_GIVEREF(__pyx_v_phi);
    PyTuple_SET_ITEM(__pyx_t_1, 0+1, __pyx_v_phi);
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_1, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 941, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = PyNumber_Multiply(__pyx_t_7, __pyx_t_6); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 941, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_10);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_Axis), __pyx_tuple__44, __pyx_t_10) < 0)) __PYX_ERR(0, 941, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;

  /* "libTEXTURIZE.pyx":942
 *     phi = met.INVCDF1D(phidist, phimin, phimax, p)
 *     Axis[:, 0] = np.sin(theta) * np.cos(phi)
 *     Axis[:, 1] = np.sin(theta) * np.sin(phi)             # <<<<<<<<<<<<<<
 *     Axis[:, 2] = np.cos(theta)
 *     Roo = conv.zxz_to_rm(np.array([[eul1], [eul], [eul2]]).T)
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 942, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_sin); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 942, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_7))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_7);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_7);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_7, function);
    }
  }
  if (!__pyx_t_6) {
    __pyx_t_10 = __Pyx_PyObject_CallOneArg(__pyx_t_7, __pyx_v_theta); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 942, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
  } else {
    __pyx_t_1 = PyTuple_New(1+1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 942, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_1);
    __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6); __pyx_t_6 = NULL;
    __Pyx_INCREF(__pyx_v_theta);
    __Pyx_GIVEREF(__pyx_v_theta);
    PyTuple_SET_ITEM(__pyx_t_1, 0+1, __pyx_v_theta);
    __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_7, __pyx_t_1, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 942, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  }
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 942, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_sin); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 942, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_6))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_6);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_6);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_6, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_7 = __Pyx_PyObject_CallOneArg(__pyx_t_6, __pyx_v_phi); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 942, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 942, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1); __pyx_t_1 = NULL;
    __Pyx_INCREF(__pyx_v_phi);
    __Pyx_GIVEREF(__pyx_v_phi);
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_phi);
    __pyx_t_7 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_4, NULL); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 942, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_7);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = PyNumber_Multiply(__pyx_t_10, __pyx_t_7); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 942, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_Axis), __pyx_tuple__46, __pyx_t_6) < 0)) __PYX_ERR(0, 942, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":943
 *     Axis[:, 0] = np.sin(theta) * np.cos(phi)
 *     Axis[:, 1] = np.sin(theta) * np.sin(phi)
 *     Axis[:, 2] = np.cos(theta)             # <<<<<<<<<<<<<<
 *     Roo = conv.zxz_to_rm(np.array([[eul1], [eul], [eul2]]).T)
 *     Ro = Roo[0, :, :]
 */
  __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 943, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_10 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_cos); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 943, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_10);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_10))) {
    __pyx_t_7 = PyMethod_GET_SELF(__pyx_t_10);
    if (likely(__pyx_t_7)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_10);
      __Pyx_INCREF(__pyx_t_7);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_10, function);
    }
  }
  if (!__pyx_t_7) {
    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_10, __pyx_v_theta); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 943, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
  } else {
    __pyx_t_4 = PyTuple_New(1+1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 943, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_GIVEREF(__pyx_t_7); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_7); __pyx_t_7 = NULL;
    __Pyx_INCREF(__pyx_v_theta);
    __Pyx_GIVEREF(__pyx_v_theta);
    PyTuple_SET_ITEM(__pyx_t_4, 0+1, __pyx_v_theta);
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_10, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 943, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  }
  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
  if (unlikely(PyObject_SetItem(((PyObject *)__pyx_v_Axis), __pyx_tuple__48, __pyx_t_6) < 0)) __PYX_ERR(0, 943, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":944
 *     Axis[:, 1] = np.sin(theta) * np.sin(phi)
 *     Axis[:, 2] = np.cos(theta)
 *     Roo = conv.zxz_to_rm(np.array([[eul1], [eul], [eul2]]).T)             # <<<<<<<<<<<<<<
 *     Ro = Roo[0, :, :]
 *     delR = conv.aap_to_rm(Axis, Angle)
 */
  __pyx_t_10 = __Pyx_GetModuleGlobalName(__pyx_n_s_conv); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 944, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_10);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_zxz_to_rm); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 944, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_7 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 944, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_7, __pyx_n_s_array); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 944, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = PyFloat_FromDouble(__pyx_v_eul1); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 944, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_12 = PyList_New(1); if (unlikely(!__pyx_t_12)) __PYX_ERR(0, 944, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_12);
  __Pyx_GIVEREF(__pyx_t_7);
  PyList_SET_ITEM(__pyx_t_12, 0, __pyx_t_7);
  __pyx_t_7 = 0;
  __pyx_t_7 = PyFloat_FromDouble(__pyx_v_eul); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 944, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_5 = PyList_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 944, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_7);
  PyList_SET_ITEM(__pyx_t_5, 0, __pyx_t_7);
  __pyx_t_7 = 0;
  __pyx_t_7 = PyFloat_FromDouble(__pyx_v_eul2); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 944, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __pyx_t_13 = PyList_New(1); if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 944, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_13);
  __Pyx_GIVEREF(__pyx_t_7);
  PyList_SET_ITEM(__pyx_t_13, 0, __pyx_t_7);
  __pyx_t_7 = 0;
  __pyx_t_7 = PyList_New(3); if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 944, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_7);
  __Pyx_GIVEREF(__pyx_t_12);
  PyList_SET_ITEM(__pyx_t_7, 0, __pyx_t_12);
  __Pyx_GIVEREF(__pyx_t_5);
  PyList_SET_ITEM(__pyx_t_7, 1, __pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_13);
  PyList_SET_ITEM(__pyx_t_7, 2, __pyx_t_13);
  __pyx_t_12 = 0;
  __pyx_t_5 = 0;
  __pyx_t_13 = 0;
  __pyx_t_13 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_13 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_13)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_13);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
    }
  }
  if (!__pyx_t_13) {
    __pyx_t_10 = __Pyx_PyObject_CallOneArg(__pyx_t_1, __pyx_t_7); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 944, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_7); __pyx_t_7 = 0;
    __Pyx_GOTREF(__pyx_t_10);
  } else {
    __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 944, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_13); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_13); __pyx_t_13 = NULL;
    __Pyx_GIVEREF(__pyx_t_7);
    PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_t_7);
    __pyx_t_7 = 0;
    __pyx_t_10 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_5, NULL); if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 944, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_10);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_10, __pyx_n_s_T); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 944, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_10); __pyx_t_10 = 0;
  __pyx_t_10 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_10 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_10)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_10);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_10) {
    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 944, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_GOTREF(__pyx_t_6);
  } else {
    __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 944, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_10); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_10); __pyx_t_10 = NULL;
    __Pyx_GIVEREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_5, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 944, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_Roo = __pyx_t_6;
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":945
 *     Axis[:, 2] = np.cos(theta)
 *     Roo = conv.zxz_to_rm(np.array([[eul1], [eul], [eul2]]).T)
 *     Ro = Roo[0, :, :]             # <<<<<<<<<<<<<<
 *     delR = conv.aap_to_rm(Axis, Angle)
 * 
 */
  __pyx_t_6 = PyObject_GetItem(__pyx_v_Roo, __pyx_tuple__51); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 945, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_v_Ro = __pyx_t_6;
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":946
 *     Roo = conv.zxz_to_rm(np.array([[eul1], [eul], [eul2]]).T)
 *     Ro = Roo[0, :, :]
 *     delR = conv.aap_to_rm(Axis, Angle)             # <<<<<<<<<<<<<<
 * 
 *     Rot = np.einsum('kil,lj->kij', delR , Ro)
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_conv); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 946, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_aap_to_rm); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 946, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  __pyx_t_11 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
      __pyx_t_11 = 1;
    }
  }
  __pyx_t_1 = PyTuple_New(2+__pyx_t_11); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 946, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (__pyx_t_4) {
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_4); __pyx_t_4 = NULL;
  }
  __Pyx_INCREF(((PyObject *)__pyx_v_Axis));
  __Pyx_GIVEREF(((PyObject *)__pyx_v_Axis));
  PyTuple_SET_ITEM(__pyx_t_1, 0+__pyx_t_11, ((PyObject *)__pyx_v_Axis));
  __Pyx_INCREF(__pyx_v_Angle);
  __Pyx_GIVEREF(__pyx_v_Angle);
  PyTuple_SET_ITEM(__pyx_t_1, 1+__pyx_t_11, __pyx_v_Angle);
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 946, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_delR = __pyx_t_6;
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":948
 *     delR = conv.aap_to_rm(Axis, Angle)
 * 
 *     Rot = np.einsum('kil,lj->kij', delR , Ro)             # <<<<<<<<<<<<<<
 * 
 *     Eul = conv.rm_to_zxz(Rot)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 948, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_einsum); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 948, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  __pyx_t_11 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_1))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_1);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_1);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_1, function);
      __pyx_t_11 = 1;
    }
  }
  __pyx_t_4 = PyTuple_New(3+__pyx_t_11); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 948, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  if (__pyx_t_5) {
    __Pyx_GIVEREF(__pyx_t_5); PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  __Pyx_INCREF(__pyx_kp_s_kil_lj_kij);
  __Pyx_GIVEREF(__pyx_kp_s_kil_lj_kij);
  PyTuple_SET_ITEM(__pyx_t_4, 0+__pyx_t_11, __pyx_kp_s_kil_lj_kij);
  __Pyx_INCREF(__pyx_v_delR);
  __Pyx_GIVEREF(__pyx_v_delR);
  PyTuple_SET_ITEM(__pyx_t_4, 1+__pyx_t_11, __pyx_v_delR);
  __Pyx_INCREF(__pyx_v_Ro);
  __Pyx_GIVEREF(__pyx_v_Ro);
  PyTuple_SET_ITEM(__pyx_t_4, 2+__pyx_t_11, __pyx_v_Ro);
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 948, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_Rot = __pyx_t_6;
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":950
 *     Rot = np.einsum('kil,lj->kij', delR , Ro)
 * 
 *     Eul = conv.rm_to_zxz(Rot)             # <<<<<<<<<<<<<<
 * 
 *     if makecanvas == 0:
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_conv); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 950, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_rm_to_zxz); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 950, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_4))) {
    __pyx_t_1 = PyMethod_GET_SELF(__pyx_t_4);
    if (likely(__pyx_t_1)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_4);
      __Pyx_INCREF(__pyx_t_1);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_1) {
    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_4, __pyx_v_Rot); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 950, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
  } else {
    __pyx_t_5 = PyTuple_New(1+1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 950, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_5);
    __Pyx_GIVEREF(__pyx_t_1); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1); __pyx_t_1 = NULL;
    __Pyx_INCREF(__pyx_v_Rot);
    __Pyx_GIVEREF(__pyx_v_Rot);
    PyTuple_SET_ITEM(__pyx_t_5, 0+1, __pyx_v_Rot);
    __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_5, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 950, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  }
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_Eul = __pyx_t_6;
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":952
 *     Eul = conv.rm_to_zxz(Rot)
 * 
 *     if makecanvas == 0:             # <<<<<<<<<<<<<<
 * 
 *         obj.Eul = Eul
 */
  __pyx_t_14 = ((__pyx_v_makecanvas == 0) != 0);
  if (__pyx_t_14) {

    /* "libTEXTURIZE.pyx":954
 *     if makecanvas == 0:
 * 
 *         obj.Eul = Eul             # <<<<<<<<<<<<<<
 *     else:
 *         obj.EUL = getcanvas(m, n, Eul)
 */
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_Eul, __pyx_v_Eul) < 0) __PYX_ERR(0, 954, __pyx_L1_error)

    /* "libTEXTURIZE.pyx":952
 *     Eul = conv.rm_to_zxz(Rot)
 * 
 *     if makecanvas == 0:             # <<<<<<<<<<<<<<
 * 
 *         obj.Eul = Eul
 */
    goto __pyx_L3;
  }

  /* "libTEXTURIZE.pyx":956
 *         obj.Eul = Eul
 *     else:
 *         obj.EUL = getcanvas(m, n, Eul)             # <<<<<<<<<<<<<<
 * 
 *     toc = time.time()
 */
  /*else*/ {
    if (!(likely(((__pyx_v_Eul) == Py_None) || likely(__Pyx_TypeTest(__pyx_v_Eul, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 956, __pyx_L1_error)
    __pyx_t_6 = __pyx_f_12libTEXTURIZE_getcanvas(__pyx_v_m, __pyx_v_n, ((PyArrayObject *)__pyx_v_Eul)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 956, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_6);
    if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_EUL, __pyx_t_6) < 0) __PYX_ERR(0, 956, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  }
  __pyx_L3:;

  /* "libTEXTURIZE.pyx":958
 *         obj.EUL = getcanvas(m, n, Eul)
 * 
 *     toc = time.time()             # <<<<<<<<<<<<<<
 *     obj.exetime = toc - tic
 *     return obj
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_time); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 958, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_time); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 958, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
    }
  }
  if (__pyx_t_4) {
    __pyx_t_6 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 958, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  } else {
    __pyx_t_6 = __Pyx_PyObject_CallNoArg(__pyx_t_5); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 958, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_9 = __pyx_PyFloat_AsDouble(__pyx_t_6); if (unlikely((__pyx_t_9 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 958, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_toc = __pyx_t_9;

  /* "libTEXTURIZE.pyx":959
 * 
 *     toc = time.time()
 *     obj.exetime = toc - tic             # <<<<<<<<<<<<<<
 *     return obj
 * 
 */
  __pyx_t_6 = PyFloat_FromDouble((__pyx_v_toc - __pyx_v_tic)); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 959, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  if (__Pyx_PyObject_SetAttrStr(__pyx_v_obj, __pyx_n_s_exetime, __pyx_t_6) < 0) __PYX_ERR(0, 959, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":960
 *     toc = time.time()
 *     obj.exetime = toc - tic
 *     return obj             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(__pyx_v_obj);
  __pyx_r = __pyx_v_obj;
  goto __pyx_L0;

  /* "libTEXTURIZE.pyx":911
 *     return obj
 * 
 * def Texture_Sheet(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_XDECREF(__pyx_t_7);
  __Pyx_XDECREF(__pyx_t_10);
  __Pyx_XDECREF(__pyx_t_12);
  __Pyx_XDECREF(__pyx_t_13);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("libTEXTURIZE.Texture_Sheet", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XDECREF(__pyx_v_gammadist);
  __Pyx_XDECREF(__pyx_v_thetadist);
  __Pyx_XDECREF(__pyx_v_phidist);
  __Pyx_XDECREF((PyObject *)__pyx_v_Axis);
  __Pyx_XDECREF(__pyx_v_Angle);
  __Pyx_XDECREF(__pyx_v_theta);
  __Pyx_XDECREF(__pyx_v_phi);
  __Pyx_XDECREF(__pyx_v_Roo);
  __Pyx_XDECREF(__pyx_v_Ro);
  __Pyx_XDECREF(__pyx_v_delR);
  __Pyx_XDECREF(__pyx_v_Rot);
  __Pyx_XDECREF(__pyx_v_Eul);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "libTEXTURIZE.pyx":963
 * 
 * 
 * def Texture_Generic_Euler(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */

/* Python wrapper */
static PyObject *__pyx_pw_12libTEXTURIZE_23Texture_Generic_Euler(PyObject *__pyx_self, PyObject *__pyx_v_obj); /*proto*/
static PyMethodDef __pyx_mdef_12libTEXTURIZE_23Texture_Generic_Euler = {"Texture_Generic_Euler", (PyCFunction)__pyx_pw_12libTEXTURIZE_23Texture_Generic_Euler, METH_O, 0};
static PyObject *__pyx_pw_12libTEXTURIZE_23Texture_Generic_Euler(PyObject *__pyx_self, PyObject *__pyx_v_obj) {
  PyObject *__pyx_r = 0;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("Texture_Generic_Euler (wrapper)", 0);
  __pyx_r = __pyx_pf_12libTEXTURIZE_22Texture_Generic_Euler(__pyx_self, ((PyObject *)__pyx_v_obj));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyObject *__pyx_pf_12libTEXTURIZE_22Texture_Generic_Euler(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_obj) {
  int __pyx_v_myseed;
  int __pyx_v_p;
  CYTHON_UNUSED int __pyx_v_m;
  CYTHON_UNUSED int __pyx_v_n;
  CYTHON_UNUSED int __pyx_v_makecanvas;
  CYTHON_UNUSED double __pyx_v_tic;
  CYTHON_UNUSED int __pyx_v_grainloc;
  CYTHON_UNUSED PyObject *__pyx_v_Phi1Func = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_PhiFunc = NULL;
  CYTHON_UNUSED PyObject *__pyx_v_Phi2Func = NULL;
  CYTHON_UNUSED PyArrayObject *__pyx_v_lambdaa = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_phi = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_V1 = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_V2 = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Xc = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Yc = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Zc = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Rot = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_delR = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Eul = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Axis = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Angle = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Nd = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Rd = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Rv = 0;
  CYTHON_UNUSED PyArrayObject *__pyx_v_Q = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Angle;
  __Pyx_Buffer __pyx_pybuffer_Angle;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Axis;
  __Pyx_Buffer __pyx_pybuffer_Axis;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Eul;
  __Pyx_Buffer __pyx_pybuffer_Eul;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Nd;
  __Pyx_Buffer __pyx_pybuffer_Nd;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Q;
  __Pyx_Buffer __pyx_pybuffer_Q;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rd;
  __Pyx_Buffer __pyx_pybuffer_Rd;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rot;
  __Pyx_Buffer __pyx_pybuffer_Rot;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Rv;
  __Pyx_Buffer __pyx_pybuffer_Rv;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_V1;
  __Pyx_Buffer __pyx_pybuffer_V1;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_V2;
  __Pyx_Buffer __pyx_pybuffer_V2;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Xc;
  __Pyx_Buffer __pyx_pybuffer_Xc;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Yc;
  __Pyx_Buffer __pyx_pybuffer_Yc;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Zc;
  __Pyx_Buffer __pyx_pybuffer_Zc;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_delR;
  __Pyx_Buffer __pyx_pybuffer_delR;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_lambdaa;
  __Pyx_Buffer __pyx_pybuffer_lambdaa;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_phi;
  __Pyx_Buffer __pyx_pybuffer_phi;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyObject *__pyx_t_6 = NULL;
  PyArrayObject *__pyx_t_7 = NULL;
  PyArrayObject *__pyx_t_8 = NULL;
  PyArrayObject *__pyx_t_9 = NULL;
  PyArrayObject *__pyx_t_10 = NULL;
  PyArrayObject *__pyx_t_11 = NULL;
  PyArrayObject *__pyx_t_12 = NULL;
  PyArrayObject *__pyx_t_13 = NULL;
  PyArrayObject *__pyx_t_14 = NULL;
  PyArrayObject *__pyx_t_15 = NULL;
  PyArrayObject *__pyx_t_16 = NULL;
  PyArrayObject *__pyx_t_17 = NULL;
  PyArrayObject *__pyx_t_18 = NULL;
  PyArrayObject *__pyx_t_19 = NULL;
  PyArrayObject *__pyx_t_20 = NULL;
  PyArrayObject *__pyx_t_21 = NULL;
  PyArrayObject *__pyx_t_22 = NULL;
  double __pyx_t_23;
  __Pyx_RefNannySetupContext("Texture_Generic_Euler", 0);
  __pyx_pybuffer_lambdaa.pybuffer.buf = NULL;
  __pyx_pybuffer_lambdaa.refcount = 0;
  __pyx_pybuffernd_lambdaa.data = NULL;
  __pyx_pybuffernd_lambdaa.rcbuffer = &__pyx_pybuffer_lambdaa;
  __pyx_pybuffer_phi.pybuffer.buf = NULL;
  __pyx_pybuffer_phi.refcount = 0;
  __pyx_pybuffernd_phi.data = NULL;
  __pyx_pybuffernd_phi.rcbuffer = &__pyx_pybuffer_phi;
  __pyx_pybuffer_V1.pybuffer.buf = NULL;
  __pyx_pybuffer_V1.refcount = 0;
  __pyx_pybuffernd_V1.data = NULL;
  __pyx_pybuffernd_V1.rcbuffer = &__pyx_pybuffer_V1;
  __pyx_pybuffer_V2.pybuffer.buf = NULL;
  __pyx_pybuffer_V2.refcount = 0;
  __pyx_pybuffernd_V2.data = NULL;
  __pyx_pybuffernd_V2.rcbuffer = &__pyx_pybuffer_V2;
  __pyx_pybuffer_Xc.pybuffer.buf = NULL;
  __pyx_pybuffer_Xc.refcount = 0;
  __pyx_pybuffernd_Xc.data = NULL;
  __pyx_pybuffernd_Xc.rcbuffer = &__pyx_pybuffer_Xc;
  __pyx_pybuffer_Yc.pybuffer.buf = NULL;
  __pyx_pybuffer_Yc.refcount = 0;
  __pyx_pybuffernd_Yc.data = NULL;
  __pyx_pybuffernd_Yc.rcbuffer = &__pyx_pybuffer_Yc;
  __pyx_pybuffer_Zc.pybuffer.buf = NULL;
  __pyx_pybuffer_Zc.refcount = 0;
  __pyx_pybuffernd_Zc.data = NULL;
  __pyx_pybuffernd_Zc.rcbuffer = &__pyx_pybuffer_Zc;
  __pyx_pybuffer_Rot.pybuffer.buf = NULL;
  __pyx_pybuffer_Rot.refcount = 0;
  __pyx_pybuffernd_Rot.data = NULL;
  __pyx_pybuffernd_Rot.rcbuffer = &__pyx_pybuffer_Rot;
  __pyx_pybuffer_delR.pybuffer.buf = NULL;
  __pyx_pybuffer_delR.refcount = 0;
  __pyx_pybuffernd_delR.data = NULL;
  __pyx_pybuffernd_delR.rcbuffer = &__pyx_pybuffer_delR;
  __pyx_pybuffer_Eul.pybuffer.buf = NULL;
  __pyx_pybuffer_Eul.refcount = 0;
  __pyx_pybuffernd_Eul.data = NULL;
  __pyx_pybuffernd_Eul.rcbuffer = &__pyx_pybuffer_Eul;
  __pyx_pybuffer_Axis.pybuffer.buf = NULL;
  __pyx_pybuffer_Axis.refcount = 0;
  __pyx_pybuffernd_Axis.data = NULL;
  __pyx_pybuffernd_Axis.rcbuffer = &__pyx_pybuffer_Axis;
  __pyx_pybuffer_Angle.pybuffer.buf = NULL;
  __pyx_pybuffer_Angle.refcount = 0;
  __pyx_pybuffernd_Angle.data = NULL;
  __pyx_pybuffernd_Angle.rcbuffer = &__pyx_pybuffer_Angle;
  __pyx_pybuffer_Nd.pybuffer.buf = NULL;
  __pyx_pybuffer_Nd.refcount = 0;
  __pyx_pybuffernd_Nd.data = NULL;
  __pyx_pybuffernd_Nd.rcbuffer = &__pyx_pybuffer_Nd;
  __pyx_pybuffer_Rd.pybuffer.buf = NULL;
  __pyx_pybuffer_Rd.refcount = 0;
  __pyx_pybuffernd_Rd.data = NULL;
  __pyx_pybuffernd_Rd.rcbuffer = &__pyx_pybuffer_Rd;
  __pyx_pybuffer_Rv.pybuffer.buf = NULL;
  __pyx_pybuffer_Rv.refcount = 0;
  __pyx_pybuffernd_Rv.data = NULL;
  __pyx_pybuffernd_Rv.rcbuffer = &__pyx_pybuffer_Rv;
  __pyx_pybuffer_Q.pybuffer.buf = NULL;
  __pyx_pybuffer_Q.refcount = 0;
  __pyx_pybuffernd_Q.data = NULL;
  __pyx_pybuffernd_Q.rcbuffer = &__pyx_pybuffer_Q;

  /* "libTEXTURIZE.pyx":964
 * 
 * def Texture_Generic_Euler(obj):
 *     cdef int myseed = obj.myseed             # <<<<<<<<<<<<<<
 *     cdef int p = obj.p
 *     cdef int m = obj.m
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_myseed); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 964, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 964, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_myseed = __pyx_t_2;

  /* "libTEXTURIZE.pyx":965
 * def Texture_Generic_Euler(obj):
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p             # <<<<<<<<<<<<<<
 *     cdef int m = obj.m
 *     cdef int n = obj.n
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 965, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 965, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_p = __pyx_t_2;

  /* "libTEXTURIZE.pyx":966
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 *     cdef int m = obj.m             # <<<<<<<<<<<<<<
 *     cdef int n = obj.n
 *     cdef int makecanvas = obj.makecanvas
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_m); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 966, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 966, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_m = __pyx_t_2;

  /* "libTEXTURIZE.pyx":967
 *     cdef int p = obj.p
 *     cdef int m = obj.m
 *     cdef int n = obj.n             # <<<<<<<<<<<<<<
 *     cdef int makecanvas = obj.makecanvas
 *     cdef double tic, toc
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_n); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 967, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 967, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_n = __pyx_t_2;

  /* "libTEXTURIZE.pyx":968
 *     cdef int m = obj.m
 *     cdef int n = obj.n
 *     cdef int makecanvas = obj.makecanvas             # <<<<<<<<<<<<<<
 *     cdef double tic, toc
 * 
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_makecanvas); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 968, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 968, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_makecanvas = __pyx_t_2;

  /* "libTEXTURIZE.pyx":971
 *     cdef double tic, toc
 * 
 *     cdef int grainloc = obj.grainloc             # <<<<<<<<<<<<<<
 *     Phi1Func = obj.Phi1Func
 *     PhiFunc = obj.PhiFunc
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_grainloc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 971, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_As_int(__pyx_t_1); if (unlikely((__pyx_t_2 == (int)-1) && PyErr_Occurred())) __PYX_ERR(0, 971, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_grainloc = __pyx_t_2;

  /* "libTEXTURIZE.pyx":972
 * 
 *     cdef int grainloc = obj.grainloc
 *     Phi1Func = obj.Phi1Func             # <<<<<<<<<<<<<<
 *     PhiFunc = obj.PhiFunc
 *     Phi2Func = obj.Phi2Func
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_Phi1Func); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 972, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_Phi1Func = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":973
 *     cdef int grainloc = obj.grainloc
 *     Phi1Func = obj.Phi1Func
 *     PhiFunc = obj.PhiFunc             # <<<<<<<<<<<<<<
 *     Phi2Func = obj.Phi2Func
 * 
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_PhiFunc); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 973, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_PhiFunc = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":974
 *     Phi1Func = obj.Phi1Func
 *     PhiFunc = obj.PhiFunc
 *     Phi2Func = obj.Phi2Func             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_v_obj, __pyx_n_s_Phi2Func); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 974, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_v_Phi2Func = __pyx_t_1;
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":980
 *     cdef int i
 *     cdef float th, ph, lm , sth, sph, cth, cph, clm, slm, Xc0, Xc1, Xc2
 *     cdef np.ndarray[np.float64_t, ndim = 1] lambdaa = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] phi = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 980, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 980, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 980, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 980, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 980, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 980, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 980, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 980, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 980, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 980, __pyx_L1_error)
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_lambdaa.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_lambdaa = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_lambdaa.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 980, __pyx_L1_error)
    } else {__pyx_pybuffernd_lambdaa.diminfo[0].strides = __pyx_pybuffernd_lambdaa.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_lambdaa.diminfo[0].shape = __pyx_pybuffernd_lambdaa.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_lambdaa = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":981
 *     cdef float th, ph, lm , sth, sph, cth, cph, clm, slm, Xc0, Xc1, Xc2
 *     cdef np.ndarray[np.float64_t, ndim = 1] lambdaa = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] phi = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 981, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 981, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 981, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 981, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 981, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 981, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 981, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 981, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_4, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 981, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 981, __pyx_L1_error)
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_phi.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_phi = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_phi.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 981, __pyx_L1_error)
    } else {__pyx_pybuffernd_phi.diminfo[0].strides = __pyx_pybuffernd_phi.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_phi.diminfo[0].shape = __pyx_pybuffernd_phi.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_8 = 0;
  __pyx_v_phi = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":982
 *     cdef np.ndarray[np.float64_t, ndim = 1] lambdaa = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] phi = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 982, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 982, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 982, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 982, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 982, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 982, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__52, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 982, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 982, __pyx_L1_error)
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_V1.rcbuffer->pybuffer, (PyObject*)__pyx_t_9, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_V1 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_V1.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 982, __pyx_L1_error)
    } else {__pyx_pybuffernd_V1.diminfo[0].strides = __pyx_pybuffernd_V1.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_V1.diminfo[0].shape = __pyx_pybuffernd_V1.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_9 = 0;
  __pyx_v_V1 = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":983
 *     cdef np.ndarray[np.float64_t, ndim = 1] phi = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 983, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 983, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 983, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 983, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 983, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 983, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_tuple__53, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 983, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 983, __pyx_L1_error)
  __pyx_t_10 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_V2.rcbuffer->pybuffer, (PyObject*)__pyx_t_10, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_V2 = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_V2.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 983, __pyx_L1_error)
    } else {__pyx_pybuffernd_V2.diminfo[0].strides = __pyx_pybuffernd_V2.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_V2.diminfo[0].shape = __pyx_pybuffernd_V2.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_10 = 0;
  __pyx_v_V2 = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":984
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zc = np.zeros(3, dtype=np.float64)
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 984, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 984, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 984, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 984, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 984, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 984, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_tuple__54, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 984, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 984, __pyx_L1_error)
  __pyx_t_11 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Xc.rcbuffer->pybuffer, (PyObject*)__pyx_t_11, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Xc = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Xc.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 984, __pyx_L1_error)
    } else {__pyx_pybuffernd_Xc.diminfo[0].strides = __pyx_pybuffernd_Xc.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Xc.diminfo[0].shape = __pyx_pybuffernd_Xc.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_11 = 0;
  __pyx_v_Xc = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":985
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zc = np.zeros(3, dtype=np.float64)
 * 
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 985, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 985, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 985, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 985, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 985, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 985, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_tuple__55, __pyx_t_6); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 985, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 985, __pyx_L1_error)
  __pyx_t_12 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Yc.rcbuffer->pybuffer, (PyObject*)__pyx_t_12, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Yc = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Yc.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 985, __pyx_L1_error)
    } else {__pyx_pybuffernd_Yc.diminfo[0].strides = __pyx_pybuffernd_Yc.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Yc.diminfo[0].shape = __pyx_pybuffernd_Yc.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_12 = 0;
  __pyx_v_Yc = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":986
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zc = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 986, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 986, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 986, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 986, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 986, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 986, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__56, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 986, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 986, __pyx_L1_error)
  __pyx_t_13 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Zc.rcbuffer->pybuffer, (PyObject*)__pyx_t_13, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Zc = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Zc.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 986, __pyx_L1_error)
    } else {__pyx_pybuffernd_Zc.diminfo[0].strides = __pyx_pybuffernd_Zc.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Zc.diminfo[0].shape = __pyx_pybuffernd_Zc.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_13 = 0;
  __pyx_v_Zc = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":990
 * 
 *     # DESCRIPTORS OF ORIENTATIONS
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] delR = np.zeros((3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 990, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 990, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 990, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = PyTuple_New(3); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 990, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_1);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_int_3);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_6, 2, __pyx_int_3);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 990, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 990, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 990, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 990, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 990, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_1, __pyx_t_6); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 990, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 990, __pyx_L1_error)
  __pyx_t_14 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer, (PyObject*)__pyx_t_14, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 3, 0, __pyx_stack) == -1)) {
      __pyx_v_Rot = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rot.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 990, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rot.diminfo[0].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rot.diminfo[0].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rot.diminfo[1].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rot.diminfo[1].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_Rot.diminfo[2].strides = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_Rot.diminfo[2].shape = __pyx_pybuffernd_Rot.rcbuffer->pybuffer.shape[2];
    }
  }
  __pyx_t_14 = 0;
  __pyx_v_Rot = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":991
 *     # DESCRIPTORS OF ORIENTATIONS
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] delR = np.zeros((3, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 991, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 991, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 991, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 991, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 991, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 991, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_tuple__58, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 991, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 991, __pyx_L1_error)
  __pyx_t_15 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_delR.rcbuffer->pybuffer, (PyObject*)__pyx_t_15, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_delR = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_delR.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 991, __pyx_L1_error)
    } else {__pyx_pybuffernd_delR.diminfo[0].strides = __pyx_pybuffernd_delR.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_delR.diminfo[0].shape = __pyx_pybuffernd_delR.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_delR.diminfo[1].strides = __pyx_pybuffernd_delR.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_delR.diminfo[1].shape = __pyx_pybuffernd_delR.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_15 = 0;
  __pyx_v_delR = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":992
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] delR = np.zeros((3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 992, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 992, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 992, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 992, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_int_3);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 992, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 992, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 992, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 992, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 992, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 992, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 992, __pyx_L1_error)
  __pyx_t_16 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_t_16, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Eul = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Eul.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 992, __pyx_L1_error)
    } else {__pyx_pybuffernd_Eul.diminfo[0].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Eul.diminfo[0].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Eul.diminfo[1].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Eul.diminfo[1].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_16 = 0;
  __pyx_v_Eul = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":993
 *     cdef np.ndarray[np.float64_t, ndim = 2] delR = np.zeros((3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 993, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 993, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 993, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 993, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_int_3);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 993, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 993, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 993, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 993, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 993, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_4, __pyx_t_5); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 993, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 993, __pyx_L1_error)
  __pyx_t_17 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer, (PyObject*)__pyx_t_17, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Axis = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Axis.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 993, __pyx_L1_error)
    } else {__pyx_pybuffernd_Axis.diminfo[0].strides = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Axis.diminfo[0].shape = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Axis.diminfo[1].strides = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Axis.diminfo[1].shape = __pyx_pybuffernd_Axis.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_17 = 0;
  __pyx_v_Axis = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":994
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 994, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 994, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 994, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 994, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 994, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 994, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_float64); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 994, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_3) < 0) __PYX_ERR(0, 994, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_4, __pyx_t_1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 994, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 994, __pyx_L1_error)
  __pyx_t_18 = ((PyArrayObject *)__pyx_t_3);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer, (PyObject*)__pyx_t_18, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_Angle = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Angle.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 994, __pyx_L1_error)
    } else {__pyx_pybuffernd_Angle.diminfo[0].strides = __pyx_pybuffernd_Angle.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Angle.diminfo[0].shape = __pyx_pybuffernd_Angle.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_18 = 0;
  __pyx_v_Angle = ((PyArrayObject *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "libTEXTURIZE.pyx":995
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 995, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 995, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 995, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(2); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 995, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_int_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 995, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 995, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 995, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 995, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_6) < 0) __PYX_ERR(0, 995, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 995, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_6) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 995, __pyx_L1_error)
  __pyx_t_19 = ((PyArrayObject *)__pyx_t_6);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer, (PyObject*)__pyx_t_19, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Nd = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Nd.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 995, __pyx_L1_error)
    } else {__pyx_pybuffernd_Nd.diminfo[0].strides = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Nd.diminfo[0].shape = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Nd.diminfo[1].strides = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Nd.diminfo[1].shape = __pyx_pybuffernd_Nd.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_19 = 0;
  __pyx_v_Nd = ((PyArrayObject *)__pyx_t_6);
  __pyx_t_6 = 0;

  /* "libTEXTURIZE.pyx":996
 *     cdef np.ndarray[np.float64_t, ndim = 1] Angle = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)
 */
  __pyx_t_6 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 996, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_6, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 996, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_t_6 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 996, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_3 = PyTuple_New(2); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 996, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_6);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_3, 1, __pyx_int_3);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyTuple_New(1); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 996, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_3 = PyDict_New(); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 996, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 996, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 996, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_3, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 996, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_6, __pyx_t_3); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 996, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 996, __pyx_L1_error)
  __pyx_t_20 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer, (PyObject*)__pyx_t_20, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Rd = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rd.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 996, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rd.diminfo[0].strides = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rd.diminfo[0].shape = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rd.diminfo[1].strides = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rd.diminfo[1].shape = __pyx_pybuffernd_Rd.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_20 = 0;
  __pyx_v_Rd = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":997
 *     cdef np.ndarray[np.float64_t, ndim = 2] Nd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)
 * 
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 997, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 997, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 997, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_6 = PyTuple_New(2); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 997, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_6, 0, __pyx_t_5);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_6, 1, __pyx_int_3);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyTuple_New(1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 997, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_6);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_6);
  __pyx_t_6 = 0;
  __pyx_t_6 = PyDict_New(); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 997, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 997, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 997, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_6, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 997, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_3, __pyx_t_5, __pyx_t_6); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 997, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 997, __pyx_L1_error)
  __pyx_t_21 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer, (PyObject*)__pyx_t_21, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Rv = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Rv.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 997, __pyx_L1_error)
    } else {__pyx_pybuffernd_Rv.diminfo[0].strides = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Rv.diminfo[0].shape = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Rv.diminfo[1].strides = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Rv.diminfo[1].shape = __pyx_pybuffernd_Rv.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_21 = 0;
  __pyx_v_Rv = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":998
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rd = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Rv = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)             # <<<<<<<<<<<<<<
 * 
 *     plantseed(myseed)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 998, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 998, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_6);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 998, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = PyTuple_New(2); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 998, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_1);
  __Pyx_INCREF(__pyx_int_4);
  __Pyx_GIVEREF(__pyx_int_4);
  PyTuple_SET_ITEM(__pyx_t_5, 1, __pyx_int_4);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyTuple_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 998, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_1, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 998, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 998, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 998, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 998, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_6, __pyx_t_1, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 998, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 998, __pyx_L1_error)
  __pyx_t_22 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Q.rcbuffer->pybuffer, (PyObject*)__pyx_t_22, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) {
      __pyx_v_Q = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_Q.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 998, __pyx_L1_error)
    } else {__pyx_pybuffernd_Q.diminfo[0].strides = __pyx_pybuffernd_Q.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Q.diminfo[0].shape = __pyx_pybuffernd_Q.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Q.diminfo[1].strides = __pyx_pybuffernd_Q.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Q.diminfo[1].shape = __pyx_pybuffernd_Q.rcbuffer->pybuffer.shape[1];
    }
  }
  __pyx_t_22 = 0;
  __pyx_v_Q = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":1000
 *     cdef np.ndarray[np.float64_t, ndim = 2] Q = np.zeros((p, 4), dtype=np.float64)
 * 
 *     plantseed(myseed)             # <<<<<<<<<<<<<<
 *     tic = time.time()
 * 
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_plantseed); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1000, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_myseed); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1000, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_6 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_6 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_6)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_6);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
    }
  }
  if (!__pyx_t_6) {
    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_5, __pyx_t_1); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1000, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
    __Pyx_GOTREF(__pyx_t_4);
  } else {
    __pyx_t_3 = PyTuple_New(1+1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1000, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_GIVEREF(__pyx_t_6); PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_6); __pyx_t_6 = NULL;
    __Pyx_GIVEREF(__pyx_t_1);
    PyTuple_SET_ITEM(__pyx_t_3, 0+1, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1000, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  }
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":1001
 * 
 *     plantseed(myseed)
 *     tic = time.time()             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_time); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1001, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_time); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1001, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_3))) {
    __pyx_t_5 = PyMethod_GET_SELF(__pyx_t_3);
    if (likely(__pyx_t_5)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_5);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_3, function);
    }
  }
  if (__pyx_t_5) {
    __pyx_t_4 = __Pyx_PyObject_CallOneArg(__pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1001, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  } else {
    __pyx_t_4 = __Pyx_PyObject_CallNoArg(__pyx_t_3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1001, __pyx_L1_error)
  }
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_23 = __pyx_PyFloat_AsDouble(__pyx_t_4); if (unlikely((__pyx_t_23 == (double)-1) && PyErr_Occurred())) __PYX_ERR(0, 1001, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_tic = __pyx_t_23;

  /* "libTEXTURIZE.pyx":963
 * 
 * 
 * def Texture_Generic_Euler(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */

  /* function exit code */
  __pyx_r = Py_None; __Pyx_INCREF(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_6);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Q.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V1.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V2.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Xc.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Yc.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Zc.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_delR.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_lambdaa.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_phi.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("libTEXTURIZE.Texture_Generic_Euler", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Angle.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Axis.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Nd.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Q.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rd.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rot.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Rv.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V1.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_V2.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Xc.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Yc.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Zc.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_delR.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_lambdaa.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_phi.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XDECREF(__pyx_v_Phi1Func);
  __Pyx_XDECREF(__pyx_v_PhiFunc);
  __Pyx_XDECREF(__pyx_v_Phi2Func);
  __Pyx_XDECREF((PyObject *)__pyx_v_lambdaa);
  __Pyx_XDECREF((PyObject *)__pyx_v_phi);
  __Pyx_XDECREF((PyObject *)__pyx_v_V1);
  __Pyx_XDECREF((PyObject *)__pyx_v_V2);
  __Pyx_XDECREF((PyObject *)__pyx_v_Xc);
  __Pyx_XDECREF((PyObject *)__pyx_v_Yc);
  __Pyx_XDECREF((PyObject *)__pyx_v_Zc);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rot);
  __Pyx_XDECREF((PyObject *)__pyx_v_delR);
  __Pyx_XDECREF((PyObject *)__pyx_v_Eul);
  __Pyx_XDECREF((PyObject *)__pyx_v_Axis);
  __Pyx_XDECREF((PyObject *)__pyx_v_Angle);
  __Pyx_XDECREF((PyObject *)__pyx_v_Nd);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rd);
  __Pyx_XDECREF((PyObject *)__pyx_v_Rv);
  __Pyx_XDECREF((PyObject *)__pyx_v_Q);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "libTEXTURIZE.pyx":1005
 * 
 * 
 * cdef np.ndarray[np.float64_t, ndim = 1] ProbSinSquare(float low, float high, float m, int p):             # <<<<<<<<<<<<<<
 * 
 * 
 */

static PyArrayObject *__pyx_f_12libTEXTURIZE_ProbSinSquare(float __pyx_v_low, float __pyx_v_high, float __pyx_v_m, int __pyx_v_p) {
  int __pyx_v_i;
  int __pyx_v_j;
  float __pyx_v_g;
  float __pyx_v_u;
  float __pyx_v_v1;
  float __pyx_v_v2;
  float __pyx_v_g1;
  float __pyx_v_g2;
  float __pyx_v_mbt;
  float __pyx_v_N;
  float __pyx_v_MIN;
  int __pyx_v_num;
  PyArrayObject *__pyx_v_GRID = 0;
  PyArrayObject *__pyx_v_VALUE = 0;
  PyArrayObject *__pyx_v_U = 0;
  PyArrayObject *__pyx_v_X = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_GRID;
  __Pyx_Buffer __pyx_pybuffer_GRID;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_U;
  __Pyx_Buffer __pyx_pybuffer_U;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_VALUE;
  __Pyx_Buffer __pyx_pybuffer_VALUE;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_X;
  __Pyx_Buffer __pyx_pybuffer_X;
  PyArrayObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyArrayObject *__pyx_t_6 = NULL;
  PyArrayObject *__pyx_t_7 = NULL;
  PyArrayObject *__pyx_t_8 = NULL;
  PyArrayObject *__pyx_t_9 = NULL;
  Py_ssize_t __pyx_t_10;
  int __pyx_t_11;
  PyObject *__pyx_t_12 = NULL;
  PyObject *__pyx_t_13 = NULL;
  PyObject *__pyx_t_14 = NULL;
  PyObject *__pyx_t_15 = NULL;
  PyObject *__pyx_t_16 = NULL;
  int __pyx_t_17;
  Py_ssize_t __pyx_t_18;
  Py_ssize_t __pyx_t_19;
  Py_ssize_t __pyx_t_20;
  long __pyx_t_21;
  int __pyx_t_22;
  int __pyx_t_23;
  Py_ssize_t __pyx_t_24;
  int __pyx_t_25;
  Py_ssize_t __pyx_t_26;
  Py_ssize_t __pyx_t_27;
  Py_ssize_t __pyx_t_28;
  Py_ssize_t __pyx_t_29;
  Py_ssize_t __pyx_t_30;
  Py_ssize_t __pyx_t_31;
  __Pyx_RefNannySetupContext("ProbSinSquare", 0);
  __pyx_pybuffer_GRID.pybuffer.buf = NULL;
  __pyx_pybuffer_GRID.refcount = 0;
  __pyx_pybuffernd_GRID.data = NULL;
  __pyx_pybuffernd_GRID.rcbuffer = &__pyx_pybuffer_GRID;
  __pyx_pybuffer_VALUE.pybuffer.buf = NULL;
  __pyx_pybuffer_VALUE.refcount = 0;
  __pyx_pybuffernd_VALUE.data = NULL;
  __pyx_pybuffernd_VALUE.rcbuffer = &__pyx_pybuffer_VALUE;
  __pyx_pybuffer_U.pybuffer.buf = NULL;
  __pyx_pybuffer_U.refcount = 0;
  __pyx_pybuffernd_U.data = NULL;
  __pyx_pybuffernd_U.rcbuffer = &__pyx_pybuffer_U;
  __pyx_pybuffer_X.pybuffer.buf = NULL;
  __pyx_pybuffer_X.refcount = 0;
  __pyx_pybuffernd_X.data = NULL;
  __pyx_pybuffernd_X.rcbuffer = &__pyx_pybuffer_X;

  /* "libTEXTURIZE.pyx":1010
 *     cdef int i, j
 *     cdef float g, u, v1, v2, g1, g2, mbt, N, MIN
 *     cdef int num = 1000             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] GRID = np.zeros(num, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] VALUE = np.zeros(num, dtype=np.float64)
 */
  __pyx_v_num = 0x3E8;

  /* "libTEXTURIZE.pyx":1011
 *     cdef float g, u, v1, v2, g1, g2, mbt, N, MIN
 *     cdef int num = 1000
 *     cdef np.ndarray[np.float64_t, ndim = 1] GRID = np.zeros(num, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] VALUE = np.zeros(num, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] U = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1011, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1011, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_num); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1011, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1011, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1011, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1011, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1011, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (PyDict_SetItem(__pyx_t_1, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1011, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_1); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1011, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1011, __pyx_L1_error)
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_GRID.rcbuffer->pybuffer, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_GRID = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_GRID.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 1011, __pyx_L1_error)
    } else {__pyx_pybuffernd_GRID.diminfo[0].strides = __pyx_pybuffernd_GRID.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_GRID.diminfo[0].shape = __pyx_pybuffernd_GRID.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_6 = 0;
  __pyx_v_GRID = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":1012
 *     cdef int num = 1000
 *     cdef np.ndarray[np.float64_t, ndim = 1] GRID = np.zeros(num, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] VALUE = np.zeros(num, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] U = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X = np.zeros(p, dtype=np.float64)
 */
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1012, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_zeros); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1012, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyInt_From_int(__pyx_v_num); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1012, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1012, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_5);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_5);
  __pyx_t_5 = 0;
  __pyx_t_5 = PyDict_New(); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1012, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1012, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_float64); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1012, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (PyDict_SetItem(__pyx_t_5, __pyx_n_s_dtype, __pyx_t_4) < 0) __PYX_ERR(0, 1012, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyObject_Call(__pyx_t_1, __pyx_t_3, __pyx_t_5); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1012, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_4) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1012, __pyx_L1_error)
  __pyx_t_7 = ((PyArrayObject *)__pyx_t_4);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_VALUE.rcbuffer->pybuffer, (PyObject*)__pyx_t_7, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_VALUE = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_VALUE.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 1012, __pyx_L1_error)
    } else {__pyx_pybuffernd_VALUE.diminfo[0].strides = __pyx_pybuffernd_VALUE.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_VALUE.diminfo[0].shape = __pyx_pybuffernd_VALUE.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_7 = 0;
  __pyx_v_VALUE = ((PyArrayObject *)__pyx_t_4);
  __pyx_t_4 = 0;

  /* "libTEXTURIZE.pyx":1013
 *     cdef np.ndarray[np.float64_t, ndim = 1] GRID = np.zeros(num, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] VALUE = np.zeros(num, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] U = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] X = np.zeros(p, dtype=np.float64)
 * 
 */
  __pyx_t_4 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1013, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_4, __pyx_n_s_zeros); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1013, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1013, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1013, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1013, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1013, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1013, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_2) < 0) __PYX_ERR(0, 1013, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1013, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_2) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_2, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1013, __pyx_L1_error)
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_2);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_U.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_U = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_U.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 1013, __pyx_L1_error)
    } else {__pyx_pybuffernd_U.diminfo[0].strides = __pyx_pybuffernd_U.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_U.diminfo[0].shape = __pyx_pybuffernd_U.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_8 = 0;
  __pyx_v_U = ((PyArrayObject *)__pyx_t_2);
  __pyx_t_2 = 0;

  /* "libTEXTURIZE.pyx":1014
 *     cdef np.ndarray[np.float64_t, ndim = 1] VALUE = np.zeros(num, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] U = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X = np.zeros(p, dtype=np.float64)             # <<<<<<<<<<<<<<
 * 
 *     U = np.random.uniform(0, 1, p)
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1014, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_4 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_zeros); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1014, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1014, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1014, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = PyDict_New(); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1014, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1014, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_5, __pyx_n_s_float64); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1014, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (PyDict_SetItem(__pyx_t_2, __pyx_n_s_dtype, __pyx_t_1) < 0) __PYX_ERR(0, 1014, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_4, __pyx_t_3, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1014, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1014, __pyx_L1_error)
  __pyx_t_9 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_X.rcbuffer->pybuffer, (PyObject*)__pyx_t_9, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 1, 0, __pyx_stack) == -1)) {
      __pyx_v_X = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_X.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 1014, __pyx_L1_error)
    } else {__pyx_pybuffernd_X.diminfo[0].strides = __pyx_pybuffernd_X.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_X.diminfo[0].shape = __pyx_pybuffernd_X.rcbuffer->pybuffer.shape[0];
    }
  }
  __pyx_t_9 = 0;
  __pyx_v_X = ((PyArrayObject *)__pyx_t_1);
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":1016
 *     cdef np.ndarray[np.float64_t, ndim = 1] X = np.zeros(p, dtype=np.float64)
 * 
 *     U = np.random.uniform(0, 1, p)             # <<<<<<<<<<<<<<
 * 
 *     GRID = np.linspace(low, high, num)
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1016, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_random); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1016, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_3, __pyx_n_s_uniform); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1016, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_p); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1016, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = NULL;
  __pyx_t_10 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && likely(PyMethod_Check(__pyx_t_2))) {
    __pyx_t_4 = PyMethod_GET_SELF(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_2);
      __Pyx_INCREF(__pyx_t_4);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_2, function);
      __pyx_t_10 = 1;
    }
  }
  __pyx_t_5 = PyTuple_New(3+__pyx_t_10); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1016, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  if (__pyx_t_4) {
    __Pyx_GIVEREF(__pyx_t_4); PyTuple_SET_ITEM(__pyx_t_5, 0, __pyx_t_4); __pyx_t_4 = NULL;
  }
  __Pyx_INCREF(__pyx_int_0);
  __Pyx_GIVEREF(__pyx_int_0);
  PyTuple_SET_ITEM(__pyx_t_5, 0+__pyx_t_10, __pyx_int_0);
  __Pyx_INCREF(__pyx_int_1);
  __Pyx_GIVEREF(__pyx_int_1);
  PyTuple_SET_ITEM(__pyx_t_5, 1+__pyx_t_10, __pyx_int_1);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_5, 2+__pyx_t_10, __pyx_t_3);
  __pyx_t_3 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_5, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1016, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1016, __pyx_L1_error)
  __pyx_t_8 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_U.rcbuffer->pybuffer);
    __pyx_t_11 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_U.rcbuffer->pybuffer, (PyObject*)__pyx_t_8, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_11 < 0)) {
      PyErr_Fetch(&__pyx_t_12, &__pyx_t_13, &__pyx_t_14);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_U.rcbuffer->pybuffer, (PyObject*)__pyx_v_U, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_12); Py_XDECREF(__pyx_t_13); Py_XDECREF(__pyx_t_14);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_12, __pyx_t_13, __pyx_t_14);
      }
    }
    __pyx_pybuffernd_U.diminfo[0].strides = __pyx_pybuffernd_U.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_U.diminfo[0].shape = __pyx_pybuffernd_U.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1016, __pyx_L1_error)
  }
  __pyx_t_8 = 0;
  __Pyx_DECREF_SET(__pyx_v_U, ((PyArrayObject *)__pyx_t_1));
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":1018
 *     U = np.random.uniform(0, 1, p)
 * 
 *     GRID = np.linspace(low, high, num)             # <<<<<<<<<<<<<<
 *     mbt = m / 2
 *     N = ((high - mbt * sin(high / mbt)) - (low - mbt * sin(low / mbt)))
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1018, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_linspace); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1018, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyFloat_FromDouble(__pyx_v_low); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1018, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_3 = PyFloat_FromDouble(__pyx_v_high); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1018, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_num); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1018, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_15 = NULL;
  __pyx_t_10 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON && unlikely(PyMethod_Check(__pyx_t_5))) {
    __pyx_t_15 = PyMethod_GET_SELF(__pyx_t_5);
    if (likely(__pyx_t_15)) {
      PyObject* function = PyMethod_GET_FUNCTION(__pyx_t_5);
      __Pyx_INCREF(__pyx_t_15);
      __Pyx_INCREF(function);
      __Pyx_DECREF_SET(__pyx_t_5, function);
      __pyx_t_10 = 1;
    }
  }
  __pyx_t_16 = PyTuple_New(3+__pyx_t_10); if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 1018, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_16);
  if (__pyx_t_15) {
    __Pyx_GIVEREF(__pyx_t_15); PyTuple_SET_ITEM(__pyx_t_16, 0, __pyx_t_15); __pyx_t_15 = NULL;
  }
  __Pyx_GIVEREF(__pyx_t_2);
  PyTuple_SET_ITEM(__pyx_t_16, 0+__pyx_t_10, __pyx_t_2);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_16, 1+__pyx_t_10, __pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_16, 2+__pyx_t_10, __pyx_t_4);
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_1 = __Pyx_PyObject_Call(__pyx_t_5, __pyx_t_16, NULL); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1018, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_16); __pyx_t_16 = 0;
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  if (!(likely(((__pyx_t_1) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1018, __pyx_L1_error)
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_1);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_GRID.rcbuffer->pybuffer);
    __pyx_t_11 = __Pyx_GetBufferAndValidate(&__pyx_pybuffernd_GRID.rcbuffer->pybuffer, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack);
    if (unlikely(__pyx_t_11 < 0)) {
      PyErr_Fetch(&__pyx_t_14, &__pyx_t_13, &__pyx_t_12);
      if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_GRID.rcbuffer->pybuffer, (PyObject*)__pyx_v_GRID, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 1, 0, __pyx_stack) == -1)) {
        Py_XDECREF(__pyx_t_14); Py_XDECREF(__pyx_t_13); Py_XDECREF(__pyx_t_12);
        __Pyx_RaiseBufferFallbackError();
      } else {
        PyErr_Restore(__pyx_t_14, __pyx_t_13, __pyx_t_12);
      }
    }
    __pyx_pybuffernd_GRID.diminfo[0].strides = __pyx_pybuffernd_GRID.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_GRID.diminfo[0].shape = __pyx_pybuffernd_GRID.rcbuffer->pybuffer.shape[0];
    if (unlikely(__pyx_t_11 < 0)) __PYX_ERR(0, 1018, __pyx_L1_error)
  }
  __pyx_t_6 = 0;
  __Pyx_DECREF_SET(__pyx_v_GRID, ((PyArrayObject *)__pyx_t_1));
  __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":1019
 * 
 *     GRID = np.linspace(low, high, num)
 *     mbt = m / 2             # <<<<<<<<<<<<<<
 *     N = ((high - mbt * sin(high / mbt)) - (low - mbt * sin(low / mbt)))
 *     MIN = low - mbt * sin(low / mbt)
 */
  __pyx_v_mbt = (__pyx_v_m / 2.0);

  /* "libTEXTURIZE.pyx":1020
 *     GRID = np.linspace(low, high, num)
 *     mbt = m / 2
 *     N = ((high - mbt * sin(high / mbt)) - (low - mbt * sin(low / mbt)))             # <<<<<<<<<<<<<<
 *     MIN = low - mbt * sin(low / mbt)
 *     for i in range(num):
 */
  __pyx_v_N = ((__pyx_v_high - (__pyx_v_mbt * sin((__pyx_v_high / __pyx_v_mbt)))) - (__pyx_v_low - (__pyx_v_mbt * sin((__pyx_v_low / __pyx_v_mbt)))));

  /* "libTEXTURIZE.pyx":1021
 *     mbt = m / 2
 *     N = ((high - mbt * sin(high / mbt)) - (low - mbt * sin(low / mbt)))
 *     MIN = low - mbt * sin(low / mbt)             # <<<<<<<<<<<<<<
 *     for i in range(num):
 *         g = GRID[i]
 */
  __pyx_v_MIN = (__pyx_v_low - (__pyx_v_mbt * sin((__pyx_v_low / __pyx_v_mbt))));

  /* "libTEXTURIZE.pyx":1022
 *     N = ((high - mbt * sin(high / mbt)) - (low - mbt * sin(low / mbt)))
 *     MIN = low - mbt * sin(low / mbt)
 *     for i in range(num):             # <<<<<<<<<<<<<<
 *         g = GRID[i]
 *         VALUE[i] = (g - mbt * sin(g / mbt) - MIN) / N
 */
  __pyx_t_11 = __pyx_v_num;
  for (__pyx_t_17 = 0; __pyx_t_17 < __pyx_t_11; __pyx_t_17+=1) {
    __pyx_v_i = __pyx_t_17;

    /* "libTEXTURIZE.pyx":1023
 *     MIN = low - mbt * sin(low / mbt)
 *     for i in range(num):
 *         g = GRID[i]             # <<<<<<<<<<<<<<
 *         VALUE[i] = (g - mbt * sin(g / mbt) - MIN) / N
 * 
 */
    __pyx_t_18 = __pyx_v_i;
    __pyx_v_g = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_GRID.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_GRID.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":1024
 *     for i in range(num):
 *         g = GRID[i]
 *         VALUE[i] = (g - mbt * sin(g / mbt) - MIN) / N             # <<<<<<<<<<<<<<
 * 
 * 
 */
    __pyx_t_19 = __pyx_v_i;
    *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_VALUE.rcbuffer->pybuffer.buf, __pyx_t_19, __pyx_pybuffernd_VALUE.diminfo[0].strides) = (((__pyx_v_g - (__pyx_v_mbt * sin((__pyx_v_g / __pyx_v_mbt)))) - __pyx_v_MIN) / ((double)__pyx_v_N));
  }

  /* "libTEXTURIZE.pyx":1027
 * 
 * 
 *     for j in range(p):             # <<<<<<<<<<<<<<
 *         u = U[j]
 *         for i in range(num - 1):
 */
  __pyx_t_11 = __pyx_v_p;
  for (__pyx_t_17 = 0; __pyx_t_17 < __pyx_t_11; __pyx_t_17+=1) {
    __pyx_v_j = __pyx_t_17;

    /* "libTEXTURIZE.pyx":1028
 * 
 *     for j in range(p):
 *         u = U[j]             # <<<<<<<<<<<<<<
 *         for i in range(num - 1):
 *             if u > VALUE[i] and u < VALUE[i + 1]:
 */
    __pyx_t_20 = __pyx_v_j;
    __pyx_v_u = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_U.rcbuffer->pybuffer.buf, __pyx_t_20, __pyx_pybuffernd_U.diminfo[0].strides));

    /* "libTEXTURIZE.pyx":1029
 *     for j in range(p):
 *         u = U[j]
 *         for i in range(num - 1):             # <<<<<<<<<<<<<<
 *             if u > VALUE[i] and u < VALUE[i + 1]:
 *                 g1 = GRID[i]
 */
    __pyx_t_21 = (__pyx_v_num - 1);
    for (__pyx_t_22 = 0; __pyx_t_22 < __pyx_t_21; __pyx_t_22+=1) {
      __pyx_v_i = __pyx_t_22;

      /* "libTEXTURIZE.pyx":1030
 *         u = U[j]
 *         for i in range(num - 1):
 *             if u > VALUE[i] and u < VALUE[i + 1]:             # <<<<<<<<<<<<<<
 *                 g1 = GRID[i]
 *                 g2 = GRID[i + 1]
 */
      __pyx_t_24 = __pyx_v_i;
      __pyx_t_25 = ((__pyx_v_u > (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_VALUE.rcbuffer->pybuffer.buf, __pyx_t_24, __pyx_pybuffernd_VALUE.diminfo[0].strides))) != 0);
      if (__pyx_t_25) {
      } else {
        __pyx_t_23 = __pyx_t_25;
        goto __pyx_L10_bool_binop_done;
      }
      __pyx_t_26 = (__pyx_v_i + 1);
      __pyx_t_25 = ((__pyx_v_u < (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_VALUE.rcbuffer->pybuffer.buf, __pyx_t_26, __pyx_pybuffernd_VALUE.diminfo[0].strides))) != 0);
      __pyx_t_23 = __pyx_t_25;
      __pyx_L10_bool_binop_done:;
      if (__pyx_t_23) {

        /* "libTEXTURIZE.pyx":1031
 *         for i in range(num - 1):
 *             if u > VALUE[i] and u < VALUE[i + 1]:
 *                 g1 = GRID[i]             # <<<<<<<<<<<<<<
 *                 g2 = GRID[i + 1]
 *                 v1 = VALUE[i]
 */
        __pyx_t_27 = __pyx_v_i;
        __pyx_v_g1 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_GRID.rcbuffer->pybuffer.buf, __pyx_t_27, __pyx_pybuffernd_GRID.diminfo[0].strides));

        /* "libTEXTURIZE.pyx":1032
 *             if u > VALUE[i] and u < VALUE[i + 1]:
 *                 g1 = GRID[i]
 *                 g2 = GRID[i + 1]             # <<<<<<<<<<<<<<
 *                 v1 = VALUE[i]
 *                 v2 = VALUE[i + 1]
 */
        __pyx_t_28 = (__pyx_v_i + 1);
        __pyx_v_g2 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_GRID.rcbuffer->pybuffer.buf, __pyx_t_28, __pyx_pybuffernd_GRID.diminfo[0].strides));

        /* "libTEXTURIZE.pyx":1033
 *                 g1 = GRID[i]
 *                 g2 = GRID[i + 1]
 *                 v1 = VALUE[i]             # <<<<<<<<<<<<<<
 *                 v2 = VALUE[i + 1]
 *                 m = (v2 - v1) / (g2 - g1)
 */
        __pyx_t_29 = __pyx_v_i;
        __pyx_v_v1 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_VALUE.rcbuffer->pybuffer.buf, __pyx_t_29, __pyx_pybuffernd_VALUE.diminfo[0].strides));

        /* "libTEXTURIZE.pyx":1034
 *                 g2 = GRID[i + 1]
 *                 v1 = VALUE[i]
 *                 v2 = VALUE[i + 1]             # <<<<<<<<<<<<<<
 *                 m = (v2 - v1) / (g2 - g1)
 *                 X[j] = g1 + (u - v1) / m
 */
        __pyx_t_30 = (__pyx_v_i + 1);
        __pyx_v_v2 = (*__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_VALUE.rcbuffer->pybuffer.buf, __pyx_t_30, __pyx_pybuffernd_VALUE.diminfo[0].strides));

        /* "libTEXTURIZE.pyx":1035
 *                 v1 = VALUE[i]
 *                 v2 = VALUE[i + 1]
 *                 m = (v2 - v1) / (g2 - g1)             # <<<<<<<<<<<<<<
 *                 X[j] = g1 + (u - v1) / m
 *                 break
 */
        __pyx_v_m = ((__pyx_v_v2 - __pyx_v_v1) / (__pyx_v_g2 - __pyx_v_g1));

        /* "libTEXTURIZE.pyx":1036
 *                 v2 = VALUE[i + 1]
 *                 m = (v2 - v1) / (g2 - g1)
 *                 X[j] = g1 + (u - v1) / m             # <<<<<<<<<<<<<<
 *                 break
 * 
 */
        __pyx_t_31 = __pyx_v_j;
        *__Pyx_BufPtrStrided1d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_X.rcbuffer->pybuffer.buf, __pyx_t_31, __pyx_pybuffernd_X.diminfo[0].strides) = (__pyx_v_g1 + ((__pyx_v_u - __pyx_v_v1) / __pyx_v_m));

        /* "libTEXTURIZE.pyx":1037
 *                 m = (v2 - v1) / (g2 - g1)
 *                 X[j] = g1 + (u - v1) / m
 *                 break             # <<<<<<<<<<<<<<
 * 
 *     return X
 */
        goto __pyx_L8_break;

        /* "libTEXTURIZE.pyx":1030
 *         u = U[j]
 *         for i in range(num - 1):
 *             if u > VALUE[i] and u < VALUE[i + 1]:             # <<<<<<<<<<<<<<
 *                 g1 = GRID[i]
 *                 g2 = GRID[i + 1]
 */
      }
    }
    __pyx_L8_break:;
  }

  /* "libTEXTURIZE.pyx":1039
 *                 break
 * 
 *     return X             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __Pyx_XDECREF(((PyObject *)__pyx_r));
  __Pyx_INCREF(((PyObject *)__pyx_v_X));
  __pyx_r = ((PyArrayObject *)__pyx_v_X);
  goto __pyx_L0;

  /* "libTEXTURIZE.pyx":1005
 * 
 * 
 * cdef np.ndarray[np.float64_t, ndim = 1] ProbSinSquare(float low, float high, float m, int p):             # <<<<<<<<<<<<<<
 * 
 * 
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  __Pyx_XDECREF(__pyx_t_15);
  __Pyx_XDECREF(__pyx_t_16);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_GRID.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_U.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_VALUE.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("libTEXTURIZE.ProbSinSquare", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_GRID.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_U.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_VALUE.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_X.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XDECREF((PyObject *)__pyx_v_GRID);
  __Pyx_XDECREF((PyObject *)__pyx_v_VALUE);
  __Pyx_XDECREF((PyObject *)__pyx_v_U);
  __Pyx_XDECREF((PyObject *)__pyx_v_X);
  __Pyx_XGIVEREF((PyObject *)__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "libTEXTURIZE.pyx":1042
 * 
 * 
 * cdef getcanvas(int m, int n, np.ndarray[np.float64_t, ndim=2] Eul):             # <<<<<<<<<<<<<<
 *     cdef int i, j, count
 *     cdef np.ndarray[np.float64_t, ndim = 3] EUL = np.zeros((m, n, 3), dtype=np.float64)
 */

static PyObject *__pyx_f_12libTEXTURIZE_getcanvas(int __pyx_v_m, int __pyx_v_n, PyArrayObject *__pyx_v_Eul) {
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_count;
  PyArrayObject *__pyx_v_EUL = 0;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_EUL;
  __Pyx_Buffer __pyx_pybuffer_EUL;
  __Pyx_LocalBuf_ND __pyx_pybuffernd_Eul;
  __Pyx_Buffer __pyx_pybuffer_Eul;
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  PyObject *__pyx_t_5 = NULL;
  PyArrayObject *__pyx_t_6 = NULL;
  int __pyx_t_7;
  int __pyx_t_8;
  int __pyx_t_9;
  int __pyx_t_10;
  Py_ssize_t __pyx_t_11;
  Py_ssize_t __pyx_t_12;
  Py_ssize_t __pyx_t_13;
  Py_ssize_t __pyx_t_14;
  Py_ssize_t __pyx_t_15;
  Py_ssize_t __pyx_t_16;
  Py_ssize_t __pyx_t_17;
  Py_ssize_t __pyx_t_18;
  Py_ssize_t __pyx_t_19;
  Py_ssize_t __pyx_t_20;
  Py_ssize_t __pyx_t_21;
  Py_ssize_t __pyx_t_22;
  Py_ssize_t __pyx_t_23;
  Py_ssize_t __pyx_t_24;
  Py_ssize_t __pyx_t_25;
  __Pyx_RefNannySetupContext("getcanvas", 0);
  __pyx_pybuffer_EUL.pybuffer.buf = NULL;
  __pyx_pybuffer_EUL.refcount = 0;
  __pyx_pybuffernd_EUL.data = NULL;
  __pyx_pybuffernd_EUL.rcbuffer = &__pyx_pybuffer_EUL;
  __pyx_pybuffer_Eul.pybuffer.buf = NULL;
  __pyx_pybuffer_Eul.refcount = 0;
  __pyx_pybuffernd_Eul.data = NULL;
  __pyx_pybuffernd_Eul.rcbuffer = &__pyx_pybuffer_Eul;
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer, (PyObject*)__pyx_v_Eul, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES, 2, 0, __pyx_stack) == -1)) __PYX_ERR(0, 1042, __pyx_L1_error)
  }
  __pyx_pybuffernd_Eul.diminfo[0].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_Eul.diminfo[0].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_Eul.diminfo[1].strides = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_Eul.diminfo[1].shape = __pyx_pybuffernd_Eul.rcbuffer->pybuffer.shape[1];

  /* "libTEXTURIZE.pyx":1044
 * cdef getcanvas(int m, int n, np.ndarray[np.float64_t, ndim=2] Eul):
 *     cdef int i, j, count
 *     cdef np.ndarray[np.float64_t, ndim = 3] EUL = np.zeros((m, n, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     count = 0
 *     for i in range(m):
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1044, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_zeros); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 1044, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_From_int(__pyx_v_m); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1044, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_n); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1044, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __pyx_t_4 = PyTuple_New(3); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1044, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __Pyx_GIVEREF(__pyx_t_1);
  PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_1);
  __Pyx_GIVEREF(__pyx_t_3);
  PyTuple_SET_ITEM(__pyx_t_4, 1, __pyx_t_3);
  __Pyx_INCREF(__pyx_int_3);
  __Pyx_GIVEREF(__pyx_int_3);
  PyTuple_SET_ITEM(__pyx_t_4, 2, __pyx_int_3);
  __pyx_t_1 = 0;
  __pyx_t_3 = 0;
  __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 1044, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_3);
  __Pyx_GIVEREF(__pyx_t_4);
  PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_4);
  __pyx_t_4 = 0;
  __pyx_t_4 = PyDict_New(); if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 1044, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_4);
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1044, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_5 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_float64); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1044, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  if (PyDict_SetItem(__pyx_t_4, __pyx_n_s_dtype, __pyx_t_5) < 0) __PYX_ERR(0, 1044, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = __Pyx_PyObject_Call(__pyx_t_2, __pyx_t_3, __pyx_t_4); if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 1044, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_5);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
  __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
  if (!(likely(((__pyx_t_5) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_5, __pyx_ptype_5numpy_ndarray))))) __PYX_ERR(0, 1044, __pyx_L1_error)
  __pyx_t_6 = ((PyArrayObject *)__pyx_t_5);
  {
    __Pyx_BufFmt_StackElem __pyx_stack[1];
    if (unlikely(__Pyx_GetBufferAndValidate(&__pyx_pybuffernd_EUL.rcbuffer->pybuffer, (PyObject*)__pyx_t_6, &__Pyx_TypeInfo_nn___pyx_t_5numpy_float64_t, PyBUF_FORMAT| PyBUF_STRIDES| PyBUF_WRITABLE, 3, 0, __pyx_stack) == -1)) {
      __pyx_v_EUL = ((PyArrayObject *)Py_None); __Pyx_INCREF(Py_None); __pyx_pybuffernd_EUL.rcbuffer->pybuffer.buf = NULL;
      __PYX_ERR(0, 1044, __pyx_L1_error)
    } else {__pyx_pybuffernd_EUL.diminfo[0].strides = __pyx_pybuffernd_EUL.rcbuffer->pybuffer.strides[0]; __pyx_pybuffernd_EUL.diminfo[0].shape = __pyx_pybuffernd_EUL.rcbuffer->pybuffer.shape[0]; __pyx_pybuffernd_EUL.diminfo[1].strides = __pyx_pybuffernd_EUL.rcbuffer->pybuffer.strides[1]; __pyx_pybuffernd_EUL.diminfo[1].shape = __pyx_pybuffernd_EUL.rcbuffer->pybuffer.shape[1]; __pyx_pybuffernd_EUL.diminfo[2].strides = __pyx_pybuffernd_EUL.rcbuffer->pybuffer.strides[2]; __pyx_pybuffernd_EUL.diminfo[2].shape = __pyx_pybuffernd_EUL.rcbuffer->pybuffer.shape[2];
    }
  }
  __pyx_t_6 = 0;
  __pyx_v_EUL = ((PyArrayObject *)__pyx_t_5);
  __pyx_t_5 = 0;

  /* "libTEXTURIZE.pyx":1045
 *     cdef int i, j, count
 *     cdef np.ndarray[np.float64_t, ndim = 3] EUL = np.zeros((m, n, 3), dtype=np.float64)
 *     count = 0             # <<<<<<<<<<<<<<
 *     for i in range(m):
 *         for j in range(n):
 */
  __pyx_v_count = 0;

  /* "libTEXTURIZE.pyx":1046
 *     cdef np.ndarray[np.float64_t, ndim = 3] EUL = np.zeros((m, n, 3), dtype=np.float64)
 *     count = 0
 *     for i in range(m):             # <<<<<<<<<<<<<<
 *         for j in range(n):
 * 
 */
  __pyx_t_7 = __pyx_v_m;
  for (__pyx_t_8 = 0; __pyx_t_8 < __pyx_t_7; __pyx_t_8+=1) {
    __pyx_v_i = __pyx_t_8;

    /* "libTEXTURIZE.pyx":1047
 *     count = 0
 *     for i in range(m):
 *         for j in range(n):             # <<<<<<<<<<<<<<
 * 
 *             EUL[i, j, 0 ] = Eul[count, 0]
 */
    __pyx_t_9 = __pyx_v_n;
    for (__pyx_t_10 = 0; __pyx_t_10 < __pyx_t_9; __pyx_t_10+=1) {
      __pyx_v_j = __pyx_t_10;

      /* "libTEXTURIZE.pyx":1049
 *         for j in range(n):
 * 
 *             EUL[i, j, 0 ] = Eul[count, 0]             # <<<<<<<<<<<<<<
 *             EUL[i, j, 1 ] = Eul[count, 1]
 *             EUL[i, j, 2 ] = Eul[count, 2]
 */
      __pyx_t_11 = __pyx_v_count;
      __pyx_t_12 = 0;
      __pyx_t_13 = __pyx_v_i;
      __pyx_t_14 = __pyx_v_j;
      __pyx_t_15 = 0;
      *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_EUL.rcbuffer->pybuffer.buf, __pyx_t_13, __pyx_pybuffernd_EUL.diminfo[0].strides, __pyx_t_14, __pyx_pybuffernd_EUL.diminfo[1].strides, __pyx_t_15, __pyx_pybuffernd_EUL.diminfo[2].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Eul.rcbuffer->pybuffer.buf, __pyx_t_11, __pyx_pybuffernd_Eul.diminfo[0].strides, __pyx_t_12, __pyx_pybuffernd_Eul.diminfo[1].strides));

      /* "libTEXTURIZE.pyx":1050
 * 
 *             EUL[i, j, 0 ] = Eul[count, 0]
 *             EUL[i, j, 1 ] = Eul[count, 1]             # <<<<<<<<<<<<<<
 *             EUL[i, j, 2 ] = Eul[count, 2]
 *             count = count + 1
 */
      __pyx_t_16 = __pyx_v_count;
      __pyx_t_17 = 1;
      __pyx_t_18 = __pyx_v_i;
      __pyx_t_19 = __pyx_v_j;
      __pyx_t_20 = 1;
      *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_EUL.rcbuffer->pybuffer.buf, __pyx_t_18, __pyx_pybuffernd_EUL.diminfo[0].strides, __pyx_t_19, __pyx_pybuffernd_EUL.diminfo[1].strides, __pyx_t_20, __pyx_pybuffernd_EUL.diminfo[2].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Eul.rcbuffer->pybuffer.buf, __pyx_t_16, __pyx_pybuffernd_Eul.diminfo[0].strides, __pyx_t_17, __pyx_pybuffernd_Eul.diminfo[1].strides));

      /* "libTEXTURIZE.pyx":1051
 *             EUL[i, j, 0 ] = Eul[count, 0]
 *             EUL[i, j, 1 ] = Eul[count, 1]
 *             EUL[i, j, 2 ] = Eul[count, 2]             # <<<<<<<<<<<<<<
 *             count = count + 1
 *     return EUL
 */
      __pyx_t_21 = __pyx_v_count;
      __pyx_t_22 = 2;
      __pyx_t_23 = __pyx_v_i;
      __pyx_t_24 = __pyx_v_j;
      __pyx_t_25 = 2;
      *__Pyx_BufPtrStrided3d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_EUL.rcbuffer->pybuffer.buf, __pyx_t_23, __pyx_pybuffernd_EUL.diminfo[0].strides, __pyx_t_24, __pyx_pybuffernd_EUL.diminfo[1].strides, __pyx_t_25, __pyx_pybuffernd_EUL.diminfo[2].strides) = (*__Pyx_BufPtrStrided2d(__pyx_t_5numpy_float64_t *, __pyx_pybuffernd_Eul.rcbuffer->pybuffer.buf, __pyx_t_21, __pyx_pybuffernd_Eul.diminfo[0].strides, __pyx_t_22, __pyx_pybuffernd_Eul.diminfo[1].strides));

      /* "libTEXTURIZE.pyx":1052
 *             EUL[i, j, 1 ] = Eul[count, 1]
 *             EUL[i, j, 2 ] = Eul[count, 2]
 *             count = count + 1             # <<<<<<<<<<<<<<
 *     return EUL
 */
      __pyx_v_count = (__pyx_v_count + 1);
    }
  }

  /* "libTEXTURIZE.pyx":1053
 *             EUL[i, j, 2 ] = Eul[count, 2]
 *             count = count + 1
 *     return EUL             # <<<<<<<<<<<<<<
 */
  __Pyx_XDECREF(__pyx_r);
  __Pyx_INCREF(((PyObject *)__pyx_v_EUL));
  __pyx_r = ((PyObject *)__pyx_v_EUL);
  goto __pyx_L0;

  /* "libTEXTURIZE.pyx":1042
 * 
 * 
 * cdef getcanvas(int m, int n, np.ndarray[np.float64_t, ndim=2] Eul):             # <<<<<<<<<<<<<<
 *     cdef int i, j, count
 *     cdef np.ndarray[np.float64_t, ndim = 3] EUL = np.zeros((m, n, 3), dtype=np.float64)
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_XDECREF(__pyx_t_5);
  { PyObject *__pyx_type, *__pyx_value, *__pyx_tb;
    __Pyx_PyThreadState_declare
    __Pyx_PyThreadState_assign
    __Pyx_ErrFetch(&__pyx_type, &__pyx_value, &__pyx_tb);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_EUL.rcbuffer->pybuffer);
    __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
  __Pyx_ErrRestore(__pyx_type, __pyx_value, __pyx_tb);}
  __Pyx_AddTraceback("libTEXTURIZE.getcanvas", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  goto __pyx_L2;
  __pyx_L0:;
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_EUL.rcbuffer->pybuffer);
  __Pyx_SafeReleaseBuffer(&__pyx_pybuffernd_Eul.rcbuffer->pybuffer);
  __pyx_L2:;
  __Pyx_XDECREF((PyObject *)__pyx_v_EUL);
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":197
 *         # experimental exception made for __getbuffer__ and __releasebuffer__
 *         # -- the details of this may change.
 *         def __getbuffer__(ndarray self, Py_buffer* info, int flags):             # <<<<<<<<<<<<<<
 *             # This implementation of getbuffer is geared towards Cython
 *             # requirements, and does not yet fullfill the PEP.
 */

/* Python wrapper */
static CYTHON_UNUSED int __pyx_pw_5numpy_7ndarray_1__getbuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags); /*proto*/
static CYTHON_UNUSED int __pyx_pw_5numpy_7ndarray_1__getbuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags) {
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__getbuffer__ (wrapper)", 0);
  __pyx_r = __pyx_pf_5numpy_7ndarray___getbuffer__(((PyArrayObject *)__pyx_v_self), ((Py_buffer *)__pyx_v_info), ((int)__pyx_v_flags));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static int __pyx_pf_5numpy_7ndarray___getbuffer__(PyArrayObject *__pyx_v_self, Py_buffer *__pyx_v_info, int __pyx_v_flags) {
  int __pyx_v_copy_shape;
  int __pyx_v_i;
  int __pyx_v_ndim;
  int __pyx_v_endian_detector;
  int __pyx_v_little_endian;
  int __pyx_v_t;
  char *__pyx_v_f;
  PyArray_Descr *__pyx_v_descr = 0;
  int __pyx_v_offset;
  int __pyx_v_hasfields;
  int __pyx_r;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  int __pyx_t_4;
  int __pyx_t_5;
  PyObject *__pyx_t_6 = NULL;
  char *__pyx_t_7;
  __Pyx_RefNannySetupContext("__getbuffer__", 0);
  if (__pyx_v_info != NULL) {
    __pyx_v_info->obj = Py_None; __Pyx_INCREF(Py_None);
    __Pyx_GIVEREF(__pyx_v_info->obj);
  }

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":203
 *             # of flags
 * 
 *             if info == NULL: return             # <<<<<<<<<<<<<<
 * 
 *             cdef int copy_shape, i, ndim
 */
  __pyx_t_1 = ((__pyx_v_info == NULL) != 0);
  if (__pyx_t_1) {
    __pyx_r = 0;
    goto __pyx_L0;
  }

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":206
 * 
 *             cdef int copy_shape, i, ndim
 *             cdef int endian_detector = 1             # <<<<<<<<<<<<<<
 *             cdef bint little_endian = ((<char*>&endian_detector)[0] != 0)
 * 
 */
  __pyx_v_endian_detector = 1;

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":207
 *             cdef int copy_shape, i, ndim
 *             cdef int endian_detector = 1
 *             cdef bint little_endian = ((<char*>&endian_detector)[0] != 0)             # <<<<<<<<<<<<<<
 * 
 *             ndim = PyArray_NDIM(self)
 */
  __pyx_v_little_endian = ((((char *)(&__pyx_v_endian_detector))[0]) != 0);

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":209
 *             cdef bint little_endian = ((<char*>&endian_detector)[0] != 0)
 * 
 *             ndim = PyArray_NDIM(self)             # <<<<<<<<<<<<<<
 * 
 *             if sizeof(npy_intp) != sizeof(Py_ssize_t):
 */
  __pyx_v_ndim = PyArray_NDIM(__pyx_v_self);

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":211
 *             ndim = PyArray_NDIM(self)
 * 
 *             if sizeof(npy_intp) != sizeof(Py_ssize_t):             # <<<<<<<<<<<<<<
 *                 copy_shape = 1
 *             else:
 */
  __pyx_t_1 = (((sizeof(npy_intp)) != (sizeof(Py_ssize_t))) != 0);
  if (__pyx_t_1) {

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":212
 * 
 *             if sizeof(npy_intp) != sizeof(Py_ssize_t):
 *                 copy_shape = 1             # <<<<<<<<<<<<<<
 *             else:
 *                 copy_shape = 0
 */
    __pyx_v_copy_shape = 1;

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":211
 *             ndim = PyArray_NDIM(self)
 * 
 *             if sizeof(npy_intp) != sizeof(Py_ssize_t):             # <<<<<<<<<<<<<<
 *                 copy_shape = 1
 *             else:
 */
    goto __pyx_L4;
  }

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":214
 *                 copy_shape = 1
 *             else:
 *                 copy_shape = 0             # <<<<<<<<<<<<<<
 * 
 *             if ((flags & pybuf.PyBUF_C_CONTIGUOUS == pybuf.PyBUF_C_CONTIGUOUS)
 */
  /*else*/ {
    __pyx_v_copy_shape = 0;
  }
  __pyx_L4:;

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":216
 *                 copy_shape = 0
 * 
 *             if ((flags & pybuf.PyBUF_C_CONTIGUOUS == pybuf.PyBUF_C_CONTIGUOUS)             # <<<<<<<<<<<<<<
 *                 and not PyArray_CHKFLAGS(self, NPY_C_CONTIGUOUS)):
 *                 raise ValueError(u"ndarray is not C contiguous")
 */
  __pyx_t_2 = (((__pyx_v_flags & PyBUF_C_CONTIGUOUS) == PyBUF_C_CONTIGUOUS) != 0);
  if (__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L6_bool_binop_done;
  }

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":217
 * 
 *             if ((flags & pybuf.PyBUF_C_CONTIGUOUS == pybuf.PyBUF_C_CONTIGUOUS)
 *                 and not PyArray_CHKFLAGS(self, NPY_C_CONTIGUOUS)):             # <<<<<<<<<<<<<<
 *                 raise ValueError(u"ndarray is not C contiguous")
 * 
 */
  __pyx_t_2 = ((!(PyArray_CHKFLAGS(__pyx_v_self, NPY_C_CONTIGUOUS) != 0)) != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L6_bool_binop_done:;

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":216
 *                 copy_shape = 0
 * 
 *             if ((flags & pybuf.PyBUF_C_CONTIGUOUS == pybuf.PyBUF_C_CONTIGUOUS)             # <<<<<<<<<<<<<<
 *                 and not PyArray_CHKFLAGS(self, NPY_C_CONTIGUOUS)):
 *                 raise ValueError(u"ndarray is not C contiguous")
 */
  if (__pyx_t_1) {

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":218
 *             if ((flags & pybuf.PyBUF_C_CONTIGUOUS == pybuf.PyBUF_C_CONTIGUOUS)
 *                 and not PyArray_CHKFLAGS(self, NPY_C_CONTIGUOUS)):
 *                 raise ValueError(u"ndarray is not C contiguous")             # <<<<<<<<<<<<<<
 * 
 *             if ((flags & pybuf.PyBUF_F_CONTIGUOUS == pybuf.PyBUF_F_CONTIGUOUS)
 */
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__59, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 218, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __PYX_ERR(1, 218, __pyx_L1_error)

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":216
 *                 copy_shape = 0
 * 
 *             if ((flags & pybuf.PyBUF_C_CONTIGUOUS == pybuf.PyBUF_C_CONTIGUOUS)             # <<<<<<<<<<<<<<
 *                 and not PyArray_CHKFLAGS(self, NPY_C_CONTIGUOUS)):
 *                 raise ValueError(u"ndarray is not C contiguous")
 */
  }

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":220
 *                 raise ValueError(u"ndarray is not C contiguous")
 * 
 *             if ((flags & pybuf.PyBUF_F_CONTIGUOUS == pybuf.PyBUF_F_CONTIGUOUS)             # <<<<<<<<<<<<<<
 *                 and not PyArray_CHKFLAGS(self, NPY_F_CONTIGUOUS)):
 *                 raise ValueError(u"ndarray is not Fortran contiguous")
 */
  __pyx_t_2 = (((__pyx_v_flags & PyBUF_F_CONTIGUOUS) == PyBUF_F_CONTIGUOUS) != 0);
  if (__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L9_bool_binop_done;
  }

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":221
 * 
 *             if ((flags & pybuf.PyBUF_F_CONTIGUOUS == pybuf.PyBUF_F_CONTIGUOUS)
 *                 and not PyArray_CHKFLAGS(self, NPY_F_CONTIGUOUS)):             # <<<<<<<<<<<<<<
 *                 raise ValueError(u"ndarray is not Fortran contiguous")
 * 
 */
  __pyx_t_2 = ((!(PyArray_CHKFLAGS(__pyx_v_self, NPY_F_CONTIGUOUS) != 0)) != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L9_bool_binop_done:;

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":220
 *                 raise ValueError(u"ndarray is not C contiguous")
 * 
 *             if ((flags & pybuf.PyBUF_F_CONTIGUOUS == pybuf.PyBUF_F_CONTIGUOUS)             # <<<<<<<<<<<<<<
 *                 and not PyArray_CHKFLAGS(self, NPY_F_CONTIGUOUS)):
 *                 raise ValueError(u"ndarray is not Fortran contiguous")
 */
  if (__pyx_t_1) {

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":222
 *             if ((flags & pybuf.PyBUF_F_CONTIGUOUS == pybuf.PyBUF_F_CONTIGUOUS)
 *                 and not PyArray_CHKFLAGS(self, NPY_F_CONTIGUOUS)):
 *                 raise ValueError(u"ndarray is not Fortran contiguous")             # <<<<<<<<<<<<<<
 * 
 *             info.buf = PyArray_DATA(self)
 */
    __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__60, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 222, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_Raise(__pyx_t_3, 0, 0, 0);
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __PYX_ERR(1, 222, __pyx_L1_error)

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":220
 *                 raise ValueError(u"ndarray is not C contiguous")
 * 
 *             if ((flags & pybuf.PyBUF_F_CONTIGUOUS == pybuf.PyBUF_F_CONTIGUOUS)             # <<<<<<<<<<<<<<
 *                 and not PyArray_CHKFLAGS(self, NPY_F_CONTIGUOUS)):
 *                 raise ValueError(u"ndarray is not Fortran contiguous")
 */
  }

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":224
 *                 raise ValueError(u"ndarray is not Fortran contiguous")
 * 
 *             info.buf = PyArray_DATA(self)             # <<<<<<<<<<<<<<
 *             info.ndim = ndim
 *             if copy_shape:
 */
  __pyx_v_info->buf = PyArray_DATA(__pyx_v_self);

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":225
 * 
 *             info.buf = PyArray_DATA(self)
 *             info.ndim = ndim             # <<<<<<<<<<<<<<
 *             if copy_shape:
 *                 # Allocate new buffer for strides and shape info.
 */
  __pyx_v_info->ndim = __pyx_v_ndim;

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":226
 *             info.buf = PyArray_DATA(self)
 *             info.ndim = ndim
 *             if copy_shape:             # <<<<<<<<<<<<<<
 *                 # Allocate new buffer for strides and shape info.
 *                 # This is allocated as one block, strides first.
 */
  __pyx_t_1 = (__pyx_v_copy_shape != 0);
  if (__pyx_t_1) {

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":229
 *                 # Allocate new buffer for strides and shape info.
 *                 # This is allocated as one block, strides first.
 *                 info.strides = <Py_ssize_t*>stdlib.malloc(sizeof(Py_ssize_t) * <size_t>ndim * 2)             # <<<<<<<<<<<<<<
 *                 info.shape = info.strides + ndim
 *                 for i in range(ndim):
 */
    __pyx_v_info->strides = ((Py_ssize_t *)malloc((((sizeof(Py_ssize_t)) * ((size_t)__pyx_v_ndim)) * 2)));

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":230
 *                 # This is allocated as one block, strides first.
 *                 info.strides = <Py_ssize_t*>stdlib.malloc(sizeof(Py_ssize_t) * <size_t>ndim * 2)
 *                 info.shape = info.strides + ndim             # <<<<<<<<<<<<<<
 *                 for i in range(ndim):
 *                     info.strides[i] = PyArray_STRIDES(self)[i]
 */
    __pyx_v_info->shape = (__pyx_v_info->strides + __pyx_v_ndim);

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":231
 *                 info.strides = <Py_ssize_t*>stdlib.malloc(sizeof(Py_ssize_t) * <size_t>ndim * 2)
 *                 info.shape = info.strides + ndim
 *                 for i in range(ndim):             # <<<<<<<<<<<<<<
 *                     info.strides[i] = PyArray_STRIDES(self)[i]
 *                     info.shape[i] = PyArray_DIMS(self)[i]
 */
    __pyx_t_4 = __pyx_v_ndim;
    for (__pyx_t_5 = 0; __pyx_t_5 < __pyx_t_4; __pyx_t_5+=1) {
      __pyx_v_i = __pyx_t_5;

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":232
 *                 info.shape = info.strides + ndim
 *                 for i in range(ndim):
 *                     info.strides[i] = PyArray_STRIDES(self)[i]             # <<<<<<<<<<<<<<
 *                     info.shape[i] = PyArray_DIMS(self)[i]
 *             else:
 */
      (__pyx_v_info->strides[__pyx_v_i]) = (PyArray_STRIDES(__pyx_v_self)[__pyx_v_i]);

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":233
 *                 for i in range(ndim):
 *                     info.strides[i] = PyArray_STRIDES(self)[i]
 *                     info.shape[i] = PyArray_DIMS(self)[i]             # <<<<<<<<<<<<<<
 *             else:
 *                 info.strides = <Py_ssize_t*>PyArray_STRIDES(self)
 */
      (__pyx_v_info->shape[__pyx_v_i]) = (PyArray_DIMS(__pyx_v_self)[__pyx_v_i]);
    }

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":226
 *             info.buf = PyArray_DATA(self)
 *             info.ndim = ndim
 *             if copy_shape:             # <<<<<<<<<<<<<<
 *                 # Allocate new buffer for strides and shape info.
 *                 # This is allocated as one block, strides first.
 */
    goto __pyx_L11;
  }

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":235
 *                     info.shape[i] = PyArray_DIMS(self)[i]
 *             else:
 *                 info.strides = <Py_ssize_t*>PyArray_STRIDES(self)             # <<<<<<<<<<<<<<
 *                 info.shape = <Py_ssize_t*>PyArray_DIMS(self)
 *             info.suboffsets = NULL
 */
  /*else*/ {
    __pyx_v_info->strides = ((Py_ssize_t *)PyArray_STRIDES(__pyx_v_self));

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":236
 *             else:
 *                 info.strides = <Py_ssize_t*>PyArray_STRIDES(self)
 *                 info.shape = <Py_ssize_t*>PyArray_DIMS(self)             # <<<<<<<<<<<<<<
 *             info.suboffsets = NULL
 *             info.itemsize = PyArray_ITEMSIZE(self)
 */
    __pyx_v_info->shape = ((Py_ssize_t *)PyArray_DIMS(__pyx_v_self));
  }
  __pyx_L11:;

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":237
 *                 info.strides = <Py_ssize_t*>PyArray_STRIDES(self)
 *                 info.shape = <Py_ssize_t*>PyArray_DIMS(self)
 *             info.suboffsets = NULL             # <<<<<<<<<<<<<<
 *             info.itemsize = PyArray_ITEMSIZE(self)
 *             info.readonly = not PyArray_ISWRITEABLE(self)
 */
  __pyx_v_info->suboffsets = NULL;

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":238
 *                 info.shape = <Py_ssize_t*>PyArray_DIMS(self)
 *             info.suboffsets = NULL
 *             info.itemsize = PyArray_ITEMSIZE(self)             # <<<<<<<<<<<<<<
 *             info.readonly = not PyArray_ISWRITEABLE(self)
 * 
 */
  __pyx_v_info->itemsize = PyArray_ITEMSIZE(__pyx_v_self);

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":239
 *             info.suboffsets = NULL
 *             info.itemsize = PyArray_ITEMSIZE(self)
 *             info.readonly = not PyArray_ISWRITEABLE(self)             # <<<<<<<<<<<<<<
 * 
 *             cdef int t
 */
  __pyx_v_info->readonly = (!(PyArray_ISWRITEABLE(__pyx_v_self) != 0));

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":242
 * 
 *             cdef int t
 *             cdef char* f = NULL             # <<<<<<<<<<<<<<
 *             cdef dtype descr = self.descr
 *             cdef int offset
 */
  __pyx_v_f = NULL;

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":243
 *             cdef int t
 *             cdef char* f = NULL
 *             cdef dtype descr = self.descr             # <<<<<<<<<<<<<<
 *             cdef int offset
 * 
 */
  __pyx_t_3 = ((PyObject *)__pyx_v_self->descr);
  __Pyx_INCREF(__pyx_t_3);
  __pyx_v_descr = ((PyArray_Descr *)__pyx_t_3);
  __pyx_t_3 = 0;

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":246
 *             cdef int offset
 * 
 *             cdef bint hasfields = PyDataType_HASFIELDS(descr)             # <<<<<<<<<<<<<<
 * 
 *             if not hasfields and not copy_shape:
 */
  __pyx_v_hasfields = PyDataType_HASFIELDS(__pyx_v_descr);

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":248
 *             cdef bint hasfields = PyDataType_HASFIELDS(descr)
 * 
 *             if not hasfields and not copy_shape:             # <<<<<<<<<<<<<<
 *                 # do not call releasebuffer
 *                 info.obj = None
 */
  __pyx_t_2 = ((!(__pyx_v_hasfields != 0)) != 0);
  if (__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L15_bool_binop_done;
  }
  __pyx_t_2 = ((!(__pyx_v_copy_shape != 0)) != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L15_bool_binop_done:;
  if (__pyx_t_1) {

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":250
 *             if not hasfields and not copy_shape:
 *                 # do not call releasebuffer
 *                 info.obj = None             # <<<<<<<<<<<<<<
 *             else:
 *                 # need to call releasebuffer
 */
    __Pyx_INCREF(Py_None);
    __Pyx_GIVEREF(Py_None);
    __Pyx_GOTREF(__pyx_v_info->obj);
    __Pyx_DECREF(__pyx_v_info->obj);
    __pyx_v_info->obj = Py_None;

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":248
 *             cdef bint hasfields = PyDataType_HASFIELDS(descr)
 * 
 *             if not hasfields and not copy_shape:             # <<<<<<<<<<<<<<
 *                 # do not call releasebuffer
 *                 info.obj = None
 */
    goto __pyx_L14;
  }

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":253
 *             else:
 *                 # need to call releasebuffer
 *                 info.obj = self             # <<<<<<<<<<<<<<
 * 
 *             if not hasfields:
 */
  /*else*/ {
    __Pyx_INCREF(((PyObject *)__pyx_v_self));
    __Pyx_GIVEREF(((PyObject *)__pyx_v_self));
    __Pyx_GOTREF(__pyx_v_info->obj);
    __Pyx_DECREF(__pyx_v_info->obj);
    __pyx_v_info->obj = ((PyObject *)__pyx_v_self);
  }
  __pyx_L14:;

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":255
 *                 info.obj = self
 * 
 *             if not hasfields:             # <<<<<<<<<<<<<<
 *                 t = descr.type_num
 *                 if ((descr.byteorder == c'>' and little_endian) or
 */
  __pyx_t_1 = ((!(__pyx_v_hasfields != 0)) != 0);
  if (__pyx_t_1) {

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":256
 * 
 *             if not hasfields:
 *                 t = descr.type_num             # <<<<<<<<<<<<<<
 *                 if ((descr.byteorder == c'>' and little_endian) or
 *                     (descr.byteorder == c'<' and not little_endian)):
 */
    __pyx_t_4 = __pyx_v_descr->type_num;
    __pyx_v_t = __pyx_t_4;

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":257
 *             if not hasfields:
 *                 t = descr.type_num
 *                 if ((descr.byteorder == c'>' and little_endian) or             # <<<<<<<<<<<<<<
 *                     (descr.byteorder == c'<' and not little_endian)):
 *                     raise ValueError(u"Non-native byte order not supported")
 */
    __pyx_t_2 = ((__pyx_v_descr->byteorder == '>') != 0);
    if (!__pyx_t_2) {
      goto __pyx_L20_next_or;
    } else {
    }
    __pyx_t_2 = (__pyx_v_little_endian != 0);
    if (!__pyx_t_2) {
    } else {
      __pyx_t_1 = __pyx_t_2;
      goto __pyx_L19_bool_binop_done;
    }
    __pyx_L20_next_or:;

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":258
 *                 t = descr.type_num
 *                 if ((descr.byteorder == c'>' and little_endian) or
 *                     (descr.byteorder == c'<' and not little_endian)):             # <<<<<<<<<<<<<<
 *                     raise ValueError(u"Non-native byte order not supported")
 *                 if   t == NPY_BYTE:        f = "b"
 */
    __pyx_t_2 = ((__pyx_v_descr->byteorder == '<') != 0);
    if (__pyx_t_2) {
    } else {
      __pyx_t_1 = __pyx_t_2;
      goto __pyx_L19_bool_binop_done;
    }
    __pyx_t_2 = ((!(__pyx_v_little_endian != 0)) != 0);
    __pyx_t_1 = __pyx_t_2;
    __pyx_L19_bool_binop_done:;

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":257
 *             if not hasfields:
 *                 t = descr.type_num
 *                 if ((descr.byteorder == c'>' and little_endian) or             # <<<<<<<<<<<<<<
 *                     (descr.byteorder == c'<' and not little_endian)):
 *                     raise ValueError(u"Non-native byte order not supported")
 */
    if (__pyx_t_1) {

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":259
 *                 if ((descr.byteorder == c'>' and little_endian) or
 *                     (descr.byteorder == c'<' and not little_endian)):
 *                     raise ValueError(u"Non-native byte order not supported")             # <<<<<<<<<<<<<<
 *                 if   t == NPY_BYTE:        f = "b"
 *                 elif t == NPY_UBYTE:       f = "B"
 */
      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__61, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 259, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_Raise(__pyx_t_3, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __PYX_ERR(1, 259, __pyx_L1_error)

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":257
 *             if not hasfields:
 *                 t = descr.type_num
 *                 if ((descr.byteorder == c'>' and little_endian) or             # <<<<<<<<<<<<<<
 *                     (descr.byteorder == c'<' and not little_endian)):
 *                     raise ValueError(u"Non-native byte order not supported")
 */
    }

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":260
 *                     (descr.byteorder == c'<' and not little_endian)):
 *                     raise ValueError(u"Non-native byte order not supported")
 *                 if   t == NPY_BYTE:        f = "b"             # <<<<<<<<<<<<<<
 *                 elif t == NPY_UBYTE:       f = "B"
 *                 elif t == NPY_SHORT:       f = "h"
 */
    switch (__pyx_v_t) {
      case NPY_BYTE:
      __pyx_v_f = ((char *)"b");
      break;

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":261
 *                     raise ValueError(u"Non-native byte order not supported")
 *                 if   t == NPY_BYTE:        f = "b"
 *                 elif t == NPY_UBYTE:       f = "B"             # <<<<<<<<<<<<<<
 *                 elif t == NPY_SHORT:       f = "h"
 *                 elif t == NPY_USHORT:      f = "H"
 */
      case NPY_UBYTE:
      __pyx_v_f = ((char *)"B");
      break;

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":262
 *                 if   t == NPY_BYTE:        f = "b"
 *                 elif t == NPY_UBYTE:       f = "B"
 *                 elif t == NPY_SHORT:       f = "h"             # <<<<<<<<<<<<<<
 *                 elif t == NPY_USHORT:      f = "H"
 *                 elif t == NPY_INT:         f = "i"
 */
      case NPY_SHORT:
      __pyx_v_f = ((char *)"h");
      break;

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":263
 *                 elif t == NPY_UBYTE:       f = "B"
 *                 elif t == NPY_SHORT:       f = "h"
 *                 elif t == NPY_USHORT:      f = "H"             # <<<<<<<<<<<<<<
 *                 elif t == NPY_INT:         f = "i"
 *                 elif t == NPY_UINT:        f = "I"
 */
      case NPY_USHORT:
      __pyx_v_f = ((char *)"H");
      break;

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":264
 *                 elif t == NPY_SHORT:       f = "h"
 *                 elif t == NPY_USHORT:      f = "H"
 *                 elif t == NPY_INT:         f = "i"             # <<<<<<<<<<<<<<
 *                 elif t == NPY_UINT:        f = "I"
 *                 elif t == NPY_LONG:        f = "l"
 */
      case NPY_INT:
      __pyx_v_f = ((char *)"i");
      break;

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":265
 *                 elif t == NPY_USHORT:      f = "H"
 *                 elif t == NPY_INT:         f = "i"
 *                 elif t == NPY_UINT:        f = "I"             # <<<<<<<<<<<<<<
 *                 elif t == NPY_LONG:        f = "l"
 *                 elif t == NPY_ULONG:       f = "L"
 */
      case NPY_UINT:
      __pyx_v_f = ((char *)"I");
      break;

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":266
 *                 elif t == NPY_INT:         f = "i"
 *                 elif t == NPY_UINT:        f = "I"
 *                 elif t == NPY_LONG:        f = "l"             # <<<<<<<<<<<<<<
 *                 elif t == NPY_ULONG:       f = "L"
 *                 elif t == NPY_LONGLONG:    f = "q"
 */
      case NPY_LONG:
      __pyx_v_f = ((char *)"l");
      break;

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":267
 *                 elif t == NPY_UINT:        f = "I"
 *                 elif t == NPY_LONG:        f = "l"
 *                 elif t == NPY_ULONG:       f = "L"             # <<<<<<<<<<<<<<
 *                 elif t == NPY_LONGLONG:    f = "q"
 *                 elif t == NPY_ULONGLONG:   f = "Q"
 */
      case NPY_ULONG:
      __pyx_v_f = ((char *)"L");
      break;

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":268
 *                 elif t == NPY_LONG:        f = "l"
 *                 elif t == NPY_ULONG:       f = "L"
 *                 elif t == NPY_LONGLONG:    f = "q"             # <<<<<<<<<<<<<<
 *                 elif t == NPY_ULONGLONG:   f = "Q"
 *                 elif t == NPY_FLOAT:       f = "f"
 */
      case NPY_LONGLONG:
      __pyx_v_f = ((char *)"q");
      break;

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":269
 *                 elif t == NPY_ULONG:       f = "L"
 *                 elif t == NPY_LONGLONG:    f = "q"
 *                 elif t == NPY_ULONGLONG:   f = "Q"             # <<<<<<<<<<<<<<
 *                 elif t == NPY_FLOAT:       f = "f"
 *                 elif t == NPY_DOUBLE:      f = "d"
 */
      case NPY_ULONGLONG:
      __pyx_v_f = ((char *)"Q");
      break;

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":270
 *                 elif t == NPY_LONGLONG:    f = "q"
 *                 elif t == NPY_ULONGLONG:   f = "Q"
 *                 elif t == NPY_FLOAT:       f = "f"             # <<<<<<<<<<<<<<
 *                 elif t == NPY_DOUBLE:      f = "d"
 *                 elif t == NPY_LONGDOUBLE:  f = "g"
 */
      case NPY_FLOAT:
      __pyx_v_f = ((char *)"f");
      break;

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":271
 *                 elif t == NPY_ULONGLONG:   f = "Q"
 *                 elif t == NPY_FLOAT:       f = "f"
 *                 elif t == NPY_DOUBLE:      f = "d"             # <<<<<<<<<<<<<<
 *                 elif t == NPY_LONGDOUBLE:  f = "g"
 *                 elif t == NPY_CFLOAT:      f = "Zf"
 */
      case NPY_DOUBLE:
      __pyx_v_f = ((char *)"d");
      break;

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":272
 *                 elif t == NPY_FLOAT:       f = "f"
 *                 elif t == NPY_DOUBLE:      f = "d"
 *                 elif t == NPY_LONGDOUBLE:  f = "g"             # <<<<<<<<<<<<<<
 *                 elif t == NPY_CFLOAT:      f = "Zf"
 *                 elif t == NPY_CDOUBLE:     f = "Zd"
 */
      case NPY_LONGDOUBLE:
      __pyx_v_f = ((char *)"g");
      break;

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":273
 *                 elif t == NPY_DOUBLE:      f = "d"
 *                 elif t == NPY_LONGDOUBLE:  f = "g"
 *                 elif t == NPY_CFLOAT:      f = "Zf"             # <<<<<<<<<<<<<<
 *                 elif t == NPY_CDOUBLE:     f = "Zd"
 *                 elif t == NPY_CLONGDOUBLE: f = "Zg"
 */
      case NPY_CFLOAT:
      __pyx_v_f = ((char *)"Zf");
      break;

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":274
 *                 elif t == NPY_LONGDOUBLE:  f = "g"
 *                 elif t == NPY_CFLOAT:      f = "Zf"
 *                 elif t == NPY_CDOUBLE:     f = "Zd"             # <<<<<<<<<<<<<<
 *                 elif t == NPY_CLONGDOUBLE: f = "Zg"
 *                 elif t == NPY_OBJECT:      f = "O"
 */
      case NPY_CDOUBLE:
      __pyx_v_f = ((char *)"Zd");
      break;

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":275
 *                 elif t == NPY_CFLOAT:      f = "Zf"
 *                 elif t == NPY_CDOUBLE:     f = "Zd"
 *                 elif t == NPY_CLONGDOUBLE: f = "Zg"             # <<<<<<<<<<<<<<
 *                 elif t == NPY_OBJECT:      f = "O"
 *                 else:
 */
      case NPY_CLONGDOUBLE:
      __pyx_v_f = ((char *)"Zg");
      break;

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":276
 *                 elif t == NPY_CDOUBLE:     f = "Zd"
 *                 elif t == NPY_CLONGDOUBLE: f = "Zg"
 *                 elif t == NPY_OBJECT:      f = "O"             # <<<<<<<<<<<<<<
 *                 else:
 *                     raise ValueError(u"unknown dtype code in numpy.pxd (%d)" % t)
 */
      case NPY_OBJECT:
      __pyx_v_f = ((char *)"O");
      break;
      default:

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":278
 *                 elif t == NPY_OBJECT:      f = "O"
 *                 else:
 *                     raise ValueError(u"unknown dtype code in numpy.pxd (%d)" % t)             # <<<<<<<<<<<<<<
 *                 info.format = f
 *                 return
 */
      __pyx_t_3 = __Pyx_PyInt_From_int(__pyx_v_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 278, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_6 = PyUnicode_Format(__pyx_kp_u_unknown_dtype_code_in_numpy_pxd, __pyx_t_3); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 278, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 278, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_GIVEREF(__pyx_t_6);
      PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_6 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_t_3, NULL); if (unlikely(!__pyx_t_6)) __PYX_ERR(1, 278, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_6);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __Pyx_Raise(__pyx_t_6, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_6); __pyx_t_6 = 0;
      __PYX_ERR(1, 278, __pyx_L1_error)
      break;
    }

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":279
 *                 else:
 *                     raise ValueError(u"unknown dtype code in numpy.pxd (%d)" % t)
 *                 info.format = f             # <<<<<<<<<<<<<<
 *                 return
 *             else:
 */
    __pyx_v_info->format = __pyx_v_f;

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":280
 *                     raise ValueError(u"unknown dtype code in numpy.pxd (%d)" % t)
 *                 info.format = f
 *                 return             # <<<<<<<<<<<<<<
 *             else:
 *                 info.format = <char*>stdlib.malloc(_buffer_format_string_len)
 */
    __pyx_r = 0;
    goto __pyx_L0;

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":255
 *                 info.obj = self
 * 
 *             if not hasfields:             # <<<<<<<<<<<<<<
 *                 t = descr.type_num
 *                 if ((descr.byteorder == c'>' and little_endian) or
 */
  }

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":282
 *                 return
 *             else:
 *                 info.format = <char*>stdlib.malloc(_buffer_format_string_len)             # <<<<<<<<<<<<<<
 *                 info.format[0] = c'^' # Native data types, manual alignment
 *                 offset = 0
 */
  /*else*/ {
    __pyx_v_info->format = ((char *)malloc(0xFF));

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":283
 *             else:
 *                 info.format = <char*>stdlib.malloc(_buffer_format_string_len)
 *                 info.format[0] = c'^' # Native data types, manual alignment             # <<<<<<<<<<<<<<
 *                 offset = 0
 *                 f = _util_dtypestring(descr, info.format + 1,
 */
    (__pyx_v_info->format[0]) = '^';

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":284
 *                 info.format = <char*>stdlib.malloc(_buffer_format_string_len)
 *                 info.format[0] = c'^' # Native data types, manual alignment
 *                 offset = 0             # <<<<<<<<<<<<<<
 *                 f = _util_dtypestring(descr, info.format + 1,
 *                                       info.format + _buffer_format_string_len,
 */
    __pyx_v_offset = 0;

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":285
 *                 info.format[0] = c'^' # Native data types, manual alignment
 *                 offset = 0
 *                 f = _util_dtypestring(descr, info.format + 1,             # <<<<<<<<<<<<<<
 *                                       info.format + _buffer_format_string_len,
 *                                       &offset)
 */
    __pyx_t_7 = __pyx_f_5numpy__util_dtypestring(__pyx_v_descr, (__pyx_v_info->format + 1), (__pyx_v_info->format + 0xFF), (&__pyx_v_offset)); if (unlikely(__pyx_t_7 == NULL)) __PYX_ERR(1, 285, __pyx_L1_error)
    __pyx_v_f = __pyx_t_7;

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":288
 *                                       info.format + _buffer_format_string_len,
 *                                       &offset)
 *                 f[0] = c'\0' # Terminate format string             # <<<<<<<<<<<<<<
 * 
 *         def __releasebuffer__(ndarray self, Py_buffer* info):
 */
    (__pyx_v_f[0]) = '\x00';
  }

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":197
 *         # experimental exception made for __getbuffer__ and __releasebuffer__
 *         # -- the details of this may change.
 *         def __getbuffer__(ndarray self, Py_buffer* info, int flags):             # <<<<<<<<<<<<<<
 *             # This implementation of getbuffer is geared towards Cython
 *             # requirements, and does not yet fullfill the PEP.
 */

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_6);
  __Pyx_AddTraceback("numpy.ndarray.__getbuffer__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  if (__pyx_v_info != NULL && __pyx_v_info->obj != NULL) {
    __Pyx_GOTREF(__pyx_v_info->obj);
    __Pyx_DECREF(__pyx_v_info->obj); __pyx_v_info->obj = NULL;
  }
  goto __pyx_L2;
  __pyx_L0:;
  if (__pyx_v_info != NULL && __pyx_v_info->obj == Py_None) {
    __Pyx_GOTREF(Py_None);
    __Pyx_DECREF(Py_None); __pyx_v_info->obj = NULL;
  }
  __pyx_L2:;
  __Pyx_XDECREF((PyObject *)__pyx_v_descr);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":290
 *                 f[0] = c'\0' # Terminate format string
 * 
 *         def __releasebuffer__(ndarray self, Py_buffer* info):             # <<<<<<<<<<<<<<
 *             if PyArray_HASFIELDS(self):
 *                 stdlib.free(info.format)
 */

/* Python wrapper */
static CYTHON_UNUSED void __pyx_pw_5numpy_7ndarray_3__releasebuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_info); /*proto*/
static CYTHON_UNUSED void __pyx_pw_5numpy_7ndarray_3__releasebuffer__(PyObject *__pyx_v_self, Py_buffer *__pyx_v_info) {
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__releasebuffer__ (wrapper)", 0);
  __pyx_pf_5numpy_7ndarray_2__releasebuffer__(((PyArrayObject *)__pyx_v_self), ((Py_buffer *)__pyx_v_info));

  /* function exit code */
  __Pyx_RefNannyFinishContext();
}

static void __pyx_pf_5numpy_7ndarray_2__releasebuffer__(PyArrayObject *__pyx_v_self, Py_buffer *__pyx_v_info) {
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  __Pyx_RefNannySetupContext("__releasebuffer__", 0);

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":291
 * 
 *         def __releasebuffer__(ndarray self, Py_buffer* info):
 *             if PyArray_HASFIELDS(self):             # <<<<<<<<<<<<<<
 *                 stdlib.free(info.format)
 *             if sizeof(npy_intp) != sizeof(Py_ssize_t):
 */
  __pyx_t_1 = (PyArray_HASFIELDS(__pyx_v_self) != 0);
  if (__pyx_t_1) {

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":292
 *         def __releasebuffer__(ndarray self, Py_buffer* info):
 *             if PyArray_HASFIELDS(self):
 *                 stdlib.free(info.format)             # <<<<<<<<<<<<<<
 *             if sizeof(npy_intp) != sizeof(Py_ssize_t):
 *                 stdlib.free(info.strides)
 */
    free(__pyx_v_info->format);

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":291
 * 
 *         def __releasebuffer__(ndarray self, Py_buffer* info):
 *             if PyArray_HASFIELDS(self):             # <<<<<<<<<<<<<<
 *                 stdlib.free(info.format)
 *             if sizeof(npy_intp) != sizeof(Py_ssize_t):
 */
  }

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":293
 *             if PyArray_HASFIELDS(self):
 *                 stdlib.free(info.format)
 *             if sizeof(npy_intp) != sizeof(Py_ssize_t):             # <<<<<<<<<<<<<<
 *                 stdlib.free(info.strides)
 *                 # info.shape was stored after info.strides in the same block
 */
  __pyx_t_1 = (((sizeof(npy_intp)) != (sizeof(Py_ssize_t))) != 0);
  if (__pyx_t_1) {

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":294
 *                 stdlib.free(info.format)
 *             if sizeof(npy_intp) != sizeof(Py_ssize_t):
 *                 stdlib.free(info.strides)             # <<<<<<<<<<<<<<
 *                 # info.shape was stored after info.strides in the same block
 * 
 */
    free(__pyx_v_info->strides);

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":293
 *             if PyArray_HASFIELDS(self):
 *                 stdlib.free(info.format)
 *             if sizeof(npy_intp) != sizeof(Py_ssize_t):             # <<<<<<<<<<<<<<
 *                 stdlib.free(info.strides)
 *                 # info.shape was stored after info.strides in the same block
 */
  }

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":290
 *                 f[0] = c'\0' # Terminate format string
 * 
 *         def __releasebuffer__(ndarray self, Py_buffer* info):             # <<<<<<<<<<<<<<
 *             if PyArray_HASFIELDS(self):
 *                 stdlib.free(info.format)
 */

  /* function exit code */
  __Pyx_RefNannyFinishContext();
}

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":770
 * ctypedef npy_cdouble     complex_t
 * 
 * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
 *     return PyArray_MultiIterNew(1, <void*>a)
 * 
 */

static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew1(PyObject *__pyx_v_a) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("PyArray_MultiIterNew1", 0);

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":771
 * 
 * cdef inline object PyArray_MultiIterNew1(a):
 *     return PyArray_MultiIterNew(1, <void*>a)             # <<<<<<<<<<<<<<
 * 
 * cdef inline object PyArray_MultiIterNew2(a, b):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyArray_MultiIterNew(1, ((void *)__pyx_v_a)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 771, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":770
 * ctypedef npy_cdouble     complex_t
 * 
 * cdef inline object PyArray_MultiIterNew1(a):             # <<<<<<<<<<<<<<
 *     return PyArray_MultiIterNew(1, <void*>a)
 * 
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("numpy.PyArray_MultiIterNew1", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":773
 *     return PyArray_MultiIterNew(1, <void*>a)
 * 
 * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
 *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
 * 
 */

static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew2(PyObject *__pyx_v_a, PyObject *__pyx_v_b) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("PyArray_MultiIterNew2", 0);

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":774
 * 
 * cdef inline object PyArray_MultiIterNew2(a, b):
 *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)             # <<<<<<<<<<<<<<
 * 
 * cdef inline object PyArray_MultiIterNew3(a, b, c):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyArray_MultiIterNew(2, ((void *)__pyx_v_a), ((void *)__pyx_v_b)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 774, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":773
 *     return PyArray_MultiIterNew(1, <void*>a)
 * 
 * cdef inline object PyArray_MultiIterNew2(a, b):             # <<<<<<<<<<<<<<
 *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
 * 
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("numpy.PyArray_MultiIterNew2", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":776
 *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
 * 
 * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
 *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
 * 
 */

static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew3(PyObject *__pyx_v_a, PyObject *__pyx_v_b, PyObject *__pyx_v_c) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("PyArray_MultiIterNew3", 0);

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":777
 * 
 * cdef inline object PyArray_MultiIterNew3(a, b, c):
 *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)             # <<<<<<<<<<<<<<
 * 
 * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyArray_MultiIterNew(3, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 777, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":776
 *     return PyArray_MultiIterNew(2, <void*>a, <void*>b)
 * 
 * cdef inline object PyArray_MultiIterNew3(a, b, c):             # <<<<<<<<<<<<<<
 *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
 * 
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("numpy.PyArray_MultiIterNew3", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":779
 *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
 * 
 * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
 *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
 * 
 */

static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew4(PyObject *__pyx_v_a, PyObject *__pyx_v_b, PyObject *__pyx_v_c, PyObject *__pyx_v_d) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("PyArray_MultiIterNew4", 0);

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":780
 * 
 * cdef inline object PyArray_MultiIterNew4(a, b, c, d):
 *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)             # <<<<<<<<<<<<<<
 * 
 * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyArray_MultiIterNew(4, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 780, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":779
 *     return PyArray_MultiIterNew(3, <void*>a, <void*>b, <void*> c)
 * 
 * cdef inline object PyArray_MultiIterNew4(a, b, c, d):             # <<<<<<<<<<<<<<
 *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
 * 
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("numpy.PyArray_MultiIterNew4", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":782
 *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
 * 
 * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
 *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
 * 
 */

static CYTHON_INLINE PyObject *__pyx_f_5numpy_PyArray_MultiIterNew5(PyObject *__pyx_v_a, PyObject *__pyx_v_b, PyObject *__pyx_v_c, PyObject *__pyx_v_d, PyObject *__pyx_v_e) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  __Pyx_RefNannySetupContext("PyArray_MultiIterNew5", 0);

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":783
 * 
 * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):
 *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)             # <<<<<<<<<<<<<<
 * 
 * cdef inline char* _util_dtypestring(dtype descr, char* f, char* end, int* offset) except NULL:
 */
  __Pyx_XDECREF(__pyx_r);
  __pyx_t_1 = PyArray_MultiIterNew(5, ((void *)__pyx_v_a), ((void *)__pyx_v_b), ((void *)__pyx_v_c), ((void *)__pyx_v_d), ((void *)__pyx_v_e)); if (unlikely(!__pyx_t_1)) __PYX_ERR(1, 783, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":782
 *     return PyArray_MultiIterNew(4, <void*>a, <void*>b, <void*>c, <void*> d)
 * 
 * cdef inline object PyArray_MultiIterNew5(a, b, c, d, e):             # <<<<<<<<<<<<<<
 *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
 * 
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_AddTraceback("numpy.PyArray_MultiIterNew5", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":785
 *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
 * 
 * cdef inline char* _util_dtypestring(dtype descr, char* f, char* end, int* offset) except NULL:             # <<<<<<<<<<<<<<
 *     # Recursive utility function used in __getbuffer__ to get format
 *     # string. The new location in the format string is returned.
 */

static CYTHON_INLINE char *__pyx_f_5numpy__util_dtypestring(PyArray_Descr *__pyx_v_descr, char *__pyx_v_f, char *__pyx_v_end, int *__pyx_v_offset) {
  PyArray_Descr *__pyx_v_child = 0;
  int __pyx_v_endian_detector;
  int __pyx_v_little_endian;
  PyObject *__pyx_v_fields = 0;
  PyObject *__pyx_v_childname = NULL;
  PyObject *__pyx_v_new_offset = NULL;
  PyObject *__pyx_v_t = NULL;
  char *__pyx_r;
  __Pyx_RefNannyDeclarations
  PyObject *__pyx_t_1 = NULL;
  Py_ssize_t __pyx_t_2;
  PyObject *__pyx_t_3 = NULL;
  PyObject *__pyx_t_4 = NULL;
  int __pyx_t_5;
  int __pyx_t_6;
  int __pyx_t_7;
  long __pyx_t_8;
  char *__pyx_t_9;
  __Pyx_RefNannySetupContext("_util_dtypestring", 0);

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":790
 * 
 *     cdef dtype child
 *     cdef int endian_detector = 1             # <<<<<<<<<<<<<<
 *     cdef bint little_endian = ((<char*>&endian_detector)[0] != 0)
 *     cdef tuple fields
 */
  __pyx_v_endian_detector = 1;

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":791
 *     cdef dtype child
 *     cdef int endian_detector = 1
 *     cdef bint little_endian = ((<char*>&endian_detector)[0] != 0)             # <<<<<<<<<<<<<<
 *     cdef tuple fields
 * 
 */
  __pyx_v_little_endian = ((((char *)(&__pyx_v_endian_detector))[0]) != 0);

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":794
 *     cdef tuple fields
 * 
 *     for childname in descr.names:             # <<<<<<<<<<<<<<
 *         fields = descr.fields[childname]
 *         child, new_offset = fields
 */
  if (unlikely(__pyx_v_descr->names == Py_None)) {
    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
    __PYX_ERR(1, 794, __pyx_L1_error)
  }
  __pyx_t_1 = __pyx_v_descr->names; __Pyx_INCREF(__pyx_t_1); __pyx_t_2 = 0;
  for (;;) {
    if (__pyx_t_2 >= PyTuple_GET_SIZE(__pyx_t_1)) break;
    #if CYTHON_COMPILING_IN_CPYTHON
    __pyx_t_3 = PyTuple_GET_ITEM(__pyx_t_1, __pyx_t_2); __Pyx_INCREF(__pyx_t_3); __pyx_t_2++; if (unlikely(0 < 0)) __PYX_ERR(1, 794, __pyx_L1_error)
    #else
    __pyx_t_3 = PySequence_ITEM(__pyx_t_1, __pyx_t_2); __pyx_t_2++; if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 794, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    #endif
    __Pyx_XDECREF_SET(__pyx_v_childname, __pyx_t_3);
    __pyx_t_3 = 0;

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":795
 * 
 *     for childname in descr.names:
 *         fields = descr.fields[childname]             # <<<<<<<<<<<<<<
 *         child, new_offset = fields
 * 
 */
    if (unlikely(__pyx_v_descr->fields == Py_None)) {
      PyErr_SetString(PyExc_TypeError, "'NoneType' object is not subscriptable");
      __PYX_ERR(1, 795, __pyx_L1_error)
    }
    __pyx_t_3 = __Pyx_PyDict_GetItem(__pyx_v_descr->fields, __pyx_v_childname); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 795, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    if (!(likely(PyTuple_CheckExact(__pyx_t_3))||((__pyx_t_3) == Py_None)||(PyErr_Format(PyExc_TypeError, "Expected %.16s, got %.200s", "tuple", Py_TYPE(__pyx_t_3)->tp_name), 0))) __PYX_ERR(1, 795, __pyx_L1_error)
    __Pyx_XDECREF_SET(__pyx_v_fields, ((PyObject*)__pyx_t_3));
    __pyx_t_3 = 0;

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":796
 *     for childname in descr.names:
 *         fields = descr.fields[childname]
 *         child, new_offset = fields             # <<<<<<<<<<<<<<
 * 
 *         if (end - f) - <int>(new_offset - offset[0]) < 15:
 */
    if (likely(__pyx_v_fields != Py_None)) {
      PyObject* sequence = __pyx_v_fields;
      #if CYTHON_COMPILING_IN_CPYTHON
      Py_ssize_t size = Py_SIZE(sequence);
      #else
      Py_ssize_t size = PySequence_Size(sequence);
      #endif
      if (unlikely(size != 2)) {
        if (size > 2) __Pyx_RaiseTooManyValuesError(2);
        else if (size >= 0) __Pyx_RaiseNeedMoreValuesError(size);
        __PYX_ERR(1, 796, __pyx_L1_error)
      }
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_3 = PyTuple_GET_ITEM(sequence, 0); 
      __pyx_t_4 = PyTuple_GET_ITEM(sequence, 1); 
      __Pyx_INCREF(__pyx_t_3);
      __Pyx_INCREF(__pyx_t_4);
      #else
      __pyx_t_3 = PySequence_ITEM(sequence, 0); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 796, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PySequence_ITEM(sequence, 1); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 796, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      #endif
    } else {
      __Pyx_RaiseNoneNotIterableError(); __PYX_ERR(1, 796, __pyx_L1_error)
    }
    if (!(likely(((__pyx_t_3) == Py_None) || likely(__Pyx_TypeTest(__pyx_t_3, __pyx_ptype_5numpy_dtype))))) __PYX_ERR(1, 796, __pyx_L1_error)
    __Pyx_XDECREF_SET(__pyx_v_child, ((PyArray_Descr *)__pyx_t_3));
    __pyx_t_3 = 0;
    __Pyx_XDECREF_SET(__pyx_v_new_offset, __pyx_t_4);
    __pyx_t_4 = 0;

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":798
 *         child, new_offset = fields
 * 
 *         if (end - f) - <int>(new_offset - offset[0]) < 15:             # <<<<<<<<<<<<<<
 *             raise RuntimeError(u"Format string allocated too short, see comment in numpy.pxd")
 * 
 */
    __pyx_t_4 = __Pyx_PyInt_From_int((__pyx_v_offset[0])); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 798, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_4);
    __pyx_t_3 = PyNumber_Subtract(__pyx_v_new_offset, __pyx_t_4); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 798, __pyx_L1_error)
    __Pyx_GOTREF(__pyx_t_3);
    __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_5 = __Pyx_PyInt_As_int(__pyx_t_3); if (unlikely((__pyx_t_5 == (int)-1) && PyErr_Occurred())) __PYX_ERR(1, 798, __pyx_L1_error)
    __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_6 = ((((__pyx_v_end - __pyx_v_f) - ((int)__pyx_t_5)) < 15) != 0);
    if (__pyx_t_6) {

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":799
 * 
 *         if (end - f) - <int>(new_offset - offset[0]) < 15:
 *             raise RuntimeError(u"Format string allocated too short, see comment in numpy.pxd")             # <<<<<<<<<<<<<<
 * 
 *         if ((child.byteorder == c'>' and little_endian) or
 */
      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__62, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 799, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_Raise(__pyx_t_3, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __PYX_ERR(1, 799, __pyx_L1_error)

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":798
 *         child, new_offset = fields
 * 
 *         if (end - f) - <int>(new_offset - offset[0]) < 15:             # <<<<<<<<<<<<<<
 *             raise RuntimeError(u"Format string allocated too short, see comment in numpy.pxd")
 * 
 */
    }

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":801
 *             raise RuntimeError(u"Format string allocated too short, see comment in numpy.pxd")
 * 
 *         if ((child.byteorder == c'>' and little_endian) or             # <<<<<<<<<<<<<<
 *             (child.byteorder == c'<' and not little_endian)):
 *             raise ValueError(u"Non-native byte order not supported")
 */
    __pyx_t_7 = ((__pyx_v_child->byteorder == '>') != 0);
    if (!__pyx_t_7) {
      goto __pyx_L8_next_or;
    } else {
    }
    __pyx_t_7 = (__pyx_v_little_endian != 0);
    if (!__pyx_t_7) {
    } else {
      __pyx_t_6 = __pyx_t_7;
      goto __pyx_L7_bool_binop_done;
    }
    __pyx_L8_next_or:;

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":802
 * 
 *         if ((child.byteorder == c'>' and little_endian) or
 *             (child.byteorder == c'<' and not little_endian)):             # <<<<<<<<<<<<<<
 *             raise ValueError(u"Non-native byte order not supported")
 *             # One could encode it in the format string and have Cython
 */
    __pyx_t_7 = ((__pyx_v_child->byteorder == '<') != 0);
    if (__pyx_t_7) {
    } else {
      __pyx_t_6 = __pyx_t_7;
      goto __pyx_L7_bool_binop_done;
    }
    __pyx_t_7 = ((!(__pyx_v_little_endian != 0)) != 0);
    __pyx_t_6 = __pyx_t_7;
    __pyx_L7_bool_binop_done:;

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":801
 *             raise RuntimeError(u"Format string allocated too short, see comment in numpy.pxd")
 * 
 *         if ((child.byteorder == c'>' and little_endian) or             # <<<<<<<<<<<<<<
 *             (child.byteorder == c'<' and not little_endian)):
 *             raise ValueError(u"Non-native byte order not supported")
 */
    if (__pyx_t_6) {

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":803
 *         if ((child.byteorder == c'>' and little_endian) or
 *             (child.byteorder == c'<' and not little_endian)):
 *             raise ValueError(u"Non-native byte order not supported")             # <<<<<<<<<<<<<<
 *             # One could encode it in the format string and have Cython
 *             # complain instead, BUT: < and > in format strings also imply
 */
      __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_tuple__63, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 803, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __Pyx_Raise(__pyx_t_3, 0, 0, 0);
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __PYX_ERR(1, 803, __pyx_L1_error)

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":801
 *             raise RuntimeError(u"Format string allocated too short, see comment in numpy.pxd")
 * 
 *         if ((child.byteorder == c'>' and little_endian) or             # <<<<<<<<<<<<<<
 *             (child.byteorder == c'<' and not little_endian)):
 *             raise ValueError(u"Non-native byte order not supported")
 */
    }

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":813
 * 
 *         # Output padding bytes
 *         while offset[0] < new_offset:             # <<<<<<<<<<<<<<
 *             f[0] = 120 # "x"; pad byte
 *             f += 1
 */
    while (1) {
      __pyx_t_3 = __Pyx_PyInt_From_int((__pyx_v_offset[0])); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 813, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PyObject_RichCompare(__pyx_t_3, __pyx_v_new_offset, Py_LT); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 813, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(1, 813, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (!__pyx_t_6) break;

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":814
 *         # Output padding bytes
 *         while offset[0] < new_offset:
 *             f[0] = 120 # "x"; pad byte             # <<<<<<<<<<<<<<
 *             f += 1
 *             offset[0] += 1
 */
      (__pyx_v_f[0]) = 0x78;

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":815
 *         while offset[0] < new_offset:
 *             f[0] = 120 # "x"; pad byte
 *             f += 1             # <<<<<<<<<<<<<<
 *             offset[0] += 1
 * 
 */
      __pyx_v_f = (__pyx_v_f + 1);

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":816
 *             f[0] = 120 # "x"; pad byte
 *             f += 1
 *             offset[0] += 1             # <<<<<<<<<<<<<<
 * 
 *         offset[0] += child.itemsize
 */
      __pyx_t_8 = 0;
      (__pyx_v_offset[__pyx_t_8]) = ((__pyx_v_offset[__pyx_t_8]) + 1);
    }

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":818
 *             offset[0] += 1
 * 
 *         offset[0] += child.itemsize             # <<<<<<<<<<<<<<
 * 
 *         if not PyDataType_HASFIELDS(child):
 */
    __pyx_t_8 = 0;
    (__pyx_v_offset[__pyx_t_8]) = ((__pyx_v_offset[__pyx_t_8]) + __pyx_v_child->elsize);

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":820
 *         offset[0] += child.itemsize
 * 
 *         if not PyDataType_HASFIELDS(child):             # <<<<<<<<<<<<<<
 *             t = child.type_num
 *             if end - f < 5:
 */
    __pyx_t_6 = ((!(PyDataType_HASFIELDS(__pyx_v_child) != 0)) != 0);
    if (__pyx_t_6) {

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":821
 * 
 *         if not PyDataType_HASFIELDS(child):
 *             t = child.type_num             # <<<<<<<<<<<<<<
 *             if end - f < 5:
 *                 raise RuntimeError(u"Format string allocated too short.")
 */
      __pyx_t_4 = __Pyx_PyInt_From_int(__pyx_v_child->type_num); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 821, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __Pyx_XDECREF_SET(__pyx_v_t, __pyx_t_4);
      __pyx_t_4 = 0;

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":822
 *         if not PyDataType_HASFIELDS(child):
 *             t = child.type_num
 *             if end - f < 5:             # <<<<<<<<<<<<<<
 *                 raise RuntimeError(u"Format string allocated too short.")
 * 
 */
      __pyx_t_6 = (((__pyx_v_end - __pyx_v_f) < 5) != 0);
      if (__pyx_t_6) {

        /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":823
 *             t = child.type_num
 *             if end - f < 5:
 *                 raise RuntimeError(u"Format string allocated too short.")             # <<<<<<<<<<<<<<
 * 
 *             # Until ticket #99 is fixed, use integers to avoid warnings
 */
        __pyx_t_4 = __Pyx_PyObject_Call(__pyx_builtin_RuntimeError, __pyx_tuple__64, NULL); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 823, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_Raise(__pyx_t_4, 0, 0, 0);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __PYX_ERR(1, 823, __pyx_L1_error)

        /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":822
 *         if not PyDataType_HASFIELDS(child):
 *             t = child.type_num
 *             if end - f < 5:             # <<<<<<<<<<<<<<
 *                 raise RuntimeError(u"Format string allocated too short.")
 * 
 */
      }

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":826
 * 
 *             # Until ticket #99 is fixed, use integers to avoid warnings
 *             if   t == NPY_BYTE:        f[0] =  98 #"b"             # <<<<<<<<<<<<<<
 *             elif t == NPY_UBYTE:       f[0] =  66 #"B"
 *             elif t == NPY_SHORT:       f[0] = 104 #"h"
 */
      __pyx_t_4 = __Pyx_PyInt_From_enum__NPY_TYPES(NPY_BYTE); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 826, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_4, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 826, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(1, 826, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      if (__pyx_t_6) {
        (__pyx_v_f[0]) = 98;
        goto __pyx_L15;
      }

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":827
 *             # Until ticket #99 is fixed, use integers to avoid warnings
 *             if   t == NPY_BYTE:        f[0] =  98 #"b"
 *             elif t == NPY_UBYTE:       f[0] =  66 #"B"             # <<<<<<<<<<<<<<
 *             elif t == NPY_SHORT:       f[0] = 104 #"h"
 *             elif t == NPY_USHORT:      f[0] =  72 #"H"
 */
      __pyx_t_3 = __Pyx_PyInt_From_enum__NPY_TYPES(NPY_UBYTE); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 827, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 827, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(1, 827, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (__pyx_t_6) {
        (__pyx_v_f[0]) = 66;
        goto __pyx_L15;
      }

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":828
 *             if   t == NPY_BYTE:        f[0] =  98 #"b"
 *             elif t == NPY_UBYTE:       f[0] =  66 #"B"
 *             elif t == NPY_SHORT:       f[0] = 104 #"h"             # <<<<<<<<<<<<<<
 *             elif t == NPY_USHORT:      f[0] =  72 #"H"
 *             elif t == NPY_INT:         f[0] = 105 #"i"
 */
      __pyx_t_4 = __Pyx_PyInt_From_enum__NPY_TYPES(NPY_SHORT); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 828, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_4, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 828, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(1, 828, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      if (__pyx_t_6) {
        (__pyx_v_f[0]) = 0x68;
        goto __pyx_L15;
      }

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":829
 *             elif t == NPY_UBYTE:       f[0] =  66 #"B"
 *             elif t == NPY_SHORT:       f[0] = 104 #"h"
 *             elif t == NPY_USHORT:      f[0] =  72 #"H"             # <<<<<<<<<<<<<<
 *             elif t == NPY_INT:         f[0] = 105 #"i"
 *             elif t == NPY_UINT:        f[0] =  73 #"I"
 */
      __pyx_t_3 = __Pyx_PyInt_From_enum__NPY_TYPES(NPY_USHORT); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 829, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 829, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(1, 829, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (__pyx_t_6) {
        (__pyx_v_f[0]) = 72;
        goto __pyx_L15;
      }

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":830
 *             elif t == NPY_SHORT:       f[0] = 104 #"h"
 *             elif t == NPY_USHORT:      f[0] =  72 #"H"
 *             elif t == NPY_INT:         f[0] = 105 #"i"             # <<<<<<<<<<<<<<
 *             elif t == NPY_UINT:        f[0] =  73 #"I"
 *             elif t == NPY_LONG:        f[0] = 108 #"l"
 */
      __pyx_t_4 = __Pyx_PyInt_From_enum__NPY_TYPES(NPY_INT); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 830, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_4, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 830, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(1, 830, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      if (__pyx_t_6) {
        (__pyx_v_f[0]) = 0x69;
        goto __pyx_L15;
      }

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":831
 *             elif t == NPY_USHORT:      f[0] =  72 #"H"
 *             elif t == NPY_INT:         f[0] = 105 #"i"
 *             elif t == NPY_UINT:        f[0] =  73 #"I"             # <<<<<<<<<<<<<<
 *             elif t == NPY_LONG:        f[0] = 108 #"l"
 *             elif t == NPY_ULONG:       f[0] = 76  #"L"
 */
      __pyx_t_3 = __Pyx_PyInt_From_enum__NPY_TYPES(NPY_UINT); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 831, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 831, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(1, 831, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (__pyx_t_6) {
        (__pyx_v_f[0]) = 73;
        goto __pyx_L15;
      }

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":832
 *             elif t == NPY_INT:         f[0] = 105 #"i"
 *             elif t == NPY_UINT:        f[0] =  73 #"I"
 *             elif t == NPY_LONG:        f[0] = 108 #"l"             # <<<<<<<<<<<<<<
 *             elif t == NPY_ULONG:       f[0] = 76  #"L"
 *             elif t == NPY_LONGLONG:    f[0] = 113 #"q"
 */
      __pyx_t_4 = __Pyx_PyInt_From_enum__NPY_TYPES(NPY_LONG); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 832, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_4, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 832, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(1, 832, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      if (__pyx_t_6) {
        (__pyx_v_f[0]) = 0x6C;
        goto __pyx_L15;
      }

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":833
 *             elif t == NPY_UINT:        f[0] =  73 #"I"
 *             elif t == NPY_LONG:        f[0] = 108 #"l"
 *             elif t == NPY_ULONG:       f[0] = 76  #"L"             # <<<<<<<<<<<<<<
 *             elif t == NPY_LONGLONG:    f[0] = 113 #"q"
 *             elif t == NPY_ULONGLONG:   f[0] = 81  #"Q"
 */
      __pyx_t_3 = __Pyx_PyInt_From_enum__NPY_TYPES(NPY_ULONG); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 833, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 833, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(1, 833, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (__pyx_t_6) {
        (__pyx_v_f[0]) = 76;
        goto __pyx_L15;
      }

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":834
 *             elif t == NPY_LONG:        f[0] = 108 #"l"
 *             elif t == NPY_ULONG:       f[0] = 76  #"L"
 *             elif t == NPY_LONGLONG:    f[0] = 113 #"q"             # <<<<<<<<<<<<<<
 *             elif t == NPY_ULONGLONG:   f[0] = 81  #"Q"
 *             elif t == NPY_FLOAT:       f[0] = 102 #"f"
 */
      __pyx_t_4 = __Pyx_PyInt_From_enum__NPY_TYPES(NPY_LONGLONG); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 834, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_4, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 834, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(1, 834, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      if (__pyx_t_6) {
        (__pyx_v_f[0]) = 0x71;
        goto __pyx_L15;
      }

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":835
 *             elif t == NPY_ULONG:       f[0] = 76  #"L"
 *             elif t == NPY_LONGLONG:    f[0] = 113 #"q"
 *             elif t == NPY_ULONGLONG:   f[0] = 81  #"Q"             # <<<<<<<<<<<<<<
 *             elif t == NPY_FLOAT:       f[0] = 102 #"f"
 *             elif t == NPY_DOUBLE:      f[0] = 100 #"d"
 */
      __pyx_t_3 = __Pyx_PyInt_From_enum__NPY_TYPES(NPY_ULONGLONG); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 835, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 835, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(1, 835, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (__pyx_t_6) {
        (__pyx_v_f[0]) = 81;
        goto __pyx_L15;
      }

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":836
 *             elif t == NPY_LONGLONG:    f[0] = 113 #"q"
 *             elif t == NPY_ULONGLONG:   f[0] = 81  #"Q"
 *             elif t == NPY_FLOAT:       f[0] = 102 #"f"             # <<<<<<<<<<<<<<
 *             elif t == NPY_DOUBLE:      f[0] = 100 #"d"
 *             elif t == NPY_LONGDOUBLE:  f[0] = 103 #"g"
 */
      __pyx_t_4 = __Pyx_PyInt_From_enum__NPY_TYPES(NPY_FLOAT); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 836, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_4, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 836, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(1, 836, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      if (__pyx_t_6) {
        (__pyx_v_f[0]) = 0x66;
        goto __pyx_L15;
      }

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":837
 *             elif t == NPY_ULONGLONG:   f[0] = 81  #"Q"
 *             elif t == NPY_FLOAT:       f[0] = 102 #"f"
 *             elif t == NPY_DOUBLE:      f[0] = 100 #"d"             # <<<<<<<<<<<<<<
 *             elif t == NPY_LONGDOUBLE:  f[0] = 103 #"g"
 *             elif t == NPY_CFLOAT:      f[0] = 90; f[1] = 102; f += 1 # Zf
 */
      __pyx_t_3 = __Pyx_PyInt_From_enum__NPY_TYPES(NPY_DOUBLE); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 837, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 837, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(1, 837, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (__pyx_t_6) {
        (__pyx_v_f[0]) = 0x64;
        goto __pyx_L15;
      }

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":838
 *             elif t == NPY_FLOAT:       f[0] = 102 #"f"
 *             elif t == NPY_DOUBLE:      f[0] = 100 #"d"
 *             elif t == NPY_LONGDOUBLE:  f[0] = 103 #"g"             # <<<<<<<<<<<<<<
 *             elif t == NPY_CFLOAT:      f[0] = 90; f[1] = 102; f += 1 # Zf
 *             elif t == NPY_CDOUBLE:     f[0] = 90; f[1] = 100; f += 1 # Zd
 */
      __pyx_t_4 = __Pyx_PyInt_From_enum__NPY_TYPES(NPY_LONGDOUBLE); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 838, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_4, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 838, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(1, 838, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      if (__pyx_t_6) {
        (__pyx_v_f[0]) = 0x67;
        goto __pyx_L15;
      }

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":839
 *             elif t == NPY_DOUBLE:      f[0] = 100 #"d"
 *             elif t == NPY_LONGDOUBLE:  f[0] = 103 #"g"
 *             elif t == NPY_CFLOAT:      f[0] = 90; f[1] = 102; f += 1 # Zf             # <<<<<<<<<<<<<<
 *             elif t == NPY_CDOUBLE:     f[0] = 90; f[1] = 100; f += 1 # Zd
 *             elif t == NPY_CLONGDOUBLE: f[0] = 90; f[1] = 103; f += 1 # Zg
 */
      __pyx_t_3 = __Pyx_PyInt_From_enum__NPY_TYPES(NPY_CFLOAT); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 839, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 839, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(1, 839, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (__pyx_t_6) {
        (__pyx_v_f[0]) = 90;
        (__pyx_v_f[1]) = 0x66;
        __pyx_v_f = (__pyx_v_f + 1);
        goto __pyx_L15;
      }

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":840
 *             elif t == NPY_LONGDOUBLE:  f[0] = 103 #"g"
 *             elif t == NPY_CFLOAT:      f[0] = 90; f[1] = 102; f += 1 # Zf
 *             elif t == NPY_CDOUBLE:     f[0] = 90; f[1] = 100; f += 1 # Zd             # <<<<<<<<<<<<<<
 *             elif t == NPY_CLONGDOUBLE: f[0] = 90; f[1] = 103; f += 1 # Zg
 *             elif t == NPY_OBJECT:      f[0] = 79 #"O"
 */
      __pyx_t_4 = __Pyx_PyInt_From_enum__NPY_TYPES(NPY_CDOUBLE); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 840, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_4, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 840, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(1, 840, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      if (__pyx_t_6) {
        (__pyx_v_f[0]) = 90;
        (__pyx_v_f[1]) = 0x64;
        __pyx_v_f = (__pyx_v_f + 1);
        goto __pyx_L15;
      }

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":841
 *             elif t == NPY_CFLOAT:      f[0] = 90; f[1] = 102; f += 1 # Zf
 *             elif t == NPY_CDOUBLE:     f[0] = 90; f[1] = 100; f += 1 # Zd
 *             elif t == NPY_CLONGDOUBLE: f[0] = 90; f[1] = 103; f += 1 # Zg             # <<<<<<<<<<<<<<
 *             elif t == NPY_OBJECT:      f[0] = 79 #"O"
 *             else:
 */
      __pyx_t_3 = __Pyx_PyInt_From_enum__NPY_TYPES(NPY_CLONGDOUBLE); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 841, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_3);
      __pyx_t_4 = PyObject_RichCompare(__pyx_v_t, __pyx_t_3, Py_EQ); __Pyx_XGOTREF(__pyx_t_4); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 841, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_4); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(1, 841, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      if (__pyx_t_6) {
        (__pyx_v_f[0]) = 90;
        (__pyx_v_f[1]) = 0x67;
        __pyx_v_f = (__pyx_v_f + 1);
        goto __pyx_L15;
      }

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":842
 *             elif t == NPY_CDOUBLE:     f[0] = 90; f[1] = 100; f += 1 # Zd
 *             elif t == NPY_CLONGDOUBLE: f[0] = 90; f[1] = 103; f += 1 # Zg
 *             elif t == NPY_OBJECT:      f[0] = 79 #"O"             # <<<<<<<<<<<<<<
 *             else:
 *                 raise ValueError(u"unknown dtype code in numpy.pxd (%d)" % t)
 */
      __pyx_t_4 = __Pyx_PyInt_From_enum__NPY_TYPES(NPY_OBJECT); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 842, __pyx_L1_error)
      __Pyx_GOTREF(__pyx_t_4);
      __pyx_t_3 = PyObject_RichCompare(__pyx_v_t, __pyx_t_4, Py_EQ); __Pyx_XGOTREF(__pyx_t_3); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 842, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_6 = __Pyx_PyObject_IsTrue(__pyx_t_3); if (unlikely(__pyx_t_6 < 0)) __PYX_ERR(1, 842, __pyx_L1_error)
      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
      if (__pyx_t_6) {
        (__pyx_v_f[0]) = 79;
        goto __pyx_L15;
      }

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":844
 *             elif t == NPY_OBJECT:      f[0] = 79 #"O"
 *             else:
 *                 raise ValueError(u"unknown dtype code in numpy.pxd (%d)" % t)             # <<<<<<<<<<<<<<
 *             f += 1
 *         else:
 */
      /*else*/ {
        __pyx_t_3 = PyUnicode_Format(__pyx_kp_u_unknown_dtype_code_in_numpy_pxd, __pyx_v_t); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 844, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __pyx_t_4 = PyTuple_New(1); if (unlikely(!__pyx_t_4)) __PYX_ERR(1, 844, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_4);
        __Pyx_GIVEREF(__pyx_t_3);
        PyTuple_SET_ITEM(__pyx_t_4, 0, __pyx_t_3);
        __pyx_t_3 = 0;
        __pyx_t_3 = __Pyx_PyObject_Call(__pyx_builtin_ValueError, __pyx_t_4, NULL); if (unlikely(!__pyx_t_3)) __PYX_ERR(1, 844, __pyx_L1_error)
        __Pyx_GOTREF(__pyx_t_3);
        __Pyx_DECREF(__pyx_t_4); __pyx_t_4 = 0;
        __Pyx_Raise(__pyx_t_3, 0, 0, 0);
        __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
        __PYX_ERR(1, 844, __pyx_L1_error)
      }
      __pyx_L15:;

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":845
 *             else:
 *                 raise ValueError(u"unknown dtype code in numpy.pxd (%d)" % t)
 *             f += 1             # <<<<<<<<<<<<<<
 *         else:
 *             # Cython ignores struct boundary information ("T{...}"),
 */
      __pyx_v_f = (__pyx_v_f + 1);

      /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":820
 *         offset[0] += child.itemsize
 * 
 *         if not PyDataType_HASFIELDS(child):             # <<<<<<<<<<<<<<
 *             t = child.type_num
 *             if end - f < 5:
 */
      goto __pyx_L13;
    }

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":849
 *             # Cython ignores struct boundary information ("T{...}"),
 *             # so don't output it
 *             f = _util_dtypestring(child, f, end, offset)             # <<<<<<<<<<<<<<
 *     return f
 * 
 */
    /*else*/ {
      __pyx_t_9 = __pyx_f_5numpy__util_dtypestring(__pyx_v_child, __pyx_v_f, __pyx_v_end, __pyx_v_offset); if (unlikely(__pyx_t_9 == NULL)) __PYX_ERR(1, 849, __pyx_L1_error)
      __pyx_v_f = __pyx_t_9;
    }
    __pyx_L13:;

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":794
 *     cdef tuple fields
 * 
 *     for childname in descr.names:             # <<<<<<<<<<<<<<
 *         fields = descr.fields[childname]
 *         child, new_offset = fields
 */
  }
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":850
 *             # so don't output it
 *             f = _util_dtypestring(child, f, end, offset)
 *     return f             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_r = __pyx_v_f;
  goto __pyx_L0;

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":785
 *     return PyArray_MultiIterNew(5, <void*>a, <void*>b, <void*>c, <void*> d, <void*> e)
 * 
 * cdef inline char* _util_dtypestring(dtype descr, char* f, char* end, int* offset) except NULL:             # <<<<<<<<<<<<<<
 *     # Recursive utility function used in __getbuffer__ to get format
 *     # string. The new location in the format string is returned.
 */

  /* function exit code */
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_3);
  __Pyx_XDECREF(__pyx_t_4);
  __Pyx_AddTraceback("numpy._util_dtypestring", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  __Pyx_XDECREF((PyObject *)__pyx_v_child);
  __Pyx_XDECREF(__pyx_v_fields);
  __Pyx_XDECREF(__pyx_v_childname);
  __Pyx_XDECREF(__pyx_v_new_offset);
  __Pyx_XDECREF(__pyx_v_t);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":966
 * 
 * 
 * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
 *      cdef PyObject* baseptr
 *      if base is None:
 */

static CYTHON_INLINE void __pyx_f_5numpy_set_array_base(PyArrayObject *__pyx_v_arr, PyObject *__pyx_v_base) {
  PyObject *__pyx_v_baseptr;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  int __pyx_t_2;
  __Pyx_RefNannySetupContext("set_array_base", 0);

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":968
 * cdef inline void set_array_base(ndarray arr, object base):
 *      cdef PyObject* baseptr
 *      if base is None:             # <<<<<<<<<<<<<<
 *          baseptr = NULL
 *      else:
 */
  __pyx_t_1 = (__pyx_v_base == Py_None);
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":969
 *      cdef PyObject* baseptr
 *      if base is None:
 *          baseptr = NULL             # <<<<<<<<<<<<<<
 *      else:
 *          Py_INCREF(base) # important to do this before decref below!
 */
    __pyx_v_baseptr = NULL;

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":968
 * cdef inline void set_array_base(ndarray arr, object base):
 *      cdef PyObject* baseptr
 *      if base is None:             # <<<<<<<<<<<<<<
 *          baseptr = NULL
 *      else:
 */
    goto __pyx_L3;
  }

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":971
 *          baseptr = NULL
 *      else:
 *          Py_INCREF(base) # important to do this before decref below!             # <<<<<<<<<<<<<<
 *          baseptr = <PyObject*>base
 *      Py_XDECREF(arr.base)
 */
  /*else*/ {
    Py_INCREF(__pyx_v_base);

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":972
 *      else:
 *          Py_INCREF(base) # important to do this before decref below!
 *          baseptr = <PyObject*>base             # <<<<<<<<<<<<<<
 *      Py_XDECREF(arr.base)
 *      arr.base = baseptr
 */
    __pyx_v_baseptr = ((PyObject *)__pyx_v_base);
  }
  __pyx_L3:;

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":973
 *          Py_INCREF(base) # important to do this before decref below!
 *          baseptr = <PyObject*>base
 *      Py_XDECREF(arr.base)             # <<<<<<<<<<<<<<
 *      arr.base = baseptr
 * 
 */
  Py_XDECREF(__pyx_v_arr->base);

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":974
 *          baseptr = <PyObject*>base
 *      Py_XDECREF(arr.base)
 *      arr.base = baseptr             # <<<<<<<<<<<<<<
 * 
 * cdef inline object get_array_base(ndarray arr):
 */
  __pyx_v_arr->base = __pyx_v_baseptr;

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":966
 * 
 * 
 * cdef inline void set_array_base(ndarray arr, object base):             # <<<<<<<<<<<<<<
 *      cdef PyObject* baseptr
 *      if base is None:
 */

  /* function exit code */
  __Pyx_RefNannyFinishContext();
}

/* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":976
 *      arr.base = baseptr
 * 
 * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
 *     if arr.base is NULL:
 *         return None
 */

static CYTHON_INLINE PyObject *__pyx_f_5numpy_get_array_base(PyArrayObject *__pyx_v_arr) {
  PyObject *__pyx_r = NULL;
  __Pyx_RefNannyDeclarations
  int __pyx_t_1;
  __Pyx_RefNannySetupContext("get_array_base", 0);

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":977
 * 
 * cdef inline object get_array_base(ndarray arr):
 *     if arr.base is NULL:             # <<<<<<<<<<<<<<
 *         return None
 *     else:
 */
  __pyx_t_1 = ((__pyx_v_arr->base == NULL) != 0);
  if (__pyx_t_1) {

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":978
 * cdef inline object get_array_base(ndarray arr):
 *     if arr.base is NULL:
 *         return None             # <<<<<<<<<<<<<<
 *     else:
 *         return <object>arr.base
 */
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(Py_None);
    __pyx_r = Py_None;
    goto __pyx_L0;

    /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":977
 * 
 * cdef inline object get_array_base(ndarray arr):
 *     if arr.base is NULL:             # <<<<<<<<<<<<<<
 *         return None
 *     else:
 */
  }

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":980
 *         return None
 *     else:
 *         return <object>arr.base             # <<<<<<<<<<<<<<
 */
  /*else*/ {
    __Pyx_XDECREF(__pyx_r);
    __Pyx_INCREF(((PyObject *)__pyx_v_arr->base));
    __pyx_r = ((PyObject *)__pyx_v_arr->base);
    goto __pyx_L0;
  }

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":976
 *      arr.base = baseptr
 * 
 * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
 *     if arr.base is NULL:
 *         return None
 */

  /* function exit code */
  __pyx_L0:;
  __Pyx_XGIVEREF(__pyx_r);
  __Pyx_RefNannyFinishContext();
  return __pyx_r;
}

static PyMethodDef __pyx_methods[] = {
  {0, 0, 0, 0}
};

#if PY_MAJOR_VERSION >= 3
static struct PyModuleDef __pyx_moduledef = {
  #if PY_VERSION_HEX < 0x03020000
    { PyObject_HEAD_INIT(NULL) NULL, 0, NULL },
  #else
    PyModuleDef_HEAD_INIT,
  #endif
    "libTEXTURIZE",
    0, /* m_doc */
    -1, /* m_size */
    __pyx_methods /* m_methods */,
    NULL, /* m_reload */
    NULL, /* m_traverse */
    NULL, /* m_clear */
    NULL /* m_free */
};
#endif

static __Pyx_StringTabEntry __pyx_string_tab[] = {
  {&__pyx_n_s_Angle, __pyx_k_Angle, sizeof(__pyx_k_Angle), 0, 0, 1, 1},
  {&__pyx_n_s_Aux1, __pyx_k_Aux1, sizeof(__pyx_k_Aux1), 0, 0, 1, 1},
  {&__pyx_n_s_Aux2, __pyx_k_Aux2, sizeof(__pyx_k_Aux2), 0, 0, 1, 1},
  {&__pyx_n_s_Aux3, __pyx_k_Aux3, sizeof(__pyx_k_Aux3), 0, 0, 1, 1},
  {&__pyx_n_s_Axis, __pyx_k_Axis, sizeof(__pyx_k_Axis), 0, 0, 1, 1},
  {&__pyx_n_s_Beta, __pyx_k_Beta, sizeof(__pyx_k_Beta), 0, 0, 1, 1},
  {&__pyx_n_s_CPH, __pyx_k_CPH, sizeof(__pyx_k_CPH), 0, 0, 1, 1},
  {&__pyx_n_s_CTH, __pyx_k_CTH, sizeof(__pyx_k_CTH), 0, 0, 1, 1},
  {&__pyx_n_s_EUL, __pyx_k_EUL, sizeof(__pyx_k_EUL), 0, 0, 1, 1},
  {&__pyx_n_s_EYE, __pyx_k_EYE, sizeof(__pyx_k_EYE), 0, 0, 1, 1},
  {&__pyx_kp_s_E_Dropbox_Public_PhDResources_10, __pyx_k_E_Dropbox_Public_PhDResources_10, sizeof(__pyx_k_E_Dropbox_Public_PhDResources_10), 0, 0, 1, 0},
  {&__pyx_n_s_Eul, __pyx_k_Eul, sizeof(__pyx_k_Eul), 0, 0, 1, 1},
  {&__pyx_kp_u_Format_string_allocated_too_shor, __pyx_k_Format_string_allocated_too_shor, sizeof(__pyx_k_Format_string_allocated_too_shor), 0, 1, 0, 0},
  {&__pyx_kp_u_Format_string_allocated_too_shor_2, __pyx_k_Format_string_allocated_too_shor_2, sizeof(__pyx_k_Format_string_allocated_too_shor_2), 0, 1, 0, 0},
  {&__pyx_n_s_H, __pyx_k_H, sizeof(__pyx_k_H), 0, 0, 1, 1},
  {&__pyx_n_s_INVCDF1D, __pyx_k_INVCDF1D, sizeof(__pyx_k_INVCDF1D), 0, 0, 1, 1},
  {&__pyx_n_s_Lambdaa, __pyx_k_Lambdaa, sizeof(__pyx_k_Lambdaa), 0, 0, 1, 1},
  {&__pyx_n_s_Nd, __pyx_k_Nd, sizeof(__pyx_k_Nd), 0, 0, 1, 1},
  {&__pyx_kp_u_Non_native_byte_order_not_suppor, __pyx_k_Non_native_byte_order_not_suppor, sizeof(__pyx_k_Non_native_byte_order_not_suppor), 0, 1, 0, 0},
  {&__pyx_n_s_P, __pyx_k_P, sizeof(__pyx_k_P), 0, 0, 1, 1},
  {&__pyx_n_s_PHI, __pyx_k_PHI, sizeof(__pyx_k_PHI), 0, 0, 1, 1},
  {&__pyx_n_s_PHI1, __pyx_k_PHI1, sizeof(__pyx_k_PHI1), 0, 0, 1, 1},
  {&__pyx_n_s_PHI2, __pyx_k_PHI2, sizeof(__pyx_k_PHI2), 0, 0, 1, 1},
  {&__pyx_n_s_Phi, __pyx_k_Phi, sizeof(__pyx_k_Phi), 0, 0, 1, 1},
  {&__pyx_n_s_Phi1Func, __pyx_k_Phi1Func, sizeof(__pyx_k_Phi1Func), 0, 0, 1, 1},
  {&__pyx_n_s_Phi2Func, __pyx_k_Phi2Func, sizeof(__pyx_k_Phi2Func), 0, 0, 1, 1},
  {&__pyx_n_s_PhiFunc, __pyx_k_PhiFunc, sizeof(__pyx_k_PhiFunc), 0, 0, 1, 1},
  {&__pyx_n_s_Q, __pyx_k_Q, sizeof(__pyx_k_Q), 0, 0, 1, 1},
  {&__pyx_n_s_R, __pyx_k_R, sizeof(__pyx_k_R), 0, 0, 1, 1},
  {&__pyx_n_s_Rd, __pyx_k_Rd, sizeof(__pyx_k_Rd), 0, 0, 1, 1},
  {&__pyx_n_s_Ro, __pyx_k_Ro, sizeof(__pyx_k_Ro), 0, 0, 1, 1},
  {&__pyx_n_s_Roo, __pyx_k_Roo, sizeof(__pyx_k_Roo), 0, 0, 1, 1},
  {&__pyx_n_s_Rot, __pyx_k_Rot, sizeof(__pyx_k_Rot), 0, 0, 1, 1},
  {&__pyx_n_s_RuntimeError, __pyx_k_RuntimeError, sizeof(__pyx_k_RuntimeError), 0, 0, 1, 1},
  {&__pyx_n_s_Rv, __pyx_k_Rv, sizeof(__pyx_k_Rv), 0, 0, 1, 1},
  {&__pyx_n_s_S, __pyx_k_S, sizeof(__pyx_k_S), 0, 0, 1, 1},
  {&__pyx_n_s_SPH, __pyx_k_SPH, sizeof(__pyx_k_SPH), 0, 0, 1, 1},
  {&__pyx_n_s_SQ, __pyx_k_SQ, sizeof(__pyx_k_SQ), 0, 0, 1, 1},
  {&__pyx_n_s_STH, __pyx_k_STH, sizeof(__pyx_k_STH), 0, 0, 1, 1},
  {&__pyx_n_s_T, __pyx_k_T, sizeof(__pyx_k_T), 0, 0, 1, 1},
  {&__pyx_n_s_Texture_Fiber, __pyx_k_Texture_Fiber, sizeof(__pyx_k_Texture_Fiber), 0, 0, 1, 1},
  {&__pyx_n_s_Texture_Generic_Euler, __pyx_k_Texture_Generic_Euler, sizeof(__pyx_k_Texture_Generic_Euler), 0, 0, 1, 1},
  {&__pyx_n_s_Texture_Sheet, __pyx_k_Texture_Sheet, sizeof(__pyx_k_Texture_Sheet), 0, 0, 1, 1},
  {&__pyx_n_s_Texture_URO_arvo, __pyx_k_Texture_URO_arvo, sizeof(__pyx_k_Texture_URO_arvo), 0, 0, 1, 1},
  {&__pyx_n_s_Texture_URO_mack, __pyx_k_Texture_URO_mack, sizeof(__pyx_k_Texture_URO_mack), 0, 0, 1, 1},
  {&__pyx_n_s_Texture_URO_miles, __pyx_k_Texture_URO_miles, sizeof(__pyx_k_Texture_URO_miles), 0, 0, 1, 1},
  {&__pyx_n_s_Texture_URO_mur, __pyx_k_Texture_URO_mur, sizeof(__pyx_k_Texture_URO_mur), 0, 0, 1, 1},
  {&__pyx_n_s_Texture_URO_nxyz, __pyx_k_Texture_URO_nxyz, sizeof(__pyx_k_Texture_URO_nxyz), 0, 0, 1, 1},
  {&__pyx_n_s_Texture_URO_sm1, __pyx_k_Texture_URO_sm1, sizeof(__pyx_k_Texture_URO_sm1), 0, 0, 1, 1},
  {&__pyx_n_s_Texture_URO_sm2, __pyx_k_Texture_URO_sm2, sizeof(__pyx_k_Texture_URO_sm2), 0, 0, 1, 1},
  {&__pyx_n_s_Texture_URO_xyz, __pyx_k_Texture_URO_xyz, sizeof(__pyx_k_Texture_URO_xyz), 0, 0, 1, 1},
  {&__pyx_n_s_Theta, __pyx_k_Theta, sizeof(__pyx_k_Theta), 0, 0, 1, 1},
  {&__pyx_n_s_U, __pyx_k_U, sizeof(__pyx_k_U), 0, 0, 1, 1},
  {&__pyx_n_s_U0, __pyx_k_U0, sizeof(__pyx_k_U0), 0, 0, 1, 1},
  {&__pyx_n_s_U1, __pyx_k_U1, sizeof(__pyx_k_U1), 0, 0, 1, 1},
  {&__pyx_n_s_U2, __pyx_k_U2, sizeof(__pyx_k_U2), 0, 0, 1, 1},
  {&__pyx_n_s_V, __pyx_k_V, sizeof(__pyx_k_V), 0, 0, 1, 1},
  {&__pyx_n_s_V1, __pyx_k_V1, sizeof(__pyx_k_V1), 0, 0, 1, 1},
  {&__pyx_n_s_V2, __pyx_k_V2, sizeof(__pyx_k_V2), 0, 0, 1, 1},
  {&__pyx_n_s_V3, __pyx_k_V3, sizeof(__pyx_k_V3), 0, 0, 1, 1},
  {&__pyx_n_s_ValueError, __pyx_k_ValueError, sizeof(__pyx_k_ValueError), 0, 0, 1, 1},
  {&__pyx_n_s_X1, __pyx_k_X1, sizeof(__pyx_k_X1), 0, 0, 1, 1},
  {&__pyx_n_s_X1C, __pyx_k_X1C, sizeof(__pyx_k_X1C), 0, 0, 1, 1},
  {&__pyx_n_s_X1S, __pyx_k_X1S, sizeof(__pyx_k_X1S), 0, 0, 1, 1},
  {&__pyx_n_s_X2, __pyx_k_X2, sizeof(__pyx_k_X2), 0, 0, 1, 1},
  {&__pyx_n_s_X2C, __pyx_k_X2C, sizeof(__pyx_k_X2C), 0, 0, 1, 1},
  {&__pyx_n_s_X2S, __pyx_k_X2S, sizeof(__pyx_k_X2S), 0, 0, 1, 1},
  {&__pyx_n_s_X3, __pyx_k_X3, sizeof(__pyx_k_X3), 0, 0, 1, 1},
  {&__pyx_n_s_X3C, __pyx_k_X3C, sizeof(__pyx_k_X3C), 0, 0, 1, 1},
  {&__pyx_n_s_X3S, __pyx_k_X3S, sizeof(__pyx_k_X3S), 0, 0, 1, 1},
  {&__pyx_n_s_Xc, __pyx_k_Xc, sizeof(__pyx_k_Xc), 0, 0, 1, 1},
  {&__pyx_n_s_Xc0, __pyx_k_Xc0, sizeof(__pyx_k_Xc0), 0, 0, 1, 1},
  {&__pyx_n_s_Xc1, __pyx_k_Xc1, sizeof(__pyx_k_Xc1), 0, 0, 1, 1},
  {&__pyx_n_s_Xc2, __pyx_k_Xc2, sizeof(__pyx_k_Xc2), 0, 0, 1, 1},
  {&__pyx_n_s_Xp, __pyx_k_Xp, sizeof(__pyx_k_Xp), 0, 0, 1, 1},
  {&__pyx_n_s_Yc, __pyx_k_Yc, sizeof(__pyx_k_Yc), 0, 0, 1, 1},
  {&__pyx_n_s_Yp, __pyx_k_Yp, sizeof(__pyx_k_Yp), 0, 0, 1, 1},
  {&__pyx_n_s_Zc, __pyx_k_Zc, sizeof(__pyx_k_Zc), 0, 0, 1, 1},
  {&__pyx_n_s_Zp, __pyx_k_Zp, sizeof(__pyx_k_Zp), 0, 0, 1, 1},
  {&__pyx_n_s_a, __pyx_k_a, sizeof(__pyx_k_a), 0, 0, 1, 1},
  {&__pyx_n_s_aap_to_rm, __pyx_k_aap_to_rm, sizeof(__pyx_k_aap_to_rm), 0, 0, 1, 1},
  {&__pyx_n_s_alpha, __pyx_k_alpha, sizeof(__pyx_k_alpha), 0, 0, 1, 1},
  {&__pyx_n_s_arccos, __pyx_k_arccos, sizeof(__pyx_k_arccos), 0, 0, 1, 1},
  {&__pyx_n_s_array, __pyx_k_array, sizeof(__pyx_k_array), 0, 0, 1, 1},
  {&__pyx_n_s_atan2, __pyx_k_atan2, sizeof(__pyx_k_atan2), 0, 0, 1, 1},
  {&__pyx_n_s_aux1, __pyx_k_aux1, sizeof(__pyx_k_aux1), 0, 0, 1, 1},
  {&__pyx_n_s_aux2, __pyx_k_aux2, sizeof(__pyx_k_aux2), 0, 0, 1, 1},
  {&__pyx_n_s_aux3, __pyx_k_aux3, sizeof(__pyx_k_aux3), 0, 0, 1, 1},
  {&__pyx_n_s_axisdist, __pyx_k_axisdist, sizeof(__pyx_k_axisdist), 0, 0, 1, 1},
  {&__pyx_n_s_beta, __pyx_k_beta, sizeof(__pyx_k_beta), 0, 0, 1, 1},
  {&__pyx_n_s_c1, __pyx_k_c1, sizeof(__pyx_k_c1), 0, 0, 1, 1},
  {&__pyx_n_s_c2, __pyx_k_c2, sizeof(__pyx_k_c2), 0, 0, 1, 1},
  {&__pyx_n_s_cb, __pyx_k_cb, sizeof(__pyx_k_cb), 0, 0, 1, 1},
  {&__pyx_n_s_clm, __pyx_k_clm, sizeof(__pyx_k_clm), 0, 0, 1, 1},
  {&__pyx_n_s_cmath, __pyx_k_cmath, sizeof(__pyx_k_cmath), 0, 0, 1, 1},
  {&__pyx_n_s_conv, __pyx_k_conv, sizeof(__pyx_k_conv), 0, 0, 1, 1},
  {&__pyx_n_s_cos, __pyx_k_cos, sizeof(__pyx_k_cos), 0, 0, 1, 1},
  {&__pyx_n_s_coss, __pyx_k_coss, sizeof(__pyx_k_coss), 0, 0, 1, 1},
  {&__pyx_n_s_cossncap0, __pyx_k_cossncap0, sizeof(__pyx_k_cossncap0), 0, 0, 1, 1},
  {&__pyx_n_s_cossncap1, __pyx_k_cossncap1, sizeof(__pyx_k_cossncap1), 0, 0, 1, 1},
  {&__pyx_n_s_cossncap2, __pyx_k_cossncap2, sizeof(__pyx_k_cossncap2), 0, 0, 1, 1},
  {&__pyx_n_s_cp, __pyx_k_cp, sizeof(__pyx_k_cp), 0, 0, 1, 1},
  {&__pyx_n_s_cph, __pyx_k_cph, sizeof(__pyx_k_cph), 0, 0, 1, 1},
  {&__pyx_n_s_cross, __pyx_k_cross, sizeof(__pyx_k_cross), 0, 0, 1, 1},
  {&__pyx_n_s_ct, __pyx_k_ct, sizeof(__pyx_k_ct), 0, 0, 1, 1},
  {&__pyx_n_s_cth, __pyx_k_cth, sizeof(__pyx_k_cth), 0, 0, 1, 1},
  {&__pyx_n_s_cv2, __pyx_k_cv2, sizeof(__pyx_k_cv2), 0, 0, 1, 1},
  {&__pyx_n_s_delR, __pyx_k_delR, sizeof(__pyx_k_delR), 0, 0, 1, 1},
  {&__pyx_n_s_den, __pyx_k_den, sizeof(__pyx_k_den), 0, 0, 1, 1},
  {&__pyx_n_s_den1, __pyx_k_den1, sizeof(__pyx_k_den1), 0, 0, 1, 1},
  {&__pyx_n_s_den2, __pyx_k_den2, sizeof(__pyx_k_den2), 0, 0, 1, 1},
  {&__pyx_n_s_den3, __pyx_k_den3, sizeof(__pyx_k_den3), 0, 0, 1, 1},
  {&__pyx_n_s_dtype, __pyx_k_dtype, sizeof(__pyx_k_dtype), 0, 0, 1, 1},
  {&__pyx_n_s_einsum, __pyx_k_einsum, sizeof(__pyx_k_einsum), 0, 0, 1, 1},
  {&__pyx_n_s_eul, __pyx_k_eul, sizeof(__pyx_k_eul), 0, 0, 1, 1},
  {&__pyx_n_s_eul1, __pyx_k_eul1, sizeof(__pyx_k_eul1), 0, 0, 1, 1},
  {&__pyx_n_s_eul2, __pyx_k_eul2, sizeof(__pyx_k_eul2), 0, 0, 1, 1},
  {&__pyx_n_s_exetime, __pyx_k_exetime, sizeof(__pyx_k_exetime), 0, 0, 1, 1},
  {&__pyx_n_s_eye, __pyx_k_eye, sizeof(__pyx_k_eye), 0, 0, 1, 1},
  {&__pyx_n_s_float64, __pyx_k_float64, sizeof(__pyx_k_float64), 0, 0, 1, 1},
  {&__pyx_n_s_gamma, __pyx_k_gamma, sizeof(__pyx_k_gamma), 0, 0, 1, 1},
  {&__pyx_n_s_gamma1, __pyx_k_gamma1, sizeof(__pyx_k_gamma1), 0, 0, 1, 1},
  {&__pyx_n_s_gamma2, __pyx_k_gamma2, sizeof(__pyx_k_gamma2), 0, 0, 1, 1},
  {&__pyx_n_s_gammadist, __pyx_k_gammadist, sizeof(__pyx_k_gammadist), 0, 0, 1, 1},
  {&__pyx_n_s_gammamax, __pyx_k_gammamax, sizeof(__pyx_k_gammamax), 0, 0, 1, 1},
  {&__pyx_n_s_gammamin, __pyx_k_gammamin, sizeof(__pyx_k_gammamin), 0, 0, 1, 1},
  {&__pyx_n_s_grainloc, __pyx_k_grainloc, sizeof(__pyx_k_grainloc), 0, 0, 1, 1},
  {&__pyx_n_s_i, __pyx_k_i, sizeof(__pyx_k_i), 0, 0, 1, 1},
  {&__pyx_n_s_import, __pyx_k_import, sizeof(__pyx_k_import), 0, 0, 1, 1},
  {&__pyx_n_s_j, __pyx_k_j, sizeof(__pyx_k_j), 0, 0, 1, 1},
  {&__pyx_n_s_k, __pyx_k_k, sizeof(__pyx_k_k), 0, 0, 1, 1},
  {&__pyx_kp_s_kil_lj_kij, __pyx_k_kil_lj_kij, sizeof(__pyx_k_kil_lj_kij), 0, 0, 1, 0},
  {&__pyx_n_s_l, __pyx_k_l, sizeof(__pyx_k_l), 0, 0, 1, 1},
  {&__pyx_n_s_lambdaa, __pyx_k_lambdaa, sizeof(__pyx_k_lambdaa), 0, 0, 1, 1},
  {&__pyx_n_s_libCONVERT, __pyx_k_libCONVERT, sizeof(__pyx_k_libCONVERT), 0, 0, 1, 1},
  {&__pyx_n_s_libMETROPOLIS, __pyx_k_libMETROPOLIS, sizeof(__pyx_k_libMETROPOLIS), 0, 0, 1, 1},
  {&__pyx_n_s_libTEXTURIZE, __pyx_k_libTEXTURIZE, sizeof(__pyx_k_libTEXTURIZE), 0, 0, 1, 1},
  {&__pyx_n_s_linspace, __pyx_k_linspace, sizeof(__pyx_k_linspace), 0, 0, 1, 1},
  {&__pyx_n_s_lm, __pyx_k_lm, sizeof(__pyx_k_lm), 0, 0, 1, 1},
  {&__pyx_n_s_m, __pyx_k_m, sizeof(__pyx_k_m), 0, 0, 1, 1},
  {&__pyx_n_s_main, __pyx_k_main, sizeof(__pyx_k_main), 0, 0, 1, 1},
  {&__pyx_n_s_makecanvas, __pyx_k_makecanvas, sizeof(__pyx_k_makecanvas), 0, 0, 1, 1},
  {&__pyx_n_s_math, __pyx_k_math, sizeof(__pyx_k_math), 0, 0, 1, 1},
  {&__pyx_n_s_met, __pyx_k_met, sizeof(__pyx_k_met), 0, 0, 1, 1},
  {&__pyx_n_s_multivariate_normal, __pyx_k_multivariate_normal, sizeof(__pyx_k_multivariate_normal), 0, 0, 1, 1},
  {&__pyx_n_s_myseed, __pyx_k_myseed, sizeof(__pyx_k_myseed), 0, 0, 1, 1},
  {&__pyx_n_s_n, __pyx_k_n, sizeof(__pyx_k_n), 0, 0, 1, 1},
  {&__pyx_n_s_ncap, __pyx_k_ncap, sizeof(__pyx_k_ncap), 0, 0, 1, 1},
  {&__pyx_kp_u_ndarray_is_not_C_contiguous, __pyx_k_ndarray_is_not_C_contiguous, sizeof(__pyx_k_ndarray_is_not_C_contiguous), 0, 1, 0, 0},
  {&__pyx_kp_u_ndarray_is_not_Fortran_contiguou, __pyx_k_ndarray_is_not_Fortran_contiguou, sizeof(__pyx_k_ndarray_is_not_Fortran_contiguou), 0, 1, 0, 0},
  {&__pyx_n_s_normC, __pyx_k_normC, sizeof(__pyx_k_normC), 0, 0, 1, 1},
  {&__pyx_n_s_normS, __pyx_k_normS, sizeof(__pyx_k_normS), 0, 0, 1, 1},
  {&__pyx_n_s_np, __pyx_k_np, sizeof(__pyx_k_np), 0, 0, 1, 1},
  {&__pyx_n_s_numpy, __pyx_k_numpy, sizeof(__pyx_k_numpy), 0, 0, 1, 1},
  {&__pyx_n_s_obj, __pyx_k_obj, sizeof(__pyx_k_obj), 0, 0, 1, 1},
  {&__pyx_n_s_os, __pyx_k_os, sizeof(__pyx_k_os), 0, 0, 1, 1},
  {&__pyx_n_s_p, __pyx_k_p, sizeof(__pyx_k_p), 0, 0, 1, 1},
  {&__pyx_n_s_ph, __pyx_k_ph, sizeof(__pyx_k_ph), 0, 0, 1, 1},
  {&__pyx_n_s_phi, __pyx_k_phi, sizeof(__pyx_k_phi), 0, 0, 1, 1},
  {&__pyx_n_s_phidist, __pyx_k_phidist, sizeof(__pyx_k_phidist), 0, 0, 1, 1},
  {&__pyx_n_s_phimax, __pyx_k_phimax, sizeof(__pyx_k_phimax), 0, 0, 1, 1},
  {&__pyx_n_s_phimin, __pyx_k_phimin, sizeof(__pyx_k_phimin), 0, 0, 1, 1},
  {&__pyx_n_s_pi, __pyx_k_pi, sizeof(__pyx_k_pi), 0, 0, 1, 1},
  {&__pyx_n_s_plantseed, __pyx_k_plantseed, sizeof(__pyx_k_plantseed), 0, 0, 1, 1},
  {&__pyx_n_s_qn_to_aap, __pyx_k_qn_to_aap, sizeof(__pyx_k_qn_to_aap), 0, 0, 1, 1},
  {&__pyx_n_s_r1, __pyx_k_r1, sizeof(__pyx_k_r1), 0, 0, 1, 1},
  {&__pyx_n_s_r2, __pyx_k_r2, sizeof(__pyx_k_r2), 0, 0, 1, 1},
  {&__pyx_n_s_random, __pyx_k_random, sizeof(__pyx_k_random), 0, 0, 1, 1},
  {&__pyx_n_s_range, __pyx_k_range, sizeof(__pyx_k_range), 0, 0, 1, 1},
  {&__pyx_n_s_rm_to_zxz, __pyx_k_rm_to_zxz, sizeof(__pyx_k_rm_to_zxz), 0, 0, 1, 1},
  {&__pyx_n_s_rsign, __pyx_k_rsign, sizeof(__pyx_k_rsign), 0, 0, 1, 1},
  {&__pyx_n_s_s1, __pyx_k_s1, sizeof(__pyx_k_s1), 0, 0, 1, 1},
  {&__pyx_n_s_s2, __pyx_k_s2, sizeof(__pyx_k_s2), 0, 0, 1, 1},
  {&__pyx_n_s_sb, __pyx_k_sb, sizeof(__pyx_k_sb), 0, 0, 1, 1},
  {&__pyx_n_s_seed, __pyx_k_seed, sizeof(__pyx_k_seed), 0, 0, 1, 1},
  {&__pyx_n_s_sin, __pyx_k_sin, sizeof(__pyx_k_sin), 0, 0, 1, 1},
  {&__pyx_n_s_sinn, __pyx_k_sinn, sizeof(__pyx_k_sinn), 0, 0, 1, 1},
  {&__pyx_n_s_slm, __pyx_k_slm, sizeof(__pyx_k_slm), 0, 0, 1, 1},
  {&__pyx_n_s_sp, __pyx_k_sp, sizeof(__pyx_k_sp), 0, 0, 1, 1},
  {&__pyx_n_s_sph, __pyx_k_sph, sizeof(__pyx_k_sph), 0, 0, 1, 1},
  {&__pyx_n_s_sqrt, __pyx_k_sqrt, sizeof(__pyx_k_sqrt), 0, 0, 1, 1},
  {&__pyx_n_s_squ, __pyx_k_squ, sizeof(__pyx_k_squ), 0, 0, 1, 1},
  {&__pyx_n_s_st, __pyx_k_st, sizeof(__pyx_k_st), 0, 0, 1, 1},
  {&__pyx_n_s_sth, __pyx_k_sth, sizeof(__pyx_k_sth), 0, 0, 1, 1},
  {&__pyx_n_s_sthcph, __pyx_k_sthcph, sizeof(__pyx_k_sthcph), 0, 0, 1, 1},
  {&__pyx_n_s_sthsph, __pyx_k_sthsph, sizeof(__pyx_k_sthsph), 0, 0, 1, 1},
  {&__pyx_n_s_sum, __pyx_k_sum, sizeof(__pyx_k_sum), 0, 0, 1, 1},
  {&__pyx_n_s_sys, __pyx_k_sys, sizeof(__pyx_k_sys), 0, 0, 1, 1},
  {&__pyx_n_s_test, __pyx_k_test, sizeof(__pyx_k_test), 0, 0, 1, 1},
  {&__pyx_n_s_th, __pyx_k_th, sizeof(__pyx_k_th), 0, 0, 1, 1},
  {&__pyx_n_s_theta, __pyx_k_theta, sizeof(__pyx_k_theta), 0, 0, 1, 1},
  {&__pyx_n_s_thetadist, __pyx_k_thetadist, sizeof(__pyx_k_thetadist), 0, 0, 1, 1},
  {&__pyx_n_s_thetamax, __pyx_k_thetamax, sizeof(__pyx_k_thetamax), 0, 0, 1, 1},
  {&__pyx_n_s_thetamin, __pyx_k_thetamin, sizeof(__pyx_k_thetamin), 0, 0, 1, 1},
  {&__pyx_n_s_tic, __pyx_k_tic, sizeof(__pyx_k_tic), 0, 0, 1, 1},
  {&__pyx_n_s_time, __pyx_k_time, sizeof(__pyx_k_time), 0, 0, 1, 1},
  {&__pyx_n_s_toc, __pyx_k_toc, sizeof(__pyx_k_toc), 0, 0, 1, 1},
  {&__pyx_n_s_u, __pyx_k_u, sizeof(__pyx_k_u), 0, 0, 1, 1},
  {&__pyx_n_s_u0, __pyx_k_u0, sizeof(__pyx_k_u0), 0, 0, 1, 1},
  {&__pyx_n_s_u1, __pyx_k_u1, sizeof(__pyx_k_u1), 0, 0, 1, 1},
  {&__pyx_n_s_u2, __pyx_k_u2, sizeof(__pyx_k_u2), 0, 0, 1, 1},
  {&__pyx_n_s_uniform, __pyx_k_uniform, sizeof(__pyx_k_uniform), 0, 0, 1, 1},
  {&__pyx_kp_u_unknown_dtype_code_in_numpy_pxd, __pyx_k_unknown_dtype_code_in_numpy_pxd, sizeof(__pyx_k_unknown_dtype_code_in_numpy_pxd), 0, 1, 0, 0},
  {&__pyx_n_s_v1, __pyx_k_v1, sizeof(__pyx_k_v1), 0, 0, 1, 1},
  {&__pyx_n_s_v2, __pyx_k_v2, sizeof(__pyx_k_v2), 0, 0, 1, 1},
  {&__pyx_n_s_v3, __pyx_k_v3, sizeof(__pyx_k_v3), 0, 0, 1, 1},
  {&__pyx_n_s_x1, __pyx_k_x1, sizeof(__pyx_k_x1), 0, 0, 1, 1},
  {&__pyx_n_s_x2, __pyx_k_x2, sizeof(__pyx_k_x2), 0, 0, 1, 1},
  {&__pyx_n_s_x3, __pyx_k_x3, sizeof(__pyx_k_x3), 0, 0, 1, 1},
  {&__pyx_n_s_xc, __pyx_k_xc, sizeof(__pyx_k_xc), 0, 0, 1, 1},
  {&__pyx_n_s_xs, __pyx_k_xs, sizeof(__pyx_k_xs), 0, 0, 1, 1},
  {&__pyx_n_s_yc, __pyx_k_yc, sizeof(__pyx_k_yc), 0, 0, 1, 1},
  {&__pyx_n_s_ys, __pyx_k_ys, sizeof(__pyx_k_ys), 0, 0, 1, 1},
  {&__pyx_n_s_zc, __pyx_k_zc, sizeof(__pyx_k_zc), 0, 0, 1, 1},
  {&__pyx_n_s_zeros, __pyx_k_zeros, sizeof(__pyx_k_zeros), 0, 0, 1, 1},
  {&__pyx_n_s_zs, __pyx_k_zs, sizeof(__pyx_k_zs), 0, 0, 1, 1},
  {&__pyx_n_s_zxz_to_rm, __pyx_k_zxz_to_rm, sizeof(__pyx_k_zxz_to_rm), 0, 0, 1, 1},
  {0, 0, 0, 0, 0, 0, 0}
};
static int __Pyx_InitCachedBuiltins(void) {
  __pyx_builtin_range = __Pyx_GetBuiltinName(__pyx_n_s_range); if (!__pyx_builtin_range) __PYX_ERR(0, 76, __pyx_L1_error)
  __pyx_builtin_ValueError = __Pyx_GetBuiltinName(__pyx_n_s_ValueError); if (!__pyx_builtin_ValueError) __PYX_ERR(1, 218, __pyx_L1_error)
  __pyx_builtin_RuntimeError = __Pyx_GetBuiltinName(__pyx_n_s_RuntimeError); if (!__pyx_builtin_RuntimeError) __PYX_ERR(1, 799, __pyx_L1_error)
  return 0;
  __pyx_L1_error:;
  return -1;
}

static int __Pyx_InitCachedConstants(void) {
  __Pyx_RefNannyDeclarations
  __Pyx_RefNannySetupContext("__Pyx_InitCachedConstants", 0);

  /* "libTEXTURIZE.pyx":52
 *     cdef np.ndarray[np.float64_t, ndim = 1] theta = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] phi = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(3, dtype=np.float64)
 */
  __pyx_tuple_ = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple_)) __PYX_ERR(0, 52, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple_);
  __Pyx_GIVEREF(__pyx_tuple_);

  /* "libTEXTURIZE.pyx":53
 *     cdef np.ndarray[np.float64_t, ndim = 1] phi = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(3, dtype=np.float64)
 */
  __pyx_tuple__2 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__2)) __PYX_ERR(0, 53, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__2);
  __Pyx_GIVEREF(__pyx_tuple__2);

  /* "libTEXTURIZE.pyx":54
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zc = np.zeros(3, dtype=np.float64)
 */
  __pyx_tuple__3 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 54, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__3);
  __Pyx_GIVEREF(__pyx_tuple__3);

  /* "libTEXTURIZE.pyx":55
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zc = np.zeros(3, dtype=np.float64)
 * 
 */
  __pyx_tuple__4 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__4)) __PYX_ERR(0, 55, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__4);
  __Pyx_GIVEREF(__pyx_tuple__4);

  /* "libTEXTURIZE.pyx":56
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zc = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 * 
 *     # DESCRIPTORS OF ORIENTATIONS
 */
  __pyx_tuple__5 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__5)) __PYX_ERR(0, 56, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__5);
  __Pyx_GIVEREF(__pyx_tuple__5);

  /* "libTEXTURIZE.pyx":154
 *     cdef np.ndarray[np.float64_t, ndim = 1] theta = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] phi = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] ncap = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 */
  __pyx_tuple__6 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__6)) __PYX_ERR(0, 154, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__6);
  __Pyx_GIVEREF(__pyx_tuple__6);

  /* "libTEXTURIZE.pyx":155
 *     cdef np.ndarray[np.float64_t, ndim = 1] phi = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] ncap = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xp = np.zeros(3, dtype=np.float64)
 */
  __pyx_tuple__7 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 155, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__7);
  __Pyx_GIVEREF(__pyx_tuple__7);

  /* "libTEXTURIZE.pyx":156
 *     cdef np.ndarray[np.float64_t, ndim = 1] ncap = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xp = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yp = np.zeros(3, dtype=np.float64)
 */
  __pyx_tuple__8 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__8)) __PYX_ERR(0, 156, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__8);
  __Pyx_GIVEREF(__pyx_tuple__8);

  /* "libTEXTURIZE.pyx":157
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xp = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yp = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zp = np.zeros(3, dtype=np.float64)
 */
  __pyx_tuple__9 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__9)) __PYX_ERR(0, 157, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__9);
  __Pyx_GIVEREF(__pyx_tuple__9);

  /* "libTEXTURIZE.pyx":158
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xp = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yp = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zp = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(p, dtype=np.float64)
 */
  __pyx_tuple__10 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__10)) __PYX_ERR(0, 158, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__10);
  __Pyx_GIVEREF(__pyx_tuple__10);

  /* "libTEXTURIZE.pyx":159
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xp = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yp = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zp = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(p, dtype=np.float64)
 */
  __pyx_tuple__11 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__11)) __PYX_ERR(0, 159, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__11);
  __Pyx_GIVEREF(__pyx_tuple__11);

  /* "libTEXTURIZE.pyx":298
 *     cdef np.ndarray[np.float64_t, ndim = 1] U = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] lambdaa = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] R = np.zeros((3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] H = np.zeros((3, 3), dtype=np.float64)
 */
  __pyx_tuple__12 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 298, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__12);
  __Pyx_GIVEREF(__pyx_tuple__12);

  /* "libTEXTURIZE.pyx":299
 *     cdef np.ndarray[np.float64_t, ndim = 1] lambdaa = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] R = np.zeros((3, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] H = np.zeros((3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] EYE = np.zeros((3, 3), dtype=np.float64)
 */
  __pyx_tuple__13 = PyTuple_Pack(2, __pyx_int_3, __pyx_int_3); if (unlikely(!__pyx_tuple__13)) __PYX_ERR(0, 299, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__13);
  __Pyx_GIVEREF(__pyx_tuple__13);
  __pyx_tuple__14 = PyTuple_Pack(1, __pyx_tuple__13); if (unlikely(!__pyx_tuple__14)) __PYX_ERR(0, 299, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__14);
  __Pyx_GIVEREF(__pyx_tuple__14);

  /* "libTEXTURIZE.pyx":300
 *     cdef np.ndarray[np.float64_t, ndim = 1] V = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] R = np.zeros((3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] H = np.zeros((3, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] EYE = np.zeros((3, 3), dtype=np.float64)
 *     EYE = np.eye(3)
 */
  __pyx_tuple__15 = PyTuple_Pack(2, __pyx_int_3, __pyx_int_3); if (unlikely(!__pyx_tuple__15)) __PYX_ERR(0, 300, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__15);
  __Pyx_GIVEREF(__pyx_tuple__15);
  __pyx_tuple__16 = PyTuple_Pack(1, __pyx_tuple__15); if (unlikely(!__pyx_tuple__16)) __PYX_ERR(0, 300, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__16);
  __Pyx_GIVEREF(__pyx_tuple__16);

  /* "libTEXTURIZE.pyx":301
 *     cdef np.ndarray[np.float64_t, ndim = 2] R = np.zeros((3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] H = np.zeros((3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] EYE = np.zeros((3, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     EYE = np.eye(3)
 * 
 */
  __pyx_tuple__17 = PyTuple_Pack(2, __pyx_int_3, __pyx_int_3); if (unlikely(!__pyx_tuple__17)) __PYX_ERR(0, 301, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__17);
  __Pyx_GIVEREF(__pyx_tuple__17);
  __pyx_tuple__18 = PyTuple_Pack(1, __pyx_tuple__17); if (unlikely(!__pyx_tuple__18)) __PYX_ERR(0, 301, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__18);
  __Pyx_GIVEREF(__pyx_tuple__18);

  /* "libTEXTURIZE.pyx":302
 *     cdef np.ndarray[np.float64_t, ndim = 2] H = np.zeros((3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] EYE = np.zeros((3, 3), dtype=np.float64)
 *     EYE = np.eye(3)             # <<<<<<<<<<<<<<
 * 
 *     # DESCRIPTORS OF ORIENTATIONS
 */
  __pyx_tuple__19 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__19)) __PYX_ERR(0, 302, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__19);
  __Pyx_GIVEREF(__pyx_tuple__19);

  /* "libTEXTURIZE.pyx":399
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V3 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] EYE = np.zeros((3, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     EYE = np.eye(3)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(p, dtype=np.float64)
 */
  __pyx_tuple__20 = PyTuple_Pack(2, __pyx_int_3, __pyx_int_3); if (unlikely(!__pyx_tuple__20)) __PYX_ERR(0, 399, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__20);
  __Pyx_GIVEREF(__pyx_tuple__20);
  __pyx_tuple__21 = PyTuple_Pack(1, __pyx_tuple__20); if (unlikely(!__pyx_tuple__21)) __PYX_ERR(0, 399, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__21);
  __Pyx_GIVEREF(__pyx_tuple__21);

  /* "libTEXTURIZE.pyx":400
 *     cdef np.ndarray[np.float64_t, ndim = 1] V3 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] EYE = np.zeros((3, 3), dtype=np.float64)
 *     EYE = np.eye(3)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(p, dtype=np.float64)
 */
  __pyx_tuple__22 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__22)) __PYX_ERR(0, 400, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__22);
  __Pyx_GIVEREF(__pyx_tuple__22);

  /* "libTEXTURIZE.pyx":696
 * 
 * 
 *     Eul[0:, 0] = np.random.uniform(0, 2 * pi, [p, ])             # <<<<<<<<<<<<<<
 *     r1 = np.random.uniform(0, 1, [p, ])
 *     Eul[0:, 1] = np.arccos(2 * r1 - 1)
 */
  __pyx_slice__23 = PySlice_New(__pyx_int_0, Py_None, Py_None); if (unlikely(!__pyx_slice__23)) __PYX_ERR(0, 696, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__23);
  __Pyx_GIVEREF(__pyx_slice__23);
  __pyx_tuple__24 = PyTuple_Pack(2, __pyx_slice__23, __pyx_int_0); if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 696, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__24);
  __Pyx_GIVEREF(__pyx_tuple__24);

  /* "libTEXTURIZE.pyx":698
 *     Eul[0:, 0] = np.random.uniform(0, 2 * pi, [p, ])
 *     r1 = np.random.uniform(0, 1, [p, ])
 *     Eul[0:, 1] = np.arccos(2 * r1 - 1)             # <<<<<<<<<<<<<<
 *     Eul[0:, 2] = np.random.uniform(0, 2 * pi, [p, ])
 * 
 */
  __pyx_slice__25 = PySlice_New(__pyx_int_0, Py_None, Py_None); if (unlikely(!__pyx_slice__25)) __PYX_ERR(0, 698, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__25);
  __Pyx_GIVEREF(__pyx_slice__25);
  __pyx_tuple__26 = PyTuple_Pack(2, __pyx_slice__25, __pyx_int_1); if (unlikely(!__pyx_tuple__26)) __PYX_ERR(0, 698, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__26);
  __Pyx_GIVEREF(__pyx_tuple__26);

  /* "libTEXTURIZE.pyx":699
 *     r1 = np.random.uniform(0, 1, [p, ])
 *     Eul[0:, 1] = np.arccos(2 * r1 - 1)
 *     Eul[0:, 2] = np.random.uniform(0, 2 * pi, [p, ])             # <<<<<<<<<<<<<<
 * 
 *     Rot = conv.zxz_to_rm(Eul)
 */
  __pyx_slice__27 = PySlice_New(__pyx_int_0, Py_None, Py_None); if (unlikely(!__pyx_slice__27)) __PYX_ERR(0, 699, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__27);
  __Pyx_GIVEREF(__pyx_slice__27);
  __pyx_tuple__28 = PyTuple_Pack(2, __pyx_slice__27, __pyx_int_2); if (unlikely(!__pyx_tuple__28)) __PYX_ERR(0, 699, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__28);
  __Pyx_GIVEREF(__pyx_tuple__28);

  /* "libTEXTURIZE.pyx":742
 *     cdef np.ndarray[np.float64_t, ndim = 1] Lambdaa = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Phi = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X1C = np.zeros(3, dtype=np.float64)
 */
  __pyx_tuple__29 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 742, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__29);
  __Pyx_GIVEREF(__pyx_tuple__29);

  /* "libTEXTURIZE.pyx":743
 *     cdef np.ndarray[np.float64_t, ndim = 1] Phi = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] X1C = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X2C = np.zeros(3, dtype=np.float64)
 */
  __pyx_tuple__30 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__30)) __PYX_ERR(0, 743, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__30);
  __Pyx_GIVEREF(__pyx_tuple__30);

  /* "libTEXTURIZE.pyx":744
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X1C = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] X2C = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3C = np.zeros(3, dtype=np.float64)
 */
  __pyx_tuple__31 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 744, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__31);
  __Pyx_GIVEREF(__pyx_tuple__31);

  /* "libTEXTURIZE.pyx":745
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X1C = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X2C = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3C = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X1S = np.zeros(3, dtype=np.float64)
 */
  __pyx_tuple__32 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__32)) __PYX_ERR(0, 745, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__32);
  __Pyx_GIVEREF(__pyx_tuple__32);

  /* "libTEXTURIZE.pyx":746
 *     cdef np.ndarray[np.float64_t, ndim = 1] X1C = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X2C = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3C = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] X1S = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X2S = np.zeros(3, dtype=np.float64)
 */
  __pyx_tuple__33 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__33)) __PYX_ERR(0, 746, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__33);
  __Pyx_GIVEREF(__pyx_tuple__33);

  /* "libTEXTURIZE.pyx":747
 *     cdef np.ndarray[np.float64_t, ndim = 1] X2C = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3C = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X1S = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] X2S = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3S = np.zeros(3, dtype=np.float64)
 */
  __pyx_tuple__34 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__34)) __PYX_ERR(0, 747, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__34);
  __Pyx_GIVEREF(__pyx_tuple__34);

  /* "libTEXTURIZE.pyx":748
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3C = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X1S = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X2S = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3S = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux1 = np.zeros(3, dtype=np.float64)
 */
  __pyx_tuple__35 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 748, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__35);
  __Pyx_GIVEREF(__pyx_tuple__35);

  /* "libTEXTURIZE.pyx":749
 *     cdef np.ndarray[np.float64_t, ndim = 1] X1S = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X2S = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3S = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux2 = np.zeros(3, dtype=np.float64)
 */
  __pyx_tuple__36 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__36)) __PYX_ERR(0, 749, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__36);
  __Pyx_GIVEREF(__pyx_tuple__36);

  /* "libTEXTURIZE.pyx":750
 *     cdef np.ndarray[np.float64_t, ndim = 1] X2S = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3S = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux1 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux3 = np.zeros(3, dtype=np.float64)
 */
  __pyx_tuple__37 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__37)) __PYX_ERR(0, 750, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__37);
  __Pyx_GIVEREF(__pyx_tuple__37);

  /* "libTEXTURIZE.pyx":751
 *     cdef np.ndarray[np.float64_t, ndim = 1] X3S = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux2 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux3 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux1 = np.zeros(3, dtype=np.float64)
 */
  __pyx_tuple__38 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__38)) __PYX_ERR(0, 751, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__38);
  __Pyx_GIVEREF(__pyx_tuple__38);

  /* "libTEXTURIZE.pyx":752
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux3 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux2 = np.zeros(3, dtype=np.float64)
 */
  __pyx_tuple__39 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__39)) __PYX_ERR(0, 752, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__39);
  __Pyx_GIVEREF(__pyx_tuple__39);

  /* "libTEXTURIZE.pyx":753
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux3 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux1 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux3 = np.zeros(3, dtype=np.float64)
 */
  __pyx_tuple__40 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__40)) __PYX_ERR(0, 753, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__40);
  __Pyx_GIVEREF(__pyx_tuple__40);

  /* "libTEXTURIZE.pyx":754
 *     cdef np.ndarray[np.float64_t, ndim = 1] aux3 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux2 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux3 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] PHI1 = np.zeros(p, dtype=np.float64)
 */
  __pyx_tuple__41 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__41)) __PYX_ERR(0, 754, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__41);
  __Pyx_GIVEREF(__pyx_tuple__41);

  /* "libTEXTURIZE.pyx":755
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Aux3 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] PHI1 = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] PHI2 = np.zeros(p, dtype=np.float64)
 */
  __pyx_tuple__42 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__42)) __PYX_ERR(0, 755, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__42);
  __Pyx_GIVEREF(__pyx_tuple__42);

  /* "libTEXTURIZE.pyx":941
 *     theta = met.INVCDF1D(thetadist, thetamin, thetamax, p)
 *     phi = met.INVCDF1D(phidist, phimin, phimax, p)
 *     Axis[:, 0] = np.sin(theta) * np.cos(phi)             # <<<<<<<<<<<<<<
 *     Axis[:, 1] = np.sin(theta) * np.sin(phi)
 *     Axis[:, 2] = np.cos(theta)
 */
  __pyx_slice__43 = PySlice_New(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__43)) __PYX_ERR(0, 941, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__43);
  __Pyx_GIVEREF(__pyx_slice__43);
  __pyx_tuple__44 = PyTuple_Pack(2, __pyx_slice__43, __pyx_int_0); if (unlikely(!__pyx_tuple__44)) __PYX_ERR(0, 941, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__44);
  __Pyx_GIVEREF(__pyx_tuple__44);

  /* "libTEXTURIZE.pyx":942
 *     phi = met.INVCDF1D(phidist, phimin, phimax, p)
 *     Axis[:, 0] = np.sin(theta) * np.cos(phi)
 *     Axis[:, 1] = np.sin(theta) * np.sin(phi)             # <<<<<<<<<<<<<<
 *     Axis[:, 2] = np.cos(theta)
 *     Roo = conv.zxz_to_rm(np.array([[eul1], [eul], [eul2]]).T)
 */
  __pyx_slice__45 = PySlice_New(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__45)) __PYX_ERR(0, 942, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__45);
  __Pyx_GIVEREF(__pyx_slice__45);
  __pyx_tuple__46 = PyTuple_Pack(2, __pyx_slice__45, __pyx_int_1); if (unlikely(!__pyx_tuple__46)) __PYX_ERR(0, 942, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__46);
  __Pyx_GIVEREF(__pyx_tuple__46);

  /* "libTEXTURIZE.pyx":943
 *     Axis[:, 0] = np.sin(theta) * np.cos(phi)
 *     Axis[:, 1] = np.sin(theta) * np.sin(phi)
 *     Axis[:, 2] = np.cos(theta)             # <<<<<<<<<<<<<<
 *     Roo = conv.zxz_to_rm(np.array([[eul1], [eul], [eul2]]).T)
 *     Ro = Roo[0, :, :]
 */
  __pyx_slice__47 = PySlice_New(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__47)) __PYX_ERR(0, 943, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__47);
  __Pyx_GIVEREF(__pyx_slice__47);
  __pyx_tuple__48 = PyTuple_Pack(2, __pyx_slice__47, __pyx_int_2); if (unlikely(!__pyx_tuple__48)) __PYX_ERR(0, 943, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__48);
  __Pyx_GIVEREF(__pyx_tuple__48);

  /* "libTEXTURIZE.pyx":945
 *     Axis[:, 2] = np.cos(theta)
 *     Roo = conv.zxz_to_rm(np.array([[eul1], [eul], [eul2]]).T)
 *     Ro = Roo[0, :, :]             # <<<<<<<<<<<<<<
 *     delR = conv.aap_to_rm(Axis, Angle)
 * 
 */
  __pyx_slice__49 = PySlice_New(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__49)) __PYX_ERR(0, 945, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__49);
  __Pyx_GIVEREF(__pyx_slice__49);
  __pyx_slice__50 = PySlice_New(Py_None, Py_None, Py_None); if (unlikely(!__pyx_slice__50)) __PYX_ERR(0, 945, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_slice__50);
  __Pyx_GIVEREF(__pyx_slice__50);
  __pyx_tuple__51 = PyTuple_Pack(3, __pyx_int_0, __pyx_slice__49, __pyx_slice__50); if (unlikely(!__pyx_tuple__51)) __PYX_ERR(0, 945, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__51);
  __Pyx_GIVEREF(__pyx_tuple__51);

  /* "libTEXTURIZE.pyx":982
 *     cdef np.ndarray[np.float64_t, ndim = 1] lambdaa = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] phi = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(3, dtype=np.float64)
 */
  __pyx_tuple__52 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__52)) __PYX_ERR(0, 982, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__52);
  __Pyx_GIVEREF(__pyx_tuple__52);

  /* "libTEXTURIZE.pyx":983
 *     cdef np.ndarray[np.float64_t, ndim = 1] phi = np.zeros(p, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(3, dtype=np.float64)
 */
  __pyx_tuple__53 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__53)) __PYX_ERR(0, 983, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__53);
  __Pyx_GIVEREF(__pyx_tuple__53);

  /* "libTEXTURIZE.pyx":984
 *     cdef np.ndarray[np.float64_t, ndim = 1] V1 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zc = np.zeros(3, dtype=np.float64)
 */
  __pyx_tuple__54 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__54)) __PYX_ERR(0, 984, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__54);
  __Pyx_GIVEREF(__pyx_tuple__54);

  /* "libTEXTURIZE.pyx":985
 *     cdef np.ndarray[np.float64_t, ndim = 1] V2 = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zc = np.zeros(3, dtype=np.float64)
 * 
 */
  __pyx_tuple__55 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__55)) __PYX_ERR(0, 985, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__55);
  __Pyx_GIVEREF(__pyx_tuple__55);

  /* "libTEXTURIZE.pyx":986
 *     cdef np.ndarray[np.float64_t, ndim = 1] Xc = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Yc = np.zeros(3, dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 1] Zc = np.zeros(3, dtype=np.float64)             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_tuple__56 = PyTuple_Pack(1, __pyx_int_3); if (unlikely(!__pyx_tuple__56)) __PYX_ERR(0, 986, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__56);
  __Pyx_GIVEREF(__pyx_tuple__56);

  /* "libTEXTURIZE.pyx":991
 *     # DESCRIPTORS OF ORIENTATIONS
 *     cdef np.ndarray[np.float64_t, ndim = 3] Rot = np.zeros((p, 3, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] delR = np.zeros((3, 3), dtype=np.float64)             # <<<<<<<<<<<<<<
 *     cdef np.ndarray[np.float64_t, ndim = 2] Eul = np.zeros((p, 3), dtype=np.float64)
 *     cdef np.ndarray[np.float64_t, ndim = 2] Axis = np.zeros((p, 3), dtype=np.float64)
 */
  __pyx_tuple__57 = PyTuple_Pack(2, __pyx_int_3, __pyx_int_3); if (unlikely(!__pyx_tuple__57)) __PYX_ERR(0, 991, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__57);
  __Pyx_GIVEREF(__pyx_tuple__57);
  __pyx_tuple__58 = PyTuple_Pack(1, __pyx_tuple__57); if (unlikely(!__pyx_tuple__58)) __PYX_ERR(0, 991, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__58);
  __Pyx_GIVEREF(__pyx_tuple__58);

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":218
 *             if ((flags & pybuf.PyBUF_C_CONTIGUOUS == pybuf.PyBUF_C_CONTIGUOUS)
 *                 and not PyArray_CHKFLAGS(self, NPY_C_CONTIGUOUS)):
 *                 raise ValueError(u"ndarray is not C contiguous")             # <<<<<<<<<<<<<<
 * 
 *             if ((flags & pybuf.PyBUF_F_CONTIGUOUS == pybuf.PyBUF_F_CONTIGUOUS)
 */
  __pyx_tuple__59 = PyTuple_Pack(1, __pyx_kp_u_ndarray_is_not_C_contiguous); if (unlikely(!__pyx_tuple__59)) __PYX_ERR(1, 218, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__59);
  __Pyx_GIVEREF(__pyx_tuple__59);

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":222
 *             if ((flags & pybuf.PyBUF_F_CONTIGUOUS == pybuf.PyBUF_F_CONTIGUOUS)
 *                 and not PyArray_CHKFLAGS(self, NPY_F_CONTIGUOUS)):
 *                 raise ValueError(u"ndarray is not Fortran contiguous")             # <<<<<<<<<<<<<<
 * 
 *             info.buf = PyArray_DATA(self)
 */
  __pyx_tuple__60 = PyTuple_Pack(1, __pyx_kp_u_ndarray_is_not_Fortran_contiguou); if (unlikely(!__pyx_tuple__60)) __PYX_ERR(1, 222, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__60);
  __Pyx_GIVEREF(__pyx_tuple__60);

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":259
 *                 if ((descr.byteorder == c'>' and little_endian) or
 *                     (descr.byteorder == c'<' and not little_endian)):
 *                     raise ValueError(u"Non-native byte order not supported")             # <<<<<<<<<<<<<<
 *                 if   t == NPY_BYTE:        f = "b"
 *                 elif t == NPY_UBYTE:       f = "B"
 */
  __pyx_tuple__61 = PyTuple_Pack(1, __pyx_kp_u_Non_native_byte_order_not_suppor); if (unlikely(!__pyx_tuple__61)) __PYX_ERR(1, 259, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__61);
  __Pyx_GIVEREF(__pyx_tuple__61);

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":799
 * 
 *         if (end - f) - <int>(new_offset - offset[0]) < 15:
 *             raise RuntimeError(u"Format string allocated too short, see comment in numpy.pxd")             # <<<<<<<<<<<<<<
 * 
 *         if ((child.byteorder == c'>' and little_endian) or
 */
  __pyx_tuple__62 = PyTuple_Pack(1, __pyx_kp_u_Format_string_allocated_too_shor); if (unlikely(!__pyx_tuple__62)) __PYX_ERR(1, 799, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__62);
  __Pyx_GIVEREF(__pyx_tuple__62);

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":803
 *         if ((child.byteorder == c'>' and little_endian) or
 *             (child.byteorder == c'<' and not little_endian)):
 *             raise ValueError(u"Non-native byte order not supported")             # <<<<<<<<<<<<<<
 *             # One could encode it in the format string and have Cython
 *             # complain instead, BUT: < and > in format strings also imply
 */
  __pyx_tuple__63 = PyTuple_Pack(1, __pyx_kp_u_Non_native_byte_order_not_suppor); if (unlikely(!__pyx_tuple__63)) __PYX_ERR(1, 803, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__63);
  __Pyx_GIVEREF(__pyx_tuple__63);

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":823
 *             t = child.type_num
 *             if end - f < 5:
 *                 raise RuntimeError(u"Format string allocated too short.")             # <<<<<<<<<<<<<<
 * 
 *             # Until ticket #99 is fixed, use integers to avoid warnings
 */
  __pyx_tuple__64 = PyTuple_Pack(1, __pyx_kp_u_Format_string_allocated_too_shor_2); if (unlikely(!__pyx_tuple__64)) __PYX_ERR(1, 823, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__64);
  __Pyx_GIVEREF(__pyx_tuple__64);

  /* "libTEXTURIZE.pyx":33
 * cdef float tpi = 2 * np.pi
 * 
 * def plantseed(myseed):             # <<<<<<<<<<<<<<
 *     if myseed > 0:
 *         np.random.seed(myseed)
 */
  __pyx_tuple__65 = PyTuple_Pack(1, __pyx_n_s_myseed); if (unlikely(!__pyx_tuple__65)) __PYX_ERR(0, 33, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__65);
  __Pyx_GIVEREF(__pyx_tuple__65);
  __pyx_codeobj__66 = (PyObject*)__Pyx_PyCode_New(1, 0, 1, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__65, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_E_Dropbox_Public_PhDResources_10, __pyx_n_s_plantseed, 33, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__66)) __PYX_ERR(0, 33, __pyx_L1_error)

  /* "libTEXTURIZE.pyx":38
 *         random.seed(myseed)
 * 
 * def Texture_URO_xyz(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */
  __pyx_tuple__67 = PyTuple_Pack(35, __pyx_n_s_obj, __pyx_n_s_myseed, __pyx_n_s_p, __pyx_n_s_m, __pyx_n_s_n, __pyx_n_s_makecanvas, __pyx_n_s_tic, __pyx_n_s_toc, __pyx_n_s_i, __pyx_n_s_th, __pyx_n_s_ph, __pyx_n_s_lm, __pyx_n_s_sth, __pyx_n_s_sph, __pyx_n_s_cth, __pyx_n_s_cph, __pyx_n_s_clm, __pyx_n_s_slm, __pyx_n_s_r1, __pyx_n_s_lambdaa, __pyx_n_s_theta, __pyx_n_s_phi, __pyx_n_s_V1, __pyx_n_s_V2, __pyx_n_s_Xc, __pyx_n_s_Yc, __pyx_n_s_Zc, __pyx_n_s_Rot, __pyx_n_s_Eul, __pyx_n_s_Axis, __pyx_n_s_Angle, __pyx_n_s_Nd, __pyx_n_s_Rd, __pyx_n_s_Rv, __pyx_n_s_Q); if (unlikely(!__pyx_tuple__67)) __PYX_ERR(0, 38, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__67);
  __Pyx_GIVEREF(__pyx_tuple__67);
  __pyx_codeobj__68 = (PyObject*)__Pyx_PyCode_New(1, 0, 35, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__67, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_E_Dropbox_Public_PhDResources_10, __pyx_n_s_Texture_URO_xyz, 38, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__68)) __PYX_ERR(0, 38, __pyx_L1_error)

  /* "libTEXTURIZE.pyx":139
 * 
 * 
 * def Texture_URO_nxyz(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */
  __pyx_tuple__69 = PyTuple_Pack(44, __pyx_n_s_obj, __pyx_n_s_myseed, __pyx_n_s_p, __pyx_n_s_m, __pyx_n_s_n, __pyx_n_s_makecanvas, __pyx_n_s_tic, __pyx_n_s_toc, __pyx_n_s_i, __pyx_n_s_th, __pyx_n_s_ph, __pyx_n_s_lm, __pyx_n_s_sth, __pyx_n_s_sph, __pyx_n_s_cth, __pyx_n_s_cph, __pyx_n_s_clm, __pyx_n_s_slm, __pyx_n_s_coss, __pyx_n_s_sinn, __pyx_n_s_cossncap0, __pyx_n_s_cossncap1, __pyx_n_s_cossncap2, __pyx_n_s_r1, __pyx_n_s_lambdaa, __pyx_n_s_theta, __pyx_n_s_phi, __pyx_n_s_ncap, __pyx_n_s_V1, __pyx_n_s_V2, __pyx_n_s_Xp, __pyx_n_s_Yp, __pyx_n_s_Zp, __pyx_n_s_Xc, __pyx_n_s_Yc, __pyx_n_s_Zc, __pyx_n_s_Rot, __pyx_n_s_Eul, __pyx_n_s_Axis, __pyx_n_s_Angle, __pyx_n_s_Nd, __pyx_n_s_Rd, __pyx_n_s_Rv, __pyx_n_s_Q); if (unlikely(!__pyx_tuple__69)) __PYX_ERR(0, 139, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__69);
  __Pyx_GIVEREF(__pyx_tuple__69);
  __pyx_codeobj__70 = (PyObject*)__Pyx_PyCode_New(1, 0, 44, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__69, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_E_Dropbox_Public_PhDResources_10, __pyx_n_s_Texture_URO_nxyz, 139, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__70)) __PYX_ERR(0, 139, __pyx_L1_error)

  /* "libTEXTURIZE.pyx":283
 * 
 * 
 * def Texture_URO_arvo(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */
  __pyx_tuple__71 = PyTuple_Pack(37, __pyx_n_s_obj, __pyx_n_s_myseed, __pyx_n_s_p, __pyx_n_s_m, __pyx_n_s_n, __pyx_n_s_makecanvas, __pyx_n_s_tic, __pyx_n_s_toc, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_l, __pyx_n_s_ph, __pyx_n_s_lm, __pyx_n_s_sph, __pyx_n_s_cph, __pyx_n_s_clm, __pyx_n_s_slm, __pyx_n_s_squ, __pyx_n_s_sum, __pyx_n_s_u, __pyx_n_s_rsign, __pyx_n_s_phi, __pyx_n_s_U, __pyx_n_s_lambdaa, __pyx_n_s_V, __pyx_n_s_R, __pyx_n_s_H, __pyx_n_s_EYE, __pyx_n_s_Rot, __pyx_n_s_Eul, __pyx_n_s_Axis, __pyx_n_s_Angle, __pyx_n_s_Nd, __pyx_n_s_Rd, __pyx_n_s_Rv, __pyx_n_s_Q); if (unlikely(!__pyx_tuple__71)) __PYX_ERR(0, 283, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__71);
  __Pyx_GIVEREF(__pyx_tuple__71);
  __pyx_codeobj__72 = (PyObject*)__Pyx_PyCode_New(1, 0, 37, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__71, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_E_Dropbox_Public_PhDResources_10, __pyx_n_s_Texture_URO_arvo, 283, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__72)) __PYX_ERR(0, 283, __pyx_L1_error)

  /* "libTEXTURIZE.pyx":383
 * 
 * 
 * def Texture_URO_mack(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */
  __pyx_tuple__73 = PyTuple_Pack(37, __pyx_n_s_obj, __pyx_n_s_myseed, __pyx_n_s_p, __pyx_n_s_m, __pyx_n_s_n, __pyx_n_s_makecanvas, __pyx_n_s_tic, __pyx_n_s_toc, __pyx_n_s_k, __pyx_n_s_x1, __pyx_n_s_x2, __pyx_n_s_x3, __pyx_n_s_v1, __pyx_n_s_v2, __pyx_n_s_v3, __pyx_n_s_S, __pyx_n_s_T, __pyx_n_s_P, __pyx_n_s_SQ, __pyx_n_s_X1, __pyx_n_s_X2, __pyx_n_s_X3, __pyx_n_s_V1, __pyx_n_s_V2, __pyx_n_s_V3, __pyx_n_s_EYE, __pyx_n_s_Xc, __pyx_n_s_Yc, __pyx_n_s_Zc, __pyx_n_s_Rot, __pyx_n_s_Eul, __pyx_n_s_Axis, __pyx_n_s_Angle, __pyx_n_s_Nd, __pyx_n_s_Rd, __pyx_n_s_Rv, __pyx_n_s_Q); if (unlikely(!__pyx_tuple__73)) __PYX_ERR(0, 383, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__73);
  __Pyx_GIVEREF(__pyx_tuple__73);
  __pyx_codeobj__74 = (PyObject*)__Pyx_PyCode_New(1, 0, 37, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__73, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_E_Dropbox_Public_PhDResources_10, __pyx_n_s_Texture_URO_mack, 383, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__74)) __PYX_ERR(0, 383, __pyx_L1_error)

  /* "libTEXTURIZE.pyx":477
 * 
 * 
 * def Texture_URO_sm1(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */
  __pyx_tuple__75 = PyTuple_Pack(31, __pyx_n_s_obj, __pyx_n_s_myseed, __pyx_n_s_p, __pyx_n_s_m, __pyx_n_s_n, __pyx_n_s_makecanvas, __pyx_n_s_tic, __pyx_n_s_toc, __pyx_n_s_k, __pyx_n_s_u0, __pyx_n_s_u1, __pyx_n_s_u2, __pyx_n_s_c1, __pyx_n_s_s1, __pyx_n_s_c2, __pyx_n_s_s2, __pyx_n_s_r1, __pyx_n_s_r2, __pyx_n_s_gamma1, __pyx_n_s_gamma2, __pyx_n_s_U0, __pyx_n_s_U1, __pyx_n_s_U2, __pyx_n_s_Rot, __pyx_n_s_Eul, __pyx_n_s_Axis, __pyx_n_s_Angle, __pyx_n_s_Nd, __pyx_n_s_Rd, __pyx_n_s_Rv, __pyx_n_s_Q); if (unlikely(!__pyx_tuple__75)) __PYX_ERR(0, 477, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__75);
  __Pyx_GIVEREF(__pyx_tuple__75);
  __pyx_codeobj__76 = (PyObject*)__Pyx_PyCode_New(1, 0, 31, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__75, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_E_Dropbox_Public_PhDResources_10, __pyx_n_s_Texture_URO_sm1, 477, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__76)) __PYX_ERR(0, 477, __pyx_L1_error)

  /* "libTEXTURIZE.pyx":543
 * 
 * 
 * def Texture_URO_sm2(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */
  __pyx_tuple__77 = PyTuple_Pack(30, __pyx_n_s_obj, __pyx_n_s_myseed, __pyx_n_s_p, __pyx_n_s_m, __pyx_n_s_n, __pyx_n_s_makecanvas, __pyx_n_s_tic, __pyx_n_s_toc, __pyx_n_s_k, __pyx_n_s_beta, __pyx_n_s_theta, __pyx_n_s_phi, __pyx_n_s_cb, __pyx_n_s_sb, __pyx_n_s_st, __pyx_n_s_cp, __pyx_n_s_sp, __pyx_n_s_ct, __pyx_n_s_r1, __pyx_n_s_Beta, __pyx_n_s_Theta, __pyx_n_s_Phi, __pyx_n_s_Rot, __pyx_n_s_Eul, __pyx_n_s_Axis, __pyx_n_s_Angle, __pyx_n_s_Nd, __pyx_n_s_Rd, __pyx_n_s_Rv, __pyx_n_s_Q); if (unlikely(!__pyx_tuple__77)) __PYX_ERR(0, 543, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__77);
  __Pyx_GIVEREF(__pyx_tuple__77);
  __pyx_codeobj__78 = (PyObject*)__Pyx_PyCode_New(1, 0, 30, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__77, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_E_Dropbox_Public_PhDResources_10, __pyx_n_s_Texture_URO_sm2, 543, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__78)) __PYX_ERR(0, 543, __pyx_L1_error)

  /* "libTEXTURIZE.pyx":610
 *     return obj
 * 
 * def Texture_URO_miles(obj):  # AXIS ANGLE PAIRS             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */
  __pyx_tuple__79 = PyTuple_Pack(26, __pyx_n_s_obj, __pyx_n_s_myseed, __pyx_n_s_p, __pyx_n_s_m, __pyx_n_s_n, __pyx_n_s_makecanvas, __pyx_n_s_tic, __pyx_n_s_toc, __pyx_n_s_k, __pyx_n_s_st, __pyx_n_s_sp, __pyx_n_s_ct, __pyx_n_s_cp, __pyx_n_s_theta, __pyx_n_s_phi, __pyx_n_s_r1, __pyx_n_s_Theta, __pyx_n_s_Phi, __pyx_n_s_Rot, __pyx_n_s_Eul, __pyx_n_s_Axis, __pyx_n_s_Angle, __pyx_n_s_Nd, __pyx_n_s_Rd, __pyx_n_s_Rv, __pyx_n_s_Q); if (unlikely(!__pyx_tuple__79)) __PYX_ERR(0, 610, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__79);
  __Pyx_GIVEREF(__pyx_tuple__79);
  __pyx_codeobj__80 = (PyObject*)__Pyx_PyCode_New(1, 0, 26, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__79, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_E_Dropbox_Public_PhDResources_10, __pyx_n_s_Texture_URO_miles, 610, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__80)) __PYX_ERR(0, 610, __pyx_L1_error)

  /* "libTEXTURIZE.pyx":671
 * 
 * 
 * def Texture_URO_mur(obj):  # EULER TRIPLET BASED             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */
  __pyx_tuple__81 = PyTuple_Pack(17, __pyx_n_s_obj, __pyx_n_s_myseed, __pyx_n_s_p, __pyx_n_s_m, __pyx_n_s_n, __pyx_n_s_makecanvas, __pyx_n_s_tic, __pyx_n_s_toc, __pyx_n_s_r1, __pyx_n_s_Rot, __pyx_n_s_Eul, __pyx_n_s_Axis, __pyx_n_s_Angle, __pyx_n_s_Nd, __pyx_n_s_Rd, __pyx_n_s_Rv, __pyx_n_s_Q); if (unlikely(!__pyx_tuple__81)) __PYX_ERR(0, 671, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__81);
  __Pyx_GIVEREF(__pyx_tuple__81);
  __pyx_codeobj__82 = (PyObject*)__Pyx_PyCode_New(1, 0, 17, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__81, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_E_Dropbox_Public_PhDResources_10, __pyx_n_s_Texture_URO_mur, 671, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__82)) __PYX_ERR(0, 671, __pyx_L1_error)

  /* "libTEXTURIZE.pyx":716
 * 
 * 
 * def Texture_Fiber(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */
  __pyx_tuple__83 = PyTuple_Pack(66, __pyx_n_s_obj, __pyx_n_s_myseed, __pyx_n_s_p, __pyx_n_s_m, __pyx_n_s_n, __pyx_n_s_makecanvas, __pyx_n_s_tic, __pyx_n_s_toc, __pyx_n_s_xs, __pyx_n_s_ys, __pyx_n_s_zs, __pyx_n_s_xc, __pyx_n_s_yc, __pyx_n_s_zc, __pyx_n_s_thetamax, __pyx_n_s_thetamin, __pyx_n_s_axisdist, __pyx_n_s_normC, __pyx_n_s_normS, __pyx_n_s_i, __pyx_n_s_k, __pyx_n_s_th, __pyx_n_s_ph, __pyx_n_s_lm, __pyx_n_s_sth, __pyx_n_s_sph, __pyx_n_s_cth, __pyx_n_s_cph, __pyx_n_s_clm, __pyx_n_s_slm, __pyx_n_s_STH, __pyx_n_s_SPH, __pyx_n_s_CTH, __pyx_n_s_CPH, __pyx_n_s_sthcph, __pyx_n_s_sthsph, __pyx_n_s_a, __pyx_n_s_alpha, __pyx_n_s_beta, __pyx_n_s_gamma, __pyx_n_s_den1, __pyx_n_s_den2, __pyx_n_s_den3, __pyx_n_s_den, __pyx_n_s_Lambdaa, __pyx_n_s_Phi, __pyx_n_s_V1, __pyx_n_s_V2, __pyx_n_s_X1C, __pyx_n_s_X2C, __pyx_n_s_X3C, __pyx_n_s_X1S, __pyx_n_s_X2S, __pyx_n_s_X3S, __pyx_n_s_aux1, __pyx_n_s_aux2, __pyx_n_s_aux3, __pyx_n_s_Aux1, __pyx_n_s_Aux2, __pyx_n_s_Aux3, __pyx_n_s_PHI1, __pyx_n_s_PHI2, __pyx_n_s_Rot, __pyx_n_s_Eul, __pyx_n_s_PHI, __pyx_n_s_Theta); if (unlikely(!__pyx_tuple__83)) __PYX_ERR(0, 716, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__83);
  __Pyx_GIVEREF(__pyx_tuple__83);
  __pyx_codeobj__84 = (PyObject*)__Pyx_PyCode_New(1, 0, 66, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__83, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_E_Dropbox_Public_PhDResources_10, __pyx_n_s_Texture_Fiber, 716, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__84)) __PYX_ERR(0, 716, __pyx_L1_error)

  /* "libTEXTURIZE.pyx":911
 *     return obj
 * 
 * def Texture_Sheet(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */
  __pyx_tuple__85 = PyTuple_Pack(29, __pyx_n_s_obj, __pyx_n_s_myseed, __pyx_n_s_p, __pyx_n_s_m, __pyx_n_s_n, __pyx_n_s_makecanvas, __pyx_n_s_tic, __pyx_n_s_toc, __pyx_n_s_eul1, __pyx_n_s_eul, __pyx_n_s_eul2, __pyx_n_s_gammamin, __pyx_n_s_gammamax, __pyx_n_s_thetamin, __pyx_n_s_thetamax, __pyx_n_s_phimin, __pyx_n_s_phimax, __pyx_n_s_gammadist, __pyx_n_s_thetadist, __pyx_n_s_phidist, __pyx_n_s_Axis, __pyx_n_s_Angle, __pyx_n_s_theta, __pyx_n_s_phi, __pyx_n_s_Roo, __pyx_n_s_Ro, __pyx_n_s_delR, __pyx_n_s_Rot, __pyx_n_s_Eul); if (unlikely(!__pyx_tuple__85)) __PYX_ERR(0, 911, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__85);
  __Pyx_GIVEREF(__pyx_tuple__85);
  __pyx_codeobj__86 = (PyObject*)__Pyx_PyCode_New(1, 0, 29, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__85, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_E_Dropbox_Public_PhDResources_10, __pyx_n_s_Texture_Sheet, 911, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__86)) __PYX_ERR(0, 911, __pyx_L1_error)

  /* "libTEXTURIZE.pyx":963
 * 
 * 
 * def Texture_Generic_Euler(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */
  __pyx_tuple__87 = PyTuple_Pack(41, __pyx_n_s_obj, __pyx_n_s_myseed, __pyx_n_s_p, __pyx_n_s_m, __pyx_n_s_n, __pyx_n_s_makecanvas, __pyx_n_s_tic, __pyx_n_s_toc, __pyx_n_s_grainloc, __pyx_n_s_Phi1Func, __pyx_n_s_PhiFunc, __pyx_n_s_Phi2Func, __pyx_n_s_i, __pyx_n_s_th, __pyx_n_s_ph, __pyx_n_s_lm, __pyx_n_s_sth, __pyx_n_s_sph, __pyx_n_s_cth, __pyx_n_s_cph, __pyx_n_s_clm, __pyx_n_s_slm, __pyx_n_s_Xc0, __pyx_n_s_Xc1, __pyx_n_s_Xc2, __pyx_n_s_lambdaa, __pyx_n_s_phi, __pyx_n_s_V1, __pyx_n_s_V2, __pyx_n_s_Xc, __pyx_n_s_Yc, __pyx_n_s_Zc, __pyx_n_s_Rot, __pyx_n_s_delR, __pyx_n_s_Eul, __pyx_n_s_Axis, __pyx_n_s_Angle, __pyx_n_s_Nd, __pyx_n_s_Rd, __pyx_n_s_Rv, __pyx_n_s_Q); if (unlikely(!__pyx_tuple__87)) __PYX_ERR(0, 963, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_tuple__87);
  __Pyx_GIVEREF(__pyx_tuple__87);
  __pyx_codeobj__88 = (PyObject*)__Pyx_PyCode_New(1, 0, 41, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__87, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_E_Dropbox_Public_PhDResources_10, __pyx_n_s_Texture_Generic_Euler, 963, __pyx_empty_bytes); if (unlikely(!__pyx_codeobj__88)) __PYX_ERR(0, 963, __pyx_L1_error)
  __Pyx_RefNannyFinishContext();
  return 0;
  __pyx_L1_error:;
  __Pyx_RefNannyFinishContext();
  return -1;
}

static int __Pyx_InitGlobals(void) {
  if (__Pyx_InitStrings(__pyx_string_tab) < 0) __PYX_ERR(0, 1, __pyx_L1_error);
  __pyx_int_0 = PyInt_FromLong(0); if (unlikely(!__pyx_int_0)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_1 = PyInt_FromLong(1); if (unlikely(!__pyx_int_1)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_2 = PyInt_FromLong(2); if (unlikely(!__pyx_int_2)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_3 = PyInt_FromLong(3); if (unlikely(!__pyx_int_3)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_int_4 = PyInt_FromLong(4); if (unlikely(!__pyx_int_4)) __PYX_ERR(0, 1, __pyx_L1_error)
  return 0;
  __pyx_L1_error:;
  return -1;
}

#if PY_MAJOR_VERSION < 3
PyMODINIT_FUNC initlibTEXTURIZE(void); /*proto*/
PyMODINIT_FUNC initlibTEXTURIZE(void)
#else
PyMODINIT_FUNC PyInit_libTEXTURIZE(void); /*proto*/
PyMODINIT_FUNC PyInit_libTEXTURIZE(void)
#endif
{
  PyObject *__pyx_t_1 = NULL;
  PyObject *__pyx_t_2 = NULL;
  float __pyx_t_3;
  __Pyx_RefNannyDeclarations
  #if CYTHON_REFNANNY
  __Pyx_RefNanny = __Pyx_RefNannyImportAPI("refnanny");
  if (!__Pyx_RefNanny) {
      PyErr_Clear();
      __Pyx_RefNanny = __Pyx_RefNannyImportAPI("Cython.Runtime.refnanny");
      if (!__Pyx_RefNanny)
          Py_FatalError("failed to import 'refnanny' module");
  }
  #endif
  __Pyx_RefNannySetupContext("PyMODINIT_FUNC PyInit_libTEXTURIZE(void)", 0);
  if (__Pyx_check_binary_version() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_empty_tuple = PyTuple_New(0); if (unlikely(!__pyx_empty_tuple)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_empty_bytes = PyBytes_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_bytes)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_empty_unicode = PyUnicode_FromStringAndSize("", 0); if (unlikely(!__pyx_empty_unicode)) __PYX_ERR(0, 1, __pyx_L1_error)
  #ifdef __Pyx_CyFunction_USED
  if (__pyx_CyFunction_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  #ifdef __Pyx_FusedFunction_USED
  if (__pyx_FusedFunction_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  #ifdef __Pyx_Coroutine_USED
  if (__pyx_Coroutine_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  #ifdef __Pyx_Generator_USED
  if (__pyx_Generator_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  #ifdef __Pyx_StopAsyncIteration_USED
  if (__pyx_StopAsyncIteration_init() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  /*--- Library function declarations ---*/
  /*--- Threads initialization code ---*/
  #if defined(__PYX_FORCE_INIT_THREADS) && __PYX_FORCE_INIT_THREADS
  #ifdef WITH_THREAD /* Python build with threading support? */
  PyEval_InitThreads();
  #endif
  #endif
  /*--- Module creation code ---*/
  #if PY_MAJOR_VERSION < 3
  __pyx_m = Py_InitModule4("libTEXTURIZE", __pyx_methods, 0, 0, PYTHON_API_VERSION); Py_XINCREF(__pyx_m);
  #else
  __pyx_m = PyModule_Create(&__pyx_moduledef);
  #endif
  if (unlikely(!__pyx_m)) __PYX_ERR(0, 1, __pyx_L1_error)
  __pyx_d = PyModule_GetDict(__pyx_m); if (unlikely(!__pyx_d)) __PYX_ERR(0, 1, __pyx_L1_error)
  Py_INCREF(__pyx_d);
  __pyx_b = PyImport_AddModule(__Pyx_BUILTIN_MODULE_NAME); if (unlikely(!__pyx_b)) __PYX_ERR(0, 1, __pyx_L1_error)
  #if CYTHON_COMPILING_IN_PYPY
  Py_INCREF(__pyx_b);
  #endif
  if (PyObject_SetAttrString(__pyx_m, "__builtins__", __pyx_b) < 0) __PYX_ERR(0, 1, __pyx_L1_error);
  /*--- Initialize various global constants etc. ---*/
  if (__Pyx_InitGlobals() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #if PY_MAJOR_VERSION < 3 && (__PYX_DEFAULT_STRING_ENCODING_IS_ASCII || __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT)
  if (__Pyx_init_sys_getdefaultencoding_params() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif
  if (__pyx_module_is_main_libTEXTURIZE) {
    if (PyObject_SetAttrString(__pyx_m, "__name__", __pyx_n_s_main) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  }
  #if PY_MAJOR_VERSION >= 3
  {
    PyObject *modules = PyImport_GetModuleDict(); if (unlikely(!modules)) __PYX_ERR(0, 1, __pyx_L1_error)
    if (!PyDict_GetItemString(modules, "libTEXTURIZE")) {
      if (unlikely(PyDict_SetItemString(modules, "libTEXTURIZE", __pyx_m) < 0)) __PYX_ERR(0, 1, __pyx_L1_error)
    }
  }
  #endif
  /*--- Builtin init code ---*/
  if (__Pyx_InitCachedBuiltins() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  /*--- Constants init code ---*/
  if (__Pyx_InitCachedConstants() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  /*--- Global init code ---*/
  /*--- Variable export code ---*/
  /*--- Function export code ---*/
  /*--- Type init code ---*/
  /*--- Type import code ---*/
  __pyx_ptype_7cpython_4type_type = __Pyx_ImportType(__Pyx_BUILTIN_MODULE_NAME, "type", 
  #if CYTHON_COMPILING_IN_PYPY
  sizeof(PyTypeObject),
  #else
  sizeof(PyHeapTypeObject),
  #endif
  0); if (unlikely(!__pyx_ptype_7cpython_4type_type)) __PYX_ERR(2, 9, __pyx_L1_error)
  __pyx_ptype_5numpy_dtype = __Pyx_ImportType("numpy", "dtype", sizeof(PyArray_Descr), 0); if (unlikely(!__pyx_ptype_5numpy_dtype)) __PYX_ERR(1, 155, __pyx_L1_error)
  __pyx_ptype_5numpy_flatiter = __Pyx_ImportType("numpy", "flatiter", sizeof(PyArrayIterObject), 0); if (unlikely(!__pyx_ptype_5numpy_flatiter)) __PYX_ERR(1, 168, __pyx_L1_error)
  __pyx_ptype_5numpy_broadcast = __Pyx_ImportType("numpy", "broadcast", sizeof(PyArrayMultiIterObject), 0); if (unlikely(!__pyx_ptype_5numpy_broadcast)) __PYX_ERR(1, 172, __pyx_L1_error)
  __pyx_ptype_5numpy_ndarray = __Pyx_ImportType("numpy", "ndarray", sizeof(PyArrayObject), 0); if (unlikely(!__pyx_ptype_5numpy_ndarray)) __PYX_ERR(1, 181, __pyx_L1_error)
  __pyx_ptype_5numpy_ufunc = __Pyx_ImportType("numpy", "ufunc", sizeof(PyUFuncObject), 0); if (unlikely(!__pyx_ptype_5numpy_ufunc)) __PYX_ERR(1, 861, __pyx_L1_error)
  /*--- Variable import code ---*/
  /*--- Function import code ---*/
  /*--- Execution code ---*/
  #if defined(__Pyx_Generator_USED) || defined(__Pyx_Coroutine_USED)
  if (__Pyx_patch_abc() < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  #endif

  /* "libTEXTURIZE.pyx":4
 * from __future__ import division
 * 
 * from cmath import sqrt             # <<<<<<<<<<<<<<
 * from math import gamma, atan2
 * import math
 */
  __pyx_t_1 = PyList_New(1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_INCREF(__pyx_n_s_sqrt);
  __Pyx_GIVEREF(__pyx_n_s_sqrt);
  PyList_SET_ITEM(__pyx_t_1, 0, __pyx_n_s_sqrt);
  __pyx_t_2 = __Pyx_Import(__pyx_n_s_cmath, __pyx_t_1, -1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 4, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_ImportFrom(__pyx_t_2, __pyx_n_s_sqrt); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 4, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_sqrt, __pyx_t_1) < 0) __PYX_ERR(0, 4, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;

  /* "libTEXTURIZE.pyx":5
 * 
 * from cmath import sqrt
 * from math import gamma, atan2             # <<<<<<<<<<<<<<
 * import math
 * import os
 */
  __pyx_t_2 = PyList_New(2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_INCREF(__pyx_n_s_gamma);
  __Pyx_GIVEREF(__pyx_n_s_gamma);
  PyList_SET_ITEM(__pyx_t_2, 0, __pyx_n_s_gamma);
  __Pyx_INCREF(__pyx_n_s_atan2);
  __Pyx_GIVEREF(__pyx_n_s_atan2);
  PyList_SET_ITEM(__pyx_t_2, 1, __pyx_n_s_atan2);
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_math, __pyx_t_2, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 5, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_ImportFrom(__pyx_t_1, __pyx_n_s_gamma); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_gamma, __pyx_t_2) < 0) __PYX_ERR(0, 5, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_ImportFrom(__pyx_t_1, __pyx_n_s_atan2); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 5, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_atan2, __pyx_t_2) < 0) __PYX_ERR(0, 5, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":6
 * from cmath import sqrt
 * from math import gamma, atan2
 * import math             # <<<<<<<<<<<<<<
 * import os
 * import random
 */
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_math, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 6, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_math, __pyx_t_1) < 0) __PYX_ERR(0, 6, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":7
 * from math import gamma, atan2
 * import math
 * import os             # <<<<<<<<<<<<<<
 * import random
 * import sys
 */
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_os, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 7, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_os, __pyx_t_1) < 0) __PYX_ERR(0, 7, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":8
 * import math
 * import os
 * import random             # <<<<<<<<<<<<<<
 * import sys
 * import time
 */
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_random, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 8, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_random, __pyx_t_1) < 0) __PYX_ERR(0, 8, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":9
 * import os
 * import random
 * import sys             # <<<<<<<<<<<<<<
 * import time
 * 
 */
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_sys, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 9, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_sys, __pyx_t_1) < 0) __PYX_ERR(0, 9, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":10
 * import random
 * import sys
 * import time             # <<<<<<<<<<<<<<
 * 
 * import cv2
 */
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_time, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_time, __pyx_t_1) < 0) __PYX_ERR(0, 10, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":12
 * import time
 * 
 * import cv2             # <<<<<<<<<<<<<<
 * 
 * import libCONVERT as conv
 */
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_cv2, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 12, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_cv2, __pyx_t_1) < 0) __PYX_ERR(0, 12, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":14
 * import cv2
 * 
 * import libCONVERT as conv             # <<<<<<<<<<<<<<
 * import libMETROPOLIS as met
 * import numpy as np
 */
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_libCONVERT, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 14, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_conv, __pyx_t_1) < 0) __PYX_ERR(0, 14, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":15
 * 
 * import libCONVERT as conv
 * import libMETROPOLIS as met             # <<<<<<<<<<<<<<
 * import numpy as np
 * 
 */
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_libMETROPOLIS, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 15, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_met, __pyx_t_1) < 0) __PYX_ERR(0, 15, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":16
 * import libCONVERT as conv
 * import libMETROPOLIS as met
 * import numpy as np             # <<<<<<<<<<<<<<
 * 
 * 
 */
  __pyx_t_1 = __Pyx_Import(__pyx_n_s_numpy, 0, -1); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 16, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_np, __pyx_t_1) < 0) __PYX_ERR(0, 16, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":26
 * from libc.math cimport sin, cos, tan, asin, acos, atan, abs, sqrt
 * 
 * cdef float pibt = np.pi / 2             # <<<<<<<<<<<<<<
 * cdef float tpibth = 2 * np.pi / 3
 * cdef float fpibth = 4 * np.pi / 3
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 26, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_pi); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 26, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_TrueDivideObjC(__pyx_t_2, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 26, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_1); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 26, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_12libTEXTURIZE_pibt = __pyx_t_3;

  /* "libTEXTURIZE.pyx":27
 * 
 * cdef float pibt = np.pi / 2
 * cdef float tpibth = 2 * np.pi / 3             # <<<<<<<<<<<<<<
 * cdef float fpibth = 4 * np.pi / 3
 * cdef float pi = np.pi
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 27, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_pi); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 27, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyNumber_Multiply(__pyx_int_2, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 27, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = __Pyx_PyInt_TrueDivideObjC(__pyx_t_1, __pyx_int_3, 3, 0); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 27, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_2); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 27, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_12libTEXTURIZE_tpibth = __pyx_t_3;

  /* "libTEXTURIZE.pyx":28
 * cdef float pibt = np.pi / 2
 * cdef float tpibth = 2 * np.pi / 3
 * cdef float fpibth = 4 * np.pi / 3             # <<<<<<<<<<<<<<
 * cdef float pi = np.pi
 * cdef float thpibt = 3 * np.pi / 2
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 28, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_pi); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 28, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyNumber_Multiply(__pyx_int_4, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 28, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_TrueDivideObjC(__pyx_t_2, __pyx_int_3, 3, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 28, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_1); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 28, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_12libTEXTURIZE_fpibth = __pyx_t_3;

  /* "libTEXTURIZE.pyx":29
 * cdef float tpibth = 2 * np.pi / 3
 * cdef float fpibth = 4 * np.pi / 3
 * cdef float pi = np.pi             # <<<<<<<<<<<<<<
 * cdef float thpibt = 3 * np.pi / 2
 * cdef float tpi = 2 * np.pi
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 29, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_pi); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 29, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_2); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 29, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_12libTEXTURIZE_pi = __pyx_t_3;

  /* "libTEXTURIZE.pyx":30
 * cdef float fpibth = 4 * np.pi / 3
 * cdef float pi = np.pi
 * cdef float thpibt = 3 * np.pi / 2             # <<<<<<<<<<<<<<
 * cdef float tpi = 2 * np.pi
 * 
 */
  __pyx_t_2 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 30, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __pyx_t_1 = __Pyx_PyObject_GetAttrStr(__pyx_t_2, __pyx_n_s_pi); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 30, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = PyNumber_Multiply(__pyx_int_3, __pyx_t_1); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 30, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = __Pyx_PyInt_TrueDivideObjC(__pyx_t_2, __pyx_int_2, 2, 0); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 30, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_1); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 30, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_12libTEXTURIZE_thpibt = __pyx_t_3;

  /* "libTEXTURIZE.pyx":31
 * cdef float pi = np.pi
 * cdef float thpibt = 3 * np.pi / 2
 * cdef float tpi = 2 * np.pi             # <<<<<<<<<<<<<<
 * 
 * def plantseed(myseed):
 */
  __pyx_t_1 = __Pyx_GetModuleGlobalName(__pyx_n_s_np); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 31, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyObject_GetAttrStr(__pyx_t_1, __pyx_n_s_pi); if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 31, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_2);
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = PyNumber_Multiply(__pyx_int_2, __pyx_t_2); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 31, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  __Pyx_DECREF(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_3 = __pyx_PyFloat_AsFloat(__pyx_t_1); if (unlikely((__pyx_t_3 == (float)-1) && PyErr_Occurred())) __PYX_ERR(0, 31, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_12libTEXTURIZE_tpi = __pyx_t_3;

  /* "libTEXTURIZE.pyx":33
 * cdef float tpi = 2 * np.pi
 * 
 * def plantseed(myseed):             # <<<<<<<<<<<<<<
 *     if myseed > 0:
 *         np.random.seed(myseed)
 */
  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_12libTEXTURIZE_1plantseed, NULL, __pyx_n_s_libTEXTURIZE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 33, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_plantseed, __pyx_t_1) < 0) __PYX_ERR(0, 33, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":38
 *         random.seed(myseed)
 * 
 * def Texture_URO_xyz(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */
  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_12libTEXTURIZE_3Texture_URO_xyz, NULL, __pyx_n_s_libTEXTURIZE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 38, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_Texture_URO_xyz, __pyx_t_1) < 0) __PYX_ERR(0, 38, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":139
 * 
 * 
 * def Texture_URO_nxyz(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */
  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_12libTEXTURIZE_5Texture_URO_nxyz, NULL, __pyx_n_s_libTEXTURIZE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 139, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_Texture_URO_nxyz, __pyx_t_1) < 0) __PYX_ERR(0, 139, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":283
 * 
 * 
 * def Texture_URO_arvo(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */
  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_12libTEXTURIZE_7Texture_URO_arvo, NULL, __pyx_n_s_libTEXTURIZE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 283, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_Texture_URO_arvo, __pyx_t_1) < 0) __PYX_ERR(0, 283, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":383
 * 
 * 
 * def Texture_URO_mack(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */
  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_12libTEXTURIZE_9Texture_URO_mack, NULL, __pyx_n_s_libTEXTURIZE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 383, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_Texture_URO_mack, __pyx_t_1) < 0) __PYX_ERR(0, 383, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":477
 * 
 * 
 * def Texture_URO_sm1(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */
  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_12libTEXTURIZE_11Texture_URO_sm1, NULL, __pyx_n_s_libTEXTURIZE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 477, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_Texture_URO_sm1, __pyx_t_1) < 0) __PYX_ERR(0, 477, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":543
 * 
 * 
 * def Texture_URO_sm2(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */
  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_12libTEXTURIZE_13Texture_URO_sm2, NULL, __pyx_n_s_libTEXTURIZE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 543, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_Texture_URO_sm2, __pyx_t_1) < 0) __PYX_ERR(0, 543, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":610
 *     return obj
 * 
 * def Texture_URO_miles(obj):  # AXIS ANGLE PAIRS             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */
  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_12libTEXTURIZE_15Texture_URO_miles, NULL, __pyx_n_s_libTEXTURIZE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 610, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_Texture_URO_miles, __pyx_t_1) < 0) __PYX_ERR(0, 610, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":671
 * 
 * 
 * def Texture_URO_mur(obj):  # EULER TRIPLET BASED             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */
  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_12libTEXTURIZE_17Texture_URO_mur, NULL, __pyx_n_s_libTEXTURIZE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 671, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_Texture_URO_mur, __pyx_t_1) < 0) __PYX_ERR(0, 671, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":716
 * 
 * 
 * def Texture_Fiber(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */
  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_12libTEXTURIZE_19Texture_Fiber, NULL, __pyx_n_s_libTEXTURIZE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 716, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_Texture_Fiber, __pyx_t_1) < 0) __PYX_ERR(0, 716, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":911
 *     return obj
 * 
 * def Texture_Sheet(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */
  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_12libTEXTURIZE_21Texture_Sheet, NULL, __pyx_n_s_libTEXTURIZE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 911, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_Texture_Sheet, __pyx_t_1) < 0) __PYX_ERR(0, 911, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":963
 * 
 * 
 * def Texture_Generic_Euler(obj):             # <<<<<<<<<<<<<<
 *     cdef int myseed = obj.myseed
 *     cdef int p = obj.p
 */
  __pyx_t_1 = PyCFunction_NewEx(&__pyx_mdef_12libTEXTURIZE_23Texture_Generic_Euler, NULL, __pyx_n_s_libTEXTURIZE); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 963, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_Texture_Generic_Euler, __pyx_t_1) < 0) __PYX_ERR(0, 963, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "libTEXTURIZE.pyx":1
 * # cython: boundscheck=False, nonecheck=False, wraparound=False, cdivision=True             # <<<<<<<<<<<<<<
 * from __future__ import division
 * 
 */
  __pyx_t_1 = PyDict_New(); if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 1, __pyx_L1_error)
  __Pyx_GOTREF(__pyx_t_1);
  if (PyDict_SetItem(__pyx_d, __pyx_n_s_test, __pyx_t_1) < 0) __PYX_ERR(0, 1, __pyx_L1_error)
  __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;

  /* "C:/Anaconda2/lib/site-packages/Cython/Includes/numpy/__init__.pxd":976
 *      arr.base = baseptr
 * 
 * cdef inline object get_array_base(ndarray arr):             # <<<<<<<<<<<<<<
 *     if arr.base is NULL:
 *         return None
 */

  /*--- Wrapped vars code ---*/

  goto __pyx_L0;
  __pyx_L1_error:;
  __Pyx_XDECREF(__pyx_t_1);
  __Pyx_XDECREF(__pyx_t_2);
  if (__pyx_m) {
    if (__pyx_d) {
      __Pyx_AddTraceback("init libTEXTURIZE", __pyx_clineno, __pyx_lineno, __pyx_filename);
    }
    Py_DECREF(__pyx_m); __pyx_m = 0;
  } else if (!PyErr_Occurred()) {
    PyErr_SetString(PyExc_ImportError, "init libTEXTURIZE");
  }
  __pyx_L0:;
  __Pyx_RefNannyFinishContext();
  #if PY_MAJOR_VERSION < 3
  return;
  #else
  return __pyx_m;
  #endif
}

/* --- Runtime support code --- */
/* Refnanny */
#if CYTHON_REFNANNY
static __Pyx_RefNannyAPIStruct *__Pyx_RefNannyImportAPI(const char *modname) {
    PyObject *m = NULL, *p = NULL;
    void *r = NULL;
    m = PyImport_ImportModule((char *)modname);
    if (!m) goto end;
    p = PyObject_GetAttrString(m, (char *)"RefNannyAPI");
    if (!p) goto end;
    r = PyLong_AsVoidPtr(p);
end:
    Py_XDECREF(p);
    Py_XDECREF(m);
    return (__Pyx_RefNannyAPIStruct *)r;
}
#endif

/* GetBuiltinName */
static PyObject *__Pyx_GetBuiltinName(PyObject *name) {
    PyObject* result = __Pyx_PyObject_GetAttrStr(__pyx_b, name);
    if (unlikely(!result)) {
        PyErr_Format(PyExc_NameError,
#if PY_MAJOR_VERSION >= 3
            "name '%U' is not defined", name);
#else
            "name '%.200s' is not defined", PyString_AS_STRING(name));
#endif
    }
    return result;
}

/* GetModuleGlobalName */
static CYTHON_INLINE PyObject *__Pyx_GetModuleGlobalName(PyObject *name) {
    PyObject *result;
#if CYTHON_COMPILING_IN_CPYTHON
    result = PyDict_GetItem(__pyx_d, name);
    if (likely(result)) {
        Py_INCREF(result);
    } else {
#else
    result = PyObject_GetItem(__pyx_d, name);
    if (!result) {
        PyErr_Clear();
#endif
        result = __Pyx_GetBuiltinName(name);
    }
    return result;
}

/* PyObjectCall */
  #if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_Call(PyObject *func, PyObject *arg, PyObject *kw) {
    PyObject *result;
    ternaryfunc call = func->ob_type->tp_call;
    if (unlikely(!call))
        return PyObject_Call(func, arg, kw);
    if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
        return NULL;
    result = (*call)(func, arg, kw);
    Py_LeaveRecursiveCall();
    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
        PyErr_SetString(
            PyExc_SystemError,
            "NULL result without error in PyObject_Call");
    }
    return result;
}
#endif

/* PyObjectCallMethO */
  #if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallMethO(PyObject *func, PyObject *arg) {
    PyObject *self, *result;
    PyCFunction cfunc;
    cfunc = PyCFunction_GET_FUNCTION(func);
    self = PyCFunction_GET_SELF(func);
    if (unlikely(Py_EnterRecursiveCall((char*)" while calling a Python object")))
        return NULL;
    result = cfunc(self, arg);
    Py_LeaveRecursiveCall();
    if (unlikely(!result) && unlikely(!PyErr_Occurred())) {
        PyErr_SetString(
            PyExc_SystemError,
            "NULL result without error in PyObject_Call");
    }
    return result;
}
#endif

/* PyObjectCallOneArg */
  #if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx__PyObject_CallOneArg(PyObject *func, PyObject *arg) {
    PyObject *result;
    PyObject *args = PyTuple_New(1);
    if (unlikely(!args)) return NULL;
    Py_INCREF(arg);
    PyTuple_SET_ITEM(args, 0, arg);
    result = __Pyx_PyObject_Call(func, args, NULL);
    Py_DECREF(args);
    return result;
}
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg) {
#ifdef __Pyx_CyFunction_USED
    if (likely(PyCFunction_Check(func) || PyObject_TypeCheck(func, __pyx_CyFunctionType))) {
#else
    if (likely(PyCFunction_Check(func))) {
#endif
        if (likely(PyCFunction_GET_FLAGS(func) & METH_O)) {
            return __Pyx_PyObject_CallMethO(func, arg);
        }
    }
    return __Pyx__PyObject_CallOneArg(func, arg);
}
#else
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallOneArg(PyObject *func, PyObject *arg) {
    PyObject *result;
    PyObject *args = PyTuple_Pack(1, arg);
    if (unlikely(!args)) return NULL;
    result = __Pyx_PyObject_Call(func, args, NULL);
    Py_DECREF(args);
    return result;
}
#endif

/* ExtTypeTest */
    static CYTHON_INLINE int __Pyx_TypeTest(PyObject *obj, PyTypeObject *type) {
    if (unlikely(!type)) {
        PyErr_SetString(PyExc_SystemError, "Missing type object");
        return 0;
    }
    if (likely(PyObject_TypeCheck(obj, type)))
        return 1;
    PyErr_Format(PyExc_TypeError, "Cannot convert %.200s to %.200s",
                 Py_TYPE(obj)->tp_name, type->tp_name);
    return 0;
}

/* BufferFormatCheck */
    static CYTHON_INLINE int __Pyx_IsLittleEndian(void) {
  unsigned int n = 1;
  return *(unsigned char*)(&n) != 0;
}
static void __Pyx_BufFmt_Init(__Pyx_BufFmt_Context* ctx,
                              __Pyx_BufFmt_StackElem* stack,
                              __Pyx_TypeInfo* type) {
  stack[0].field = &ctx->root;
  stack[0].parent_offset = 0;
  ctx->root.type = type;
  ctx->root.name = "buffer dtype";
  ctx->root.offset = 0;
  ctx->head = stack;
  ctx->head->field = &ctx->root;
  ctx->fmt_offset = 0;
  ctx->head->parent_offset = 0;
  ctx->new_packmode = '@';
  ctx->enc_packmode = '@';
  ctx->new_count = 1;
  ctx->enc_count = 0;
  ctx->enc_type = 0;
  ctx->is_complex = 0;
  ctx->is_valid_array = 0;
  ctx->struct_alignment = 0;
  while (type->typegroup == 'S') {
    ++ctx->head;
    ctx->head->field = type->fields;
    ctx->head->parent_offset = 0;
    type = type->fields->type;
  }
}
static int __Pyx_BufFmt_ParseNumber(const char** ts) {
    int count;
    const char* t = *ts;
    if (*t < '0' || *t > '9') {
      return -1;
    } else {
        count = *t++ - '0';
        while (*t >= '0' && *t < '9') {
            count *= 10;
            count += *t++ - '0';
        }
    }
    *ts = t;
    return count;
}
static int __Pyx_BufFmt_ExpectNumber(const char **ts) {
    int number = __Pyx_BufFmt_ParseNumber(ts);
    if (number == -1)
        PyErr_Format(PyExc_ValueError,\
                     "Does not understand character buffer dtype format string ('%c')", **ts);
    return number;
}
static void __Pyx_BufFmt_RaiseUnexpectedChar(char ch) {
  PyErr_Format(PyExc_ValueError,
               "Unexpected format string character: '%c'", ch);
}
static const char* __Pyx_BufFmt_DescribeTypeChar(char ch, int is_complex) {
  switch (ch) {
    case 'c': return "'char'";
    case 'b': return "'signed char'";
    case 'B': return "'unsigned char'";
    case 'h': return "'short'";
    case 'H': return "'unsigned short'";
    case 'i': return "'int'";
    case 'I': return "'unsigned int'";
    case 'l': return "'long'";
    case 'L': return "'unsigned long'";
    case 'q': return "'long long'";
    case 'Q': return "'unsigned long long'";
    case 'f': return (is_complex ? "'complex float'" : "'float'");
    case 'd': return (is_complex ? "'complex double'" : "'double'");
    case 'g': return (is_complex ? "'complex long double'" : "'long double'");
    case 'T': return "a struct";
    case 'O': return "Python object";
    case 'P': return "a pointer";
    case 's': case 'p': return "a string";
    case 0: return "end";
    default: return "unparseable format string";
  }
}
static size_t __Pyx_BufFmt_TypeCharToStandardSize(char ch, int is_complex) {
  switch (ch) {
    case '?': case 'c': case 'b': case 'B': case 's': case 'p': return 1;
    case 'h': case 'H': return 2;
    case 'i': case 'I': case 'l': case 'L': return 4;
    case 'q': case 'Q': return 8;
    case 'f': return (is_complex ? 8 : 4);
    case 'd': return (is_complex ? 16 : 8);
    case 'g': {
      PyErr_SetString(PyExc_ValueError, "Python does not define a standard format string size for long double ('g')..");
      return 0;
    }
    case 'O': case 'P': return sizeof(void*);
    default:
      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
      return 0;
    }
}
static size_t __Pyx_BufFmt_TypeCharToNativeSize(char ch, int is_complex) {
  switch (ch) {
    case 'c': case 'b': case 'B': case 's': case 'p': return 1;
    case 'h': case 'H': return sizeof(short);
    case 'i': case 'I': return sizeof(int);
    case 'l': case 'L': return sizeof(long);
    #ifdef HAVE_LONG_LONG
    case 'q': case 'Q': return sizeof(PY_LONG_LONG);
    #endif
    case 'f': return sizeof(float) * (is_complex ? 2 : 1);
    case 'd': return sizeof(double) * (is_complex ? 2 : 1);
    case 'g': return sizeof(long double) * (is_complex ? 2 : 1);
    case 'O': case 'P': return sizeof(void*);
    default: {
      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
      return 0;
    }
  }
}
typedef struct { char c; short x; } __Pyx_st_short;
typedef struct { char c; int x; } __Pyx_st_int;
typedef struct { char c; long x; } __Pyx_st_long;
typedef struct { char c; float x; } __Pyx_st_float;
typedef struct { char c; double x; } __Pyx_st_double;
typedef struct { char c; long double x; } __Pyx_st_longdouble;
typedef struct { char c; void *x; } __Pyx_st_void_p;
#ifdef HAVE_LONG_LONG
typedef struct { char c; PY_LONG_LONG x; } __Pyx_st_longlong;
#endif
static size_t __Pyx_BufFmt_TypeCharToAlignment(char ch, CYTHON_UNUSED int is_complex) {
  switch (ch) {
    case '?': case 'c': case 'b': case 'B': case 's': case 'p': return 1;
    case 'h': case 'H': return sizeof(__Pyx_st_short) - sizeof(short);
    case 'i': case 'I': return sizeof(__Pyx_st_int) - sizeof(int);
    case 'l': case 'L': return sizeof(__Pyx_st_long) - sizeof(long);
#ifdef HAVE_LONG_LONG
    case 'q': case 'Q': return sizeof(__Pyx_st_longlong) - sizeof(PY_LONG_LONG);
#endif
    case 'f': return sizeof(__Pyx_st_float) - sizeof(float);
    case 'd': return sizeof(__Pyx_st_double) - sizeof(double);
    case 'g': return sizeof(__Pyx_st_longdouble) - sizeof(long double);
    case 'P': case 'O': return sizeof(__Pyx_st_void_p) - sizeof(void*);
    default:
      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
      return 0;
    }
}
/* These are for computing the padding at the end of the struct to align
   on the first member of the struct. This will probably the same as above,
   but we don't have any guarantees.
 */
typedef struct { short x; char c; } __Pyx_pad_short;
typedef struct { int x; char c; } __Pyx_pad_int;
typedef struct { long x; char c; } __Pyx_pad_long;
typedef struct { float x; char c; } __Pyx_pad_float;
typedef struct { double x; char c; } __Pyx_pad_double;
typedef struct { long double x; char c; } __Pyx_pad_longdouble;
typedef struct { void *x; char c; } __Pyx_pad_void_p;
#ifdef HAVE_LONG_LONG
typedef struct { PY_LONG_LONG x; char c; } __Pyx_pad_longlong;
#endif
static size_t __Pyx_BufFmt_TypeCharToPadding(char ch, CYTHON_UNUSED int is_complex) {
  switch (ch) {
    case '?': case 'c': case 'b': case 'B': case 's': case 'p': return 1;
    case 'h': case 'H': return sizeof(__Pyx_pad_short) - sizeof(short);
    case 'i': case 'I': return sizeof(__Pyx_pad_int) - sizeof(int);
    case 'l': case 'L': return sizeof(__Pyx_pad_long) - sizeof(long);
#ifdef HAVE_LONG_LONG
    case 'q': case 'Q': return sizeof(__Pyx_pad_longlong) - sizeof(PY_LONG_LONG);
#endif
    case 'f': return sizeof(__Pyx_pad_float) - sizeof(float);
    case 'd': return sizeof(__Pyx_pad_double) - sizeof(double);
    case 'g': return sizeof(__Pyx_pad_longdouble) - sizeof(long double);
    case 'P': case 'O': return sizeof(__Pyx_pad_void_p) - sizeof(void*);
    default:
      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
      return 0;
    }
}
static char __Pyx_BufFmt_TypeCharToGroup(char ch, int is_complex) {
  switch (ch) {
    case 'c':
        return 'H';
    case 'b': case 'h': case 'i':
    case 'l': case 'q': case 's': case 'p':
        return 'I';
    case 'B': case 'H': case 'I': case 'L': case 'Q':
        return 'U';
    case 'f': case 'd': case 'g':
        return (is_complex ? 'C' : 'R');
    case 'O':
        return 'O';
    case 'P':
        return 'P';
    default: {
      __Pyx_BufFmt_RaiseUnexpectedChar(ch);
      return 0;
    }
  }
}
static void __Pyx_BufFmt_RaiseExpected(__Pyx_BufFmt_Context* ctx) {
  if (ctx->head == NULL || ctx->head->field == &ctx->root) {
    const char* expected;
    const char* quote;
    if (ctx->head == NULL) {
      expected = "end";
      quote = "";
    } else {
      expected = ctx->head->field->type->name;
      quote = "'";
    }
    PyErr_Format(PyExc_ValueError,
                 "Buffer dtype mismatch, expected %s%s%s but got %s",
                 quote, expected, quote,
                 __Pyx_BufFmt_DescribeTypeChar(ctx->enc_type, ctx->is_complex));
  } else {
    __Pyx_StructField* field = ctx->head->field;
    __Pyx_StructField* parent = (ctx->head - 1)->field;
    PyErr_Format(PyExc_ValueError,
                 "Buffer dtype mismatch, expected '%s' but got %s in '%s.%s'",
                 field->type->name, __Pyx_BufFmt_DescribeTypeChar(ctx->enc_type, ctx->is_complex),
                 parent->type->name, field->name);
  }
}
static int __Pyx_BufFmt_ProcessTypeChunk(__Pyx_BufFmt_Context* ctx) {
  char group;
  size_t size, offset, arraysize = 1;
  if (ctx->enc_type == 0) return 0;
  if (ctx->head->field->type->arraysize[0]) {
    int i, ndim = 0;
    if (ctx->enc_type == 's' || ctx->enc_type == 'p') {
        ctx->is_valid_array = ctx->head->field->type->ndim == 1;
        ndim = 1;
        if (ctx->enc_count != ctx->head->field->type->arraysize[0]) {
            PyErr_Format(PyExc_ValueError,
                         "Expected a dimension of size %zu, got %zu",
                         ctx->head->field->type->arraysize[0], ctx->enc_count);
            return -1;
        }
    }
    if (!ctx->is_valid_array) {
      PyErr_Format(PyExc_ValueError, "Expected %d dimensions, got %d",
                   ctx->head->field->type->ndim, ndim);
      return -1;
    }
    for (i = 0; i < ctx->head->field->type->ndim; i++) {
      arraysize *= ctx->head->field->type->arraysize[i];
    }
    ctx->is_valid_array = 0;
    ctx->enc_count = 1;
  }
  group = __Pyx_BufFmt_TypeCharToGroup(ctx->enc_type, ctx->is_complex);
  do {
    __Pyx_StructField* field = ctx->head->field;
    __Pyx_TypeInfo* type = field->type;
    if (ctx->enc_packmode == '@' || ctx->enc_packmode == '^') {
      size = __Pyx_BufFmt_TypeCharToNativeSize(ctx->enc_type, ctx->is_complex);
    } else {
      size = __Pyx_BufFmt_TypeCharToStandardSize(ctx->enc_type, ctx->is_complex);
    }
    if (ctx->enc_packmode == '@') {
      size_t align_at = __Pyx_BufFmt_TypeCharToAlignment(ctx->enc_type, ctx->is_complex);
      size_t align_mod_offset;
      if (align_at == 0) return -1;
      align_mod_offset = ctx->fmt_offset % align_at;
      if (align_mod_offset > 0) ctx->fmt_offset += align_at - align_mod_offset;
      if (ctx->struct_alignment == 0)
          ctx->struct_alignment = __Pyx_BufFmt_TypeCharToPadding(ctx->enc_type,
                                                                 ctx->is_complex);
    }
    if (type->size != size || type->typegroup != group) {
      if (type->typegroup == 'C' && type->fields != NULL) {
        size_t parent_offset = ctx->head->parent_offset + field->offset;
        ++ctx->head;
        ctx->head->field = type->fields;
        ctx->head->parent_offset = parent_offset;
        continue;
      }
      if ((type->typegroup == 'H' || group == 'H') && type->size == size) {
      } else {
          __Pyx_BufFmt_RaiseExpected(ctx);
          return -1;
      }
    }
    offset = ctx->head->parent_offset + field->offset;
    if (ctx->fmt_offset != offset) {
      PyErr_Format(PyExc_ValueError,
                   "Buffer dtype mismatch; next field is at offset %" CYTHON_FORMAT_SSIZE_T "d but %" CYTHON_FORMAT_SSIZE_T "d expected",
                   (Py_ssize_t)ctx->fmt_offset, (Py_ssize_t)offset);
      return -1;
    }
    ctx->fmt_offset += size;
    if (arraysize)
      ctx->fmt_offset += (arraysize - 1) * size;
    --ctx->enc_count;
    while (1) {
      if (field == &ctx->root) {
        ctx->head = NULL;
        if (ctx->enc_count != 0) {
          __Pyx_BufFmt_RaiseExpected(ctx);
          return -1;
        }
        break;
      }
      ctx->head->field = ++field;
      if (field->type == NULL) {
        --ctx->head;
        field = ctx->head->field;
        continue;
      } else if (field->type->typegroup == 'S') {
        size_t parent_offset = ctx->head->parent_offset + field->offset;
        if (field->type->fields->type == NULL) continue;
        field = field->type->fields;
        ++ctx->head;
        ctx->head->field = field;
        ctx->head->parent_offset = parent_offset;
        break;
      } else {
        break;
      }
    }
  } while (ctx->enc_count);
  ctx->enc_type = 0;
  ctx->is_complex = 0;
  return 0;
}
static CYTHON_INLINE PyObject *
__pyx_buffmt_parse_array(__Pyx_BufFmt_Context* ctx, const char** tsp)
{
    const char *ts = *tsp;
    int i = 0, number;
    int ndim = ctx->head->field->type->ndim;
;
    ++ts;
    if (ctx->new_count != 1) {
        PyErr_SetString(PyExc_ValueError,
                        "Cannot handle repeated arrays in format string");
        return NULL;
    }
    if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
    while (*ts && *ts != ')') {
        switch (*ts) {
            case ' ': case '\f': case '\r': case '\n': case '\t': case '\v':  continue;
            default:  break;
        }
        number = __Pyx_BufFmt_ExpectNumber(&ts);
        if (number == -1) return NULL;
        if (i < ndim && (size_t) number != ctx->head->field->type->arraysize[i])
            return PyErr_Format(PyExc_ValueError,
                        "Expected a dimension of size %zu, got %d",
                        ctx->head->field->type->arraysize[i], number);
        if (*ts != ',' && *ts != ')')
            return PyErr_Format(PyExc_ValueError,
                                "Expected a comma in format string, got '%c'", *ts);
        if (*ts == ',') ts++;
        i++;
    }
    if (i != ndim)
        return PyErr_Format(PyExc_ValueError, "Expected %d dimension(s), got %d",
                            ctx->head->field->type->ndim, i);
    if (!*ts) {
        PyErr_SetString(PyExc_ValueError,
                        "Unexpected end of format string, expected ')'");
        return NULL;
    }
    ctx->is_valid_array = 1;
    ctx->new_count = 1;
    *tsp = ++ts;
    return Py_None;
}
static const char* __Pyx_BufFmt_CheckString(__Pyx_BufFmt_Context* ctx, const char* ts) {
  int got_Z = 0;
  while (1) {
    switch(*ts) {
      case 0:
        if (ctx->enc_type != 0 && ctx->head == NULL) {
          __Pyx_BufFmt_RaiseExpected(ctx);
          return NULL;
        }
        if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
        if (ctx->head != NULL) {
          __Pyx_BufFmt_RaiseExpected(ctx);
          return NULL;
        }
        return ts;
      case ' ':
      case '\r':
      case '\n':
        ++ts;
        break;
      case '<':
        if (!__Pyx_IsLittleEndian()) {
          PyErr_SetString(PyExc_ValueError, "Little-endian buffer not supported on big-endian compiler");
          return NULL;
        }
        ctx->new_packmode = '=';
        ++ts;
        break;
      case '>':
      case '!':
        if (__Pyx_IsLittleEndian()) {
          PyErr_SetString(PyExc_ValueError, "Big-endian buffer not supported on little-endian compiler");
          return NULL;
        }
        ctx->new_packmode = '=';
        ++ts;
        break;
      case '=':
      case '@':
      case '^':
        ctx->new_packmode = *ts++;
        break;
      case 'T':
        {
          const char* ts_after_sub;
          size_t i, struct_count = ctx->new_count;
          size_t struct_alignment = ctx->struct_alignment;
          ctx->new_count = 1;
          ++ts;
          if (*ts != '{') {
            PyErr_SetString(PyExc_ValueError, "Buffer acquisition: Expected '{' after 'T'");
            return NULL;
          }
          if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
          ctx->enc_type = 0;
          ctx->enc_count = 0;
          ctx->struct_alignment = 0;
          ++ts;
          ts_after_sub = ts;
          for (i = 0; i != struct_count; ++i) {
            ts_after_sub = __Pyx_BufFmt_CheckString(ctx, ts);
            if (!ts_after_sub) return NULL;
          }
          ts = ts_after_sub;
          if (struct_alignment) ctx->struct_alignment = struct_alignment;
        }
        break;
      case '}':
        {
          size_t alignment = ctx->struct_alignment;
          ++ts;
          if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
          ctx->enc_type = 0;
          if (alignment && ctx->fmt_offset % alignment) {
            ctx->fmt_offset += alignment - (ctx->fmt_offset % alignment);
          }
        }
        return ts;
      case 'x':
        if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
        ctx->fmt_offset += ctx->new_count;
        ctx->new_count = 1;
        ctx->enc_count = 0;
        ctx->enc_type = 0;
        ctx->enc_packmode = ctx->new_packmode;
        ++ts;
        break;
      case 'Z':
        got_Z = 1;
        ++ts;
        if (*ts != 'f' && *ts != 'd' && *ts != 'g') {
          __Pyx_BufFmt_RaiseUnexpectedChar('Z');
          return NULL;
        }
      case 'c': case 'b': case 'B': case 'h': case 'H': case 'i': case 'I':
      case 'l': case 'L': case 'q': case 'Q':
      case 'f': case 'd': case 'g':
      case 'O': case 'p':
        if (ctx->enc_type == *ts && got_Z == ctx->is_complex &&
            ctx->enc_packmode == ctx->new_packmode) {
          ctx->enc_count += ctx->new_count;
          ctx->new_count = 1;
          got_Z = 0;
          ++ts;
          break;
        }
      case 's':
        if (__Pyx_BufFmt_ProcessTypeChunk(ctx) == -1) return NULL;
        ctx->enc_count = ctx->new_count;
        ctx->enc_packmode = ctx->new_packmode;
        ctx->enc_type = *ts;
        ctx->is_complex = got_Z;
        ++ts;
        ctx->new_count = 1;
        got_Z = 0;
        break;
      case ':':
        ++ts;
        while(*ts != ':') ++ts;
        ++ts;
        break;
      case '(':
        if (!__pyx_buffmt_parse_array(ctx, &ts)) return NULL;
        break;
      default:
        {
          int number = __Pyx_BufFmt_ExpectNumber(&ts);
          if (number == -1) return NULL;
          ctx->new_count = (size_t)number;
        }
    }
  }
}
static CYTHON_INLINE void __Pyx_ZeroBuffer(Py_buffer* buf) {
  buf->buf = NULL;
  buf->obj = NULL;
  buf->strides = __Pyx_zeros;
  buf->shape = __Pyx_zeros;
  buf->suboffsets = __Pyx_minusones;
}
static CYTHON_INLINE int __Pyx_GetBufferAndValidate(
        Py_buffer* buf, PyObject* obj,  __Pyx_TypeInfo* dtype, int flags,
        int nd, int cast, __Pyx_BufFmt_StackElem* stack)
{
  if (obj == Py_None || obj == NULL) {
    __Pyx_ZeroBuffer(buf);
    return 0;
  }
  buf->buf = NULL;
  if (__Pyx_GetBuffer(obj, buf, flags) == -1) goto fail;
  if (buf->ndim != nd) {
    PyErr_Format(PyExc_ValueError,
                 "Buffer has wrong number of dimensions (expected %d, got %d)",
                 nd, buf->ndim);
    goto fail;
  }
  if (!cast) {
    __Pyx_BufFmt_Context ctx;
    __Pyx_BufFmt_Init(&ctx, stack, dtype);
    if (!__Pyx_BufFmt_CheckString(&ctx, buf->format)) goto fail;
  }
  if ((unsigned)buf->itemsize != dtype->size) {
    PyErr_Format(PyExc_ValueError,
      "Item size of buffer (%" CYTHON_FORMAT_SSIZE_T "d byte%s) does not match size of '%s' (%" CYTHON_FORMAT_SSIZE_T "d byte%s)",
      buf->itemsize, (buf->itemsize > 1) ? "s" : "",
      dtype->name, (Py_ssize_t)dtype->size, (dtype->size > 1) ? "s" : "");
    goto fail;
  }
  if (buf->suboffsets == NULL) buf->suboffsets = __Pyx_minusones;
  return 0;
fail:;
  __Pyx_ZeroBuffer(buf);
  return -1;
}
static CYTHON_INLINE void __Pyx_SafeReleaseBuffer(Py_buffer* info) {
  if (info->buf == NULL) return;
  if (info->suboffsets == __Pyx_minusones) info->suboffsets = NULL;
  __Pyx_ReleaseBuffer(info);
}

/* PyObjectCallNoArg */
      #if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE PyObject* __Pyx_PyObject_CallNoArg(PyObject *func) {
#ifdef __Pyx_CyFunction_USED
    if (likely(PyCFunction_Check(func) || PyObject_TypeCheck(func, __pyx_CyFunctionType))) {
#else
    if (likely(PyCFunction_Check(func))) {
#endif
        if (likely(PyCFunction_GET_FLAGS(func) & METH_NOARGS)) {
            return __Pyx_PyObject_CallMethO(func, NULL);
        }
    }
    return __Pyx_PyObject_Call(func, __pyx_empty_tuple, NULL);
}
#endif

/* BufferFallbackError */
        static void __Pyx_RaiseBufferFallbackError(void) {
  PyErr_SetString(PyExc_ValueError,
     "Buffer acquisition failed on assignment; and then reacquiring the old buffer failed too!");
}

/* PyIntBinop */
        #if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx_PyInt_SubtractObjC(PyObject *op1, PyObject *op2, CYTHON_UNUSED long intval, CYTHON_UNUSED int inplace) {
    #if PY_MAJOR_VERSION < 3
    if (likely(PyInt_CheckExact(op1))) {
        const long b = intval;
        long x;
        long a = PyInt_AS_LONG(op1);
            x = (long)((unsigned long)a - b);
            if (likely((x^a) >= 0 || (x^~b) >= 0))
                return PyInt_FromLong(x);
            return PyLong_Type.tp_as_number->nb_subtract(op1, op2);
    }
    #endif
    #if CYTHON_USE_PYLONG_INTERNALS && PY_MAJOR_VERSION >= 3
    if (likely(PyLong_CheckExact(op1))) {
        const long b = intval;
        long a, x;
        const PY_LONG_LONG llb = intval;
        PY_LONG_LONG lla, llx;
        const digit* digits = ((PyLongObject*)op1)->ob_digit;
        const Py_ssize_t size = Py_SIZE(op1);
        if (likely(__Pyx_sst_abs(size) <= 1)) {
            a = likely(size) ? digits[0] : 0;
            if (size == -1) a = -a;
        } else {
            switch (size) {
                case -2:
                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                        a = -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
                        lla = -(PY_LONG_LONG) (((((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case 2:
                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                        a = (long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 2 * PyLong_SHIFT) {
                        lla = (PY_LONG_LONG) (((((unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case -3:
                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                        a = -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
                        lla = -(PY_LONG_LONG) (((((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case 3:
                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                        a = (long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 3 * PyLong_SHIFT) {
                        lla = (PY_LONG_LONG) (((((((unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case -4:
                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
                        a = -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
                        lla = -(PY_LONG_LONG) (((((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                case 4:
                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
                        a = (long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    } else if (8 * sizeof(PY_LONG_LONG) - 1 > 4 * PyLong_SHIFT) {
                        lla = (PY_LONG_LONG) (((((((((unsigned PY_LONG_LONG)digits[3]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[2]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[1]) << PyLong_SHIFT) | (unsigned PY_LONG_LONG)digits[0]));
                        goto long_long;
                    }
                default: return PyLong_Type.tp_as_number->nb_subtract(op1, op2);
            }
        }
                x = a - b;
            return PyLong_FromLong(x);
        long_long:
                llx = lla - llb;
            return PyLong_FromLongLong(llx);
    }
    #endif
    if (PyFloat_CheckExact(op1)) {
        const long b = intval;
        double a = PyFloat_AS_DOUBLE(op1);
            double result;
            PyFPE_START_PROTECT("subtract", return NULL)
            result = ((double)a) - (double)b;
            PyFPE_END_PROTECT(result)
            return PyFloat_FromDouble(result);
    }
    return (inplace ? PyNumber_InPlaceSubtract : PyNumber_Subtract)(op1, op2);
}
#endif

/* PyErrFetchRestore */
        #if CYTHON_COMPILING_IN_CPYTHON
static CYTHON_INLINE void __Pyx_ErrRestoreInState(PyThreadState *tstate, PyObject *type, PyObject *value, PyObject *tb) {
    PyObject *tmp_type, *tmp_value, *tmp_tb;
    tmp_type = tstate->curexc_type;
    tmp_value = tstate->curexc_value;
    tmp_tb = tstate->curexc_traceback;
    tstate->curexc_type = type;
    tstate->curexc_value = value;
    tstate->curexc_traceback = tb;
    Py_XDECREF(tmp_type);
    Py_XDECREF(tmp_value);
    Py_XDECREF(tmp_tb);
}
static CYTHON_INLINE void __Pyx_ErrFetchInState(PyThreadState *tstate, PyObject **type, PyObject **value, PyObject **tb) {
    *type = tstate->curexc_type;
    *value = tstate->curexc_value;
    *tb = tstate->curexc_traceback;
    tstate->curexc_type = 0;
    tstate->curexc_value = 0;
    tstate->curexc_traceback = 0;
}
#endif

/* RaiseTooManyValuesToUnpack */
        static CYTHON_INLINE void __Pyx_RaiseTooManyValuesError(Py_ssize_t expected) {
    PyErr_Format(PyExc_ValueError,
                 "too many values to unpack (expected %" CYTHON_FORMAT_SSIZE_T "d)", expected);
}

/* RaiseNeedMoreValuesToUnpack */
        static CYTHON_INLINE void __Pyx_RaiseNeedMoreValuesError(Py_ssize_t index) {
    PyErr_Format(PyExc_ValueError,
                 "need more than %" CYTHON_FORMAT_SSIZE_T "d value%.1s to unpack",
                 index, (index == 1) ? "" : "s");
}

/* IterFinish */
        static CYTHON_INLINE int __Pyx_IterFinish(void) {
#if CYTHON_COMPILING_IN_CPYTHON
    PyThreadState *tstate = PyThreadState_GET();
    PyObject* exc_type = tstate->curexc_type;
    if (unlikely(exc_type)) {
        if (likely(exc_type == PyExc_StopIteration) || PyErr_GivenExceptionMatches(exc_type, PyExc_StopIteration)) {
            PyObject *exc_value, *exc_tb;
            exc_value = tstate->curexc_value;
            exc_tb = tstate->curexc_traceback;
            tstate->curexc_type = 0;
            tstate->curexc_value = 0;
            tstate->curexc_traceback = 0;
            Py_DECREF(exc_type);
            Py_XDECREF(exc_value);
            Py_XDECREF(exc_tb);
            return 0;
        } else {
            return -1;
        }
    }
    return 0;
#else
    if (unlikely(PyErr_Occurred())) {
        if (likely(PyErr_ExceptionMatches(PyExc_StopIteration))) {
            PyErr_Clear();
            return 0;
        } else {
            return -1;
        }
    }
    return 0;
#endif
}

/* UnpackItemEndCheck */
        static int __Pyx_IternextUnpackEndCheck(PyObject *retval, Py_ssize_t expected) {
    if (unlikely(retval)) {
        Py_DECREF(retval);
        __Pyx_RaiseTooManyValuesError(expected);
        return -1;
    } else {
        return __Pyx_IterFinish();
    }
    return 0;
}

/* GetItemInt */
        static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Generic(PyObject *o, PyObject* j) {
    PyObject *r;
    if (!j) return NULL;
    r = PyObject_GetItem(o, j);
    Py_DECREF(j);
    return r;
}
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_List_Fast(PyObject *o, Py_ssize_t i,
                                                              CYTHON_NCP_UNUSED int wraparound,
                                                              CYTHON_NCP_UNUSED int boundscheck) {
#if CYTHON_COMPILING_IN_CPYTHON
    if (wraparound & unlikely(i < 0)) i += PyList_GET_SIZE(o);
    if ((!boundscheck) || likely((0 <= i) & (i < PyList_GET_SIZE(o)))) {
        PyObject *r = PyList_GET_ITEM(o, i);
        Py_INCREF(r);
        return r;
    }
    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
#else
    return PySequence_GetItem(o, i);
#endif
}
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Tuple_Fast(PyObject *o, Py_ssize_t i,
                                                              CYTHON_NCP_UNUSED int wraparound,
                                                              CYTHON_NCP_UNUSED int boundscheck) {
#if CYTHON_COMPILING_IN_CPYTHON
    if (wraparound & unlikely(i < 0)) i += PyTuple_GET_SIZE(o);
    if ((!boundscheck) || likely((0 <= i) & (i < PyTuple_GET_SIZE(o)))) {
        PyObject *r = PyTuple_GET_ITEM(o, i);
        Py_INCREF(r);
        return r;
    }
    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
#else
    return PySequence_GetItem(o, i);
#endif
}
static CYTHON_INLINE PyObject *__Pyx_GetItemInt_Fast(PyObject *o, Py_ssize_t i, int is_list,
                                                     CYTHON_NCP_UNUSED int wraparound,
                                                     CYTHON_NCP_UNUSED int boundscheck) {
#if CYTHON_COMPILING_IN_CPYTHON
    if (is_list || PyList_CheckExact(o)) {
        Py_ssize_t n = ((!wraparound) | likely(i >= 0)) ? i : i + PyList_GET_SIZE(o);
        if ((!boundscheck) || (likely((n >= 0) & (n < PyList_GET_SIZE(o))))) {
            PyObject *r = PyList_GET_ITEM(o, n);
            Py_INCREF(r);
            return r;
        }
    }
    else if (PyTuple_CheckExact(o)) {
        Py_ssize_t n = ((!wraparound) | likely(i >= 0)) ? i : i + PyTuple_GET_SIZE(o);
        if ((!boundscheck) || likely((n >= 0) & (n < PyTuple_GET_SIZE(o)))) {
            PyObject *r = PyTuple_GET_ITEM(o, n);
            Py_INCREF(r);
            return r;
        }
    } else {
        PySequenceMethods *m = Py_TYPE(o)->tp_as_sequence;
        if (likely(m && m->sq_item)) {
            if (wraparound && unlikely(i < 0) && likely(m->sq_length)) {
                Py_ssize_t l = m->sq_length(o);
                if (likely(l >= 0)) {
                    i += l;
                } else {
                    if (!PyErr_ExceptionMatches(PyExc_OverflowError))
                        return NULL;
                    PyErr_Clear();
                }
            }
            return m->sq_item(o, i);
        }
    }
#else
    if (is_list || PySequence_Check(o)) {
        return PySequence_GetItem(o, i);
    }
#endif
    return __Pyx_GetItemInt_Generic(o, PyInt_FromSsize_t(i));
}

/* RaiseException */
        #if PY_MAJOR_VERSION < 3
static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb,
                        CYTHON_UNUSED PyObject *cause) {
    __Pyx_PyThreadState_declare
    Py_XINCREF(type);
    if (!value || value == Py_None)
        value = NULL;
    else
        Py_INCREF(value);
    if (!tb || tb == Py_None)
        tb = NULL;
    else {
        Py_INCREF(tb);
        if (!PyTraceBack_Check(tb)) {
            PyErr_SetString(PyExc_TypeError,
                "raise: arg 3 must be a traceback or None");
            goto raise_error;
        }
    }
    if (PyType_Check(type)) {
#if CYTHON_COMPILING_IN_PYPY
        if (!value) {
            Py_INCREF(Py_None);
            value = Py_None;
        }
#endif
        PyErr_NormalizeException(&type, &value, &tb);
    } else {
        if (value) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto raise_error;
        }
        value = type;
        type = (PyObject*) Py_TYPE(type);
        Py_INCREF(type);
        if (!PyType_IsSubtype((PyTypeObject *)type, (PyTypeObject *)PyExc_BaseException)) {
            PyErr_SetString(PyExc_TypeError,
                "raise: exception class must be a subclass of BaseException");
            goto raise_error;
        }
    }
    __Pyx_PyThreadState_assign
    __Pyx_ErrRestore(type, value, tb);
    return;
raise_error:
    Py_XDECREF(value);
    Py_XDECREF(type);
    Py_XDECREF(tb);
    return;
}
#else
static void __Pyx_Raise(PyObject *type, PyObject *value, PyObject *tb, PyObject *cause) {
    PyObject* owned_instance = NULL;
    if (tb == Py_None) {
        tb = 0;
    } else if (tb && !PyTraceBack_Check(tb)) {
        PyErr_SetString(PyExc_TypeError,
            "raise: arg 3 must be a traceback or None");
        goto bad;
    }
    if (value == Py_None)
        value = 0;
    if (PyExceptionInstance_Check(type)) {
        if (value) {
            PyErr_SetString(PyExc_TypeError,
                "instance exception may not have a separate value");
            goto bad;
        }
        value = type;
        type = (PyObject*) Py_TYPE(value);
    } else if (PyExceptionClass_Check(type)) {
        PyObject *instance_class = NULL;
        if (value && PyExceptionInstance_Check(value)) {
            instance_class = (PyObject*) Py_TYPE(value);
            if (instance_class != type) {
                int is_subclass = PyObject_IsSubclass(instance_class, type);
                if (!is_subclass) {
                    instance_class = NULL;
                } else if (unlikely(is_subclass == -1)) {
                    goto bad;
                } else {
                    type = instance_class;
                }
            }
        }
        if (!instance_class) {
            PyObject *args;
            if (!value)
                args = PyTuple_New(0);
            else if (PyTuple_Check(value)) {
                Py_INCREF(value);
                args = value;
            } else
                args = PyTuple_Pack(1, value);
            if (!args)
                goto bad;
            owned_instance = PyObject_Call(type, args, NULL);
            Py_DECREF(args);
            if (!owned_instance)
                goto bad;
            value = owned_instance;
            if (!PyExceptionInstance_Check(value)) {
                PyErr_Format(PyExc_TypeError,
                             "calling %R should have returned an instance of "
                             "BaseException, not %R",
                             type, Py_TYPE(value));
                goto bad;
            }
        }
    } else {
        PyErr_SetString(PyExc_TypeError,
            "raise: exception class must be a subclass of BaseException");
        goto bad;
    }
#if PY_VERSION_HEX >= 0x03030000
    if (cause) {
#else
    if (cause && cause != Py_None) {
#endif
        PyObject *fixed_cause;
        if (cause == Py_None) {
            fixed_cause = NULL;
        } else if (PyExceptionClass_Check(cause)) {
            fixed_cause = PyObject_CallObject(cause, NULL);
            if (fixed_cause == NULL)
                goto bad;
        } else if (PyExceptionInstance_Check(cause)) {
            fixed_cause = cause;
            Py_INCREF(fixed_cause);
        } else {
            PyErr_SetString(PyExc_TypeError,
                            "exception causes must derive from "
                            "BaseException");
            goto bad;
        }
        PyException_SetCause(value, fixed_cause);
    }
    PyErr_SetObject(type, value);
    if (tb) {
#if CYTHON_COMPILING_IN_PYPY
        PyObject *tmp_type, *tmp_value, *tmp_tb;
        PyErr_Fetch(&tmp_type, &tmp_value, &tmp_tb);
        Py_INCREF(tb);
        PyErr_Restore(tmp_type, tmp_value, tb);
        Py_XDECREF(tmp_tb);
#else
        PyThreadState *tstate = PyThreadState_GET();
        PyObject* tmp_tb = tstate->curexc_traceback;
        if (tb != tmp_tb) {
            Py_INCREF(tb);
            tstate->curexc_traceback = tb;
            Py_XDECREF(tmp_tb);
        }
#endif
    }
bad:
    Py_XDECREF(owned_instance);
    return;
}
#endif

/* RaiseNoneIterError */
          static CYTHON_INLINE void __Pyx_RaiseNoneNotIterableError(void) {
    PyErr_SetString(PyExc_TypeError, "'NoneType' object is not iterable");
}

/* Import */
          static PyObject *__Pyx_Import(PyObject *name, PyObject *from_list, int level) {
    PyObject *empty_list = 0;
    PyObject *module = 0;
    PyObject *global_dict = 0;
    PyObject *empty_dict = 0;
    PyObject *list;
    #if PY_VERSION_HEX < 0x03030000
    PyObject *py_import;
    py_import = __Pyx_PyObject_GetAttrStr(__pyx_b, __pyx_n_s_import);
    if (!py_import)
        goto bad;
    #endif
    if (from_list)
        list = from_list;
    else {
        empty_list = PyList_New(0);
        if (!empty_list)
            goto bad;
        list = empty_list;
    }
    global_dict = PyModule_GetDict(__pyx_m);
    if (!global_dict)
        goto bad;
    empty_dict = PyDict_New();
    if (!empty_dict)
        goto bad;
    {
        #if PY_MAJOR_VERSION >= 3
        if (level == -1) {
            if (strchr(__Pyx_MODULE_NAME, '.')) {
                #if PY_VERSION_HEX < 0x03030000
                PyObject *py_level = PyInt_FromLong(1);
                if (!py_level)
                    goto bad;
                module = PyObject_CallFunctionObjArgs(py_import,
                    name, global_dict, empty_dict, list, py_level, NULL);
                Py_DECREF(py_level);
                #else
                module = PyImport_ImportModuleLevelObject(
                    name, global_dict, empty_dict, list, 1);
                #endif
                if (!module) {
                    if (!PyErr_ExceptionMatches(PyExc_ImportError))
                        goto bad;
                    PyErr_Clear();
                }
            }
            level = 0;
        }
        #endif
        if (!module) {
            #if PY_VERSION_HEX < 0x03030000
            PyObject *py_level = PyInt_FromLong(level);
            if (!py_level)
                goto bad;
            module = PyObject_CallFunctionObjArgs(py_import,
                name, global_dict, empty_dict, list, py_level, NULL);
            Py_DECREF(py_level);
            #else
            module = PyImport_ImportModuleLevelObject(
                name, global_dict, empty_dict, list, level);
            #endif
        }
    }
bad:
    #if PY_VERSION_HEX < 0x03030000
    Py_XDECREF(py_import);
    #endif
    Py_XDECREF(empty_list);
    Py_XDECREF(empty_dict);
    return module;
}

/* ImportFrom */
          static PyObject* __Pyx_ImportFrom(PyObject* module, PyObject* name) {
    PyObject* value = __Pyx_PyObject_GetAttrStr(module, name);
    if (unlikely(!value) && PyErr_ExceptionMatches(PyExc_AttributeError)) {
        PyErr_Format(PyExc_ImportError,
        #if PY_MAJOR_VERSION < 3
            "cannot import name %.230s", PyString_AS_STRING(name));
        #else
            "cannot import name %S", name);
        #endif
    }
    return value;
}

/* PyIntBinop */
          #if CYTHON_COMPILING_IN_CPYTHON
static PyObject* __Pyx_PyInt_TrueDivideObjC(PyObject *op1, PyObject *op2, CYTHON_UNUSED long intval, CYTHON_UNUSED int inplace) {
    #if PY_MAJOR_VERSION < 3
    if (likely(PyInt_CheckExact(op1))) {
        const long b = intval;
        long a = PyInt_AS_LONG(op1);
            if (8 * sizeof(long) <= 53 || likely(labs(a) <= (1L << 53))) {
                return PyFloat_FromDouble((double)a / (double)b);
            }
            return PyInt_Type.tp_as_number->nb_true_divide(op1, op2);
    }
    #endif
    #if CYTHON_USE_PYLONG_INTERNALS && PY_MAJOR_VERSION >= 3
    if (likely(PyLong_CheckExact(op1))) {
        const long b = intval;
        long a, x;
        const digit* digits = ((PyLongObject*)op1)->ob_digit;
        const Py_ssize_t size = Py_SIZE(op1);
        if (likely(__Pyx_sst_abs(size) <= 1)) {
            a = likely(size) ? digits[0] : 0;
            if (size == -1) a = -a;
        } else {
            switch (size) {
                case -2:
                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT && 1 * PyLong_SHIFT < 53) {
                        a = -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    }
                case 2:
                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT && 1 * PyLong_SHIFT < 53) {
                        a = (long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    }
                case -3:
                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT && 2 * PyLong_SHIFT < 53) {
                        a = -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    }
                case 3:
                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT && 2 * PyLong_SHIFT < 53) {
                        a = (long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    }
                case -4:
                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT && 3 * PyLong_SHIFT < 53) {
                        a = -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    }
                case 4:
                    if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT && 3 * PyLong_SHIFT < 53) {
                        a = (long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0]));
                        break;
                    }
                default: return PyLong_Type.tp_as_number->nb_true_divide(op1, op2);
            }
        }
                if ((8 * sizeof(long) <= 53 || likely(labs(a) <= (1L << 53)))
                    || __Pyx_sst_abs(size) <= 52 / PyLong_SHIFT) {
                    return PyFloat_FromDouble((double)a / (double)b);
                }
                return PyLong_Type.tp_as_number->nb_true_divide(op1, op2);
            return PyLong_FromLong(x);
    }
    #endif
    if (PyFloat_CheckExact(op1)) {
        const long b = intval;
        double a = PyFloat_AS_DOUBLE(op1);
            double result;
            PyFPE_START_PROTECT("divide", return NULL)
            result = ((double)a) / (double)b;
            PyFPE_END_PROTECT(result)
            return PyFloat_FromDouble(result);
    }
    return (inplace ? PyNumber_InPlaceTrueDivide : PyNumber_TrueDivide)(op1, op2);
}
#endif

/* CodeObjectCache */
          static int __pyx_bisect_code_objects(__Pyx_CodeObjectCacheEntry* entries, int count, int code_line) {
    int start = 0, mid = 0, end = count - 1;
    if (end >= 0 && code_line > entries[end].code_line) {
        return count;
    }
    while (start < end) {
        mid = start + (end - start) / 2;
        if (code_line < entries[mid].code_line) {
            end = mid;
        } else if (code_line > entries[mid].code_line) {
             start = mid + 1;
        } else {
            return mid;
        }
    }
    if (code_line <= entries[mid].code_line) {
        return mid;
    } else {
        return mid + 1;
    }
}
static PyCodeObject *__pyx_find_code_object(int code_line) {
    PyCodeObject* code_object;
    int pos;
    if (unlikely(!code_line) || unlikely(!__pyx_code_cache.entries)) {
        return NULL;
    }
    pos = __pyx_bisect_code_objects(__pyx_code_cache.entries, __pyx_code_cache.count, code_line);
    if (unlikely(pos >= __pyx_code_cache.count) || unlikely(__pyx_code_cache.entries[pos].code_line != code_line)) {
        return NULL;
    }
    code_object = __pyx_code_cache.entries[pos].code_object;
    Py_INCREF(code_object);
    return code_object;
}
static void __pyx_insert_code_object(int code_line, PyCodeObject* code_object) {
    int pos, i;
    __Pyx_CodeObjectCacheEntry* entries = __pyx_code_cache.entries;
    if (unlikely(!code_line)) {
        return;
    }
    if (unlikely(!entries)) {
        entries = (__Pyx_CodeObjectCacheEntry*)PyMem_Malloc(64*sizeof(__Pyx_CodeObjectCacheEntry));
        if (likely(entries)) {
            __pyx_code_cache.entries = entries;
            __pyx_code_cache.max_count = 64;
            __pyx_code_cache.count = 1;
            entries[0].code_line = code_line;
            entries[0].code_object = code_object;
            Py_INCREF(code_object);
        }
        return;
    }
    pos = __pyx_bisect_code_objects(__pyx_code_cache.entries, __pyx_code_cache.count, code_line);
    if ((pos < __pyx_code_cache.count) && unlikely(__pyx_code_cache.entries[pos].code_line == code_line)) {
        PyCodeObject* tmp = entries[pos].code_object;
        entries[pos].code_object = code_object;
        Py_DECREF(tmp);
        return;
    }
    if (__pyx_code_cache.count == __pyx_code_cache.max_count) {
        int new_max = __pyx_code_cache.max_count + 64;
        entries = (__Pyx_CodeObjectCacheEntry*)PyMem_Realloc(
            __pyx_code_cache.entries, (size_t)new_max*sizeof(__Pyx_CodeObjectCacheEntry));
        if (unlikely(!entries)) {
            return;
        }
        __pyx_code_cache.entries = entries;
        __pyx_code_cache.max_count = new_max;
    }
    for (i=__pyx_code_cache.count; i>pos; i--) {
        entries[i] = entries[i-1];
    }
    entries[pos].code_line = code_line;
    entries[pos].code_object = code_object;
    __pyx_code_cache.count++;
    Py_INCREF(code_object);
}

/* AddTraceback */
          #include "compile.h"
#include "frameobject.h"
#include "traceback.h"
static PyCodeObject* __Pyx_CreateCodeObjectForTraceback(
            const char *funcname, int c_line,
            int py_line, const char *filename) {
    PyCodeObject *py_code = 0;
    PyObject *py_srcfile = 0;
    PyObject *py_funcname = 0;
    #if PY_MAJOR_VERSION < 3
    py_srcfile = PyString_FromString(filename);
    #else
    py_srcfile = PyUnicode_FromString(filename);
    #endif
    if (!py_srcfile) goto bad;
    if (c_line) {
        #if PY_MAJOR_VERSION < 3
        py_funcname = PyString_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, c_line);
        #else
        py_funcname = PyUnicode_FromFormat( "%s (%s:%d)", funcname, __pyx_cfilenm, c_line);
        #endif
    }
    else {
        #if PY_MAJOR_VERSION < 3
        py_funcname = PyString_FromString(funcname);
        #else
        py_funcname = PyUnicode_FromString(funcname);
        #endif
    }
    if (!py_funcname) goto bad;
    py_code = __Pyx_PyCode_New(
        0,
        0,
        0,
        0,
        0,
        __pyx_empty_bytes, /*PyObject *code,*/
        __pyx_empty_tuple, /*PyObject *consts,*/
        __pyx_empty_tuple, /*PyObject *names,*/
        __pyx_empty_tuple, /*PyObject *varnames,*/
        __pyx_empty_tuple, /*PyObject *freevars,*/
        __pyx_empty_tuple, /*PyObject *cellvars,*/
        py_srcfile,   /*PyObject *filename,*/
        py_funcname,  /*PyObject *name,*/
        py_line,
        __pyx_empty_bytes  /*PyObject *lnotab*/
    );
    Py_DECREF(py_srcfile);
    Py_DECREF(py_funcname);
    return py_code;
bad:
    Py_XDECREF(py_srcfile);
    Py_XDECREF(py_funcname);
    return NULL;
}
static void __Pyx_AddTraceback(const char *funcname, int c_line,
                               int py_line, const char *filename) {
    PyCodeObject *py_code = 0;
    PyFrameObject *py_frame = 0;
    py_code = __pyx_find_code_object(c_line ? c_line : py_line);
    if (!py_code) {
        py_code = __Pyx_CreateCodeObjectForTraceback(
            funcname, c_line, py_line, filename);
        if (!py_code) goto bad;
        __pyx_insert_code_object(c_line ? c_line : py_line, py_code);
    }
    py_frame = PyFrame_New(
        PyThreadState_GET(), /*PyThreadState *tstate,*/
        py_code,             /*PyCodeObject *code,*/
        __pyx_d,      /*PyObject *globals,*/
        0                    /*PyObject *locals*/
    );
    if (!py_frame) goto bad;
    py_frame->f_lineno = py_line;
    PyTraceBack_Here(py_frame);
bad:
    Py_XDECREF(py_code);
    Py_XDECREF(py_frame);
}

#if PY_MAJOR_VERSION < 3
static int __Pyx_GetBuffer(PyObject *obj, Py_buffer *view, int flags) {
    if (PyObject_CheckBuffer(obj)) return PyObject_GetBuffer(obj, view, flags);
        if (PyObject_TypeCheck(obj, __pyx_ptype_5numpy_ndarray)) return __pyx_pw_5numpy_7ndarray_1__getbuffer__(obj, view, flags);
    PyErr_Format(PyExc_TypeError, "'%.200s' does not have the buffer interface", Py_TYPE(obj)->tp_name);
    return -1;
}
static void __Pyx_ReleaseBuffer(Py_buffer *view) {
    PyObject *obj = view->obj;
    if (!obj) return;
    if (PyObject_CheckBuffer(obj)) {
        PyBuffer_Release(view);
        return;
    }
        if (PyObject_TypeCheck(obj, __pyx_ptype_5numpy_ndarray)) { __pyx_pw_5numpy_7ndarray_3__releasebuffer__(obj, view); return; }
    Py_DECREF(obj);
    view->obj = NULL;
}
#endif


          /* CIntFromPyVerify */
          #define __PYX_VERIFY_RETURN_INT(target_type, func_type, func_value)\
    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 0)
#define __PYX_VERIFY_RETURN_INT_EXC(target_type, func_type, func_value)\
    __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, 1)
#define __PYX__VERIFY_RETURN_INT(target_type, func_type, func_value, exc)\
    {\
        func_type value = func_value;\
        if (sizeof(target_type) < sizeof(func_type)) {\
            if (unlikely(value != (func_type) (target_type) value)) {\
                func_type zero = 0;\
                if (exc && unlikely(value == (func_type)-1 && PyErr_Occurred()))\
                    return (target_type) -1;\
                if (is_unsigned && unlikely(value < zero))\
                    goto raise_neg_overflow;\
                else\
                    goto raise_overflow;\
            }\
        }\
        return (target_type) value;\
    }

/* CIntToPy */
          static CYTHON_INLINE PyObject* __Pyx_PyInt_From_int(int value) {
    const int neg_one = (int) -1, const_zero = (int) 0;
    const int is_unsigned = neg_one > const_zero;
    if (is_unsigned) {
        if (sizeof(int) < sizeof(long)) {
            return PyInt_FromLong((long) value);
        } else if (sizeof(int) <= sizeof(unsigned long)) {
            return PyLong_FromUnsignedLong((unsigned long) value);
        } else if (sizeof(int) <= sizeof(unsigned PY_LONG_LONG)) {
            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
        }
    } else {
        if (sizeof(int) <= sizeof(long)) {
            return PyInt_FromLong((long) value);
        } else if (sizeof(int) <= sizeof(PY_LONG_LONG)) {
            return PyLong_FromLongLong((PY_LONG_LONG) value);
        }
    }
    {
        int one = 1; int little = (int)*(unsigned char *)&one;
        unsigned char *bytes = (unsigned char *)&value;
        return _PyLong_FromByteArray(bytes, sizeof(int),
                                     little, !is_unsigned);
    }
}

/* CIntToPy */
          static CYTHON_INLINE PyObject* __Pyx_PyInt_From_long(long value) {
    const long neg_one = (long) -1, const_zero = (long) 0;
    const int is_unsigned = neg_one > const_zero;
    if (is_unsigned) {
        if (sizeof(long) < sizeof(long)) {
            return PyInt_FromLong((long) value);
        } else if (sizeof(long) <= sizeof(unsigned long)) {
            return PyLong_FromUnsignedLong((unsigned long) value);
        } else if (sizeof(long) <= sizeof(unsigned PY_LONG_LONG)) {
            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
        }
    } else {
        if (sizeof(long) <= sizeof(long)) {
            return PyInt_FromLong((long) value);
        } else if (sizeof(long) <= sizeof(PY_LONG_LONG)) {
            return PyLong_FromLongLong((PY_LONG_LONG) value);
        }
    }
    {
        int one = 1; int little = (int)*(unsigned char *)&one;
        unsigned char *bytes = (unsigned char *)&value;
        return _PyLong_FromByteArray(bytes, sizeof(long),
                                     little, !is_unsigned);
    }
}

/* None */
          #if CYTHON_CCOMPLEX
  #ifdef __cplusplus
    static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float x, float y) {
      return ::std::complex< float >(x, y);
    }
  #else
    static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float x, float y) {
      return x + y*(__pyx_t_float_complex)_Complex_I;
    }
  #endif
#else
    static CYTHON_INLINE __pyx_t_float_complex __pyx_t_float_complex_from_parts(float x, float y) {
      __pyx_t_float_complex z;
      z.real = x;
      z.imag = y;
      return z;
    }
#endif

/* None */
          #if CYTHON_CCOMPLEX
#else
    static CYTHON_INLINE int __Pyx_c_eqf(__pyx_t_float_complex a, __pyx_t_float_complex b) {
       return (a.real == b.real) && (a.imag == b.imag);
    }
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_sumf(__pyx_t_float_complex a, __pyx_t_float_complex b) {
        __pyx_t_float_complex z;
        z.real = a.real + b.real;
        z.imag = a.imag + b.imag;
        return z;
    }
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_difff(__pyx_t_float_complex a, __pyx_t_float_complex b) {
        __pyx_t_float_complex z;
        z.real = a.real - b.real;
        z.imag = a.imag - b.imag;
        return z;
    }
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_prodf(__pyx_t_float_complex a, __pyx_t_float_complex b) {
        __pyx_t_float_complex z;
        z.real = a.real * b.real - a.imag * b.imag;
        z.imag = a.real * b.imag + a.imag * b.real;
        return z;
    }
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_quotf(__pyx_t_float_complex a, __pyx_t_float_complex b) {
        __pyx_t_float_complex z;
        float denom = b.real * b.real + b.imag * b.imag;
        z.real = (a.real * b.real + a.imag * b.imag) / denom;
        z.imag = (a.imag * b.real - a.real * b.imag) / denom;
        return z;
    }
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_negf(__pyx_t_float_complex a) {
        __pyx_t_float_complex z;
        z.real = -a.real;
        z.imag = -a.imag;
        return z;
    }
    static CYTHON_INLINE int __Pyx_c_is_zerof(__pyx_t_float_complex a) {
       return (a.real == 0) && (a.imag == 0);
    }
    static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_conjf(__pyx_t_float_complex a) {
        __pyx_t_float_complex z;
        z.real =  a.real;
        z.imag = -a.imag;
        return z;
    }
    #if 1
        static CYTHON_INLINE float __Pyx_c_absf(__pyx_t_float_complex z) {
          #if !defined(HAVE_HYPOT) || defined(_MSC_VER)
            return sqrtf(z.real*z.real + z.imag*z.imag);
          #else
            return hypotf(z.real, z.imag);
          #endif
        }
        static CYTHON_INLINE __pyx_t_float_complex __Pyx_c_powf(__pyx_t_float_complex a, __pyx_t_float_complex b) {
            __pyx_t_float_complex z;
            float r, lnr, theta, z_r, z_theta;
            if (b.imag == 0 && b.real == (int)b.real) {
                if (b.real < 0) {
                    float denom = a.real * a.real + a.imag * a.imag;
                    a.real = a.real / denom;
                    a.imag = -a.imag / denom;
                    b.real = -b.real;
                }
                switch ((int)b.real) {
                    case 0:
                        z.real = 1;
                        z.imag = 0;
                        return z;
                    case 1:
                        return a;
                    case 2:
                        z = __Pyx_c_prodf(a, a);
                        return __Pyx_c_prodf(a, a);
                    case 3:
                        z = __Pyx_c_prodf(a, a);
                        return __Pyx_c_prodf(z, a);
                    case 4:
                        z = __Pyx_c_prodf(a, a);
                        return __Pyx_c_prodf(z, z);
                }
            }
            if (a.imag == 0) {
                if (a.real == 0) {
                    return a;
                }
                r = a.real;
                theta = 0;
            } else {
                r = __Pyx_c_absf(a);
                theta = atan2f(a.imag, a.real);
            }
            lnr = logf(r);
            z_r = expf(lnr * b.real - theta * b.imag);
            z_theta = theta * b.real + lnr * b.imag;
            z.real = z_r * cosf(z_theta);
            z.imag = z_r * sinf(z_theta);
            return z;
        }
    #endif
#endif

/* None */
          #if CYTHON_CCOMPLEX
  #ifdef __cplusplus
    static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
      return ::std::complex< double >(x, y);
    }
  #else
    static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
      return x + y*(__pyx_t_double_complex)_Complex_I;
    }
  #endif
#else
    static CYTHON_INLINE __pyx_t_double_complex __pyx_t_double_complex_from_parts(double x, double y) {
      __pyx_t_double_complex z;
      z.real = x;
      z.imag = y;
      return z;
    }
#endif

/* None */
          #if CYTHON_CCOMPLEX
#else
    static CYTHON_INLINE int __Pyx_c_eq(__pyx_t_double_complex a, __pyx_t_double_complex b) {
       return (a.real == b.real) && (a.imag == b.imag);
    }
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_sum(__pyx_t_double_complex a, __pyx_t_double_complex b) {
        __pyx_t_double_complex z;
        z.real = a.real + b.real;
        z.imag = a.imag + b.imag;
        return z;
    }
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_diff(__pyx_t_double_complex a, __pyx_t_double_complex b) {
        __pyx_t_double_complex z;
        z.real = a.real - b.real;
        z.imag = a.imag - b.imag;
        return z;
    }
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_prod(__pyx_t_double_complex a, __pyx_t_double_complex b) {
        __pyx_t_double_complex z;
        z.real = a.real * b.real - a.imag * b.imag;
        z.imag = a.real * b.imag + a.imag * b.real;
        return z;
    }
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_quot(__pyx_t_double_complex a, __pyx_t_double_complex b) {
        __pyx_t_double_complex z;
        double denom = b.real * b.real + b.imag * b.imag;
        z.real = (a.real * b.real + a.imag * b.imag) / denom;
        z.imag = (a.imag * b.real - a.real * b.imag) / denom;
        return z;
    }
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_neg(__pyx_t_double_complex a) {
        __pyx_t_double_complex z;
        z.real = -a.real;
        z.imag = -a.imag;
        return z;
    }
    static CYTHON_INLINE int __Pyx_c_is_zero(__pyx_t_double_complex a) {
       return (a.real == 0) && (a.imag == 0);
    }
    static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_conj(__pyx_t_double_complex a) {
        __pyx_t_double_complex z;
        z.real =  a.real;
        z.imag = -a.imag;
        return z;
    }
    #if 1
        static CYTHON_INLINE double __Pyx_c_abs(__pyx_t_double_complex z) {
          #if !defined(HAVE_HYPOT) || defined(_MSC_VER)
            return sqrt(z.real*z.real + z.imag*z.imag);
          #else
            return hypot(z.real, z.imag);
          #endif
        }
        static CYTHON_INLINE __pyx_t_double_complex __Pyx_c_pow(__pyx_t_double_complex a, __pyx_t_double_complex b) {
            __pyx_t_double_complex z;
            double r, lnr, theta, z_r, z_theta;
            if (b.imag == 0 && b.real == (int)b.real) {
                if (b.real < 0) {
                    double denom = a.real * a.real + a.imag * a.imag;
                    a.real = a.real / denom;
                    a.imag = -a.imag / denom;
                    b.real = -b.real;
                }
                switch ((int)b.real) {
                    case 0:
                        z.real = 1;
                        z.imag = 0;
                        return z;
                    case 1:
                        return a;
                    case 2:
                        z = __Pyx_c_prod(a, a);
                        return __Pyx_c_prod(a, a);
                    case 3:
                        z = __Pyx_c_prod(a, a);
                        return __Pyx_c_prod(z, a);
                    case 4:
                        z = __Pyx_c_prod(a, a);
                        return __Pyx_c_prod(z, z);
                }
            }
            if (a.imag == 0) {
                if (a.real == 0) {
                    return a;
                }
                r = a.real;
                theta = 0;
            } else {
                r = __Pyx_c_abs(a);
                theta = atan2(a.imag, a.real);
            }
            lnr = log(r);
            z_r = exp(lnr * b.real - theta * b.imag);
            z_theta = theta * b.real + lnr * b.imag;
            z.real = z_r * cos(z_theta);
            z.imag = z_r * sin(z_theta);
            return z;
        }
    #endif
#endif

/* CIntToPy */
          static CYTHON_INLINE PyObject* __Pyx_PyInt_From_enum__NPY_TYPES(enum NPY_TYPES value) {
    const enum NPY_TYPES neg_one = (enum NPY_TYPES) -1, const_zero = (enum NPY_TYPES) 0;
    const int is_unsigned = neg_one > const_zero;
    if (is_unsigned) {
        if (sizeof(enum NPY_TYPES) < sizeof(long)) {
            return PyInt_FromLong((long) value);
        } else if (sizeof(enum NPY_TYPES) <= sizeof(unsigned long)) {
            return PyLong_FromUnsignedLong((unsigned long) value);
        } else if (sizeof(enum NPY_TYPES) <= sizeof(unsigned PY_LONG_LONG)) {
            return PyLong_FromUnsignedLongLong((unsigned PY_LONG_LONG) value);
        }
    } else {
        if (sizeof(enum NPY_TYPES) <= sizeof(long)) {
            return PyInt_FromLong((long) value);
        } else if (sizeof(enum NPY_TYPES) <= sizeof(PY_LONG_LONG)) {
            return PyLong_FromLongLong((PY_LONG_LONG) value);
        }
    }
    {
        int one = 1; int little = (int)*(unsigned char *)&one;
        unsigned char *bytes = (unsigned char *)&value;
        return _PyLong_FromByteArray(bytes, sizeof(enum NPY_TYPES),
                                     little, !is_unsigned);
    }
}

/* CIntFromPy */
          static CYTHON_INLINE int __Pyx_PyInt_As_int(PyObject *x) {
    const int neg_one = (int) -1, const_zero = (int) 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_MAJOR_VERSION < 3
    if (likely(PyInt_Check(x))) {
        if (sizeof(int) < sizeof(long)) {
            __PYX_VERIFY_RETURN_INT(int, long, PyInt_AS_LONG(x))
        } else {
            long val = PyInt_AS_LONG(x);
            if (is_unsigned && unlikely(val < 0)) {
                goto raise_neg_overflow;
            }
            return (int) val;
        }
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
#if CYTHON_USE_PYLONG_INTERNALS
            const digit* digits = ((PyLongObject*)x)->ob_digit;
            switch (Py_SIZE(x)) {
                case  0: return (int) 0;
                case  1: __PYX_VERIFY_RETURN_INT(int, digit, digits[0])
                case 2:
                    if (8 * sizeof(int) > 1 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) >= 2 * PyLong_SHIFT) {
                            return (int) (((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
                        }
                    }
                    break;
                case 3:
                    if (8 * sizeof(int) > 2 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) >= 3 * PyLong_SHIFT) {
                            return (int) (((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
                        }
                    }
                    break;
                case 4:
                    if (8 * sizeof(int) > 3 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) >= 4 * PyLong_SHIFT) {
                            return (int) (((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0]));
                        }
                    }
                    break;
            }
#endif
#if CYTHON_COMPILING_IN_CPYTHON
            if (unlikely(Py_SIZE(x) < 0)) {
                goto raise_neg_overflow;
            }
#else
            {
                int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
                if (unlikely(result < 0))
                    return (int) -1;
                if (unlikely(result == 1))
                    goto raise_neg_overflow;
            }
#endif
            if (sizeof(int) <= sizeof(unsigned long)) {
                __PYX_VERIFY_RETURN_INT_EXC(int, unsigned long, PyLong_AsUnsignedLong(x))
            } else if (sizeof(int) <= sizeof(unsigned PY_LONG_LONG)) {
                __PYX_VERIFY_RETURN_INT_EXC(int, unsigned PY_LONG_LONG, PyLong_AsUnsignedLongLong(x))
            }
        } else {
#if CYTHON_USE_PYLONG_INTERNALS
            const digit* digits = ((PyLongObject*)x)->ob_digit;
            switch (Py_SIZE(x)) {
                case  0: return (int) 0;
                case -1: __PYX_VERIFY_RETURN_INT(int, sdigit, (sdigit) (-(sdigit)digits[0]))
                case  1: __PYX_VERIFY_RETURN_INT(int,  digit, +digits[0])
                case -2:
                    if (8 * sizeof(int) - 1 > 1 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, long, -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) - 1 > 2 * PyLong_SHIFT) {
                            return (int) (((int)-1)*(((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                        }
                    }
                    break;
                case 2:
                    if (8 * sizeof(int) > 1 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) - 1 > 2 * PyLong_SHIFT) {
                            return (int) ((((((int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                        }
                    }
                    break;
                case -3:
                    if (8 * sizeof(int) - 1 > 2 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, long, -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) - 1 > 3 * PyLong_SHIFT) {
                            return (int) (((int)-1)*(((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                        }
                    }
                    break;
                case 3:
                    if (8 * sizeof(int) > 2 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) - 1 > 3 * PyLong_SHIFT) {
                            return (int) ((((((((int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                        }
                    }
                    break;
                case -4:
                    if (8 * sizeof(int) - 1 > 3 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, long, -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) - 1 > 4 * PyLong_SHIFT) {
                            return (int) (((int)-1)*(((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                        }
                    }
                    break;
                case 4:
                    if (8 * sizeof(int) > 3 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(int, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(int) - 1 > 4 * PyLong_SHIFT) {
                            return (int) ((((((((((int)digits[3]) << PyLong_SHIFT) | (int)digits[2]) << PyLong_SHIFT) | (int)digits[1]) << PyLong_SHIFT) | (int)digits[0])));
                        }
                    }
                    break;
            }
#endif
            if (sizeof(int) <= sizeof(long)) {
                __PYX_VERIFY_RETURN_INT_EXC(int, long, PyLong_AsLong(x))
            } else if (sizeof(int) <= sizeof(PY_LONG_LONG)) {
                __PYX_VERIFY_RETURN_INT_EXC(int, PY_LONG_LONG, PyLong_AsLongLong(x))
            }
        }
        {
#if CYTHON_COMPILING_IN_PYPY && !defined(_PyLong_AsByteArray)
            PyErr_SetString(PyExc_RuntimeError,
                            "_PyLong_AsByteArray() not available in PyPy, cannot convert large numbers");
#else
            int val;
            PyObject *v = __Pyx_PyNumber_IntOrLong(x);
 #if PY_MAJOR_VERSION < 3
            if (likely(v) && !PyLong_Check(v)) {
                PyObject *tmp = v;
                v = PyNumber_Long(tmp);
                Py_DECREF(tmp);
            }
 #endif
            if (likely(v)) {
                int one = 1; int is_little = (int)*(unsigned char *)&one;
                unsigned char *bytes = (unsigned char *)&val;
                int ret = _PyLong_AsByteArray((PyLongObject *)v,
                                              bytes, sizeof(val),
                                              is_little, !is_unsigned);
                Py_DECREF(v);
                if (likely(!ret))
                    return val;
            }
#endif
            return (int) -1;
        }
    } else {
        int val;
        PyObject *tmp = __Pyx_PyNumber_IntOrLong(x);
        if (!tmp) return (int) -1;
        val = __Pyx_PyInt_As_int(tmp);
        Py_DECREF(tmp);
        return val;
    }
raise_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "value too large to convert to int");
    return (int) -1;
raise_neg_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "can't convert negative value to int");
    return (int) -1;
}

/* CIntFromPy */
          static CYTHON_INLINE long __Pyx_PyInt_As_long(PyObject *x) {
    const long neg_one = (long) -1, const_zero = (long) 0;
    const int is_unsigned = neg_one > const_zero;
#if PY_MAJOR_VERSION < 3
    if (likely(PyInt_Check(x))) {
        if (sizeof(long) < sizeof(long)) {
            __PYX_VERIFY_RETURN_INT(long, long, PyInt_AS_LONG(x))
        } else {
            long val = PyInt_AS_LONG(x);
            if (is_unsigned && unlikely(val < 0)) {
                goto raise_neg_overflow;
            }
            return (long) val;
        }
    } else
#endif
    if (likely(PyLong_Check(x))) {
        if (is_unsigned) {
#if CYTHON_USE_PYLONG_INTERNALS
            const digit* digits = ((PyLongObject*)x)->ob_digit;
            switch (Py_SIZE(x)) {
                case  0: return (long) 0;
                case  1: __PYX_VERIFY_RETURN_INT(long, digit, digits[0])
                case 2:
                    if (8 * sizeof(long) > 1 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) >= 2 * PyLong_SHIFT) {
                            return (long) (((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
                        }
                    }
                    break;
                case 3:
                    if (8 * sizeof(long) > 2 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) >= 3 * PyLong_SHIFT) {
                            return (long) (((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
                        }
                    }
                    break;
                case 4:
                    if (8 * sizeof(long) > 3 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) >= 4 * PyLong_SHIFT) {
                            return (long) (((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0]));
                        }
                    }
                    break;
            }
#endif
#if CYTHON_COMPILING_IN_CPYTHON
            if (unlikely(Py_SIZE(x) < 0)) {
                goto raise_neg_overflow;
            }
#else
            {
                int result = PyObject_RichCompareBool(x, Py_False, Py_LT);
                if (unlikely(result < 0))
                    return (long) -1;
                if (unlikely(result == 1))
                    goto raise_neg_overflow;
            }
#endif
            if (sizeof(long) <= sizeof(unsigned long)) {
                __PYX_VERIFY_RETURN_INT_EXC(long, unsigned long, PyLong_AsUnsignedLong(x))
            } else if (sizeof(long) <= sizeof(unsigned PY_LONG_LONG)) {
                __PYX_VERIFY_RETURN_INT_EXC(long, unsigned PY_LONG_LONG, PyLong_AsUnsignedLongLong(x))
            }
        } else {
#if CYTHON_USE_PYLONG_INTERNALS
            const digit* digits = ((PyLongObject*)x)->ob_digit;
            switch (Py_SIZE(x)) {
                case  0: return (long) 0;
                case -1: __PYX_VERIFY_RETURN_INT(long, sdigit, (sdigit) (-(sdigit)digits[0]))
                case  1: __PYX_VERIFY_RETURN_INT(long,  digit, +digits[0])
                case -2:
                    if (8 * sizeof(long) - 1 > 1 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, long, -(long) (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                            return (long) (((long)-1)*(((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                        }
                    }
                    break;
                case 2:
                    if (8 * sizeof(long) > 1 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 2 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                            return (long) ((((((long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                        }
                    }
                    break;
                case -3:
                    if (8 * sizeof(long) - 1 > 2 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, long, -(long) (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                            return (long) (((long)-1)*(((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                        }
                    }
                    break;
                case 3:
                    if (8 * sizeof(long) > 2 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 3 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                            return (long) ((((((((long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                        }
                    }
                    break;
                case -4:
                    if (8 * sizeof(long) - 1 > 3 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, long, -(long) (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
                            return (long) (((long)-1)*(((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                        }
                    }
                    break;
                case 4:
                    if (8 * sizeof(long) > 3 * PyLong_SHIFT) {
                        if (8 * sizeof(unsigned long) > 4 * PyLong_SHIFT) {
                            __PYX_VERIFY_RETURN_INT(long, unsigned long, (((((((((unsigned long)digits[3]) << PyLong_SHIFT) | (unsigned long)digits[2]) << PyLong_SHIFT) | (unsigned long)digits[1]) << PyLong_SHIFT) | (unsigned long)digits[0])))
                        } else if (8 * sizeof(long) - 1 > 4 * PyLong_SHIFT) {
                            return (long) ((((((((((long)digits[3]) << PyLong_SHIFT) | (long)digits[2]) << PyLong_SHIFT) | (long)digits[1]) << PyLong_SHIFT) | (long)digits[0])));
                        }
                    }
                    break;
            }
#endif
            if (sizeof(long) <= sizeof(long)) {
                __PYX_VERIFY_RETURN_INT_EXC(long, long, PyLong_AsLong(x))
            } else if (sizeof(long) <= sizeof(PY_LONG_LONG)) {
                __PYX_VERIFY_RETURN_INT_EXC(long, PY_LONG_LONG, PyLong_AsLongLong(x))
            }
        }
        {
#if CYTHON_COMPILING_IN_PYPY && !defined(_PyLong_AsByteArray)
            PyErr_SetString(PyExc_RuntimeError,
                            "_PyLong_AsByteArray() not available in PyPy, cannot convert large numbers");
#else
            long val;
            PyObject *v = __Pyx_PyNumber_IntOrLong(x);
 #if PY_MAJOR_VERSION < 3
            if (likely(v) && !PyLong_Check(v)) {
                PyObject *tmp = v;
                v = PyNumber_Long(tmp);
                Py_DECREF(tmp);
            }
 #endif
            if (likely(v)) {
                int one = 1; int is_little = (int)*(unsigned char *)&one;
                unsigned char *bytes = (unsigned char *)&val;
                int ret = _PyLong_AsByteArray((PyLongObject *)v,
                                              bytes, sizeof(val),
                                              is_little, !is_unsigned);
                Py_DECREF(v);
                if (likely(!ret))
                    return val;
            }
#endif
            return (long) -1;
        }
    } else {
        long val;
        PyObject *tmp = __Pyx_PyNumber_IntOrLong(x);
        if (!tmp) return (long) -1;
        val = __Pyx_PyInt_As_long(tmp);
        Py_DECREF(tmp);
        return val;
    }
raise_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "value too large to convert to long");
    return (long) -1;
raise_neg_overflow:
    PyErr_SetString(PyExc_OverflowError,
        "can't convert negative value to long");
    return (long) -1;
}

/* CheckBinaryVersion */
          static int __Pyx_check_binary_version(void) {
    char ctversion[4], rtversion[4];
    PyOS_snprintf(ctversion, 4, "%d.%d", PY_MAJOR_VERSION, PY_MINOR_VERSION);
    PyOS_snprintf(rtversion, 4, "%s", Py_GetVersion());
    if (ctversion[0] != rtversion[0] || ctversion[2] != rtversion[2]) {
        char message[200];
        PyOS_snprintf(message, sizeof(message),
                      "compiletime version %s of module '%.100s' "
                      "does not match runtime version %s",
                      ctversion, __Pyx_MODULE_NAME, rtversion);
        return PyErr_WarnEx(NULL, message, 1);
    }
    return 0;
}

/* ModuleImport */
          #ifndef __PYX_HAVE_RT_ImportModule
#define __PYX_HAVE_RT_ImportModule
static PyObject *__Pyx_ImportModule(const char *name) {
    PyObject *py_name = 0;
    PyObject *py_module = 0;
    py_name = __Pyx_PyIdentifier_FromString(name);
    if (!py_name)
        goto bad;
    py_module = PyImport_Import(py_name);
    Py_DECREF(py_name);
    return py_module;
bad:
    Py_XDECREF(py_name);
    return 0;
}
#endif

/* TypeImport */
          #ifndef __PYX_HAVE_RT_ImportType
#define __PYX_HAVE_RT_ImportType
static PyTypeObject *__Pyx_ImportType(const char *module_name, const char *class_name,
    size_t size, int strict)
{
    PyObject *py_module = 0;
    PyObject *result = 0;
    PyObject *py_name = 0;
    char warning[200];
    Py_ssize_t basicsize;
#ifdef Py_LIMITED_API
    PyObject *py_basicsize;
#endif
    py_module = __Pyx_ImportModule(module_name);
    if (!py_module)
        goto bad;
    py_name = __Pyx_PyIdentifier_FromString(class_name);
    if (!py_name)
        goto bad;
    result = PyObject_GetAttr(py_module, py_name);
    Py_DECREF(py_name);
    py_name = 0;
    Py_DECREF(py_module);
    py_module = 0;
    if (!result)
        goto bad;
    if (!PyType_Check(result)) {
        PyErr_Format(PyExc_TypeError,
            "%.200s.%.200s is not a type object",
            module_name, class_name);
        goto bad;
    }
#ifndef Py_LIMITED_API
    basicsize = ((PyTypeObject *)result)->tp_basicsize;
#else
    py_basicsize = PyObject_GetAttrString(result, "__basicsize__");
    if (!py_basicsize)
        goto bad;
    basicsize = PyLong_AsSsize_t(py_basicsize);
    Py_DECREF(py_basicsize);
    py_basicsize = 0;
    if (basicsize == (Py_ssize_t)-1 && PyErr_Occurred())
        goto bad;
#endif
    if (!strict && (size_t)basicsize > size) {
        PyOS_snprintf(warning, sizeof(warning),
            "%s.%s size changed, may indicate binary incompatibility. Expected %zd, got %zd",
            module_name, class_name, basicsize, size);
        if (PyErr_WarnEx(NULL, warning, 0) < 0) goto bad;
    }
    else if ((size_t)basicsize != size) {
        PyErr_Format(PyExc_ValueError,
            "%.200s.%.200s has the wrong size, try recompiling. Expected %zd, got %zd",
            module_name, class_name, basicsize, size);
        goto bad;
    }
    return (PyTypeObject *)result;
bad:
    Py_XDECREF(py_module);
    Py_XDECREF(result);
    return NULL;
}
#endif

/* InitStrings */
          static int __Pyx_InitStrings(__Pyx_StringTabEntry *t) {
    while (t->p) {
        #if PY_MAJOR_VERSION < 3
        if (t->is_unicode) {
            *t->p = PyUnicode_DecodeUTF8(t->s, t->n - 1, NULL);
        } else if (t->intern) {
            *t->p = PyString_InternFromString(t->s);
        } else {
            *t->p = PyString_FromStringAndSize(t->s, t->n - 1);
        }
        #else
        if (t->is_unicode | t->is_str) {
            if (t->intern) {
                *t->p = PyUnicode_InternFromString(t->s);
            } else if (t->encoding) {
                *t->p = PyUnicode_Decode(t->s, t->n - 1, t->encoding, NULL);
            } else {
                *t->p = PyUnicode_FromStringAndSize(t->s, t->n - 1);
            }
        } else {
            *t->p = PyBytes_FromStringAndSize(t->s, t->n - 1);
        }
        #endif
        if (!*t->p)
            return -1;
        ++t;
    }
    return 0;
}

static CYTHON_INLINE PyObject* __Pyx_PyUnicode_FromString(const char* c_str) {
    return __Pyx_PyUnicode_FromStringAndSize(c_str, (Py_ssize_t)strlen(c_str));
}
static CYTHON_INLINE char* __Pyx_PyObject_AsString(PyObject* o) {
    Py_ssize_t ignore;
    return __Pyx_PyObject_AsStringAndSize(o, &ignore);
}
static CYTHON_INLINE char* __Pyx_PyObject_AsStringAndSize(PyObject* o, Py_ssize_t *length) {
#if CYTHON_COMPILING_IN_CPYTHON && (__PYX_DEFAULT_STRING_ENCODING_IS_ASCII || __PYX_DEFAULT_STRING_ENCODING_IS_DEFAULT)
    if (
#if PY_MAJOR_VERSION < 3 && __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
            __Pyx_sys_getdefaultencoding_not_ascii &&
#endif
            PyUnicode_Check(o)) {
#if PY_VERSION_HEX < 0x03030000
        char* defenc_c;
        PyObject* defenc = _PyUnicode_AsDefaultEncodedString(o, NULL);
        if (!defenc) return NULL;
        defenc_c = PyBytes_AS_STRING(defenc);
#if __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
        {
            char* end = defenc_c + PyBytes_GET_SIZE(defenc);
            char* c;
            for (c = defenc_c; c < end; c++) {
                if ((unsigned char) (*c) >= 128) {
                    PyUnicode_AsASCIIString(o);
                    return NULL;
                }
            }
        }
#endif
        *length = PyBytes_GET_SIZE(defenc);
        return defenc_c;
#else
        if (__Pyx_PyUnicode_READY(o) == -1) return NULL;
#if __PYX_DEFAULT_STRING_ENCODING_IS_ASCII
        if (PyUnicode_IS_ASCII(o)) {
            *length = PyUnicode_GET_LENGTH(o);
            return PyUnicode_AsUTF8(o);
        } else {
            PyUnicode_AsASCIIString(o);
            return NULL;
        }
#else
        return PyUnicode_AsUTF8AndSize(o, length);
#endif
#endif
    } else
#endif
#if (!CYTHON_COMPILING_IN_PYPY) || (defined(PyByteArray_AS_STRING) && defined(PyByteArray_GET_SIZE))
    if (PyByteArray_Check(o)) {
        *length = PyByteArray_GET_SIZE(o);
        return PyByteArray_AS_STRING(o);
    } else
#endif
    {
        char* result;
        int r = PyBytes_AsStringAndSize(o, &result, length);
        if (unlikely(r < 0)) {
            return NULL;
        } else {
            return result;
        }
    }
}
static CYTHON_INLINE int __Pyx_PyObject_IsTrue(PyObject* x) {
   int is_true = x == Py_True;
   if (is_true | (x == Py_False) | (x == Py_None)) return is_true;
   else return PyObject_IsTrue(x);
}
static CYTHON_INLINE PyObject* __Pyx_PyNumber_IntOrLong(PyObject* x) {
  PyNumberMethods *m;
  const char *name = NULL;
  PyObject *res = NULL;
#if PY_MAJOR_VERSION < 3
  if (PyInt_Check(x) || PyLong_Check(x))
#else
  if (PyLong_Check(x))
#endif
    return __Pyx_NewRef(x);
  m = Py_TYPE(x)->tp_as_number;
#if PY_MAJOR_VERSION < 3
  if (m && m->nb_int) {
    name = "int";
    res = PyNumber_Int(x);
  }
  else if (m && m->nb_long) {
    name = "long";
    res = PyNumber_Long(x);
  }
#else
  if (m && m->nb_int) {
    name = "int";
    res = PyNumber_Long(x);
  }
#endif
  if (res) {
#if PY_MAJOR_VERSION < 3
    if (!PyInt_Check(res) && !PyLong_Check(res)) {
#else
    if (!PyLong_Check(res)) {
#endif
      PyErr_Format(PyExc_TypeError,
                   "__%.4s__ returned non-%.4s (type %.200s)",
                   name, name, Py_TYPE(res)->tp_name);
      Py_DECREF(res);
      return NULL;
    }
  }
  else if (!PyErr_Occurred()) {
    PyErr_SetString(PyExc_TypeError,
                    "an integer is required");
  }
  return res;
}
static CYTHON_INLINE Py_ssize_t __Pyx_PyIndex_AsSsize_t(PyObject* b) {
  Py_ssize_t ival;
  PyObject *x;
#if PY_MAJOR_VERSION < 3
  if (likely(PyInt_CheckExact(b))) {
    if (sizeof(Py_ssize_t) >= sizeof(long))
        return PyInt_AS_LONG(b);
    else
        return PyInt_AsSsize_t(x);
  }
#endif
  if (likely(PyLong_CheckExact(b))) {
    #if CYTHON_USE_PYLONG_INTERNALS
    const digit* digits = ((PyLongObject*)b)->ob_digit;
    const Py_ssize_t size = Py_SIZE(b);
    if (likely(__Pyx_sst_abs(size) <= 1)) {
        ival = likely(size) ? digits[0] : 0;
        if (size == -1) ival = -ival;
        return ival;
    } else {
      switch (size) {
         case 2:
           if (8 * sizeof(Py_ssize_t) > 2 * PyLong_SHIFT) {
             return (Py_ssize_t) (((((size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
           }
           break;
         case -2:
           if (8 * sizeof(Py_ssize_t) > 2 * PyLong_SHIFT) {
             return -(Py_ssize_t) (((((size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
           }
           break;
         case 3:
           if (8 * sizeof(Py_ssize_t) > 3 * PyLong_SHIFT) {
             return (Py_ssize_t) (((((((size_t)digits[2]) << PyLong_SHIFT) | (size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
           }
           break;
         case -3:
           if (8 * sizeof(Py_ssize_t) > 3 * PyLong_SHIFT) {
             return -(Py_ssize_t) (((((((size_t)digits[2]) << PyLong_SHIFT) | (size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
           }
           break;
         case 4:
           if (8 * sizeof(Py_ssize_t) > 4 * PyLong_SHIFT) {
             return (Py_ssize_t) (((((((((size_t)digits[3]) << PyLong_SHIFT) | (size_t)digits[2]) << PyLong_SHIFT) | (size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
           }
           break;
         case -4:
           if (8 * sizeof(Py_ssize_t) > 4 * PyLong_SHIFT) {
             return -(Py_ssize_t) (((((((((size_t)digits[3]) << PyLong_SHIFT) | (size_t)digits[2]) << PyLong_SHIFT) | (size_t)digits[1]) << PyLong_SHIFT) | (size_t)digits[0]));
           }
           break;
      }
    }
    #endif
    return PyLong_AsSsize_t(b);
  }
  x = PyNumber_Index(b);
  if (!x) return -1;
  ival = PyInt_AsSsize_t(x);
  Py_DECREF(x);
  return ival;
}
static CYTHON_INLINE PyObject * __Pyx_PyInt_FromSize_t(size_t ival) {
    return PyInt_FromSize_t(ival);
}


#endif /* Py_PYTHON_H */
